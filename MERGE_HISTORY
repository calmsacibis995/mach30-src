    
    
    
==========================================================================
   ***** MK Version MK31  (rwd) *****
    
    
New features:
--- --------

Debugger has watchpoints.  Breakpoints are map specific.  New software
reference bit code which is currently turned off by default.

Bug fixes:
--- -----

Yes

[I386]	All references to AT386 in makefiles have been duplicated to I386.

Special notes:
------- -----

This merge was done with /afs/cs/project/mach/mach3/tools/bin/m3merge.
mkmerge is dead.  long live m3merge.

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
31
[ ./Makefile ]
Don't make clean include area.
[90/10/24            rwd]
[ ./kernel/boot_ufs/boot_printf.c ]
Modified boot_gets to allocate arrays from heap, not stack.
[90/10/23            rpd]
[ ./kernel/boot_ufs/file_io.c ]
Modified open_file to allocate arrays from heap, not stack.
[90/10/23            rpd]
[ ./kernel/boot_ufs/load.c ]
Modified boot_load_program and read_emulator_symbols
to allocate arrays from heap, not stack.
[90/10/23            rpd]
[ ./MERGE_HISTORY ]
Created
[ ./kernel/conf/Makefile.template ]
[ ./kernel/conf/files ]
Added ddb/db_watch.c.
[90/10/16            rpd]
[ ./kernel/ddb/db_break.c ]
Added map field to breakpoints.
Added map argument to db_set_breakpoint, db_delete_breakpoint,
db_find_breakpoint.  Added db_find_breakpoint_here.
[90/10/18            rpd]
[ ./kernel/ddb/db_break.h ]
Added map field to breakpoints.
[90/10/18            rpd]
[ ./kernel/ddb/db_command.c ]
Changed db_fncall to print the result unsigned.
[90/10/19            rpd]

Added CS_MORE to db_watchpoint_cmd.
[90/10/17            rpd]
Added watchpoint commands: watch, dwatch, show watches.
[90/10/16            rpd]
[ ./kernel/ddb/db_print.c ]
Changed db_show_regs to print unsigned.
[90/10/19            rpd]
Generalized the watchpoint support.
[90/10/16            rwd]
[ ./kernel/ddb/db_run.c ]
Changed db_find_breakpoint to db_find_breakpoint_here.
[90/10/18            rpd]

Fixed db_set_single_step to pass regs to branch_taken.
Added watchpoint argument to db_restart_at_pc.
[90/10/17            rpd]
Generalized the watchpoint support.
[90/10/16            rwd]
Added watchpoint support.
[90/10/16            rpd]
[ ./kernel/ddb/db_sym.c ]
Changed db_printsym to print unsigned.
[90/10/19            rpd]
[ ./kernel/ddb/db_trap.c ]
From rpd.
[90/10/19  17:03:17  rwd]

Generalized the watchpoint support.
[90/10/16            rwd]
Added watchpoint support.
[90/10/16            rpd]
[ ./kernel/ddb/db_watch.c ]
Made db_watchpoint_cmd parse a size argument.
[90/10/17            rpd]
Generalized the watchpoint support.
[90/10/16            rwd]
Created.
[90/10/16            rpd]
[ ./kernel/ddb/db_watch.h ]
Generalized the watchpoint support.
[90/10/16            rwd]
Created.
[90/10/16            rpd]
[ ./kernel/ddb/db_write_cmd.c ]
Changed db_write_cmd to print unsigned.
[90/10/19            rpd]
[ ./kernel/device/ds_routines.c ]
Let ds_device_write proceed w/o a valid reply port.  This is used
by the unix server ether_output routine.
[90/10/22            rwd]
Fixed ds_write_done to use ds_device_write_inband_reply
when appropriate.
[90/10/18            rpd]
Check for invalid reply ports.
[90/10/17            rwd]
[ ./kernel/i386/db_interface.c ]
Added watchpoint support.
[90/10/18            rpd]

Created.
[90/07/25            dbg]
[ ./kernel/i386/db_machdep.h ]
Added watchpoint support.
[90/10/18            rpd]
[ ./kernel/i386/trap.c ]
Added watchpoint support.
[90/10/18            rpd]
[ ./kernel/i386/trap.h ]
Added watchpoint support.
[90/10/18            rpd]
[ ./kernel/kern/debug.c ]
Change sun3 debugger invocation.
[90/10/17            rwd]
[ ./kernel/kern/printf.c ]
Purged uprintf.
[90/10/21            rpd]
[ ./kernel/kern/task.c ]
From OSF: Add thread_block() to loop that forcibly terminates
threads in task_terminate() to fix livelock.  Also hold
reference to thread when calling thread_force_terminate().
[90/10/19            rpd]
[ ./kernel/kern/thread.c ]
Added host_stack_usage and processor_set_stack_usage.
[90/10/22            rpd]

Removed pausing code in stack_alloc/stack_free.
It was broken and it isn't needed.
Added code to check how much stack is actually used.
[90/10/21            rpd]
[ ./kernel/mach_debug/mach_debug.defs ]
Added processor_set_stack_usage.
[90/10/22            rpd]
[ ./kernel/mach_debug/mach_debug_types.defs ]
Updated vm_info_region_t size.
[90/10/17            rpd]
[ ./kernel/mips/PMAX/devio.h ]
Changed uprintf to printf.
[90/10/21            rpd]
[ ./kernel/mips/db_interface.c ]
Support for watchpoints.
[90/10/16            rpd]
[ ./kernel/mips/db_machdep.h ]
Generalized the watchpoint support.
[90/10/16            rwd]
Added watchpoint support.
[90/10/16  21:09:42  rpd]
[ ./kernel/mips/pmap.c ]
Fixed the OSF pmap_protect fixes.
[90/10/21            rpd]
[ ./kernel/mips/trap.c ]
Removed static from getreg_val.
[90/10/17            rpd]
Generalized the watchpoint support.
[90/10/16            rwd]
Added watchpoint support.
[90/10/16            rpd]
[ ./kernel/sun3/db_interface.c ]
Added watchpoint support.
[90/10/16            rwd]
[ ./kernel/sun3/db_machdep.h ]
Added watchpoint support.
[90/10/16            rwd]
[ ./kernel/sun3/pmap.c ]
Change asm instructions to Debugger().
[90/10/17            rwd]
Added hardware_reference_bits runtime switch.
[90/10/13            rpd]
[ ./kernel/sun3/softint.c ]
Always enable softints when a softcall request is done.
[90/10/17            rwd]
[ ./kernel/sun3/trap.c ]
Fixed the map argument to db_find_watchpoint.
Made the faultaddr argument to pagefault a vm_offset_t.
[90/10/18            rpd]
Added watchpoint support.
[90/10/16            rwd]
[ ./kernel/sun3/trap.h ]
Added watchpoint support.
[90/10/16            rwd]
[ ./kernel/sundev/sd.c ]
Changed uprintf to printf.
[90/10/21            rpd]
Remove excess debugging code.
[90/10/21            rwd]
[ ./kernel/sundev/st.c ]
Changed uprintf to printf.
[90/10/21            rpd]
[ ./kernel/vax/db_interface.c ]
Added watchpoint support.
[90/10/18            rpd]
[ ./kernel/vax/db_machdep.h ]
Added watchpoint support.
[90/10/18            rpd]
[ ./kernel/vax/trap.c ]
Added watchpoint support.
[90/10/18            rpd]
[ ./kernel/vax/trap.h ]
Added watchpoint support.
[90/10/18            rpd]
[ ./kernel/vm/memory_object.c ]
Clean and not flush pages to lock request get moved to the
inactive queue.
[90/10/24            rwd]
[ ./kernel/vm/vm_fault.c ]
Turn software_reference_bits off by default.
[90/10/25            rwd]

Extended software_reference_bits to vm_fault_page.
[90/10/24            rpd]
Fixed vm_fault_page to clear the modify bit on zero-filled pages.
[90/10/23            rpd]
Added watchpoint debugger support.
[90/10/16            rpd]
Added software_reference_bits runtime switch.
[90/10/13            rpd]
Added watchpoint debugger support.
[90/10/16            rpd]
Added software_reference_bits runtime switch.
[90/10/13            rpd]
[ ./kernel/vm/vm_map.c ]
Fixed bug in vm_map_enter that was introduced in 2.13.
[90/10/21            rpd]
[ ./kernel/vm/vm_page.h ]
Removed the max_mapping field of pages.
[90/10/22            rpd]
[ ./kernel/vm/vm_resident.c ]
Made vm_page_alloc_deactivate_behind TRUE.
[90/10/24            rwd]

Removed the max_mapping field of pages.
[90/10/22            rpd]
[ ./user/libmach/Makefile ]
Add I386 fields.
[90/10/24            rwd]
    
    
    
==========================================================================
   ***** MK Version MK32  (rpd) *****
    
    
New features:
--- --------

I added a ddb command to search memory for a value:
	search [/bhl] addr value [mask] [,count]

Randy added cthread_fork_{prepare,child,parent}.

I added a patchable boolean, zone_check, that causes
zfree to check the consistency of zone free lists.

I changed the IPC reference-counting functions/macros
to make it easier to debug reference-count problems.

[SUN3]	  Picked up ie and xy drivers from NCSC.

[I386]	  Picked up various goodies from Bob.
The pc586 driver works now on both 386 and 486.
The first 640K of memory is available now.
The kernel tells DOS to warm boot upon reboot.
The debugger prints five arguments to functions in traces.


Bug fixes:
--- -----

I picked up dlb's vm_object_deallocate fix for a nasty race.

I fixed vm_page_deactivate to not deactivate busy pages.
(It can find busy pages on the active list when software_reference_bits
is enabled.)  Now vm_page_deactivate requires that the page's
object is locked.

I ripped out vm_region_old_behavior.  Now vm_region() has the same
semantics as in Mach 2.5.

I fixed memory_object_terminate in the device pager
to return a value.

I fixed crt0.o so that it is usable by non-standalone programs.

I fixed the assert macro so that it doesn't try to drop into ddb
when already in ddb.

I unified untimeout and untimeout_try, and fixed the related MP bugs.

[PMAX]	  Fixed jmp_buf to have the standard size.


Organizational changes:
-------------- -------

Randy fixed the Makefiles for STUMP.  This means you must use
the alpha/beta make and cpp on non-386 machines.

Randy added spin_lock_t and associated changes to cthreads.


Special notes:
------- -----

The ddb search command might fail in interesting ways if it doesn't
find the searched-for value.  This is because ddb doesn't always
recover from touching bad memory.  The optional count argument
limits the search.

The cthread_fork_* functions aren't tested.



[ ./conf/version.edit ]
32
[ ./user/libmach/Makefile ]
Added start_float.s, for the Sun-3.
[90/11/01            rpd]
Added exit.c.
[90/10/30            rpd]
[ ./include/Makeconf ]
Added REG_EXP.
[90/10/29            rwd]
[ ./include/Makefile ]
Added machine/cthreads.h include file from libthreads.
[90/11/01            rwd]
Added REG_EXP.
[90/10/29            rwd]
[ ./kernel/Makeconf ]
SUN->SUN3.
[90/10/31            rwd]
Added REG_EXP.
[90/10/29            rwd]

Change MACHINE to TARGET_MACHINE.
[90/10/29            rwd]
[ ./kernel/Makefile ]
SUN->SUN3.
[90/10/31            rwd]
Change MACHINE to TARGET_MACHINE.
[90/10/29            rwd]
[ ./kernel/conf/MASTER.sun3 ]
Added BWS.
[90/10/26  17:01:06  rwd]
[ ./kernel/conf/Makefile.template ]
Added REG_EXP.
[90/10/29            rwd]
[ ./kernel/conf/buildconf.sun3 ]
First use for 3.0
[90/10/26            rwd]
[ ./kernel/ddb/db_break.c ]
Initialize db_breakpoints_inserted to TRUE.
[90/11/04            rpd]
[ ./kernel/ddb/db_watch.c ]
Initialize db_watchpoints_inserted to TRUE.
[90/11/04            rpd]
[ ./kernel/device/dev_pager.c ]
Fixed memory_object_terminate to return KERN_SUCCESS.
[90/10/29            rpd]
[ ./kernel/i386/bcopy.s ]
Introduce bcopy16.  For 16bit copies to bus memory
[90/11/02            rvb]
[ ./kernel/i386/db_trace.c ]
If we can not guess the number of args to a function, use 5 vs 0.
[90/11/02            rvb]
[ ./kernel/i386/i386_init.c ]
Start first_addr at 0x1000 and define first available page 
after the kernel's end as first_avail.
Flush EXL.
[90/09/05            rvb]
[ ./kernel/i386/pmap.c ]
Replace (va < vm_first_phys || va > vm_last_phys) with test
using valid page.  Otherwise, video buffer memory is treated as
valid memory and setting dirty bits leads to disasterous results.
[90/11/05            rvb]

Define pmap_valid_page: [0x1000..cnvmem * 1024) and
			[first_avail..)
as useable memory
[90/09/05            rvb]
[ ./kernel/i386/start.s ]
Since we steal pages after esym for page tables, use first_avail
to record the last page +1 that we stole.
Tell bios to warm boot on reboot.
[90/09/05            rvb]
[ ./kernel/i386at/i82586.h ]
Document error bits in Xmt and Rcv.
[90/10/08            rvb]
[ ./kernel/i386at/if_pc586.c ]
Convert for pure kernel
[90/11/02            rvb]

Init scb and reset as per spec.  Use bcopy16 vs pc586copy as per spec.
Accumulate counters at hwrst.  Add counters everywhere.
Editing and style and consistency cleanup.
Flush NOP's: this required major mods to hwrst and everything it
called -- testing OK is not correct if the command is not COMPLETE.
Lot's of code clean up in xmt, rcv, reqfd.
Flush pc_softc_t "address" and pc586ehcpy.
Handle loopback of our ownbroadcast.
The rcv and xmt loops have been rewriten not copy sram
to the t_packet buffer.  This yields a teriffic thruput
improvement.
Add Notes and sram map.
[90/09/28            rvb]
[ ./kernel/i386at/if_pc586.h ]
Create 18 TBD's so that we can copy up a chain of
mbuf's.
[90/10/03            rvb]
[ ./kernel/ipc/ipc_kmsg.c ]
Changed ip_reference to ipc_port_reference.
Changed ip_release to ipc_port_release.
Use new io_reference and io_release.
Use new ip_reference and ip_release.
[90/10/29            rpd]
[ ./kernel/ipc/ipc_mqueue.c ]
Use new io_reference and io_release.
Use new ip_reference and ip_release.
[90/10/29            rpd]
[ ./kernel/ipc/ipc_object.c ]
Removed ipc_object_reference_macro, ipc_object_release_macro.
Use new io_reference and io_release.
Use new ip_reference and ip_release.
[90/10/29            rpd]
[ ./kernel/ipc/ipc_object.h ]
Removed ipc_object_reference_macro, ipc_object_release_macro.
Created new io_reference, io_release macros.
[90/10/29            rpd]
[ ./kernel/ipc/ipc_port.c ]
Changed ip_release to ipc_port_release.
Use new ip_reference and ip_release.
[90/10/29            rpd]
[ ./kernel/ipc/ipc_port.h ]
Added ipc_port_reference, ipc_port_release.
[90/10/29            rpd]
[ ./kernel/ipc/ipc_pset.c ]
Use new ips_reference and ips_release.
[90/10/29            rpd]
[ ./kernel/ipc/ipc_pset.h ]
Added ipc_pset_reference, ipc_pset_release.
[90/10/29            rpd]
[ ./kernel/ipc/ipc_right.c ]
Changed io_release to ipc_object_release.
Changed ip_release to ipc_port_release.
Use new ip_reference and ip_release.
[90/10/29            rpd]
[ ./kernel/ipc/ipc_space.c ]
Use new ip_reference and ip_release.
[90/10/29            rpd]
[ ./kernel/ipc/mach_msg.c ]
Removed ipc_object_release_macro.
Changed ip_reference to ipc_port_reference.
Changed ip_release to ipc_port_release.
Changed io_release to ipc_object_release.
Use new io_reference and io_release.
Use new ip_reference and ip_release.
[90/10/29            rpd]
[ ./kernel/kern/assert.h ]
Changed assert to use Assert instead of Debugger.
[90/11/04            rpd]
[ ./kernel/kern/debug.c ]
Added Assert.
[90/11/04            rpd]
[ ./kernel/kern/ipc_mig.c ]
Changed ip_reference to ipc_port_reference.
Changed ip_release to ipc_port_release.
Removed ipc_object_release_macro.
Use new ip_reference and ip_release.
[90/10/29            rpd]
[ ./kernel/kern/ipc_tt.c ]
Changed ip_reference to ipc_port_reference.
Use new ip_reference and ip_release.
[90/10/29            rpd]
[ ./kernel/kern/lock.h ]
Added simple_lock_taken.
[90/11/04            rpd]
[ ./kernel/kern/mach_clock.c ]
Unified untimeout and untimeout_try.
[90/10/29            rpd]
[ ./kernel/kern/syscall_subr.c ]
Restored missing multiprocessor untimeout failure code.
[90/10/29            rpd]
[ ./kernel/kern/thread.c ]
Unified untimeout and untimeout_try.
[90/10/29            rpd]
[ ./kernel/kern/time_out.h ]
Changed untimeout to return boolean.
[90/10/29            rpd]
[ ./kernel/kern/zalloc.c ]
Added zone_check option to zfree.
[90/10/29            rpd]
[ ./kernel/mips/PMAX/pm_tty.c ]
Fixed untimeout usage.
[90/10/29            rpd]
[ ./kernel/src/mig/Makefile ]
SUN->SUN3.
[90/10/31            rwd]
Change MACHINE to TARGET_MACHINE.
[90/10/29            rwd]
[ ./kernel/sun/conf.c ]
Added ie and xy from NCSC.
[90/10/26            rwd]
[ ./kernel/sundev/mbvar.h ]
Change from NCSC for xydriver.
[90/10/26            rwd]

Altered for MACH_KERNEL.
[88/03/22            dbg]
[ ./kernel/sundev/xy.c ]
change to use kalloc, kfree instead of sun_kmem_alloc, sun_kmem_free
from NCSC.
[90/10/26            rwd]
[ ./kernel/sundev/xy_conf.c ]
3.0 changes from NCSC.
[90/10/26            rwd]
[ ./kernel/sunif/if_ie.c ]
Changes for 3.0 from NCSC.
[90/10/26            rwd]
[ ./kernel/sunif/if_iereg.h ]
Changes for 3.0 from NCSC.
[90/10/26            rwd]
[ ./kernel/sunif/if_ievar.h ]
Changes for 3.0 from NCSC.
[90/10/26            rwd]
[ ./kernel/sunif/if_mie.h ]
First Checkin.
[90/10/26            rwd]
[ ./kernel/sunif/if_obie.h ]
First checkin.
[90/10/26            rwd]
[ ./kernel/sunif/if_tie.h ]
First Checkin.
[90/10/26            rwd]
[ ./kernel/vm/vm_map.c ]
Removed vm_region_old_behavior.
[90/11/02            rpd]
[ ./kernel/vm/vm_object.h ]
Added vm_object_lock_taken.
[90/11/04            rpd]
[ ./kernel/vm/vm_pageout.c ]
Modified vm_pageout_scan for new vm_page_deactivate protocol.
[90/11/04            rpd]
[ ./kernel/vm/vm_resident.c ]
Changed vm_page_deactivate to remove busy pages from the page queues.
Now it requires that the page's object be locked.
[90/11/04            rpd]
[ ./user/libmach/Makefile ]
SUN->SUN3.
[90/10/31            rwd]
Change MACHINE to TARGET_MACHINE.
[90/10/29            rwd]
[ ./user/libmach/exit.c ]
Created.
[90/10/30            rpd]
[ ./user/libmach/i386/crt0.c ]
Removed the definition of exit.
[90/10/30            rpd]
[ ./user/libmach/mips/crt0.cv ]
Removed the definition of exit.
[90/10/30            rpd]
[ ./user/libmach/mips/crt0.ss ]
Removed the definition of exit.
[90/10/30            rpd]
[ ./user/libmach/setjmp.h ]
Changed the mips jmp_buf definition to the normal size.
[90/10/30            rpd]
[ ./user/libmach/sun3/crt0.s ]
Restored call to _exit if exit returns.
Restored call to start_float.
[90/11/01            rpd]
Call exit instead of task_terminate.
[90/10/30            rpd]
[ ./user/libmach/sun3/start_float.s ]
Created.
[90/11/01            rpd]
[ ./user/libmach/vax/crt0.cc ]
Removed the definition of exit.
[90/10/30            rpd]
[ ./user/threads/Makefile ]
Change MACHINE to TARGET_MACHINE.
[90/10/29            rwd]
[ ./user/threads/cprocs.c ]
Added cproc_fork_{prepare,parent,child}.
[90/11/02            rwd]

Fix for positive stack growth.
[90/11/01            rwd]

Add spin_lock_t.
[90/10/31            rwd]
[ ./user/threads/cthread_internals.h ]
Added spin_lock_t.
[90/10/31            rwd]
[ ./user/threads/cthreads.c ]
Added cthread_fork_{prepare,parent,child}.
[90/11/02            rwd]

Add spin_lock_t.
[90/10/31            rwd]
[ ./user/threads/cthreads.h ]
Include machine/cthreads.h.  Added spin_lock_t.
[90/10/31            rwd]
[ ./user/threads/i386/cthreads.h ]
Created.
[90/11/01            rwd]
[ ./user/threads/malloc.c ]
Added malloc_fork* code.
[90/11/02            rwd]

Add spin_lock_t.
[90/10/31            rwd]
[ ./user/threads/mips/cthreads.h ]
Created.
[90/11/01            rwd]
[ ./user/threads/stack.c ]
Fixed addr_range_check for new vm_region semantics.
[90/11/02            rpd]
[ ./user/threads/sun3/cthreads.h ]
Created.
[90/11/01            rwd]
[ ./user/threads/sync.c ]
Fix casting.  Use new macros.
[90/10/31            rwd]
[ ./user/threads/vax/cthreads.h ]
Created.
[90/11/01            rwd]
[ ./kernel/conf/version.variant ]
Changed XMK to MK.
[ ./user/threads/stack.c ]
Added cproc_stack_base.  Add stack_fork_child().
[90/11/01            rwd]
[ ./kernel/vm/vm_object.c ]
From dlb@osf.org:
If pager initialization is in progress (object->pager_created &&
!object->pager_initialized), then vm_object_deallocate must wait
for it to complete before terminating the object.  Because anything
can happen in the interim, it must recheck its decision to terminate
after the wait completes.
[ ./kernel/ddb/db_command.c ]
Added search.
[90/11/06            rpd]
[ ./kernel/ddb/db_examine.c ]
Added db_search_cmd, db_search.
[90/11/06            rpd]
    
    
    
==========================================================================
   ***** MK Version MK33  (jsb) *****
    
    
New features:
--- --------

[I386]	  Added cnp ethernet driver for i386ipsc2 (Intel Hypercube).

Bug fixes:
--- -----

[I386]	  Fixed changes in MK32 which prevented STD+NORMA+iPSC2 from building.
    
    
    
==========================================================================
   ***** MK Version MK34  (jsb) *****
    
    
New features:
--- --------

Added i860 build support (for the hypercube). Details follow.
The i860 and i860ipsc2 source directories will be added in a future merge.

Added support to conf/Makefile.template for cross-compilation.
I borrowed the not-otherwise-used KCC technology so that $(KCC)
is used to build kernel files (and thus would be the cross
compiler), whereas $(CC) is used to build things like genassym
which run on the host (in this case, a i386). I fixed a couple
cases in Makefile.template that didn't conform to this convention:
vers.o is now compiled with $(KCC), and genassym is now compiled
with $(CC). I also added work-arounds for the fact that we don't
have a cross-ranlib or a cross-size.

[I860]	  Added conf/MASTER.i860{,.local}, conf/{Makefile,files}.i860,
	  and added i860 support to config, mach/machine.h, and
	  sys/varargs.h.
    
    
    
==========================================================================
   ***** MK Version MK35  (rvb) *****
    
    
This is an I386 architecture release only.  It has been tested
on an AT as well as the hypercube.

No New features:
--- --------

Except possibly that the if_pc586.c is not timing dependent
any more.

The big deal about this release is that all the files in the 
i386at directory and the files in Mach2.5 I386q are identical --
that is all improvements in the mainline have been merged to
the 3.0 code and vice versa.  NOTE:  the 3.0 com driver has 
not been tested cause I did not have any hardware.  Also I
have lpr and if_par drivers that I did not even install for
the same reason.  (I needed to install com.c for the mouse
support code.)

ALSO, this release has the Prime copyrights changed to something
less threatening, courtesy of Prime Computer Inc.

Bug fix:
The panic that rfr reported with the ram_to_ptr is no longer
possible.



    
    
    
==========================================================================
   ***** MK Version MK36  (jsb) *****
    
    
New features:
--- --------

Merged in i860 support for iPSC Intel hypercube.

Merged i860 and i386 pmap.{c,h} into new intel directory.

Merged i860 and i386 ipsc support into new ipsc directory.

Added ATSYS variable which can be used to override use of @sys
in OBJECTDIR when cross-compiling.

Changed ipsc2 references to ipsc386 or simply ipsc, as appropriate.

Removed libmig.a workaround from conf/Makefile.template since the same
thing can be acheived entirely within conf/Makefile.{machine}.
    
    
    
==========================================================================
   ***** MK Version MK37  (af) *****
    
    
New features:
--- --------

This merge brings freedom to PMAXen, there is now only one single file
left in the kernel with a MIPSco Copyright on it: mips/softfp.s which
is optional.  No DEC Copyright in sight, we only loose support for the
2D/3D boxes [actually only the 2D, I have never seen a 3D].

The entire mips/PMAX subdir is new, the only pieces I recovered are
the code Joe wrote for the terminal emulator and the in-kernel ether 
driver that Bob & I wrote/rewrote/rewrote....  Everything else is new.
The various drivers are in various stages of "maturity": the ether is 
rock-solid, the screen&serial line is quite robust.

The SCSI driver is the one likely to need most fixes and additions.
Among the missing features are:
	- true SCSI-2 support and adherence to the standard
	- disconnect/reconnect capability when more than one
	  drive is on the bus
In the PMAX case then there are still various misteries to be solved,
one most annoying: if you do not tell the prom to "init" before rebooting
it will get locked up in bus-error interrupts at the first synchronous
data transfer.  Beats me why.  It also seems to me it is much slower than it
needs to, but I won't measure it until I understand it.

Added BSD/OSF labels to kernel.

New cute font, and related tools.

New 16 sec bootstrap: shows that you do not need two levels of boots
to be flexible.  With this one you can boot any file on disk, follow
symlinks, even cross-device links (but of a very weird type..) and
all fits in 15 sectors.  Mostly C code.

Added new header file for TAPE devices.  Not that it really works yet,
but we'll get around that too.

Enabled mapped ether by default.

Added missing code to make the pmap pcache work.

Changed pmap_reference_bits array encoding, saves a cycle in tlb_umiss
as suggested by dbg.


Bug fixes:
--- -----

MP-Bug fix from DLB to thread_suspend/resume.

[i386]
Fixed syscall_sw.h to be palatable to the GNU preproc.

[PMAX]	
Fixed rpd's register leak.  Added optional code to locore to zero temporary
registers out of a syscall.
Fix from Larry Allen: kernel thread were started with interrupts disabled.
Fixed off-by-one in syscall emulation table size: Ultrix code does use
syscall 257 too.
Fixed memory sizing routine for 3max to clear memory: this way we won't
get those misterious "dropped because of previous paging-errors".
Various minor spot clean for new 3max proms.




Organizational changes:
-------------- -------

[PMAX]
The new 16 sector bootstrap is built make-ing in kernel/mips/boot.
Be careful with this: with Berkeley labels you cannot anymore just
dd any file in there: it now knows about partitioning.  See the
Makefile for more info.


Special notes:
------- -----

Booted on pmax(unnamed), 3max(testarossa), vax(nova), sun3(rocky)
and i386(intel2)

***************************************************
The following files have been Defuncted:

[ ./kernel/mips/symbols.raw ]
[ ./kernel/mips/PMAX/ascreg.h ]
[ ./kernel/mips/PMAX/cfb.c ]
[ ./kernel/mips/PMAX/cfbreg.h ]
[ ./kernel/mips/PMAX/dc7085cons.h ]
[ ./kernel/mips/PMAX/dc_hdw.c ]
[ ./kernel/mips/PMAX/dc_modem.c ]
[ ./kernel/mips/PMAX/dc_tty.c ]
[ ./kernel/mips/PMAX/devio.h ]
[ ./kernel/mips/PMAX/ga.c ]
[ ./kernel/mips/PMAX/ga.h ]
[ ./kernel/mips/PMAX/gq.c ]
[ ./kernel/mips/PMAX/gq.h ]
[ ./kernel/mips/PMAX/gx.c ]
[ ./kernel/mips/PMAX/gx.h ]
[ ./kernel/mips/PMAX/fudge.h ]
[ ./kernel/mips/PMAX/pm.h ]
[ ./kernel/mips/PMAX/pm_graphics.c ]
[ ./kernel/mips/PMAX/pm_hdw.h ]
[ ./kernel/mips/PMAX/pm_lk201.c ]
[ ./kernel/mips/PMAX/pm_lk201.h ]
[ ./kernel/mips/PMAX/pm_ms.c ]
[ ./kernel/mips/PMAX/pm_ms.h ]
[ ./kernel/mips/PMAX/pm_switch.c ]
[ ./kernel/mips/PMAX/pm_switch.h ]
[ ./kernel/mips/PMAX/pm_tty.c ]
[ ./kernel/mips/PMAX/pmax.c ]
[ ./kernel/mips/PMAX/pmevent.h ]
[ ./kernel/mips/PMAX/pmioctl.h ]
[ ./kernel/mips/PMAX/qfont.c ]
[ ./kernel/mips/PMAX/rzdisk.h ]
[ ./kernel/mips/PMAX/scsi_asc.c ]
[ ./kernel/mips/PMAX/scsi_data.c ]
[ ./kernel/mips/PMAX/scsi_debug.h ]
[ ./kernel/mips/PMAX/scsi_sii.c ]
[ ./kernel/mips/PMAX/scsireg.h ]
[ ./kernel/mips/PMAX/siireg.h ]
[ ./kernel/mips/PMAX/stamp.h ]
[ ./kernel/mips/PMAX/super.c ]
[ ./kernel/mips/PMAX/scsivar.h ]

The following files are new

[ ./kernel/mips/PMAX/boot/Makefile ]
[ ./kernel/mips/PMAX/boot/asm_misc.h ]
[ ./kernel/mips/PMAX/boot/asm_misc.s ]
[ ./kernel/mips/PMAX/boot/c_misc.c ]
[ ./kernel/mips/PMAX/boot/dev.h ]
[ ./kernel/mips/PMAX/boot/dir.h ]
[ ./kernel/mips/PMAX/boot/disk_inode.h ]
[ ./kernel/mips/PMAX/boot/fs.h ]
[ ./kernel/mips/PMAX/boot/label.b ]
[ ./kernel/mips/PMAX/boot/mkboot.c ]
[ ./kernel/mips/PMAX/boot/primary_boot.c ]
[ ./kernel/mips/PMAX/boot/start.s ]
[ ./kernel/mips/PMAX/boot/test.c ]
[ ./kernel/mips/PMAX/boot/ufs.c ]
[ ./kernel/mips/PMAX/boot/ufs.h ]
[ ./kernel/mips/PMAX/bt459.c ]
[ ./kernel/mips/PMAX/bt459.h ]
[ ./kernel/mips/PMAX/bt478.c ]
[ ./kernel/mips/PMAX/bt478.h ]
[ ./kernel/mips/PMAX/build_font.c ]
[ ./kernel/mips/PMAX/cfb_hdw.c ]
[ ./kernel/mips/PMAX/cfb_misc.c ]
[ ./kernel/mips/PMAX/dc503.c ]
[ ./kernel/mips/PMAX/dc503.h ]
[ ./kernel/mips/PMAX/dz_7085.h ]
[ ./kernel/mips/PMAX/dz_defs.h ]
[ ./kernel/mips/PMAX/dz_hdw.c ]
[ ./kernel/mips/PMAX/dz_tty.c ]
[ ./kernel/mips/PMAX/ga_hdw.c ]
[ ./kernel/mips/PMAX/gq_hdw.c ]
[ ./kernel/mips/PMAX/gx_misc.c ]
[ ./kernel/mips/PMAX/kernel_font.c ]
[ ./kernel/mips/PMAX/kernel_font.data ]
[ ./kernel/mips/PMAX/kn01.c ]
[ ./kernel/mips/PMAX/kn01.h ]
[ ./kernel/mips/PMAX/kn02.c ]
[ ./kernel/mips/PMAX/kn02.h ]
[ ./kernel/mips/PMAX/lk201.c ]
[ ./kernel/mips/PMAX/lk201.h ]
[ ./kernel/mips/PMAX/mapped_scsi.c ]
[ ./kernel/mips/PMAX/mapped_scsi.h ]
[ ./kernel/mips/PMAX/mouse.c ]
[ ./kernel/mips/PMAX/pm_defs.h ]
[ ./kernel/mips/PMAX/pm_hdw.c ]
[ ./kernel/mips/PMAX/pm_misc.c ]
[ ./kernel/mips/PMAX/pmad_aa.h ]
[ ./kernel/mips/PMAX/pmag_ba.h ]
[ ./kernel/mips/PMAX/pmaz_aa.h ]
[ ./kernel/mips/PMAX/rz.c ]
[ ./kernel/mips/PMAX/rz.h ]
[ ./kernel/mips/PMAX/rz_disk.c ]
[ ./kernel/mips/PMAX/rz_labels.h ]
[ ./kernel/mips/PMAX/rz_tape.c ]
[ ./kernel/mips/PMAX/screen.c ]
[ ./kernel/mips/PMAX/screen.h ]
[ ./kernel/mips/PMAX/screen_defs.h ]
[ ./kernel/mips/PMAX/screen_switch.c ]
[ ./kernel/mips/PMAX/screen_switch.h ]
[ ./kernel/mips/PMAX/scsi.c ]
[ ./kernel/mips/PMAX/scsi.h ]
[ ./kernel/mips/PMAX/scsi2.h ]
[ ./kernel/mips/PMAX/scsi_53C94.h ]
[ ./kernel/mips/PMAX/scsi_53C94_hdw.c ]
[ ./kernel/mips/PMAX/scsi_7061.h ]
[ ./kernel/mips/PMAX/scsi_7061_hdw.c ]
[ ./kernel/mips/PMAX/scsi_alldevs.c ]
[ ./kernel/mips/PMAX/scsi_comm.c ]
[ ./kernel/mips/PMAX/scsi_cpu.c ]
[ ./kernel/mips/PMAX/scsi_defs.h ]
[ ./kernel/mips/PMAX/scsi_disk.c ]
[ ./kernel/mips/PMAX/scsi_jukebox.c ]
[ ./kernel/mips/PMAX/scsi_optical.c ]
[ ./kernel/mips/PMAX/scsi_printer.c ]
[ ./kernel/mips/PMAX/scsi_rom.c ]
[ ./kernel/mips/PMAX/scsi_scanner.c ]
[ ./kernel/mips/PMAX/scsi_tape.c ]
[ ./kernel/mips/PMAX/scsi_worm.c ]

The following files have been modified:

[ ./Directories/ALL ]
[ ./Directories/mips ]
[ ./include/Makefile ]
[ ./kernel/conf/MASTER.mips ]
[ ./kernel/conf/files.mips ]
[ ./kernel/device/param.h ]
[ ./kernel/device/tape_status.h ]
[ ./kernel/device/tty_status.h ]
[ ./kernel/kern/syscall_emulation.c ]
[ ./kernel/kern/thread.c ]
[ ./kernel/mach/i386/syscall_sw.h ]
[ ./kernel/mips/PMAX/if_se.c ]
[ ./kernel/mips/PMAX/if_se.h ]
[ ./kernel/mips/PMAX/if_se_mapped.c ]
[ ./kernel/mips/PMAX/mc_clock.c ]
[ ./kernel/mips/PMAX/mips_box.c ]
[ ./kernel/mips/PMAX/mips_box.h ]
[ ./kernel/mips/PMAX/model_dep.c ]
[ ./kernel/mips/PMAX/tc.c ]
[ ./kernel/mips/PMAX/tc.h ]
[ ./kernel/mips/autoconf.c ]
[ ./kernel/mips/busses.c ]
[ ./kernel/mips/busses.h ]
[ ./kernel/mips/coff.h ]
[ ./kernel/mips/conf.c ]
[ ./kernel/mips/context.s ]
[ ./kernel/mips/db_interface.c ]
[ ./kernel/mips/db_mips_sym.c ]
[ ./kernel/mips/exec.c ]
[ ./kernel/mips/locore.s ]
[ ./kernel/mips/mips_init.c ]
[ ./kernel/mips/mips_misc.c ]
[ ./kernel/mips/pcb.c ]
[ ./kernel/mips/pmap.c ]
[ ./kernel/mips/prom_interface.h ]
[ ./kernel/mips/start.s ]
[ ./kernel/mips/tlb.s ]
[ ./kernel/mips/trap.c ]
[ ./user/libmach/Makefile ]

    
    
    
==========================================================================
   ***** MK Version MK38  (jsb) *****
    
    
New features:
--- --------

Replaced uses of @sys in Makefiles and Makeconf with $(atsys).
atsys is set to ATSYS if defined, @sys if not.

[MACH_CLPORT]	Support for complex inter-node messages.

[MACH_CLBOOT]	Support for transparent inter-node device access.

[iPSC]		New dcm interface for MACH_CLPORT support.

[iPSC]		Finished merge of i860 and i386 console driver (usm.c).
    
    
    
==========================================================================
   ***** MK Version MK39  (jeffreyh) *****
    
    
New features:
--- --------

Zone gc code has been picked up from OSF/1. All zones in the system
are now collected. zchange now takes an extra argument for
collectable. This is so you could turn collection off for a zone.


[I386]   The 386 is now buildable using the gcc-cpp from MtXinu.
         Several additions to the code for __STDC__ have been made.
         Due to this work mig no longer generates prototypes for ansi C
         and C++ in the generated header files. This is because the
     	 prototypes in the headers were for the the client side only.
         Kernel files that were including these headers would fail
         to compile as the types and number of arguments to the
	 functions was wrong. If prototypes are wanted for mig
	 headers, mig must be made to generate both client and server
  	 header files with apropriate prototypes.


Bug fixes:
--- -----

[PMAX]	 scsi disk fixes from af

A few others


******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
39
[ ./kernel/boot_ufs/def_pager_setup.c ]
Added init for  default_partition_lock
[90/12/11            jeffreyh]
[ ./kernel/i386/asm.h ]
changes for __STDC__
[90/12/06            jeffreyh]
[ ./kernel/i386/cswitch.s ]
Changes for __STDC__

Changes for __STDC__
[90/12/07  15:45:37  jeffreyh]
[ ./kernel/i386/interrupt.s ]
Changes for __STDC__
[90/12/07  15:43:38  jeffreyh]
[ ./kernel/i386/locore.s ]
Changes for __STDC__
[90/12/07  15:43:29  jeffreyh]
[ ./kernel/i386/pio.h ]
changes for __STDC__
[90/12/07            jeffreyh]
[ ./kernel/i386/spl.s ]
Changes for __STDC__
[90/12/07            jeffreyh]
[ ./kernel/i386/start.s ]
Changes for __STDC__
[90/12/07  15:43:21  jeffreyh]
[ ./kernel/i386at/blit.c ]
Changes for __STDC__
[90/12/07            jeffreyh]
[ ./kernel/i386at/if_pc586.c ]
Changes for __STDC__
[90/12/07            jeffreyh]
[ ./kernel/ipc/ipc_init.c ]
Changes to zchange to account for new collectable field. Made all
ipc zones collectable.
[90/12/11            jeffreyh]
[ ./kernel/ipc/ipc_marequest.c ]
Change zchange to match new number of arguments. Made zone collectable. 
[90/12/11            jeffreyh]
[ ./kernel/kern/zalloc.c ]
[90/12/19  10:36:55  jeffreyh]
[ ./kernel/kern/zalloc.h ]
Merged in changes done by jvs@osf from OSF/1 
[90/12/10            jeffreyh]
[ ./kernel/mips/PMAX/rz.c ]
Do not use minphys(), we do not need to trim requests.
[90/12/11            af]
[ ./kernel/mips/PMAX/rz_disk.c ]
Bug in strategy routine: for xfers larger than
max_dma was not setting the io_count right at
the end of the transfer.  Now new fsck works.
[90/12/10  17:26:47  af]
[ ./kernel/mips/locore.s ]
Fixed gimmeabreak() to let you sstep out of it.
Long overdue, but I had this habit of putting a breakpoint
where I wanted to stop anyways.
[90/12/13            af]
[ ./kernel/mips/PMAX/scsi_7061_hdw.c ]
More hacks to understand rz55, and now hitachis boot.
There is still one problem for hitachis at large,
will fix in the next merge.
[90/12/19  15:17:48  af]
[ ./kernel/src/mig/header.c ]
Commented out code for prototype generation. This is a temporary solution
to the longer term problem of the need 
for the generation of both a client and a server header file 
that have correct prototypes for strict ansi c and c++. The
prototypes generated before anly were for the client and broke kernel
files that included them if compiled under standard gcc
[90/12/07            jeffreyh]
[ ./kernel/vm/vm_external.c ]
Change zchange to accept new argument. Made zones collectable.
[90/12/11            jeffreyh]
    
    
    
==========================================================================
   ***** MK Version MK40  (rpd) *****
    
    
New features:
--- --------

Kernel stack discarding and related optimizations.
Currently a thread's kernel stack is discarded
when it is created, when it is suspended,
when it waits in a message receive, and when
it waits for a reply to an exception_raise upcall.

Threads without kernel stacks are "swapped".
All runnable threads have kernel stacks.

The vax and sun3 don't discard kernel stacks.
In fact, they don't even unwire kernel stacks.
MI code uses a KEEP_STACKS conditional (temporary,
I hope) to support unconverted architectures.

The i386 discards kernel stacks, but the implementation
is suboptimal.  locore still saves user state on the
kernel stack, so stack_switch() must copy user state
to and from the kernel stack.

[I386]	  I picked up Bob's v86 support.
The IO permission bit implementation is suboptimal.
It copies the IO permission bits into the kernel's TSS
at every context-switch to a thread with bits set.

I added a ddb command, continue-with-count (c/c).
It continues, counting instructions, until a breakpoint is hit.
On the pmax, loads and stores are also counted.

I added a debugging call, host_virtual_physical_table_info,
to return information about the VP hash table.
The hash_info program in the USER tree uses it.

I enabled software reference bits (again) and
disabled TLB reference bits on the pmax (again).

Bug fixes:
--- -----

I revised the way the network code allocates message buffers.
It should drop fewer packets now.  This improves network
performance significantly on some machines.

I changed the zone package to make zones non-collectable by default.
The only collectable zones now are the large kalloc zones.

Numerous minor fixes, including stuff from Sandro & Bob...


[ ./conf/version.edit ]
40
[ ./include/Makefile ]
Added mach_debug/hash_info.h.
[91/01/04            rpd]
[ ./kernel/conf/MASTER ]
Removed FAST_CSW (tag fast_csw).
[90/12/08            rpd]
Removed MACH_IPC_GENNOS (tag ipc_gennos).
[90/11/08            rpd]
[ ./kernel/conf/MASTER.mips ]
Disabled ref_bits.  Again.
[91/01/04            rpd]
[ ./kernel/conf/files ]
Removed ./mach/exc_user.c.
[90/12/26            rpd]
Removed FAST_CSW.
[90/12/08            rpd]
Removed MACH_IPC_GENNOS.
[90/11/08            rpd]
[ ./kernel/ddb/db_break.c ]
Added db_map_equal, db_map_current, db_map_addr.
[90/11/10            rpd]
[ ./kernel/ddb/db_run.c ]
Fixed bug in db_restart_at_pc.
[90/12/07            rpd]
Added STEP_COUNT and count option to db_continue_cmd.
Changed db_stop_at_pc to return (modified) is_breakpoint.
Fixed db_stop_at_pc to print newlines in the right places.
[90/11/27            rpd]
[ ./kernel/ddb/db_trap.c ]
Changed db_stop_at_pc's arguments.
Print db_inst_count, db_load_count, db_store_count.
[90/11/27            rpd]
[ ./kernel/ddb/db_watch.c ]
Use db_map_equal, db_map_current, db_map_addr.
[90/11/10            rpd]
[ ./kernel/device/dev_master.h ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/device/ds_routines.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/device/net_io.c ]
Replaced NET_KMSG_GET, NET_KMSG_FREE
with net_kmsg_get, net_kmsg_put, net_kmsg_collect.
Increased net_kmsg_ilist_min to 4.
[91/01/05            rpd]
Fixed net_rcv_msg_thread to round message sizes up to an int multiple.
[90/12/07            rpd]

Fixed net_rcv_msg_thread to not set vm_privilege.
[90/11/29            rpd]
[ ./kernel/device/net_io.h ]
Replaced NET_KMSG_GET, NET_KMSG_FREE
with net_kmsg_get, net_kmsg_put, net_kmsg_collect.
[91/01/05            rpd]
[ ./kernel/device/subrs.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/i386/cswitch.s ]
Minor cleanup.
[90/12/31            rpd]
Added switch_task_context, switch_thread_context.
[90/12/12            rpd]

Reorganized the pcb.
[90/12/11            rpd]
[ ./kernel/i386/db_machdep.h ]
Added dummy inst_load/inst_store macros.
[90/12/11            rpd]
[ ./kernel/i386/db_trace.c ]
Reorganized the pcb.
[90/12/11            rpd]
[ ./kernel/i386/fpu.c ]
Split i386_machine_state off of i386_kernel_state.
[90/12/31            rpd]
Reorganized the pcb.
[90/12/11            rpd]
[ ./kernel/i386/genassym.c ]
Reorganized the pcb.
[90/12/11            rpd]
[ ./kernel/i386/init.c ]
Initialize the new pcb zone in machine_init.
[90/12/11            rpd]
[ ./kernel/i386/locore.s ]
Replaced thread_bootstrap_user, thread_bootstrap_kernel
with thread_exception_return, thread_syscall_return.
Updated mach_trap_table indexing for new layout.
[90/12/17            rpd]

Renamed thread_bootstrap to thread_bootstrap_user.
Added thread_bootstrap_kernel.
[90/12/14            rpd]

Reorganized the pcb.
Added copyinmsg, copyoutmsg synonyms for copyin, copyout.
[90/12/11            rpd]
[ ./kernel/i386/pcb.c ]
Removed pcb_synch.  Added pcb_collect.
[91/01/03            rpd]

Split i386_machine_state off of i386_kernel_state.
Set k_stack_top correctly for V8086 threads.
[90/12/31            rpd]
Added stack_switch.  Moved stack_alloc_try, stack_alloc,
stack_free, stack_statistics to kern/thread.c.
[90/12/14            rpd]

Reorganized the pcb.
Added stack_attach, stack_alloc, stack_alloc_try,
stack_free, stack_statistics.
[90/12/11            rpd]
[ ./kernel/i386/read_fault.c ]
Changed VM_WAIT to VM_PAGE_WAIT.
[90/12/11            rpd]
[ ./kernel/i386/thread.h ]
Added i386_machine_state.
[91/01/03  22:05:01  rpd]

Reorganized the pcb.
[90/12/11            rpd]
[ ./kernel/i386/trap.c ]
Only need csw_needed in AST exit path.
[90/12/27            rpd]

Replaced thread_doexception with new exception interface.
[90/12/21            rpd]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/i386at/if_3c501.c ]
Changed NET_KMSG_GET, NET_KMSG_FREE to net_kmsg_get, net_kmsg_put.
[91/01/05            rpd]
[ ./kernel/i386at/if_pc586.c ]
Changed NET_KMSG_GET, NET_KMSG_FREE to net_kmsg_get, net_kmsg_put.
[91/01/05            rpd]
[ ./kernel/i386at/if_wd8003.c ]
Changed NET_KMSG_GET, NET_KMSG_FREE to net_kmsg_get, net_kmsg_put.
[91/01/05            rpd]
[ ./kernel/i386ipsc/if_cnp.c ]
Changed NET_KMSG_GET, NET_KMSG_FREE to net_kmsg_get, net_kmsg_put.
[91/01/05            rpd]
[ ./kernel/intel/pmap.c ]
Changed pmap_collect to ignore the kernel pmap.
[91/01/03            rpd]
[ ./kernel/ipc/ipc_entry.c ]
Removed MACH_IPC_GENNOS.
[90/11/08            rpd]
[ ./kernel/ipc/ipc_entry.h ]
Removed MACH_IPC_GENNOS, IE_BITS_UNUSEDC, IE_BITS_UNUSEDG.
[90/11/08            rpd]
[ ./kernel/ipc/ipc_hash.c ]
Changed ipc_info_bucket_t to hash_info_bucket_t.
[91/01/02            rpd]
[ ./kernel/ipc/ipc_hash.h ]
Changed ipc_info_bucket_t to hash_info_bucket_t.
[91/01/02            rpd]
[ ./kernel/ipc/ipc_init.c ]
Changed zchange calls to make the IPC zones non-collectable.
[90/12/29            rpd]
[ ./kernel/ipc/ipc_kmsg.c ]
Added ipc_kmsg_free.
[91/01/05            rpd]
Optimized ipc_kmsg_copyout_object for send rights.
[90/12/21            rpd]
Changed to use new copyinmsg/copyoutmsg operations.
Changed ipc_kmsg_get to check that the size is multiple of four.
[90/12/05            rpd]
Removed MACH_IPC_GENNOS.
[90/11/08            rpd]
[ ./kernel/ipc/ipc_kmsg.h ]
Added ipc_kmsg_free.  Generalized the notion of special message sizes.
[91/01/05            rpd]
Added declarations of ipc_kmsg_copyout_object, ipc_kmsg_copyout_body.
[90/12/21            rpd]
[ ./kernel/ipc/ipc_marequest.c ]
Changed ipc_info_bucket_t to hash_info_bucket_t.
[91/01/02            rpd]

Changed zchange calls to make the IPC zones non-collectable.
[90/12/29            rpd]
[ ./kernel/ipc/ipc_marequest.h ]
Changed ipc_info_bucket_t to hash_info_bucket_t.
[91/01/02            rpd]
[ ./kernel/ipc/ipc_mqueue.c ]
Changed continuation argument to (void (*)()).
[90/12/18            rpd]
Reorganized ipc_mqueue_receive.
[90/11/22            rpd]

Minor cleanup.
[90/11/11            rpd]
[ ./kernel/ipc/ipc_mqueue.h ]
Changed continuation argument and IMQ_NULL_CONTINUE to (void (*)()).
[90/12/18            rpd]
Reorganized ipc_mqueue_receive.
[90/11/22            rpd]
[ ./kernel/ipc/ipc_space.c ]
Removed MACH_IPC_GENNOS.
[90/11/08            rpd]
[ ./kernel/ipc/mach_debug.c ]
Changed ipc_info_bucket_t to hash_info_bucket_t.
[91/01/02            rpd]
Removed MACH_IPC_GENNOS.
[90/11/08            rpd]
[ ./kernel/ipc/mach_msg.c ]
Added KEEP_STACKS support.
[91/01/07            rpd]
Changed to use thread_syscall_return.
Added msg_receive_continue.
[90/12/18            rpd]
Added mach_msg_continue, mach_msg_receive_continue.
Changes to support kernel stack discarding/hand-off.
[90/12/09  17:29:04  rpd]

Removed MACH_IPC_GENNOS.
[90/11/08            rpd]
[ ./kernel/ipc/mach_msg.h ]
Created.
[90/11/22            rpd]
[ ./kernel/ipc/port.h ]
Removed MACH_IPC_GENNOS.
[90/11/08            rpd]
[ ./kernel/kern/exception.c ]
Added KEEP_STACKS support.
[91/01/08  14:11:40  rpd]

Replaced thread_doexception with new, optimized exception path.
[90/12/22            rpd]
[ ./kernel/kern/ipc_mig.c ]
Don't need mach_msg_rpc_from_kernel.
[90/12/26            rpd]
Updated ipc_mqueue_receive calls.
[90/11/21            rpd]
Removed MACH_IPC_GENNOS.
[90/11/09            rpd]
[ ./kernel/kern/ipc_sched.c ]
Added KEEP_STACKS support.
[91/01/06            rpd]
Added ipc_thread_switch_hits, ipc_thread_switch_misses counters.
[91/01/03  22:07:15  rpd]

Modified ipc_thread_switch to deal with pending timeouts.
[90/12/20            rpd]
Removed ipc_thread_go_and_block.
Added ipc_thread_switch.
[90/12/08            rpd]
[ ./kernel/kern/ipc_sched.h ]
Removed ipc_thread_go_and_block.
Added ipc_thread_switch.
Added continuation argument to ipc_thread_block.
[90/12/08            rpd]
[ ./kernel/kern/ipc_tt.c ]
Added retrieve_task_self_fast, retrieve_thread_self_fast.
[90/12/27            rpd]
[ ./kernel/kern/ipc_tt.h ]
Added retrieve_task_self_fast, retrieve_thread_self_fast.
[90/12/27            rpd]
[ ./kernel/kern/mach_clock.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/kern/machine.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/kern/sched_prim.c ]
Added KEEP_STACKS support.
[91/01/06            rpd]
Added thread_continue_calls counter.
[91/01/03  22:07:43  rpd]

Added continuation argument to thread_run.
[90/12/11            rpd]
Added continuation argument to thread_block/thread_continue.
Removed FAST_CSW conditionals.
[90/12/08            rpd]

Removed thread_swap_tick.
[90/11/11            rpd]
[ ./kernel/kern/startup.c ]
Swapin the startup thread and idle threads.
[90/11/20            rpd]

Removed swapout_thread.
[90/11/11            rpd]
[ ./kernel/kern/syscall_subr.c ]
Added continuation argument to thread_run.
[90/12/11            rpd]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/kern/syscall_sw.c ]
Changed to use MACH_TRAP_STACK appropriately.
[90/12/27  21:20:57  rpd]
[ ./kernel/kern/syscall_sw.h ]
Added mach_trap_stack, MACH_TRAP_STACK.
[90/12/18            rpd]
[ ./kernel/kern/task.c ]
Added consider_task_collect, task_collect_scan.
[91/01/03            rpd]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/kern/thread.c ]
Added KEEP_STACKS support.
[91/01/06            rpd]
Added consider_thread_collect, thread_collect_scan.
[91/01/03            rpd]

Added locking to the stack package.  Added stack_collect.
[90/12/31            rpd]
Changed thread_dowait to discard the stacks of suspended threads.
[90/12/22            rpd]
Added continuation argument to thread_block.
[90/12/08            rpd]

Changed thread_create to make new threads be swapped.
Changed kernel_thread to swapin the threads.
[90/11/20            rpd]

Removed stack_free/stack_alloc/etc.
[90/11/12            rpd]

Changed thread_create to let pcb_init handle all pcb initialization.
[90/11/11            rpd]
[ ./kernel/kern/thread.h ]
Added saved-state fields for exceptions.
[90/12/23            rpd]
Added swap_func.
[90/11/20            rpd]
[ ./kernel/kern/thread_swap.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]

Removed swapout_thread, swapout_threads,
swapout_scan, thread_swapout.
[90/11/11            rpd]
[ ./kernel/kern/zalloc.c ]
Added zalloc_wasted_space.
[91/01/06            rpd]
Removed COLLECT_ZONE_GARBAGE.
[91/01/03            rpd]

Changed zinit to make zones by default *not* collectable.
[90/12/29            rpd]
Added consider_zone_gc.
[90/11/11            rpd]
[ ./kernel/kern/zalloc.h ]
Removed COLLECT_ZONE_GARBAGE.  Added consider_zone_gc.
[91/01/03            rpd]
[ ./kernel/mach/mips/asm.h ]
Changed EF prefix to MSS.
[90/12/30            rpd]
[ ./kernel/mach/mips/vm_param.h ]
Reduced kernel stack size to one page.
[90/11/12            rpd]
[ ./kernel/mach_debug/hash_info.h ]
Created.
[91/01/02            rpd]
[ ./kernel/mach_debug/ipc_info.h ]
Moved ipc_info_bucket_t to mach_debug/hash_info.h.
[91/01/02            rpd]
[ ./kernel/mach_debug/mach_debug.defs ]
Added host_virtual_physical_table_info.
[91/01/02            rpd]
[ ./kernel/mach_debug/mach_debug_types.h ]
Added <mach_debug/hash_info.h>.
[91/01/02            rpd]
[ ./kernel/mips/PMAX/if_se.c ]
Changed NET_KMSG_GET, NET_KMSG_FREE to net_kmsg_get, net_kmsg_put.
[91/01/05            rpd]
[ ./kernel/mips/PMAX/mouse.c ]
Mouse events are now accounted for by the screen saver.
[91/01/04  15:35:30  af]
[ ./kernel/mips/PMAX/screen.c ]
Added compress_mouse_events, by default FALSE.
[91/01/08  14:14:03  rpd]
[ ./kernel/mips/PMAX/scsi_53C94_hdw.c ]
Added continuation argument to thread_block.
[90/12/27            rpd]
[ ./kernel/mips/PMAX/scsi_7061_hdw.c ]
Catched hitachi's problem: spurious interrupt _before_
dmain/out even got started.
[90/12/29            af]
Added continuation argument to thread_block.
[90/12/27            rpd]
[ ./kernel/mips/autoconf.c ]
Added pcb_zone.
[90/12/09  17:34:12  rpd]
[ ./kernel/mips/context.h ]
Removed TLB_SAFE_KSTACK, TLB_SAFE_KSTACK1.
[90/12/08            rpd]
[ ./kernel/mips/context.s ]
Added mips_stack_base.
[91/01/02            rpd]

Split mips_machine_state off of mips_kernel_state.
Moved stack_switch to mips/pcb.c.
[90/12/30            rpd]
Removed load_context_ipc, save_context.
Added switch_task_context, switch_thread_context.
[90/12/08            rpd]

Added stack_switch, load_context_ipc.
[90/11/29            rpd]

Changed save_context/load_context for pcb reorganization.
Removed stack wiring code from load_context.
Disabled pmap_pcache code.
[90/11/12            rpd]
[ ./kernel/mips/db_interface.c ]
Changed kdb_trap to return TRUE if it actually enters kdb.
[90/12/23            rpd]
Fixed to use kdbsplhigh/kdbsplx.
[90/11/26            rpd]
[ ./kernel/mips/db_machdep.h ]
Added inst_load, inst_store.
[90/11/27            rpd]
[ ./kernel/mips/db_trace.c ]
Quit tracing after hitting a zero pc.
[90/12/31            rpd]
Changed for new pcb organization.
[90/11/12            rpd]
[ ./kernel/mips/genassym.c ]
Added mips_stack_base.
[91/01/02            rpd]

Changed to consistent MKS_, MSS_, MEL_, MMS_ prefixes.
Split mips_machine_state off of mips_kernel_state.
[90/12/30            rpd]
Added PCB_SIZE.
[90/11/12            rpd]
[ ./kernel/mips/locore.s ]
Fixed gimmeabreak to allow the user to single-step out of it.
[91/01/06            rpd]
Added mips_stack_base.
[91/01/02            rpd]

Split mips_machine_state off of mips_kernel_state.
[90/12/30            rpd]
Moved thread_exception_return to mips/trap.c.
[90/12/23            rpd]

Replaced thread_bootstrap_user, thread_bootstrap_kernel
with thread_exception_return, thread_syscall_return.
Updated native syscall processing for new mach_trap_table layout.
[90/12/18            rpd]
Changed the exception frame/pcb layout.
[90/11/19            rpd]
[ ./kernel/mips/mips_copyin.s ]
Added copyinmsg, copyoutmsg.
Fixed copyin to check correctly for user space violations.
[90/12/05            rpd]
[ ./kernel/mips/mips_cpu.s ]
Updated for new symbolic field names.
[91/01/03  22:10:08  rpd]

Replaced thread_doexception with exception.
[90/12/27  21:22:32  rpd]

Added kdbsplhigh and kdbsplx.
[90/11/26            rpd]

Changed disable_fpa for new pcb organization.
[90/11/12            rpd]
[ ./kernel/mips/mips_init.c ]
Changed for pcb reorganization.
[90/11/12            rpd]
[ ./kernel/mips/mips_instruction.c ]
Added isa_load, isa_store.
[90/11/27            rpd]
[ ./kernel/mips/pcb.c ]
Removed pcb_synch.  Added pcb_collect.
[91/01/03            rpd]

Added mips_stack_base.
[91/01/02            rpd]

Split mips_machine_state off of mips_kernel_state.
Moved stack_switch here from mips/context.s.
[90/12/30            rpd]
Eliminated thread_bootstrap_user, thread_bootstrap_kernel.
[90/12/19            rpd]
Added pcb_alloc/pcb_free.  Use vm_page_grab/vm_page_free
for kernel stacks.  Reorganized the pcb layout.
Removed thread_private.
[90/11/11            rpd]
[ ./kernel/mips/thread.h ]
Added mips_stack_base.
[91/01/02            rpd]
Split mips_machine_state off of mips_kernel_state.
Changed mips_exception_state to mips_exception_link.
[90/12/30            rpd]
Added definition of MACHINE_STACK.
[90/12/14            rpd]
Added mips_exception_state, USER_LINK.
[90/11/13            rpd]

Changed pcb to include both mips_kernel_state and mips_saved_state.
[90/11/11            rpd]
[ ./kernel/mips/tlb.s ]
Removed tlb_probe_and_wire.
[90/11/12            rpd]
[ ./kernel/mips/trap.c ]
Added a couple counters to tlb_miss.
[91/01/08  14:15:03  rpd]

Disabled pcache code.
[90/12/29            rpd]
Replaced thread_doexception with new exception interface.
Moved thread_exception_return here from mips/locore.s.
It must install single-step breakpoints in the user.
Added thread_kdb_return.
[90/12/23            rpd]
Added continuation argument to thread_block.
[90/12/08            rpd]

Added support for copymsgin, copymsgout.
[90/12/05            rpd]

Changed for new pcb organization.
[90/11/12            rpd]
[ ./kernel/sun3/db_machdep.h ]
Added dummy inst_load/inst_store macros.
[91/01/06            rpd]
[ ./kernel/sun3/locore.s ]
Added copyinmsg, copyoutmsg aliases.
Updated for new mach_trap_table layout.
[91/01/06            rpd]
[ ./kernel/sun3/pcb.c ]
Added KEEP_STACKS support.
[91/01/06            rpd]

Added empty frame on thread start for tracing.
[89/05/25            rwd]

Converted for MACH kernel.
[88/11/03            dbg]
[ ./kernel/sun3/thread.h ]
Added KEEP_STACKS support.
[91/01/06            rpd]
[ ./kernel/sun3/trap.c ]
Added KEEP_STACKS support.
[91/01/07            rpd]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/sundev/cgtwo.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/sundev/mb.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]

Modified for MACH_KERNEL.
[89/03/22            dbg]
[ ./kernel/sundev/sd.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/sundev/st.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/sundev/xy.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/sundev/zs_async.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/sunif/if_ie.c ]
Changed NET_KMSG_GET, NET_KMSG_FREE to net_kmsg_get, net_kmsg_put.
[91/01/05            rpd]
[ ./kernel/sunif/if_le.c ]
Changed NET_KMSG_GET, NET_KMSG_FREE to net_kmsg_get, net_kmsg_put.
[91/01/05            rpd]
[ ./kernel/vax/db_machdep.h ]
Added dummy inst_load/inst_store macros.
[91/01/06            rpd]
[ ./kernel/vax/inline/langpats.c ]
Added copyinmsg, copyoutmsg.
[91/01/06            rpd]
[ ./kernel/mach_debug/mach_debug_types.defs ]
Changed ipc_info_bucket_t to hash_info_bucket_t.
[91/01/02            rpd]
[ ./kernel/mips/PMAX/dz_hdw.c ]
Modified dz_param never to use 7bits per char.
Now we can use the serial lines even in non-raw mode,
which means we can login, for instance.
[90/12/31            af]
[ ./kernel/mips/softfp.s ]
Replaced thread_doexception with new exception interface.
[90/12/23            rpd]
[ ./kernel/vax/locore.s ]
Updated for new mach_trap_table layout.
[91/01/06            rpd]
[ ./kernel/vax/model_dep.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/vax/mscp.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]

Changes for MACH_KERNEL.
[88/08/29            dbg]

Compile the error printing code if (NTMSCP > 0) as well as if NET_UDA.
Directly include <vax/mscp_umd.h>, as the Berkeley version
won't work (and must be left intact if NET_UDA is not true).
[88/08/29            mwyoung]

Corrected include file references.
[88/08/22            mwyoung]
[ ./kernel/vax/pcb.c ]
Added KEEP_STACKS support.
[91/01/06            rpd]
[ ./kernel/vax/thread.h ]
Added KEEP_STACKS support.
[91/01/06            rpd]
[ ./kernel/vax/trap.c ]
Added KEEP_STACKS support.
[91/01/07            rpd]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/vaxif/if_ni.c ]
Changed NET_KMSG_GET, NET_KMSG_FREE to net_kmsg_get, net_kmsg_put.
[91/01/05            rpd]
[ ./kernel/vaxif/if_uba.c ]
Changed NET_KMSG_GET, NET_KMSG_FREE to net_kmsg_get, net_kmsg_put.
[91/01/05            rpd]
[ ./kernel/vaxuba/qd.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/vaxuba/uba.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/vaxuba/uda_umd.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/vm/memory_object.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/vm/vm_debug.c ]
Added host_virtual_physical_table_info.
[91/01/02            rpd]
[ ./kernel/vm/vm_external.c ]
Changed zchange calls to make the zones non-collectable.
[90/12/29            rpd]
[ ./kernel/vm/vm_fault.c ]
Turned software_reference_bits on.
[90/12/29            rpd]
Added continuation argument to thread_block.
[90/12/08            rpd]

Changed VM_WAIT to VM_PAGE_WAIT.
[90/11/13            rpd]
[ ./kernel/vm/vm_kern.c ]
Changed VM_WAIT to VM_PAGE_WAIT.
[90/11/13            rpd]
[ ./kernel/vm/vm_map.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]
[ ./kernel/vm/vm_object.c ]
Added continuation argument to thread_block.
[90/12/08            rpd]

Fixed vm_object_terminate to give vm_pageout_page busy pages.
[90/11/22            rpd]

Changed VM_WAIT to VM_PAGE_WAIT.
[90/11/13            rpd]
[ ./kernel/vm/vm_page.h ]
Changed to singly-linked VP bucket chains.
[91/01/03            rpd]
Changed vm_wait/VM_WAIT to vm_page_wait/VM_PAGE_WAIT.
[90/11/13            rpd]
[ ./kernel/vm/vm_pageout.c ]
Added net_kmsg_collect.
[91/01/05            rpd]
Added consider_task_collect, consider_thread_collect.
[91/01/03            rpd]

Added stack_collect.
[90/12/31            rpd]
Added continuation argument to thread_block.
[90/12/08            rpd]

Ensure that vm_page_free_target is at least five pages
larger than vm_page_free_min, to avoid vm_page_wait deadlock.
[90/11/19            rpd]

Replaced swapout_threads with consider_zone_gc.
[90/11/11            rpd]
[ ./kernel/vm/vm_resident.c ]
Changed to singly-linked VP bucket chains.
[91/01/03            rpd]

Removed count field from VP buckets.
Added vm_page_info.
[91/01/02            rpd]
Added vm_page_grab, vm_page_release.
Changed vm_wait/VM_WAIT to vm_page_wait/VM_PAGE_WAIT.
[90/12/09  17:41:15  rpd]
[ ./user/threads/i386/csw.s ]
Don't use Times - horta doesn't like it for some reason.
[91/01/06            rpd]
[ ./kernel/conf/MASTER.i386 ]
Switch wd8003 -> ns8390
[91/01/04  12:13:52  rvb]
[ ./kernel/conf/files.i386 ]
Switch wd8003 -> ns8390
[91/01/04  12:14:06  rvb]
[ ./kernel/ddb/db_command.c ]
Forward reference for db_fncall();
[91/01/04  12:35:17  rvb]

Add call as a synonym for ! and match for next
[91/01/04  12:14:48  rvb]
[ ./kernel/i386/hardclock.c ]
EFL_VM => user_mode
[90/12/21  10:50:54  rvb]
[ ./kernel/i386/interrupt.s ]
Need special interrupt_return
[90/12/21  14:36:12  rvb]
[ ./kernel/i386/locore.s ]
interrupt_returns must check for EFL_VM.
[90/12/21  14:37:44  rvb]

Add trapv86 for VM thread.
[90/12/19  17:00:56  rvb]
[ ./kernel/i386/pit.c ]
Flush dead EXL code.
[90/11/27  11:38:08  rvb]
[ ./kernel/i386/trap.c ]
Add v86_hdw_assist().
[91/01/04  09:54:24  rvb]

Basically add trapv86()
[90/12/20  10:21:01  rvb]
[ ./kernel/i386/tss.h ]
Add bit_map
[90/12/20  10:21:17  rvb]
[ ./kernel/i386at/blitvar.h ]
Trim $ header
[90/11/27  11:44:11  rvb]
[ ./kernel/i386at/conf.c ]
Support for get/set status on hd and fd.
Also fd has 64 minor devices per unit.
Switch wd8003 -> ns8390
[91/01/04  12:17:15  rvb]
[ ./kernel/i386at/disk.h ]
Add V_ABS to log absolute address for 3.0 get/set stat version
of V_RDABS AND V_WRABS
[91/01/04  12:18:16  rvb]
[ ./kernel/i386at/hd.c ]
Allow ioctl's
[90/12/19            rvb]
[ ./kernel/i386at/if_3c503.h ]
Etherlink II device specific info.
[91/01/04  12:19:07  rvb]
[ ./kernel/i386at/if_ns8390.c ]
A few bug fixes.
[91/01/08  16:41:04  rvb]

Make this a generic driver for ns8390 from wd8003 because
we now will also support etherlink ii.
[91/01/04  12:25:21  rvb]
[ ./kernel/i386at/if_ns8390.h ]
Restrict to defines for the 8390 only.
[91/01/04  12:25:57  rvb]
[ ./kernel/i386at/if_wd8003.h ]
Flush generic NS8390 defines to an NS8390 header file.
[91/01/04  12:20:35  rvb]
[ ./kernel/i386at/kd_mouse.c ]
Trim $ Header
[90/11/27  11:44:31  rvb]
[ ./kernel/i386at/m765knl.c ]
Add some 3.0 get/set stat stuff.
[91/01/04  12:21:06  rvb]
[ ./kernel/i386at/pic_isa.c ]
Initially, do not allow clock interrupts
[91/01/04  12:21:54  rvb]
[ ./kernel/mach/i386/thread_status.h ]
Two new flavors (from 2.5):
  #define i386_FLOAT_STATE	2
	Hacked in not presently used, but someday...
 #define i386_ISA_PORT_MAP_STATE	3
	Used 
[90/12/20  10:23:34  rvb]
[ ./kernel/i386at/if_ns8390.c ]
Changed NET_KMSG_GET to net_kmsg_get.
[91/01/08            rpd]
[ ./kernel/i386at/if_wd8003.c ]
Purged.
[ ./include/Makefile ]
Added i386/fp_reg.h.
[91/01/08            rpd]
[ ./include/Makefile ]
Added i386at/disk.h.
[ ./kernel/mach_debug/Makefile ]
Purged.
[ ./kernel/i386at/if_ns8390.c ]
Fixed typo in ns8390probe.
[91/01/09            rpd]
[ ./kernel/mips/PMAX/boot/primary_boot.c ]
For new proms, zero envp because it is bogus.  This lets
me boot 2.5 on 3maxen again.
[91/01/09  16:33:38  af]
[ ./kernel/i386/pit.c ]
Fixed clkstart to reset clock interrupt priority, etc.
[91/01/09            rpd]

Flush dead EXL code.
[90/11/27  11:38:08  rvb]
[ ./kernel/mips/PMAX/mips_box.c ]
Defined pmax_memcheck() and related default implementation.
[91/01/03  02:10:32  af]
[ ./kernel/mips/PMAX/mips_box.h ]
Now define mipsbox_memory_check() to cope with bus lockup
caused by pmax SII chip.
[91/01/02            af]
[ ./kernel/mips/PMAX/kn01.c ]
Added kn01_memcheck().
[91/01/03  02:09:21  af]
[ ./kernel/mips/PMAX/model_dep.c ]
Set pmax_memcheck() for pmaxen.
[91/01/03  02:12:58  af]
[ ./kernel/mips/trap.c ]
Check mipsbox_memory_check return value.
[91/01/09            rpd]
[ ./kernel/i386/db_trace.c ]
Fixed stack tracing for threads without kernel stacks.
[91/01/09            rpd]
[ ./kernel/i386at/autoconf.c ]
Converted from wd8003 to ns8390.
[91/01/08            rpd]
[ ./kernel/mips/db_trace.c ]
Fixed stack tracing for threads without kernel stacks.
[91/01/09            rpd]
[ ./kernel/i386/cswitch.s ]
Renamed to Load_context and Switch_task_context.
Removed ktss munging.
[91/01/09            rpd]
[ ./kernel/i386/genassym.c ]
Removed user_regs, k_stack_top.
[91/01/09            rpd]
[ ./kernel/i386/init.c ]
Added ktss zone.
[91/01/09            rpd]
[ ./kernel/i386/locore.s ]
Removed k_user_regs.
[91/01/09            rpd]
[ ./kernel/i386/pcb.c ]
Revised the pcb yet again.
Picked up i386_ISA_PORT_MAP_STATE flavors.
Added load_context, switch_task_context cover functions.
[91/01/09            rpd]
[ ./kernel/i386/thread.h ]
Added dummy switch_thread_context macro.
Added ktss to i386_machine_state.
Removed user_regs, k_stack_top.
[91/01/09            rpd]
[ ./kernel/i386/trap.c ]
Fixed a merge bug.
[91/01/09            rpd]
    
    
    
==========================================================================
   ***** MK Version MK41  (mrt) *****
    
    
Added the new Mach copyright and disclaimer to all the machine 
independent files and the i386 and mips files. At this point
we are allowd to distribute freely all the files needed for 
the i386 and mips platforms.

Changed personal copyrights to author notices and added author
notices to the files in the devices, ddb and mips directories.
I would encourage people to put author notices on any files
that they created or will create. Please do not put personal
copyrights on files as it casts doubt over the rights of
Carnegie Mellon to distribute the files. 

Since we will now be distributing these sources without requiring
any licenses, please be very careful about adding any files with
copyright notices that do not include a permission to distribute
clause like the CMU one. If for some reason it is necessary to
include a copyrighted file, be sure to tell me,so that I can exclude 
it from the ftp distribution.

There was no change to code in this release.
    
    
    
==========================================================================
   ***** MK Version MK42  (mrt) *****
    
    
Bug fixes:
--- -----

[I386]	Picked up Rich Draves intel/pmap.c fix to keep the i386 version
	from hanging
	Picked up a number of i386 changes from Bob

[PMAX]	Picked up the scsi driver fix from Sandro and lots of other
	mips specfic files.

Organizational changes:
-------------- -------
All the libmach, theads and man sections now have the new Mach
permissive copyright

I upgraded the libmach i386 bcopy routine to reno in order to
get a BSD permissive copyright.


******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
42

Changes from Rich
[ ./kernel/intel/pmap.c ]
Fixed pmap_expand to use vm_page_grab/VM_PAGE_WAIT.
[91/01/12            rpd]
[ ./kernel/ipc/ipc_right.c ]
Fixed bug in ipc_right_copyin_check, following rchen's report.
[91/01/26            rpd]
******************************************************************
Copyright changes
[ ./kernel/conf/copyright ]
New Mach copyright
[ ./kernel/man/* ]
Changed to new Mach copyright
[91/02/12  18:10:12  mrt]
[ ./user/libmach/* ]
Added new Mach copyright
[91/02/13  12:45:25  mrt]
[ ./user/threads/* ]
Added new Mach copyright
[91/02/13  12:40:50  mrt]
[ ./kernel/sys/ioctl.h ]
Changed to new Mach copyright
[ ./kernel/i386/ntoh.s ]
Changed to new Mach copyright
******************************************************************
Mips changes from Sandro
[ ./kernel/mips/PMAX/cfb_hdw.c ]
In interrupt routine, drop priority as now required.
[91/02/12  12:44:36  af]
[ ./kernel/mips/PMAX/dz_hdw.c ]
In interrupt routine, drop priority as now required.
[91/02/12  12:45:12  af]
Modified dz_param never to use 7bits per char.
Now we can use the serial lines even in non-raw mode,
which means we can login, for instance.
[90/12/31            af]
[ ./kernel/mips/PMAX/ga_hdw.c ]
In interrupt routine, drop priority as now required.
[91/02/12  12:43:54  af]
[ ./kernel/mips/PMAX/gq_hdw.c ]
In interrupt routine, drop priority as now required.
[91/02/12  12:44:15  af]
[ ./kernel/mips/PMAX/if_se.c ]
In interrupt routine, drop priority as now required.
Added (optional) loopback of packets sent to ourselves,
this way can run multiple POEs and have them talk to each other.
Same flag lets you run with external hardware loopback terminator
ignoring no-carrier errors.
Fixed bug with multiple ether boards.
Fixed bug with loopback path shifting data incorrectly.
[91/02/12  12:53:29  af]
[ ./kernel/mips/PMAX/if_se_mapped.c ]
In interrupt routine, drop priority as now required.
Also sanity check for spurious interrupts anyways.
[91/02/12  12:41:46  af]
[ ./kernel/mips/PMAX/kn01.c ]
In interrupt routines, drop priority as now required.
[91/02/12  12:54:42  af]
Added kn01_memcheck().
[91/01/03  02:09:21  af]
[ ./kernel/mips/PMAX/kn02.c ]
Pass along the spllevel to interrupt routines.
[91/02/12  12:40:09  af]
[ ./kernel/mips/PMAX/mapped_scsi.c ]
In interrupt routines, drop priority as now required.
Also, sanity check against spurious interrupts.
[91/02/12  13:17:21  af]
[ ./kernel/mips/PMAX/mc_clock.c ]
Factored out delay() function, and made it box-indep.
Added accurate_config_delay() which calls delay()'s
configuration code.  Modified ackrtclock() to
invoke it on first call.
Tell the user what the CPU clock speed loks like, 
distinguish between DS3100 and DS2100 based on clock speed.
[91/02/12  13:03:16  af]
[ ./kernel/mips/PMAX/mc_clock.h ]
New values for delay() function.
[91/02/12  13:04:04  af]
[ ./kernel/mips/PMAX/mips_box.c ]
In clock interrupt routine, drop priority as now required.
[91/02/12  12:59:26  af]
Defined pmax_memcheck() and related default implementation.
[91/01/03  02:10:32  af]
[ ./kernel/mips/PMAX/mips_box.h ]
Fix macros so that interrupt routines can drop priority as now required.
[91/02/12  12:56:04  af]
[ ./kernel/mips/PMAX/mouse.c ]
Sanity check so that we will never loose synch if the serial line
drops characters.
[91/02/12  12:57:21  af]
Mouse events are now accounted for by the screenm saver.
[91/01/04  15:35:30  af]
[ ./kernel/mips/PMAX/pm_hdw.c ]
In interrupt routine, drop priority as now required.
[91/02/12  12:42:39  af]
[ ./kernel/mips/PMAX/rz_disk.c ]
Added (optional and disabled) code for checksumming.
[91/02/12  12:58:27  af]
Bug in strategy routine: for xfers larger than
max_dma was not setting the io_count right at
the end of the transfer.  Now new fsck works.
[90/12/10  17:26:47  af]
[ ./kernel/mips/PMAX/scsi_53C94_hdw.c ]
In interrupt routine, drop priority as now required.
Also, sanity check for spurious interrupts.
Some more debugging tools.
[91/02/12  12:46:38  af]
[ ./kernel/mips/autoconf.c ]
New values for new delay() function.
[91/02/12  12:29:29  af]
[ ./kernel/mips/db_interface.c ]
Added flag not to invoke vm_fault(), used in crashed kernels.
[91/02/12  12:15:09  af]
[ ./kernel/mips/mips_cpu.s ]
Fixed a number of problems in the FPA emulation code.
Added delay() and its autotime function, this way we
can distinguish between DS3100 and DS2100.
[91/02/12  12:37:13  af]
[ ./kernel/mips/mips_instruction.c ]
Added branch_delay() for FPA emulation.
[91/02/12  12:23:19  af]
[ ./kernel/mips/pmap.c ]
Fixed pmap_attribute() to loop through all phys pages while
flushing the cache.  If this gets used heavily for large
ranges it will be wise to just flush the whole cache in
one shot, or keep perhaps track of which 'cache pages'
need flushing and which do not.
[91/02/12  12:33:25  af]
[ ./kernel/mips/pmap.h ]
Made sure PTETOPHYS() does not get optimized away.
[91/01/10            af]
[ ./kernel/mips/softfp.s ]
The FPA csr is now passed as third argument.
[91/02/12  12:21:21  af]
[ ./kernel/device/net_io.c ]
Added garbage collection of dead filters.
[91/02/12  12:11:10  af]
[ ./kernel/mips/PMAX/scsi_7061_hdw.c ]
In interrupt routine, drop priority as now required.
[91/02/12  13:18:18  af]
[ ./kernel/mips/db_trace.c ]
Split trace function from ddb interface.  Added (optional)
code to walk through a user-mode, optimized CThread program
like the U*x server.  Should make it MI someday.
[91/02/12  12:18:59  af]
[ ./kernel/mips/locore.s ]
Reversed the meaning of the booleans in the ref_bits array.
[91/02/12  12:24:39  af]
[ ./kernel/mips/trap.c ]
Pass along the spl level to interrupt routines, which are now
invoked with interrupts DISABLED so that they can defend 
themselves from unwarranted multiple invocations.  It is
now the routine's responsibility to lower the spl at the indicated
priority level as soon as the interrupt cause has been cleared.
[91/02/12  12:28:43  af]
Activated mipsbox_memory_check() macro.
[91/01/03  02:08:14  af]
*************************************************************
Changes from Bob
[ ./kernel/ddb/db_input.c ]
Add input line editing.
[90/11/11            dbg]
[ ./kernel/i386/trap.c ]
rfr's latest changes to v86 assist
[91/01/28  15:25:30  rvb]
[ ./kernel/i386at/com.c ]
Merge of dbg's latest working com.c onto the old com.c
with the new autoconf and other major changes.
[91/01/28  15:26:13  rvb]
[ ./kernel/i386at/conf.c ]
Allow com driver and distinguish EtherLinkII from wd8003
[91/01/28  15:27:02  rvb]
[ ./kernel/i386at/fd.c ]
This file is the logical contatenation of the previous c765.c,
m765knl.c and m765drv.c, in that order.  
[91/01/15            rvb]
[ ./kernel/i386at/fdreg.h ]
New, Improved, compatible with new fd.c
[91/01/28  15:33:58  rvb]
[ ./kernel/i386at/if_ns8390.c ]
Distinguish EtherLinkII vs WD8003 on open.  Get packet
size right for statistics.  Fix 3.0 buf that sometimes
reported packets too large.
[91/01/28  15:31:22  rvb]
[ ./kernel/i386at/if_pc586.c ]
You must check RBD_SW_EOF for rbd chain termination, a link of 0xffff
does not work.  Also we've just seen a status of 0xffff in rcv() with
a bad fd_p->link_offset; we'll now reset.
[91/01/17            rvb]
[ ./kernel/i386at/kd.c ]
Merge cleanup.
[91/01/28  17:14:11  rvb]
Drop priority around display routines in kdstart, so that
scrolling or clearing the screen doesn't block other interrupts
(e.g. com driver).
[91/01/28  15:29:45  rvb]
[ ./kernel/i386at/kdasm.s ]
Follow dbg's lead.
[91/01/15            rvb]

    
    
    
==========================================================================
   ***** MK Version MK43  (rpd) *****
    
    
New features:
--- --------

I revised the AST interface.  Now there is a machine-independent function,
ast_taken, which handles ASTs.  Also the idle thread will process
network ASTs.

I changed the network code to use ASTs to run packets through the packet
filters and send IPC messages.  The network thread only runs when
more message buffers must be allocated.  The network code now keeps
two queues of packets, for low and high priority packets.  If it runs
out of free buffers, it will recycle packets in the low-priority queue.
The network drivers currently mark broadcast packets as low priority.
These changes greatly reduce the number of dropped high-priority packets
and the amount of memory consumed by packet buffers.

More paths through the kernel use explicit continuations now.
I changed the scheduling state machine so that swapped threads
can live on the run queues.  Now the kernel uses explicit continuations for
	threads blocked in (user) message receive
	threads blocked in exceptions
	threads blocked in (user) page faults
	kernel threads (including the idle thread) blocking for more work
	preemptive scheduling
	thread_switch and friends
These cases account for >99% of all context-switches.

I changed the interface to machine-dependent context-switch functions.
The two main functions now are stack_handoff and switch_context.
These functions are also responsible for changing address spaces.
switch_context returns the previously running thread (instead of
calling thread_continue, like the old interface).  stack_handoff
accounts for >99% of all context-switches.

I changed how the IPC system caches message buffers.
Now it uses a per-processor cache, instead of a per-thread cache.
The per-processor cache uses less memory and has a better hit rate.

[PMAX,I386]	I pulled floating-point state out of the pcbs.
Now space for FP registers is only allocated for threads
which actually use FP.

[PMAX]	  I changed how the mips code handles the FP registers,
to remove FP overhead from the context-switch path.


Bug fixes:
--- -----

I fixed a bug ipc_entry_grow_table, which causes a panic when the default
pager tries to grow its table and there aren't enough free pages.
Now ipc_entry_grow_table uses a new function, kmem_realloc,
to grow large tables.  I also reorganized the kmem_alloc interface,
so that those functions have real return codes now.  kmem_alloc
allocates a new object and kmem_alloc_wired uses the kernel-object.
Both functions do not zero the new memory.

I fixed a page leak.  Copy-on-write faults left the original page
off the paging queues.  Related changes to vm_page_deactivate
and how vm_object_terminate and the pageout daemon interact.

I fixed the ioctl definitions for Ansi C.

I changed the default value of db_maxoff to 4K.

I fixed ddb to catch exceptions that occur in ddb commands.
Typos in arguments to "show foo" are no longer fatal.

I fixed the default pager's initialization of pager structures.

I fixed memory_object_data_provided to only return success
when it consumes its copy object, so erroneous data-provided's
don't crash the kernel.

I fixed vm_fault_page to give vm_pageout_page busy pages.

I fixed kmem_alloc and friends to not hold object locks across pmap_enter.

Fix for vm_map_entry_delete's use of vm_object_page_remove from dlb.

Fix for vm_map_fork/VM_INHERIT_COPY of wired entries from dlb.

Fix for boot_printf from sumitomo.

Fix for read_emulator_symbols (to not panic if there is no emulator) from jsb.

[SUN3]	  I fixed the pmap module to initialize new pmaps correctly.

[SUN3]	  I fixed locore to not leave thread->recover set across system calls.

[PMAX]	  I picked up a couple more spl/interrupt-race fixes from af.

[PMAX]	  I fixed switch_context and call_continuation
so stack traces in ddb terminate correctly.

[I386]	  I fixed several floating-point bugs.
Now multiple threads can use FP without stepping on each other.

[I386]	  Fixed kdb_trap to disable interrupts and skip permanent breakpoints.

[I386]	  I fixed switch_context and call_continuation
so stack traces in ddb terminate correctly.


Organizational changes:
-------------- -------

device/tape_status.h is exported to the release directory now.

I changed the definition of REG_EXP, to make it .* on all platforms.
If you have an old make, you may need to override this definition
with REG_EXP=\* on your make command line.  I also fixed the
Makeconf created in the build directory to define REG_EXP,
so builds initiated in the build directory work.

Special notes:
------- -----

I only tested briefly on the Vax and Sun 3.


******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
43
[ ./include/Makefile ]
Added export of tape_status.h
[91/02/21            af]
[ ./kernel/boot_ufs/boot_printf.c ]
Should initialize the "count" before a device_read_inband().
Bug found by laverne@sumitomo.com.
[91/03/13  15:03:15  af]
[ ./kernel/Makeconf ]
Define REG_EXP as .* on all platforms.
[91/03/14            rpd]
[ ./kernel/Makefile ]
Added REG_EXP to the Makeconf created in the build directory.
[91/03/14            rpd]
[ ./kernel/boot_ufs/default_pager.c ]
Updated for new kmem_alloc interface.
Fixed memory_object_create to zero the new pager structure.
[91/03/03            rpd]
Removed thread_swappable.
[91/01/18            rpd]
[ ./kernel/boot_ufs/load.c ]
Fixed read_emulator_symbols to not panic if there is no emulator.
[91/03/13            rpd]
[ ./kernel/conf/MASTER ]
Added MACH_COUNTERS (tag count).
[91/02/24            rpd]
[ ./kernel/conf/Makefile.i386 ]
Nullify the VOLATILE macro.
[91/03/13            rpd]
[ ./kernel/conf/Makefile.template ]
Moved VOLATILE from LINTOPTS to ALLOPTS.
[91/03/13            rpd]
[ ./kernel/conf/files ]
Added MACH_COUNTERS and kern/counters.c.
[91/02/24            rpd]
[ ./kernel/ddb/db_aout.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/ddb/db_command.c ]
Added db_recover.
[91/01/13            rpd]
[ ./kernel/ddb/db_sym.c ]
Changed the default db_maxoff to 4K.
[91/03/10            rpd]
[ ./kernel/device/device_init.c ]
Changed net_rcv_msg_thread to net_thread.
[91/02/13            rpd]
[ ./kernel/device/device_types.defs ]
Added filter_t.
[91/02/12            rpd]
[ ./kernel/device/ds_routines.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
Added io_done_thread_continue.
[91/02/13            rpd]
Removed thread_swappable.
[91/01/18            rpd]
[ ./kernel/device/net_io.c ]
Added net_thread, net_thread_continue.
[91/02/13            rpd]
Split net_rcv_msg_queue into high and low priority queues.
Cap the total number of buffers allocated.
[91/01/14            rpd]

Added net_rcv_msg_queue_size, net_rcv_msg_queue_max.
[91/01/12            rpd]
[ ./kernel/device/net_io.h ]
Added net_packet.
[91/01/14            rpd]
[ ./kernel/device/subrs.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/device/tape_status.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/i386/cswitch.s ]
Renamed Switch_task_context to Switch_context.
[91/02/17            rpd]
Added active_stacks.
[91/01/29            rpd]
[ ./kernel/i386/db_interface.c ]
Fixed kdb_trap to skip over permanent breakpoints.
[91/03/15            rpd]

Changed kdb_trap to use db_recover.
[91/01/14            rpd]

Fixed kdb_trap to disable interrupts.
[91/01/12            rpd]
[ ./kernel/i386/fpu.c ]
Pulled i386_fpsave_state out of i386_machine_state.
Picked up fixes from dbg.
[91/02/18            rpd]
[ ./kernel/i386/genassym.c ]
Removed k_ipl.
[91/03/01            rpd]
Added TH_SWAP_FUNC.
[91/02/24            rpd]

Added PCB_SIZE.
[91/02/01            rpd]
[ ./kernel/i386/init.c ]
Moved ktss_zone, pcb_zone initialization to pcb_module_init.
[91/02/18            rpd]
[ ./kernel/i386/io_map.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/i386/locore.s ]
Changed call_continuation to not change spl.
[91/02/17            rpd]
Added call_continuation.
Changed the AST interface.
[91/01/18            rpd]
[ ./kernel/i386/pcb.c ]
Pulled i386_fpsave_state out of i386_machine_state.
Added pcb_module_init.
[91/02/18            rpd]

Replaced stack_switch with stack_handoff and
switch_task_context with switch_context.
[91/02/18            rpd]
Added active_stacks.
[91/01/29            rpd]
[ ./kernel/i386/phys.c ]
Added resume, continuation arguments to vm_fault.
[91/02/05            rpd]
[ ./kernel/i386/read_fault.c ]
Added resume, continuation arguments to vm_fault_page.
Added continuation argument to VM_PAGE_WAIT.
[91/02/05            rpd]
[ ./kernel/i386/thread.h ]
Removed k_ipl from i386_kernel_state.
[91/03/01            rpd]

Pulled i386_fpsave_state out of i386_machine_state.
[91/02/18            rpd]

Renamed unused field in i386_saved_state to cr2.
Removed switch_thread_context.
[91/02/05            rpd]
[ ./kernel/i386/trap.c ]
Added resume, continuation arguments to vm_fault.
Added user_page_fault_continue.
[91/02/05            rpd]
Removed astintr.
[91/01/22  15:53:33  rpd]
[ ./kernel/i386at/blit.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/i386at/blituser.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/i386at/disk.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/i386at/if_3c501.c ]
Changed net_filter to net_packet.
[91/01/15            rpd]
[ ./kernel/i386at/if_ns8390.c ]
Changed net_filter to net_packet.
[91/01/15            rpd]
[ ./kernel/i386at/if_pc586.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
Changed net_filter to net_packet.
[91/01/15            rpd]
[ ./kernel/i386at/kd.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/i386at/rtc.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/i386ipsc/if_cnp.c ]
Changed net_filter to net_packet.
[91/01/15            rpd]
[ ./kernel/i386ipsc/sd.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/intel/pmap.c ]
Removed some incorrect (?) assertions.
[91/03/13  14:18:51  rpd]

Updated for new kmem_alloc interface.
[91/03/03            rpd]
Added continuation argument to VM_PAGE_WAIT.
[91/02/05            rpd]
[ ./kernel/ipc/ipc_entry.c ]
Fixed ipc_entry_grow_table to use it_entries_realloc.
[91/03/05            rpd]
[ ./kernel/ipc/ipc_kmsg.c ]
Replaced ith_saved with ipc_kmsg_cache.
[91/02/16            rpd]
[ ./kernel/ipc/ipc_kmsg.h ]
Replaced ith_saved with ipc_kmsg_cache.
[91/02/16            rpd]
[ ./kernel/ipc/ipc_mqueue.c ]
Renamed ipc_thread_{go,will_wait,will_wait_with_timeout}
to thread_{go,will_wait,will_wait_with_timeout}.
Replaced ipc_thread_block with thread_block.
[91/02/17            rpd]
[ ./kernel/ipc/ipc_port.c ]
Renamed ipc_thread_go to thread_go.
[91/02/17            rpd]
[ ./kernel/ipc/ipc_space.c ]
Added is_growing.
[91/03/07  16:38:42  rpd]
[ ./kernel/ipc/ipc_space.h ]
Added is_growing.
[91/03/04            rpd]
[ ./kernel/ipc/ipc_table.c ]
Added ipc_table_realloc and ipc_table_reallocable.
[91/03/04            rpd]
[ ./kernel/ipc/ipc_table.h ]
Added ipc_table_realloc.
[91/03/04            rpd]
[ ./kernel/ipc/mach_msg.c ]
Replaced ipc_thread_switch with thread_handoff.
Replaced ith_saved with ikm_cache.
[91/02/16            rpd]
Made null mach_msg_trap measurement easier.
[91/01/29            rpd]
[ ./kernel/kern/ast.c ]
Cleanup.
[91/02/13            rpd]
Changed the AST interface.
[91/01/17            rpd]
[ ./kernel/kern/ast.h ]
Fixed dummy aston, astoff definitions.
[91/02/12            rpd]
Revised the AST interface, adding AST_NETWORK.
Added volatile attribute to need_ast.
[91/01/18            rpd]
[ ./kernel/kern/debug.c ]
In panic, only call halt_cpu when not calling Debugger.
[91/03/12            rpd]
[ ./kernel/kern/exception.c ]
Fixed assertion typo.
[91/03/08            rpd]
Replaced ipc_thread_switch with thread_handoff.
Replaced ith_saved with ikm_cache.
[91/02/16            rpd]
[ ./kernel/kern/ipc_kobject.c ]
Replaced ith_saved with ikm_cache.
[91/02/16            rpd]
[ ./kernel/kern/ipc_sched.c ]
Rewrote ipc_thread_switch as thread_handoff,
with new stack_handoff replacing stack_switch.
Renamed ipc_thread_{go,will_wait,will_wait_with_timeout}
to thread_{go,will_wait,will_wait_with_timeout}.
[91/02/17            rpd]
Removed ipc_thread_switch_hits.
[91/01/28            rpd]
Allow swapped threads on the run queues.
[91/01/17            rpd]
[ ./kernel/kern/ipc_sched.h ]
Replaced ipc_thread_switch with thread_handoff.
Renamed ipc_thread_{go,will_wait,will_wait_with_timeout}
to thread_{go,will_wait,will_wait_with_timeout}.
Removed ipc_thread_block.
[91/02/17            rpd]
[ ./kernel/kern/ipc_tt.c ]
Removed ith_saved.
[91/02/16            rpd]
[ ./kernel/kern/kalloc.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/kern/mach_clock.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
Use counter macros to track thread and stack usage.
[91/03/01  17:43:15  rpd]
[ ./kernel/kern/machine.c ]
Added action_thread_continue.
[91/01/22            rpd]
[ ./kernel/kern/sched_prim.c ]
Added idle_thread_continue, sched_thread_continue.
[91/01/20            rpd]

Allow swapped threads on the run queues.
Added thread_invoke, thread_select.
Reorganized thread_block, thread_run.
Changed the AST interface; idle_thread checks for ASTs now.
[91/01/17            rpd]
[ ./kernel/kern/sched_prim.h ]
Added declarations of new functions.
[91/02/24            rpd]
[ ./kernel/kern/server_loop.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/kern/startup.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
Removed thread_swappable.
[91/01/18            rpd]
[ ./kernel/kern/syscall_subr.c ]
Renamed ipc_thread_will_wait_with_timeout
to thread_will_wait_with_timeout.
[91/02/17            rpd]
Added swtch_continue, swtch_pri_continue, thread_switch_continue.
[91/01/17            rpd]
[ ./kernel/kern/syscall_sw.c ]
Changed swtch, swtch_pri, and thread_switch to MACH_TRAP_STACK.
[91/01/17            rpd]
[ ./kernel/kern/task.c ]
Can't use thread_dowait on the current thread now.
[91/01/20            rpd]
[ ./kernel/kern/thread.c ]
Fixed the initialization of stack_lock_data.
[91/03/11            rpd]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
Removed ith_saved.
[91/02/16            rpd]

Added stack_alloc_max.
[91/02/10            rpd]
Added active_stacks.
[91/01/28            rpd]
Can't use thread_dowait on the current thread now.
Added reaper_thread_continue.
Added stack_free_reserved.
[91/01/20            rpd]

Removed thread_swappable.
Allow swapped threads on the run queues.
Changed the AST interface.
[91/01/17            rpd]
[ ./kernel/kern/thread.h ]
Removed ith_saved.
[91/02/16            rpd]

Added save-state fields for page faults.
[91/02/05            rpd]
Added NCPUS to active_threads declaration.
Added active_stacks.
[91/01/28            rpd]
Added swap_privilege.
[91/01/18            rpd]
[ ./kernel/kern/thread_swap.c ]
Removed thread_swapout.
[91/02/24            rpd]
Added swapin_thread_continue.
Simplified the state machine.  Now it uses only
TH_SW_IN, TH_SW_OUT, TH_SW_COMING_IN.
[91/01/20            rpd]

Simplified thread_swapin.
[91/01/17            rpd]
[ ./kernel/kern/thread_swap.h ]
Removed thread_swappable, swapout_thread, etc.
Removed unnecessary swap states.
[91/01/18            rpd]
[ ./kernel/kern/xpr.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/kern/zalloc.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
Added continuation argument to thread_block.
[91/02/16            rpd]
[ ./kernel/mips/PMAX/if_se.c ]
Changed net_filter to net_packet.
[91/01/15            rpd]
[ ./kernel/mips/PMAX/if_se_mapped.c ]
Picked up a further spl fix from Sandro.
[91/03/09            rpd]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
Removed thread_swappable.
[91/01/18            rpd]
[ ./kernel/mips/PMAX/lk201.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/mips/PMAX/mapped_scsi.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
Removed thread_swappable.
[91/01/18            rpd]
[ ./kernel/mips/PMAX/screen.c ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/mips/PMAX/screen.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/mips/PMAX/scsi_7061_hdw.c ]
Picked up a further spl fix from Sandro.
[91/03/09            rpd]
[ ./kernel/mips/ast.h ]
Removed EXC_AST.
[91/01/22  15:59:10  rpd]
[ ./kernel/mips/autoconf.c ]
Replaced pcb_zone initialization with pcb_module_init.
[91/02/17            rpd]
[ ./kernel/mips/context.s ]
Replaced stack_switch with stack_handoff
and switch_{task,thread}_context with Switch_context.
[91/02/17            rpd]
Moved stack_switch here again.
Added active_stacks.
[91/01/28            rpd]
[ ./kernel/mips/db_interface.c ]
Added resume, continuation arguments to vm_fault.
[91/02/04            rpd]
Changed kdb_trap to use db_recover.
[91/01/13            rpd]

Removed db_nofault.
db_error might return now.
[91/01/13            rpd]
[ ./kernel/mips/db_mips_sym.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/mips/db_trace.c ]
Fixed db_trace_cproc to handle wired cthreads.
Fixed db_cproc_state.
[91/03/10            rpd]
Fixed tracing of swapped threads.
Removed unnecessary uses of db_get_value.
[91/03/01  17:49:16  rpd]
[ ./kernel/mips/genassym.c ]
Removed MKS_SR.
[91/03/01            rpd]

Added mips_float_state definitions.
[91/02/18            rpd]

Added PCB_SIZE.
[91/02/01            rpd]
Removed pcache support.
[91/01/10            rpd]
[ ./kernel/mips/locore.s ]
Pulled mips_float_state out of mips_machine_state.
[91/02/18            rpd]

Changed call_continuation to not change spl.
[91/02/17            rpd]
Changed TRAP_cu to disable fpa use for the old fpa owner.
[91/01/29            rpd]
Added call_continuation.
Changed the AST interface.
[91/01/18            rpd]
[ ./kernel/mips/mips_cpu.s ]
Pulled mips_float_state out of mips_machine_state.
[91/02/18            rpd]
[ ./kernel/mips/pcb.c ]
Pulled mips_float_state, mips_sstep_state out of mips_machine_state.
Added pcb_module_init.
[91/02/18            rpd]
Added continuation argument to VM_PAGE_WAIT.
Added stack_alloc_max.
[91/02/05            rpd]
Moved stack_switch to mips/context.s.
Added active_stacks.
[91/01/28            rpd]
Added stack_free_reserved.
[91/01/20            rpd]
[ ./kernel/mips/pmap.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
Removed pcache support.
[91/01/10            rpd]
[ ./kernel/mips/pmap.h ]
Removed pcache support.
[91/01/10            rpd]
[ ./kernel/mips/thread.h ]
Removed sr from mips_kernel_state.
[91/03/01            rpd]

Broke mips_float_state, mips_sstep_state out of mips_machine_state.
[91/02/17            rpd]
[ ./kernel/mips/trap.c ]
Added mips_sstep_state.
[91/02/18            rpd]
Added resume, continuation arguments to vm_fault.
Added user_page_fault_continue.
[91/02/04            rpd]
Removed EXC_AST.
[91/01/22  16:01:04  rpd]
[ ./kernel/sun/cons.c ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/sun/dkio.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/sun/fbio.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/sun3/autoconf.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/sun3/db_interface.c ]
Replaced db_nofault with db_recover.
[91/03/14            rpd]
[ ./kernel/sun3/db_trace.c ]
Replaced db_jmpbuf with db_recover.
[91/03/14            rpd]
[ ./kernel/sun3/locore.s ]
Clear thread->recover in the syscall path.
[91/03/15            rpd]
[ ./kernel/sun3/model_dep.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/sun3/pcb.c ]
Added continuation argument to stack_attach.
[91/03/14            rpd]
[ ./kernel/sun3/pmap.c ]
bzero pmap after getting it from zalloc.
[91/03/15            rwd]

Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/sun3/trap.c ]
Hacked for AST interface changes.
[91/03/15            rpd]

Added resume, continuation arguments to vm_fault.
[91/03/13            rpd]

Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/sundev/cgfour.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/sundev/cgtwo.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/sundev/fpareg.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/sundev/kbio.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/sundev/si.c ]
Replaced vm_map_find with vm_map_enter.
[91/03/14            rpd]
[ ./kernel/sundev/vuid_event.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/sundev/xy.c ]
Removed non-MACH code.
[91/03/04            rpd]
[ ./kernel/sunif/if_ie.c ]
Updated for new kmem_alloc interface.
Removed non-MACH code.
[91/03/03            rpd]
Changed net_filter to net_packet.
[91/01/15            rpd]
[ ./kernel/sunif/if_le.c ]
Replaced vm_map_find with vm_map_enter.
[91/03/14            rpd]

Updated for new kmem_alloc interface.
Removed non-MACH code.
[91/03/03            rpd]
Changed net_filter to net_packet.
[91/01/15            rpd]
[ ./kernel/sys/ioctl.h ]
Fixed the definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/vax/ast.h ]
Updated for the new AST interface.
[91/03/13            rpd]
[ ./kernel/vax/autoconf.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/vax/biconf.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/vax/db_interface.c ]
Replaced db_nofault with db_recover.
[91/03/14            rpd]
[ ./kernel/vax/pcb.c ]
Added continuation argument to stack_attach.
[91/03/14            rpd]
[ ./kernel/vax/pmap.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/vax/trap.c ]
Hacked for AST interface changes.
[91/03/15            rpd]

Added resume, continuation arguments to vm_fault.
[91/03/13            rpd]
[ ./kernel/vaxif/if_ni.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
Changed net_filter to net_packet.
[91/01/15            rpd]
[ ./kernel/vaxif/if_uba.c ]
Changed net_filter to net_packet.
[91/01/15            rpd]
[ ./kernel/vaxuba/qd.c ]
Updated for new kmem_alloc interface.
[91/03/03            rpd]
[ ./kernel/vaxuba/qdioctl.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/vaxuba/qv.c ]
Updated for new kmem_alloc interface.
Removed non-MACH, non-CMUCS, non-CMU code.
[91/03/03            rpd]
[ ./kernel/vaxuba/qvioctl.h ]
Fixed ioctl definitions for ANSI C.
[91/02/20            rpd]
[ ./kernel/vm/memory_object.c ]
Removed the old version of memory_object_data_provided.
[91/03/11            rpd]
Fixed memory_object_data_provided to return success
iff it consumes the copy object.
[91/02/10            rpd]
[ ./kernel/vm/vm_fault.c ]
Fixed vm_fault_page to give vm_pageout_page busy pages.
[91/03/11            rpd]
Added vm_fault_init, vm_fault_state_t.
[91/02/16            rpd]

Added resume, continuation arguments to vm_fault, vm_fault_page.
Added continuation argument to VM_PAGE_WAIT.
Added vm_fault_continue.
[91/02/05            rpd]
[ ./kernel/vm/vm_fault.h ]
Added vm_fault_init.
[91/02/16            rpd]
[ ./kernel/vm/vm_init.c ]
Added vm_fault_init.
[91/02/16            rpd]
[ ./kernel/vm/vm_kern.c ]
Fixed kmem_alloc_pages and kmem_remap_pages
to not hold locks across pmap_enter.
[91/03/11            rpd]
Added kmem_realloc.  Changed kmem_alloc, kmem_alloc_wired, and
kmem_alloc_pageable to return error codes.  Changed kmem_alloc
to not use the kernel object and to not zero memory.
Changed kmem_alloc_wired to use the kernel object.
[91/03/07  16:49:52  rpd]

Added resume, continuation arguments to vm_fault_page.
Added continuation argument to VM_PAGE_WAIT.
[91/02/05            rpd]
[ ./kernel/vm/vm_kern.h ]
Added kmem_realloc.  Changed kmem_alloc and friends
to return a kern_return_t.
[91/03/03            rpd]
[ ./kernel/vm/vm_map.c ]
Fixed vm_map_pmap_enter to activate loose pages after PMAP_ENTER.
[91/03/11            rpd]
Removed vm_map_find.
[91/03/03            rpd]
Fixed vm_map_entry_delete's use of vm_object_page_remove,
following dlb's report.
[91/01/26            rpd]
Picked up dlb's fix for vm_map_fork/VM_INHERIT_COPY of wired entries.
[91/01/12            rpd]
[ ./kernel/vm/vm_map.h ]
Removed vm_map_find.  Added vm_map_find_entry.
[91/03/03            rpd]
[ ./kernel/vm/vm_object.c ]
Changed vm_object_deactivate_pages and vm_object_terminate to
check for busy pages.  Changed how vm_object_terminate
interacts with the pageout daemon.
[91/03/12            rpd]
Fixed vm_object_page_remove to be smart about small regions.
[91/03/05            rpd]
Added resume, continuation arguments to vm_fault_page.
Added continuation argument to VM_PAGE_WAIT.
[91/02/05            rpd]
[ ./kernel/vm/vm_page.h ]
Added continuation argument to VM_PAGE_WAIT, vm_page_wait.
[91/02/05            rpd]
[ ./kernel/vm/vm_pageout.c ]
Modified vm_pageout_scan for further vm_page_deactivate changes.
Also changed it to ignore pages in dead objects.
[91/03/11            rpd]
Added vm_pageout_continue.
[91/01/20            rpd]
[ ./kernel/vm/vm_resident.c ]
Reverted to the previous version of vm_page_deactivate,
which doesn't look at the busy bit.  Changed vm_page_alloc
to not deactivate busy pages.
[91/03/11            rpd]

Fixed simple-locking typo.
[91/03/09            rpd]
Added continuation argument to vm_page_wait.
[91/02/05            rpd]
[ ./kernel/vm/vm_user.c ]
Removed temporary extra stats.
[91/02/10            rpd]
[ ./kernel/kern/counters.c ]
Created.
[91/03/13            rpd]
[ ./kernel/kern/counters.h ]
Created.
[91/03/13            rpd]
    
    
    
==========================================================================
   ***** MK Version MK44  (dbg) *****
    
    
New features:
--- --------

The kernel now runs on at least two multiprocessors: the Sequent (i386),
and R2D2 (Vax 8200).  The machine-independent portions of the kernel
should now be OK for multiprocessor work.

CPU_SUBTYPE_SYMMETRY is now defined.

[I386]	We now support the Sequent Symmetry i386 multiprocessor.  To build
	for the Sequent, specify "CONFIG=STD+SQT+32".  The config program
	now assumes that "MACHINE sqt" is a Symmetry: it uses the conf/*.i386
	files, not the (non-existent) conf/*.sqt files.

[VAX]	The Vax kernel can now be built with GCC: add '+gcc' to the
	configuration name.  However, getting a proper GCC for the VAX
	was difficult, since the GCC in the .gnu-comp collection does not
	talk correctly to CMU Make.
	
	To get the proper GCC compiler, you must set up your environment
	as follows:

 setpath -i0 /afs/cs/project/mach-7/release/vax_mach/latest;
 setenv GCC_EXEC_PREFIX /afs/cs/project/mach-7/release/vax_mach/latest/lib/gcc-
	(because GCC doesn't really look down LPATH for the compiler pieces).

	And the VAX assembler code is still built with the BSD assembler,
	because there are too many bugs in GAS.

	The VAX now uses Rich Draves' stack switching code.  This leaves only
	the SUN3 (soon to be decommissioned?) and the i860 defining
	KEEP_STACKS.

	(vm/vm_object.c tripped over a VAX GCC bug; I had to partially
	 rewrite one routine as a result.  vm_object_enter should be further
	 rewritten anyway to separate the internal and external cases, since
	 they have very little in common.)

Bug fixes:
--- -----

Network packets sent to multiple filters all have the correct packet size
(thanks, DPJ).

The control ports for all CPUs are now created when the system is started,
not when the CPU is started.  The old method gave the outside world no way
to talk to a CPU that hadn't been started yet.  The ports also remain when
the CPU is shut down.  (WARNING - the shutdown code doesn't work yet - it
will crash the system).

Volatile declarations have been added where needed.

Choose_pset_thread and its callers (thread_select) have been rewritten
to avoid confusing a pset with its runq (buggy C code).


[I386]	The floating-point code has been rewritten to always save the FPU
	state in memory on context switch.  It's slower, but there were
	two problems with the old method:
	1:	It's unknown what happens when the i386 switches
		mappings while the i387 has a store instruction
		(e.g. fbstp) in progress.  Where does the data go?
	2:	On a multiprocessor, we'd need interprocessor interrupts
		to fetch a thread's FP state from the CPU it last ran on.

	Exiting an interrupt routine correctly leaves processor interrupts
	disabled until the IRET instruction.
	
	The PMAP bug that would occasionally cause the machine to reboot
	has been fixed.  We now switch to the kernel's page directory
	at PMAP_DEACTIVATE, instead of leaving a dangling reference to
	a task page directory that may be about to vanish.

	The cthreads library now uses locking instructions to unlock locks.
	I'm not sure this is necessary for the Sequent, but it may be on
	other machines, depending on hwo they implement locking.

[VAX]	The ugly 'br' and 'cvec' global register variables have been moved
	to memory to accommodate GCC.
	
	The disassembler now correctly displays instructions using indexing.


Organizational changes:
-------------- -------

kern/lock.h now imports <machine/lock.h> when building for multiprocessors
(NCPUS > 1).  This is the place to put machine-specific definitions of
a simple_lock (e.g. for the HPPA), or GCC inline-assembler definitions of
simple_lock and simple_unlock.  The files exist for the VAX and I386.



[I386]	Files in the i386 directory are common to the various i386 machines:
	the PC-AT compatibles (i386at),
	the Intel Hypercube (i386ipsc),
	and the Sequent (sqt*).
	
	Code that differs from machine to machine has been moved to the
	machine-specific directories as much as possible.  This includes
	the assembly code to get bootup parameters (*/asm_startup.h),
	the C initialization and shutdown code (*/model_dep.c), and
	interrupt and SPL handling (*/interrupt.s, */spl.s).
	
	The i386 directory does contain code that is shared by the i386at
	and i386ipsc implementations.  This is interrupt-handling and timer
	code that runs on the Intel interrupt handler (8259) and timer (8254)
	chips that both of these machines use.  If (when?) I merge in support
	for the Corollary, it will also use these routines.

	Locore.s and friends are now built with normal Make rules.

	The 'makeboot' program is needed to fix the executable file for
	the Sequent, which uses a special magic number for kernel boot
	files.

[VAX]	Locore.s and friends are now built with normal Make rules.
	The initialization code in vax_init.c has been rewritten in assembler
	(vax_init.s).  It runs in physical mode, and tripped over GCC, which
	doesn't agree with PCC about what constructs generate PC-relative
	addresses (which would give physical addresses in this context) and
	which generate absolute addresses (which always give virtual addresses).

	The awk script for vaxfloat.sa has disappeared.  The file is now
	vaxfloat.s, and uses C preprocessor macros.

	When building with GCC, the inline program is no longer used.
	Various VAX header files now use the GCC inline assembler macros
	instead.  There is a global inline-substition file, vax/gcc_asm.h,
	which is included in every kernel file through some GCC tricks.


Special notes:
------- -----

The system should now be built and tested in the following configurations:

PMAX:	STD+ANY	(decstations)

I386:	STD+WS	(PC-compatible i386 boxes)
	STD+SQT+32	the Symmetry
	STD+NORMA+iPSC	the Intel Hypercube (NOT TESTED FOR THIS RELEASE)

VAX:	STD+VAX6bb+gcc	(microvaxen)
	STD+16+fixpri+VAX6bb+BI+de+gcc (R2D2)

SUN3:	STD+SWS

i860:	???



******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
44
[ ./kernel/conf/copyright ]
Change 'Carnegie' to 'Carnegie Mellon'.
[ ./kernel/conf/MASTER.i386 ]
Remove '-fno-function-cse' from compilation options - i386 never
used the 'inline' program.
[91/04/30            dbg]

Add Sequent.  Remove options files for CPU types.
Sequent includes SYS rules to make mach.boot from mach_kernel.
[91/04/26  14:25:14  dbg]
[ ./kernel/conf/MASTER.vax ]
Add definitions for gcc.
[91/03/21            dbg]
[ ./kernel/conf/Makefile.i386 ]
Add rules to build makeboot for the Sequent.
WARNING - CPATH is hardwired to /usr/include, and
the build line probably won't work if shadowing.
This will all be fixed if makeboot is used for all kernels.
[91/04/25            dbg]

Don't build locore with special rules.
[91/03/21            dbg]
[ ./kernel/conf/Makefile.vax ]
Build locore.o with normal Make rules.
Add rules for building kernel with GCC;
the configuration will select which rules to use.
Remove awk rule for building vaxfloat.s.
[91/04/23            dbg]
[ ./kernel/conf/files ]
Remove individual 'VOLATILE' switches, since 'VOLATILE' is
defined in the master Makefile.template.
[91/04/30            dbg]

Added 'VOLATILE' for kern/{machine,syscall_subr,thread}.c.
[91/03/21            dbg]
[ ./kernel/conf/files.i386 ]
Rearrange files to add Sequent and put model-dependent files in
model-dependent directories.  Build cswitch.s, locore.s, start.s
as standard files.
[91/04/26  14:28:46  dbg]
[ ./kernel/conf/files.vax ]
Build locore.s with normal rules; put first.
Build vaxfloat.s directly.
[91/04/23            dbg]

Change vax_init.c to vax_init.s.
[91/04/11            dbg]

Added FORCE_VOLATILE for gcc.
[91/03/21            dbg]
[ ./kernel/conf/newvers.sh ]
Added one more sed clause to deal with the "'s in the new 
copyright.
[91/05/07            mrt]
[ ./kernel/emul/vaxarith.s ]
Adapt for ANSI C preprocessor.
[91/04/23            dbg]
[ ./kernel/emul/vaxashp.s ]
Adapt for ANSI C preprocessor.
[91/04/23            dbg]
[ ./kernel/emul/vaxconvrt.s ]
Adapt for ANSI C preprocessor.
[91/04/23            dbg]
[ ./kernel/emul/vaxcvtlp.s ]
Adapt for ANSI C preprocessor.
[91/04/23            dbg]
[ ./kernel/emul/vaxcvtpl.s ]
Adapt for ANSI C preprocessor.
[91/04/23            dbg]
[ ./kernel/emul/vaxdeciml.s ]
Adapt for ANSI C preprocessor.
[91/04/23            dbg]
[ ./kernel/emul/vaxeditpc.s ]
Adapt for ANSI C preprocessor.
[91/04/23            dbg]
[ ./kernel/emul/vaxemul.h ]
Changed #define to .set for ANSI preprocessor - '$' isn't an
identifier character in ANSI C.
[91/04/23            dbg]
[ ./kernel/emul/vaxemulat.s ]
Adapt for ANSI C preprocessor.
[91/04/23            dbg]
[ ./kernel/emul/vaxexception.s ]
Adapt for ANSI C preprocessor.
[91/04/23            dbg]

Changes for MACH_KERNEL:
. Don't call _grow.
[89/05/02            dbg]
[ ./kernel/emul/vaxfloat.s ]
Adapt for ANSI C preprocessor.
Fixed set_op_types macro to eliminate awk script, and
moved file to emul/vaxfloat.s.
[91/04/25            dbg]
[ ./kernel/emul/vaxhandlr.s ]
Adapt for ANSI C preprocessor.
[91/04/23            dbg]
[ ./kernel/emul/vaxregdef.h ]
Changed #define to .set for ANSI preprocessor - '$' isn't an
identifier character in ANSI C.
[91/04/23            dbg]
[ ./kernel/emul/vaxstring.s ]
Adapt for ANSI C preprocessor.
[91/04/23            dbg]
[ ./kernel/i386/ast_check.c ]
Copied for i386.
[91/03/21            dbg]
[ ./kernel/i386/ast_types.h ]
Copied for i386.
[91/03/21            dbg]
[ ./kernel/i386/cpu_number.h ]
Created.
[91/03/21            dbg]
[ ./kernel/i386/cswitch.s ]
Put parentheses around substituted immediate expressions, so
that they will pass through the GNU preprocessor.

Handle multiple CPUs.  Save floating-point state when saving
context or switching stacks.  Add switch_to_shutdown_context to
handle CPU shutdown.
[91/03/21            dbg]
[ ./kernel/i386/fpu.c ]
Simplify.  Always store FP state on context switch.
1:	It's unknown what happens when the i386 switches
	mappings while the i387 has a store instruction
	(e.g. fbstp) in progress.  Where does the data go?
2:	On a multiprocessor, we'd need interprocessor interrupts
	to fetch a thread's FP state from the CPU it last ran on.
[91/04/26  14:34:04  dbg]
[ ./kernel/i386/gdt.c ]
Collapsed GDT again.
[91/04/26  14:34:34  dbg]
[ ./kernel/i386/genassym.c ]
Add definitions for multiprocessors and for Sequent Symmetry.
Change '#define' to '.set' to help fool GCC preprocessor.
[91/04/26  14:35:03  dbg]
[ ./kernel/i386/hardclock.c ]
Include sqt/intctl.h if building for Sequent.
[91/03/21            dbg]
[ ./kernel/i386/idt.s ]
Put parentheses around substituted immediate expressions, so
that they will pass through the GNU preprocessor.
[91/04/26  14:35:28  dbg]
[ ./kernel/i386/interrupt.s ]
Put parentheses around substituted immediate expressions, so
that they will pass through the GNU preprocessor.

Use cputypes.h.  Call version of set_spl that leaves interrupts
disabled (IF clear) until iret.
[91/04/26  14:35:53  dbg]
[ ./kernel/i386/iopb.c ]
Created.
[91/03/21            dbg]
[ ./kernel/i386/iopb.h ]
Created.
[91/03/21            dbg]
[ ./kernel/i386/lock.h ]
Created.
[91/03/21            dbg]
[ ./kernel/i386/locore.s ]
Put parentheses around substituted immediate expressions, so
that they will pass through the GNU preprocessor.

Handle multiple CPUS.
[91/04/26  14:36:46  dbg]
[ ./kernel/i386/mp_desc.c ]
Created.
[91/03/21            dbg]
[ ./kernel/i386/mp_desc.h ]
Created.
[91/03/21            dbg]
[ ./kernel/i386/pcb.c ]
Use iopb_tss_t for IO permission bitmap.
[91/03/21            dbg]
[ ./kernel/i386/phys.c ]
More cleanup.
[91/03/21            dbg]
[ ./kernel/i386/pic.c ]
Use cputypes.h for CPU names.
[91/04/26  14:37:37  dbg]
[ ./kernel/i386/pic.h ]
Use cputypes.h to get CPU names.
[91/03/21            dbg]
[ ./kernel/i386/proc_reg.h ]
Created.
[91/03/21            dbg]
[ ./kernel/i386/seg.h ]
Added USER_TSS for TSS that holds IO permission bitmap.
Removed space for descriptors 8..38.
Added real_descriptor, real_gate, sel_idx.
[91/04/26  14:38:07  dbg]
[ ./kernel/i386/setroot.c ]
Include cputypes.h to get CPU names.
[91/03/21            dbg]
[ ./kernel/i386/spl.s ]
Put parentheses around substituted immediate expressions, so
that they will pass through the GNU preprocessor.

Add set_spl_noi to reset PIC masks but leave interrupts disabled
(IF clear).
[91/04/26  14:38:31  dbg]
[ ./kernel/i386/start.s ]
Put parentheses around substituted immediate expressions, so
that they will pass through the GNU preprocessor.

Moved model-specific code to machine-dependent directories.
Added startup code for multiple CPUs.
[91/04/26  14:38:55  dbg]
[ ./kernel/i386/thread.h ]
Change ktss to iopb_tss in pcb.
[91/04/26  14:39:10  dbg]
[ ./kernel/i386/trap.c ]
Correct calls to FPU error routines.
[91/04/26  14:39:33  dbg]
[ ./kernel/i386/tss.h ]
Protect against multiple includes.
[91/04/26  14:39:49  dbg]
[ ./kernel/i386at/asm_startup.h ]
Created (from old i386/start.s).
[91/04/26  14:40:03  dbg]
[ ./kernel/i386at/kd.c ]
Create and destroy io_port sets to map IO ports into user
threads.
[91/04/26  14:40:17  dbg]
[ ./kernel/i386at/model_dep.c ]
Initialization for i386 AT bus machines only.
Combine code that was in i386/init.c and i386/i386_init.c.
[91/04/26  14:40:43  dbg]
[ ./kernel/i386ipsc/asm_startup.h ]
Created (from old i386/start.s).
[91/04/26  14:40:58  dbg]
[ ./kernel/i386ipsc/model_dep.c ]
Initialization for iPSC only.
Add code that was in i386/init.c.
Add pmap_valid_page.
[91/04/26  14:41:16  dbg]
[ ./kernel/intel/pmap.c ]
Add volatile declarations where needed.
Move pmap_valid_page to model_dependent file.
[91/04/26  14:41:31  dbg]
[ ./kernel/intel/pmap.h ]
Add volatile declarations.  Load CR3 when switching to kernel
pmap in PMAP_ACTIVATE_USER.  Fix PMAP_ACTIVATE_KERNEL.
[91/04/26  14:41:54  dbg]
[ ./kernel/kern/ast.c ]
Add volatile declarations where needed.
[91/04/18            dbg]

Add missing argument to ast_on in assign/shutdown case.
[91/03/21            dbg]
[ ./kernel/kern/lock.h ]
When actually using the locks (on multiprocessors), import the
machine-dependent simple_lock routines from machine/lock.h.
[91/04/26  14:42:23  dbg]
[ ./kernel/kern/machine.c ]
Add volatile declarations.

Preserve the control port for a processor when shutting
it down.
[91/04/26  14:42:42  dbg]
[ ./kernel/kern/processor.c ]
Changed pset_sys_init to give each processor a control port,
even when it is not running.  Without a control port, there is
no way to start an inactive processor.
[91/04/26  14:42:59  dbg]
[ ./kernel/kern/queue.c ]
Compile queue routines on vax.
[91/03/26            dbg]
[ ./kernel/kern/sched_prim.c ]
Distinguish processor sets from run queues in choose_pset_thread!
Remove (long dead) 'someday' code.
[91/04/26  14:43:26  dbg]
[ ./kernel/kern/syscall_subr.c ]
Add volatile declarations.
Removed history for non-existent routines.
[91/04/26  14:43:58  dbg]
[ ./kernel/kern/thread.c ]
Add volatile declarations.
[91/04/26  14:44:13  dbg]
[ ./kernel/mach/machine.h ]
Add CPU_SUBTYPE_SYMMETRY.
[91/04/26  14:44:44  dbg]
[ ./kernel/sqt/SGSmem.h ]
Added, from Sequent SYMMETRY sources.
[91/04/26  14:45:32  dbg]
[ ./kernel/sqt/SGSproc.h ]
Added, from Sequent SYMMETRY sources.
[91/04/26  14:45:57  dbg]
[ ./kernel/sqt/_boot.s ]
Created.
[91/04/26  14:46:24  dbg]
[ ./kernel/sqt/asm_macros.h ]
Created from Sequent file.
[91/04/26  14:46:43  dbg]
[ ./kernel/sqt/asm_startup.h ]
Created.
[91/04/26  14:47:07  dbg]
[ ./kernel/sqt/autoconf.c ]
Adapted for pure Mach kernel.  No conditionals.  Removed ns32000
and KXX support.
[91/04/26  14:47:41  dbg]
[ ./kernel/sqt/bdp.h ]
Added from Sequent SYMMETRY sources.
[91/04/26  14:48:02  dbg]
[ ./kernel/sqt/bic.h ]
Added from Sequent SYMMETRY sources.
[91/04/26  14:48:22  dbg]
[ ./kernel/sqt/buscycles.h ]
Added, from Sequent SYMMETRY sources.
[91/04/26  14:48:45  dbg]
[ ./kernel/sqt/cfg.h ]
Added, from Sequent SYMMETRY sources.
[91/04/26  14:49:10  dbg]
[ ./kernel/sqt/chiptypes.h ]
Added, from Sequent SYMMETRY sources.
[91/04/26  14:49:30  dbg]
[ ./kernel/sqt/clkarb.h ]
Added, from Sequent SYMMETRY sources.
[91/04/26  14:49:49  dbg]
[ ./kernel/sqt/clock.c ]
Adapted from Sequent Symmetry sources.
[91/04/26  14:50:24  dbg]
[ ./kernel/sqt/clock.h ]
Added, from Sequent SYMMETRY sources.
[91/02/26            dbg]
[ ./kernel/sqt/consio.c ]
Adapted from Sequent SYMMETRY sources.
[91/04/26  14:51:09  dbg]
[ ./kernel/sqt/engine.h ]
Adapted from Sequent SYMMETRY sources.
[91/04/26  14:51:36  dbg]
[ ./kernel/sqt/hwparam.h ]
Added, from Sequent SYMMETRY sources.
[91/04/26  14:51:55  dbg]
[ ./kernel/sqt/intctl.h ]
Converted for pure kernel and GCC.
[91/04/26  14:52:18  dbg]
[ ./kernel/sqt/interrupt.s ]
Put parentheses around substituted immediate expressions, so
that they will pass through the GNU preprocessor.
[91/01/31            dbg]

Converted (interrupt handlers only) for pure kernel.
Use Mach Kernel interrupt sequence, not Dynix.
[90/05/02            dbg]
[ ./kernel/sqt/ioconf.h ]
Adapted for pure Mach kernel.
[91/04/26  14:53:25  dbg]
[ ./kernel/sqt/macros.h ]
Created.
[91/04/26  14:53:43  dbg]
[ ./kernel/sqt/memory.c ]
Adapted for pure Mach kernel.
[91/04/26  14:54:06  dbg]
[ ./kernel/sqt/misc.s ]
Converted for pure kernel.
[90/05/02            dbg]
[ ./kernel/sqt/model_dep.c ]
Each CPU calls mp_desc_init on its own.
[91/02/13            dbg]

Add pmap_valid_page.
[91/01/17            dbg]

Altered for pure kernel.
Created from pieces of sqt/machdep.c and sqt/startup.c.
[90/10/03            dbg]
[ ./kernel/sqt/mutex.h ]
Adapted for pure kernel.  Removed gate code, since Symmetry
doesn't use it.  Re-implemented Dynix semaphores.
[90/09/24            dbg]
[ ./kernel/sqt/mutex.s ]
Use entire word for lock to match lock primitives.
[91/02/05            dbg]

Put parentheses around substituted immediate expressions, so
that they will pass through the GNU preprocessor.
[91/01/31            dbg]

Adapted for pure kernel.
[90/09/24            dbg]
[ ./kernel/sqt/sema.c ]
Created.
[91/04/26  14:56:44  dbg]
[ ./kernel/sqt/setconf.c ]
Adapted for pure Mach kernel.
[90/10/09            dbg]
[ ./kernel/sqt/slic.c ]
Adapted for pure Mach kernel.
[90/10/03            dbg]
[ ./kernel/sqt/slic.h ]
Added volatile declarations.
[90/11/13            dbg]

Adapted for pure Mach kernel.  I386 SGS processors only.
[90/10/02            dbg]
[ ./kernel/sqt/slicreg.h ]
Added, from Sequent SYMMETRY sources.
[91/02/26            dbg]
[ ./kernel/sqt/spl.s ]
Fix SPL levels to match reality.
[91/02/14            dbg]

Put parentheses around substituted immediate expressions, so
that they will pass through the GNU preprocessor.
[91/01/31            dbg]

Adapted for pure Mach kernel.
[90/10/02            dbg]
[ ./kernel/sqt/sqtasm.h ]
Changes for pure kernel.
[90/05/02            dbg]
[ ./kernel/sqt/sqtparam.h ]
Adapted from Sequent SYMMETRY sources.
[91/04/26  15:00:13  dbg]
[ ./kernel/sqt/stubs.c ]
Created.
[91/04/26  15:00:31  dbg]
[ ./kernel/sqt/trap.h ]
Added, from Sequent SYMMETRY sources.
[91/02/26            dbg]
[ ./kernel/sqt/vm_defs.h ]
Make KVTOPHYS use kvtophys to avoid locking kernel pmap.
[91/02/14            dbg]

Move cpu-local mappings (slic, leds, elapsed-time counter) to
level 1 page just below FPA.
[90/12/17            dbg]

Rewrote for pure Mach kernel.  Kernel is no longer mapped 1-1
with physical memory.
[90/09/27            dbg]
[ ./kernel/sqtconf/conf.c ]
Created.
[90/10/04            dbg]
[ ./kernel/sqtconf/conf_co.c ]
Adapted for pure Mach kernel.
[91/04/26  15:02:33  dbg]
[ ./kernel/sqtconf/conf_if_se.c ]
Adapted for pure Mach kernel.
[90/10/05            dbg]
[ ./kernel/sqtconf/conf_led.c ]
Adapted for pure Mach kernel.
[90/10/03            dbg]
[ ./kernel/sqtconf/conf_sd.c ]
Adapted for pure Mach kernel.
[90/10/04            dbg]
[ ./kernel/sqtconf/conf_vec.c ]
Added, from Sequent SYMMETRY sources.
[91/02/26            dbg]
[ ./kernel/sqtconf/conf_zd.c ]
Adapted for pure Mach kernel.
[90/10/05            dbg]
[ ./kernel/sqtconf/sqt_io_conf.c ]
Adapted for pure Mach kernel.
[90/10/03            dbg]
[ ./kernel/sqtconf/sqtparam.c ]
Adapted for pure Mach kernel.
[90/10/03            dbg]
[ ./kernel/sqtmbad/ioconf.h ]
Added, from Sequent SYMMETRY sources.
[91/02/26            dbg]
[ ./kernel/sqtsec/co.c ]
Added cn routines for kernel debugger input.
[90/11/16            dbg]

Adapted for pure kernel.
[90/09/24            dbg]
[ ./kernel/sqtsec/co.h ]
Added volatile declarations.
[91/03/25            dbg]

Added output buffer since Mach kernel circular buffers are not
within SCED-addressable space (lowest 4 Meg).
[90/12/18            dbg]

Adapted for pure kernel.
[90/09/24            dbg]
[ ./kernel/sqtsec/if_se.c ]
Changed net_filter to net_packet.

MACH_KERNEL conversion.
Added volatile declarations.
[91/03/22            dbg]
[ ./kernel/sqtsec/if_se.h ]
MACH_KERNEL conversion.
[90/10/05            dbg]
[ ./kernel/sqtsec/ioconf.h ]
Added, from Sequent SYMMETRY sources.
[91/02/26            dbg]
[ ./kernel/sqtsec/scsi.h ]
Added, from Sequent SYMMETRY sources.
[91/02/26            dbg]
[ ./kernel/sqtsec/sd.c ]
Added volatile declarations.
[91/03/25            dbg]

Adapted for pure kernel.  No conditionals.
[90/09/24            dbg]
[ ./kernel/sqtsec/sd.h ]
Adapted for pure Mach kernel.
[90/10/04            dbg]
[ ./kernel/sqtsec/sec.c ]
Added volatile declarations.  Distribute interrupts to any CPU.
[91/03/25            dbg]

Adapted for pure kernel.
[90/09/24            dbg]
[ ./kernel/sqtsec/sec.h ]
Added volatile declarations.
[90/11/13            dbg]

Adapted for pure Mach kernel.
[90/10/04            dbg]
[ ./kernel/sqtsec/sec_ctl.h ]
Added, from Sequent SYMMETRY sources.
[91/02/26            dbg]
[ ./kernel/sqtzdc/ioconf.h ]
Added, from Sequent SYMMETRY sources.
[91/02/26            dbg]
[ ./kernel/sqtzdc/zd.c ]
Changes for new kmem_alloc interface.

Adapted for pure Mach kernel.
[91/03/22            dbg]
[ ./kernel/sqtzdc/zdbad.h ]
Adapted for pure Mach kernel.
[90/10/04            dbg]
[ ./kernel/sqtzdc/zdc.h ]
Adapted for pure Mach kernel.
[90/10/04            dbg]
[ ./kernel/sqtzdc/zdinit.c ]
Added volatile declarations.
Allowed interrupts on any CPU.
[91/03/25            dbg]

Adapted for pure Mach kernel.
[90/10/04            dbg]
[ ./kernel/src/config/config.y ]
'MACHINE sqt' defines machine as "SQT" but leaves machinename as
"i386".  We only support the Sequent SYMMETRY, which shares code
with the ATbus-based i386 configurations.
[91/03/21            dbg]
[ ./kernel/src/config/mkioconf.c ]
Fix sqt_ioconf to allow wildcards in sec devices and change
location of ioconf.h.
[91/03/21            dbg]
[ ./kernel/src/makeboot/Makefile ]
Created.
[90/10/01            dbg]
[ ./kernel/src/makeboot/build_boot.c ]
Created.
[91/02/26            dbg]
[ ./kernel/src/makeboot/loader_info.h ]
Version for build_boot.  Removed function declarations and format.
Added sym_offset, sym_size, str_size.
[90/11/20            dbg]
[ ./kernel/vax/asm.h ]
Convert for ANSI C.
[91/04/23            dbg]
[ ./kernel/vax/ast.h ]
Import mtpr and AST register definitions from mtpr.h.
[91/03/21            dbg]
[ ./kernel/vax/ast_check.c ]
Changed to new copyright.
[91/04/25            dbg]
[ ./kernel/vax/ast_types.h ]
Changed to new copyright.
[91/04/25            dbg]
[ ./kernel/vax/autoconf.c ]
Move br and cvec (Unibus probe variables) to memory.
[91/03/26            dbg]

Remove 'static' from csralloc (gcc fix).
Zero the Unibus allocation map.
[91/03/21            dbg]
[ ./kernel/vax/bi_node.h ]
Changed to new copyright.
[91/04/25            dbg]
[ ./kernel/vax/biconf.c ]
Include vax/machparam.h for SPL definitions.
[91/03/21            dbg]
[ ./kernel/vax/cca.h ]
Changed to new copyright.
[91/04/26  15:13:40  dbg]
[ ./kernel/vax/clock.c ]
Include vax/machparam.h for SPL definitions.
[91/03/21            dbg]
[ ./kernel/vax/conf.c ]
Changed to new copyright.
[91/04/25            dbg]
[ ./kernel/vax/cons.c ]
Fix CTRL macro for standard C.
Ensure that vax_maygetc always restores SPL.
[91/04/19            dbg]

Include vax/machparam.h for SPL definitions.
[91/03/21            dbg]
[ ./kernel/vax/cpmbx.h ]
Changed to new copyright.
[91/04/26  15:14:22  dbg]
[ ./kernel/vax/cpu_data.c ]
Changed to new copyright.
[91/04/25            dbg]
[ ./kernel/vax/cpu_data.h ]
Remove cast from SYSTYPE to use in assembler code.
[91/04/12            dbg]
[ ./kernel/vax/cpu_number.h ]
Added inline assembler definition for GCC.
[91/03/21            dbg]
[ ./kernel/vax/db_disasm.c ]
Re-fetch base register from operand specifier after finding
index register.
[91/04/25            dbg]
[ ./kernel/vax/db_interface.c ]
Pass regs structure directly to kdb_trap.
[91/03/21            dbg]
[ ./kernel/vax/db_machdep.h ]
Changed to new copyright.
[91/04/25            dbg]
[ ./kernel/vax/db_trace.c ]
Add stack_switching support.
[91/03/06            dbg]
[ ./kernel/vax/dfloat.s ]
Fix for ANSI C preprocessor.
[91/04/23            dbg]
[ ./kernel/vax/gcc_asm.h ]
Take this file seriously.
[91/03/26            dbg]
[ ./kernel/vax/genassym.c ]
Changes for kernel stack switching.
Undefine 'volatile'.
[91/03/21            dbg]
[ ./kernel/vax/ka6200.c ]
Include vax/machparam.h for SPL definitions.
[91/03/21            dbg]

Mangled for MACH_KERNEL.
[88/11/16            dbg]
[ ./kernel/vax/ka6200.h ]
Changed to new copyright.
[91/04/25            dbg]
[ ./kernel/vax/ka650.c ]
Add forward declarations (gcc fix).
[91/03/21            dbg]
[ ./kernel/vax/ka650.h ]
Changed to new copyright.
[91/04/26  15:16:17  dbg]
[ ./kernel/vax/ka820.c ]
Ignore BI-error machine checks while configuring system (they
may arise from BI bus resets).
[91/04/19            dbg]
[ ./kernel/vax/ka820.h ]
Changed to new copyright.
[91/04/26  15:16:49  dbg]
[ ./kernel/vax/ka8600.c ]
Fix inline assembler code for GNU C.
[91/04/25            dbg]
[ ./kernel/vax/lock.h ]
Created.
[91/03/21            dbg]
[ ./kernel/vax/locore.s ]
Include rpb, scb, ubvec, ubglue explicitly.
[91/04/23            dbg]

Move initialization code to vax_init.s.
[91/04/11            dbg]

Move br and cvec to memory.
[91/03/26            dbg]

Stack switching support.
[91/03/21            dbg]
[ ./kernel/vax/machparam.h ]
Add inline definitions for GCC.
[91/03/21            dbg]
[ ./kernel/vax/model_dep.c ]
Add memory and CPU configuration declarations that had
been in vax_init.c.  Call pmap_bootstrap here.
[91/04/11            dbg]

Add volatile declarations where needed.
[91/03/28            dbg]

Call pcb_module_init.
Include vax/machparam.h for SPL definitions.
[91/03/21            dbg]
[ ./kernel/vax/mscp.c ]
Make Chris Torek's mscp definitions (mscp_umd) standard.
Eliminate NET_UDA conditional.
[91/04/26            dbg]

Include vax/machparam.h for SPL definitions.
[91/03/21            dbg]
[ ./kernel/vax/mscp.h ]
Replaced with free version from Berkeley Tahoe release.
[91/04/26            dbg]
[ ./kernel/vax/mscpvar.h ]
Use new copyright.
[91/04/26            dbg]
[ ./kernel/vax/mtpr.h ]
Add inline assembler definitions for GCC.
[91/02/19            dbg]
[ ./kernel/vax/pcb.c ]
Support for stack switching.
[91/03/21            dbg]
[ ./kernel/vax/phys.s ]
Fix for ANSI C preprocessor.
[91/04/23            dbg]

Save and restore page table entries, rather than
using interrupt protection.
[89/07/09            mwyoung]
[ ./kernel/vax/pmap.c ]
Move page-table initialization code to vax_init.s (in
assembler).  GCC and PCC disagree on whether various C
constructs generate PC-relative addresses (physical) or absolute
addresses (virtual).
[91/04/11            dbg]

Add volatile declarations.
[91/03/28            dbg]

Fix pmap_map to not set bits in cpus_active.  Master_cpu is not
set yet.

Include vax/machparam.h for SPL definitions.
[91/03/21            dbg]
[ ./kernel/vax/pmap.h ]
Add volatile declarations.
[91/03/28            dbg]

Changes for discarding kernel stacks.  VAX hardware PCB is gone.
[91/03/21            dbg]
[ ./kernel/vax/scb.s ]
Adapt for ANSI C.
[91/04/23            dbg]
[ ./kernel/vax/setroot.c ]
Move root_name string out of text segment (for standard C).
[91/04/16            dbg]
[ ./kernel/vax/stubs.c ]
Added a real routine: strlen.
[91/03/26            dbg]
[ ./kernel/vax/thread.h ]
Support stack switching.
Add inline assembler definition for current_thread and
load_context.
[91/03/21            dbg]
[ ./kernel/vax/trap.c ]
Add stack switching support.
Add user_page_fault_continue.
[91/03/21            dbg]
[ ./kernel/vax/vax_init.s ]
Created.
[91/04/11            dbg]
[ ./kernel/vax/watch_chip.c ]
Include vax/machparam.h for SPL definitions.
[91/03/21            dbg]
[ ./kernel/vax/watch_chip.h ]
Added volatile declarations.
[91/03/28            dbg]
[ ./kernel/vaxif/if_de.c ]
Added volatile declarations.  Moved br and cvec to memory.
[91/03/26            dbg]

Include vax/machparam.h for SPL definitions.
[91/03/20            dbg]
[ ./kernel/vaxif/if_dereg.h ]
Added volatile declarations.
[91/03/26            dbg]
[ ./kernel/vaxif/if_ni.c ]
Added inline definitions for insqti, remqhi.
[91/03/27            dbg]

Include vax/machparam.h for SPL definitions.
[91/03/20            dbg]
[ ./kernel/vaxif/if_nireg.h ]
Added volatile declarations.
[91/03/27            dbg]
[ ./kernel/vaxif/if_qe.c ]
Add volatile declarations.  Moved br/cvec to memory.
[91/03/26            dbg]

Include vax/machparam.h for SPL definitions.
[91/03/20            dbg]
[ ./kernel/vaxif/if_qereg.h ]
Added volatile declarations.
[91/03/26            dbg]
[ ./kernel/vaxuba/dz.c ]
Move br and cvec to memory.
[91/03/26            dbg]
[ ./kernel/vaxuba/qd.c ]
Remove stale or lint-full code (mostly in #if !MACH)
[91/04/19            dbg]

Move br and cvec to memory.
[91/03/26            dbg]

Include vax/machparam.h for SPL definitions.
[91/03/20            dbg]
[ ./kernel/vaxuba/qdreg.h ]
Added volatile declarations.
[91/04/19            dbg]
[ ./kernel/vaxuba/qduser.h ]
Added volatile declarations.
[91/04/19            dbg]
[ ./kernel/vaxuba/qv.c ]
Move br and cvec to memory.
[91/03/26            dbg]

Include vax/machparam.h for SPL definitions.
[91/03/20            dbg]
[ ./kernel/vaxuba/qvreg.h ]
Added volatile declarations.
[91/04/19            dbg]
[ ./kernel/vaxuba/rk.c ]
Move br and cvec to memory.
[91/03/26            dbg]
[ ./kernel/vaxuba/uba.c ]
Include vax/machparam.h for SPL definitions.
[91/03/20            dbg]
[ ./kernel/vaxuba/ubareg.h ]
Added volatile declarations.
[91/03/26            dbg]
[ ./kernel/vaxuba/uda_umd.c ]
Use free MSCP definition from Berkeley Tahoe release.
[91/04/26            dbg]

Add volatile declarations.
[91/04/16            dbg]

Move br and cvec to memory.
[91/03/26            dbg]

Include vax/machparam.h for SPL definitions.
Use todr() function to get pseudo time-of-day register.
[91/03/20            dbg]
[ ./kernel/vaxuba/udareg_umd.h ]
Add volatile declarations.
[91/04/16            dbg]
[ ./kernel/vm/vm_object.c ]
Rearrange initialization code in vm_object_enter to clearly
separate 'internal' case (and to avoid a vax GCC bug).
[91/04/17            dbg]
[ ./user/Makeconf ]
Define MKREL to simplify paths.
[91/03/20            dbg]
[ ./user/threads/i386/csw.s ]
Unlock lock with a locked instruction (xchg).
[91/03/20            dbg]
[ ./user/threads/i386/cthread_inline.awk ]
Unlock lock with a locked instruction (xchg).
[91/03/20            dbg]
[ ./user/threads/i386/lock.s ]
Unlock lock with a locked instruction (xchg).
[91/03/20            dbg]
[ ./kernel/emul/vaxfloat.awk ]
Defunct
[ ./kernel/emul/vaxfloat.sa ]
Defunct
[ ./kernel/i386/i386_init.c ]
Defunct
[ ./kernel/i386/init.c ]
Defunct
[ ./kernel/vax/mscp_umd.h ]
Defunct
[ ./kernel/vax/vax_init.c ]
Defunct
[ ./Directories/ALL ]
Add Sequent directories.  Fix copyright.
[91/05/08            dbg]
[ ./Directories/sqt ]
Created.
[91/05/08            dbg]
[ ./kernel/device/net_io.c ]
Don't forget to copy the packet size when duplicating a packet
for multiple filters in net_filter().
[91/05/09            dpj]
    
    
    
==========================================================================
   ***** MK Version MK45  (af) *****
    
    

Mostly fixes and extensions for PMAX (scsi driver & co).
CMU&CMUCS Cleanup rerun.

New features:
--- --------

[PMAX]
SCSI driver much improved: does disconnect/reconnect, handles more device
types (tk50 and Exabyte tapes, CD-ROMS, many more disks including the HP 1Gb),
does automatic bad-block replacement, handles powering on/off devices
gracefully (3max only), watchdog to guard against bus lockups (hitachi),
many configuration options, extremely pipelined copy operations (esp
fast are WRITEs on 3max) and double-buffering which makes it much faster
than .. competitors :-)

Added new copy routine that speeds up aligned copy operations, used
by the SCSI driver and the pmap module.

Made modem control code optional, so that 3max can use serial lines without
contortions.

You can use the mouse with emacs with the console terminal emulator.


Bug fixes:
--- -----

[PMAX]
Fixed multibyte commands to the keyboard, and the mouse lazyness.

Fixed re-enabling of interrupts on exception returns to kernel.

Fixed dispatching of interrupts to only handle one interrupt at a time,
to make sure we do not handle the same interrupt twice or worse yet
reenter an interrupt handling routine.  Old code kept, disabled.

Organizational changes:
-------------- -------

Got rid once and forall of the "CMU" and "CMUCS" conditionals.

Special notes:
------- -----

Built for:

PMAX:	STD+ANY						check

I386:	STD+WS	(PC-compatible i386 boxes)		check
	STD+SQT+32	the Symmetry			check
	STD+NORMA+iPSC	the Intel Hypercube		check

VAX:	STD+VAX6bb					check
	STD+VAX6bb+gcc	(microvaxen)			check
	STD+16+fixpri+VAX6bb+BI+de+gcc (R2D2)		check

SUN3:	STD+SWS 					check


Tested on PMAX only, there where no major MI changes.

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
45
[ ./kernel/conf/MASTER ]
Rid of the "CMU" conditional once and forall.
[91/05/12  15:43:10  af]
[ ./kernel/conf/MASTER.local ]
Rid of the "CMU" conditional once and forall.
[91/05/12  15:43:59  af]
[ ./kernel/conf/MASTER.mips ]
Define explicitly how many scsi busses we config, which is
two for PMAX: the SII and the ASC.
[91/05/12  15:45:34  af]
[ ./kernel/conf/files.mips ]
Added bad-block replacent code for scsi driver.
[91/05/12  15:44:37  af]
[ ./kernel/device/blkio.c ]
Do not trim io_count to DEV_BSIZE, we know how to cope
and this is used for tapes also [which might be block
devices or not, depends].
[91/05/12  15:48:48  af]
[ ./kernel/device/device_types.h ]
Added D_READ_ONLY.
[91/05/12  15:47:28  af]
[ ./kernel/device/disk_status.h ]
Created, starting from Reno's disklabel.h (copyright included).
[91/05/03            af]
[ ./kernel/device/io_req.h ]
Added IO_INTERNAL, for use when an io_request packet is used
just for synchronization purposes.
[91/03/11            af]
[ ./kernel/device/tape_status.h ]
Modified tape_status structure to hold more info
either way.  Added flags field to hold special
behavioural properties such as rewind-on-close.
[91/05/12            af]
[ ./kernel/i386at/if_3c501.c ]
Made code under CMUCS standard.
[91/05/12  15:50:59  af]
[ ./kernel/i386at/if_ns8390.c ]
Made code under CMUCS standard.
[91/05/12  15:50:35  af]
[ ./kernel/i386at/if_pc586.c ]
Made code under CMUCS standard.
[91/05/12  15:50:10  af]
[ ./kernel/inline/inline.h ]
Made code under CMU standard.
[91/05/12  15:52:19  af]
[ ./kernel/inline/main.c ]
Made code under CMU standard.
[91/05/12  15:52:01  af]
[ ./kernel/mach/mips/asm.h ]
Added author note.
[91/05/12  15:55:29  af]
[ ./kernel/mach/mips/boolean.h ]
Added author note.
[91/05/12  15:55:14  af]
[ ./kernel/mach/mips/exception.h ]
Added author note.
[91/05/12  15:54:58  af]
[ ./kernel/mach/mips/mips_instruction.h ]
Added author note.
[91/05/12  15:54:42  af]
[ ./kernel/mach/mips/syscall_sw.h ]
Added author note.
[91/05/12  15:54:25  af]
[ ./kernel/mach/mips/thread_status.h ]
Added author note.
[91/05/12  15:54:03  af]
[ ./kernel/mips/PMAX/compat_30.h ]
Created.
[91/05/12  16:02:24  af]
[ ./kernel/mips/PMAX/dz_hdw.c ]
Made use of modem control code optional: patch dz_uses_modem_control
if you need it, or call dz_set_modem_control().
[91/05/12  16:06:26  af]
[ ./kernel/mips/PMAX/dz_tty.c ]
Added dz_input(), factoring some code out of dz_rint().
Now one can fake input easily, which I use for the
terminal emulator to generate escape sequence when
the mouse is clicked [non-X11 mode].
[91/04/09            af]
[ ./kernel/mips/PMAX/kn01.c ]
It turns out one has to wait for all writes to complete before
reading back from the SII scsi buffer.  Odd size transfers would
sometimes clobber the next-byte-up into 0xff, now we do it right.
[91/05/12  16:06:58  af]
[ ./kernel/mips/PMAX/lk201.c ]
Added proper spl() protection around multibyte commands.
[91/05/12  16:07:16  af]
[ ./kernel/mips/PMAX/mouse.c ]
Generate escape sequences for mouse cursor motion, same as
xterm.  Needs some more trim work.
[91/05/12  16:08:19  af]
[ ./kernel/mips/PMAX/rz.c ]
Use a longer timeout on opens (exabytes are so slooooow to
get ready).  If we are still rewinding the tape make open
fail.  Start watchdog on first open, for those adapters
that need it.  Ask for sense data when unit does not
come online quickly enough. On close, invoke anything
target-specific that needs to.
[91/05/12  16:04:29  af]
[ ./kernel/mips/PMAX/rz.h ]
Redefined naive macro names to avoid conflicts.
[91/05/12  16:08:55  af]
[ ./kernel/mips/PMAX/rz_disk.c ]
Revision 2.6.1.2  91/04/05  13:08:43  af
Fixed a type declaration, now an HBA with unlimited DMA
capability sez so by setting the max_dma_size to -1.

Revision 2.6.1.1  91/03/29  17:03:03  af
Use long forms of read/write commands on disks bigger than 1Gb,
which we automatically recognize from the read_capacity.
Allocate io_req_t records properly.
Check for transactions that aborted due to scsi bus resets.
Issue a request_sense on bad transactions, log soft errors
and only make fail bad errors.
[91/05/12  16:03:45  af]
[ ./kernel/mips/PMAX/rz_disk_bbr.c ]
Created.
[91/04/30            af]
[ ./kernel/mips/PMAX/rz_labels.h ]
Moved BSD/OSF1 stuff elsewhere, and the copyright that goes with
it.
[91/05/03            af]
[ ./kernel/mips/PMAX/scsi.c ]
Added flags to control use of disconnect-reconnect mode.
Added device-specific close routine (for tapes).
Wait for start_unit to complete properly and tell the user
what we are waiting for.
[91/05/12  16:21:16  af]
[ ./kernel/mips/PMAX/scsi2.h ]
Added read_defect_data.
[91/05/12  16:02:41  af]
[ ./kernel/mips/PMAX/scsi_53C94.h ]
Added asc_rfb register define, unused actually.
Use DMA for of nop for dma count loading.
Define macro to tell if command is a selection.
Move bus phase definitions in HBA-indep file.
[91/05/12  16:12:47  af]
[ ./kernel/mips/PMAX/scsi_53C94_hdw.c ]
Added support for dynamically powering on/off devices.
Added faster, extremely pipelined WRITEs.  And some more.

Added disconnect-reconnect capability.
Also: avoid thread_block()ing, cleaned up and compacted scripts,
added much more debugging support including nice traces and stats,
support disks larger than 1Gb, schedule scsi bus properly by
queueing up request from multiple targets in FIFO order,
do request_sense on bad status, uncovered some more misteries,
made the no_synchronous option work by negotiating a zero value
for the sync offset. Pretty close to a full rewrite.
[91/05/12  16:15:14  af]
[ ./kernel/mips/PMAX/scsi_7061.h ]
Moved bus phase defs in HBA-indep file.
[91/05/12  16:15:42  af]
[ ./kernel/mips/PMAX/scsi_7061_hdw.c ]
Removed restriction on max read/write xfers, with noticeable
performance benefits.
Handle odd-byte-boundary conditions, unified dma_out routine,
removed useless counters but kept a watchout on sii_wait,
Added functions to copy data more carefully between main
memory and the sii buffer, added back (sigh) sii_err_phase_mismatch
to cope with bogus no-init-to-prom problem [I know it just screws
the fifo, but how can I clean it ?].

Fixed one more race in sii_dosynch().

Added disconnect-reconnect capability.  Tapes work.
Also:  added watchdog() to cope with hitachi disk problems,
rid of thread_block()ing and do proper scsi bus allocation
among multiple targets in FIFO order, fixed the way we do
the synch negotiation, made no_synch option work for real,
added debug and tracing and stats, added understanding of
scsi bus resets, added support for >1Gb disks, rid of a
lot of crap in the generic error handler, guard fiercely
against re-entering the interrupt routine, watched many
incredible races happen, do command chaining in select phase
which saves an interrupt, generally try to do as much work
as possible on each interrupt to minimize their number,
get status properly and do request_sense if bad, 
checked we understand RZ56, WrenV, Hitachi, HP, TK50, Exabyte,
[91/05/12  16:17:47  af]
[ ./kernel/mips/PMAX/scsi_alldevs.c ]
Redone the request_sense command, split out function
that checks the sense data.
Rid of some embarassing crap use of identify messages.
Redone the scsi_error() routine.
[91/05/12  16:23:25  af]
[ ./kernel/mips/PMAX/scsi_defs.h ]
Made counters unsigned, added copy_count for use by HBAs
that do unlimited DMA via double buffering.  Made explicit
two padding bytes, and let them be HBA-specific (e.g. used
for odd-byte-boundary conditions on some).
Made max_dma_data unsigned, a value of -1 means unlimited.
Removed unsed residue field.

Defined tape-specific information fields to target structure.
Added tape-specific flags and flag for targets that require
the long form of various scsi commands.
Added disconnected-state information to target structure.
Added watchdog field to adapter structure.
[91/05/12  16:24:10  af]
[ ./kernel/mips/PMAX/scsi_disk.c ]
Enabled some group-1 commands needed on big disks.
Wrote all those that were missing, kept disabled until
we find a use for them (via ioctls, I am afraid).
[91/05/12  16:24:35  af]
[ ./kernel/mips/PMAX/scsi_rom.c ]
Removed unused code, added sccdrom_name().
[91/05/12  16:18:49  af]
[ ./kernel/mips/PMAX/scsi_worm.c ]
Added our name function.
[91/05/12  16:19:38  af]
[ ./kernel/mips/locore.s ]
On exception return make sure interrupts are enabled,
higher level code should only play with spls().
Added kdb_go, but does not fly yet.
[91/05/12  15:59:20  af]
[ ./kernel/mips/mips_copyin.s ]
Added aligned_block_copy
[91/05/12  16:00:40  af]
[ ./kernel/mips/mips_cpu.s ]
splsoftclock() and splnet() were swapped, oops.
Removed misleading unused spl aliases.
[91/05/12  15:58:50  af]
[ ./kernel/mips/mips_misc.c ]
Found why the dprintf hung on 3max&new proms: clock interrupts.
[91/05/12  16:00:12  af]
[ ./kernel/mips/pmap.c ]
Use the faster page copy routine.
Added a counter of in-use ptepages.
[91/05/12  15:58:13  af]
[ ./kernel/mips/trap.c ]
Removed optimization in interrupt() that would handle more
than one interrupt at a time.  See comments in interrupt()
for the reasons, and to decide wether you can still use this
optim or not, by default it is now disabled.
[91/05/12  15:57:19  af]
[ ./kernel/mon/sunromvec.h ]
Removed CMU conditionals.
[91/05/12  16:27:07  af]
[ ./kernel/sun3/interreg.h ]
Rid of the "CMU" conditional once and forall.
[91/05/12  16:29:19  af]
[ ./kernel/sun3/machparam.h ]
Removed conditionals for MACH_KERNEL only version.
Added ptob, btop.
[88/11/29            dbg]
[ ./kernel/sun3/reg.h ]
Removed CMU conditionals.
[91/05/12  16:29:38  af]
[ ./kernel/sun3/scb.s ]
Removed CMU conditionals.
[91/05/12  16:29:30  af]
[ ./kernel/sunif/ether_addr.h ]
Removed CMU conditionals.
[91/05/12  16:30:42  af]
[ ./kernel/sys/syslog.h ]
Removed CMU conditionals.
[91/05/12  16:31:12  af]
[ ./kernel/vax/cons.c ]
Removed CMU conditionals.
[91/05/12  16:32:23  af]
[ ./kernel/vax/inline/inline_machdep.c ]
Removed CMU conditionals.
[91/05/12  16:34:57  af]
[ ./kernel/vax/inline/libcpats.c ]
Removed CMU conditionals.
[91/05/12  16:35:40  af]
[ ./kernel/vax/inline/machpats.c ]
Removed CMU conditionals.
[91/05/12  16:35:55  af]
[ ./kernel/vax/nexus.h ]
Removed CMU conditionals.
[91/05/12  16:32:08  af]
[ ./kernel/vax/pte.h ]
Removed CMU conditionals.
[91/05/12  16:31:56  af]
[ ./kernel/vaxif/if_de.c ]
Rid of the "CMU" conditional once and forall.
[91/05/12  16:37:25  af]
[ ./kernel/vaxif/if_qe.c ]
Rid of the "CMU" conditional once and forall.
[91/05/12  16:36:55  af]
[ ./kernel/vaxif/if_qereg.h ]
Rid of the "CMU" conditional once and forall.
[91/05/12  16:37:10  af]
[ ./kernel/vaxmba/hpreg.h ]
Rid of the "CMU" conditional once and forall.
Fixed copyright notice.
[91/05/12  16:40:24  af]
[ ./kernel/vaxmba/mbareg.h ]
Rid of the "CMU" conditional once and forall.
Fixed copyright notice.
[91/05/12  16:39:22  af]
[ ./kernel/vaxuba/dzreg.h ]
Rid of the "CMU" conditional once and forall.
Fixed copyright notice.
[91/05/12  16:45:04  af]
[ ./kernel/vaxuba/pdma.h ]
Rid of the "CMU" conditional once and forall.
Fixed copyright notice.
[91/05/12  16:44:15  af]
[ ./kernel/vaxuba/qd.c ]
Rid of the "CMU" conditional once and forall.
[91/05/12  16:43:09  af]
[ ./kernel/vaxuba/rk.c ]
Rid of the "CMU" conditional once and forall.
[91/05/12  16:41:34  af]
[ ./kernel/vaxuba/rkreg.h ]
Rid of the "CMU" conditional once and forall.
Fixed copyright notice.
[91/05/12  16:42:54  af]
[ ./kernel/vaxuba/uda_umd.c ]
Rid of the "CMU" conditional once and forall.
[91/05/12  16:41:19  af]
[ ./kernel/mips/PMAX/screen.c ]
Generate escape seqs on mouse clicks if X not running.
[ ./kernel/mips/PMAX/scsi.h ]
Define bus phases here.  More defines for return data from
various commands that are now actually used.

Added def of max addressable block for short read/write.
Added missing sense key values (they were on the back of
the page, oops).  Added extended sense data defs.
Added mode sense defs.
[ ./kernel/mips/PMAX/rz_tape.c ]
Do not say we failed to bspfile when the target really was
only busy.
Retrieve from mode_sense speed, density and writeprotect info.
Deal with targets that are busy, note when we get confused due
to a scsi bus reset.  Set speed and density if user asks to.
Generally, made it work properly [it passes Rudy's tests].
Tapes really work now.
[ ./kernel/mips/PMAX/mapped_scsi.c ]
Check for spurious interrupts before disabling them.
[ ./kernel/mips/PMAX/scsi_tape.c ]
Cleaned up mode_select, vendor unique data can be passed
in if necessary.  Density and speed are taken from target 
structure.  Added rewind command and all th eothers that
were missing (but what we do not use is disabled).
    
    
    
==========================================================================
   ***** MK Version MK46  (mrt) *****
    
    
New features:
--- --------
none

Bug fixes:
--- -----

Corrected all the Mach free copyright messages to have "AS IS" and
Carnegie Mellon instead of just Carnegie.

[VAX]	 Put the restrictive copyrights back on the few files that
	erroneously gotton the free copyright.

Special notes:
------- -----

In the future, be very careful that you get the correct style of copyright
on to any files you add to the mk tree. For license-free c files you can use 
conf/copyright, or use /afs/cs/mach/src/copyright/{c,shell,roff}. If you pick
one up from there add a Mach Operating System line to the beginning.

If a file contains a restrictive BSD copyright or any restrictive manafacturer's
copyright, use the old Mach licensed one.

Built for all 8 configurations. Compared the .o files to be sure  nothing
had changed. 

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
 
All the files except the sqt, sun* and most vax* files changed.
    
    
    
==========================================================================
   ***** MK Version MK47  (rpd) *****
    
    
Bug fixes:
--- -----

I fixed a pageout deadlock which crept in with default_pager_object_create.
It turns out to be quite difficult to have the default pager handle
"external" objects in addition to "internal" objects.
Now the default pager is multi-threaded and separate threads handle
"internal" and "external" objects.  boot_ufs/ code picked up some locking.

I changed pagein to use fictitious pages for busy/absent pages.
Real pages get allocated when the pager calls data-provided or
data-unavailable.  To prevent the default pager from using all the pages,
pagein of "internal" objects still allocates real pages.
The association between physical pages and page structures changes
dynamically, so this won't hamper page "stealing" on the data-provided path.

I changed the pageout daemon pretty significantly, to remove some
deadlocks and to make it behave better under heavy paging loads.
Now vm_page_inactive_target is calculated dynamically and pages
trickle from the active list to the inactive list, instead of getting
dumped in big bursts.  The code also dynamically adjusts
vm_pageout_burst_wait, the amount of time it pauses per dirty page,
so it isn't as important that this number be tuned right.

I changed the pmap interface.  pmap_bootstrap, pmap_valid_page,
pmap_map, and pmap_update are out.  pmap_init changed.  pmap_startup,
pmap_steal_memory, and pmap_free_pages (or possibly pmap_virtual_space
and pmap_next_page instead of pmap_startup and pmap_steal_memory) are
in.  The pmap_startup/pmap_steal_memory system has two main advantages
over the old system.  First, machine-independent code doesn't assume
quasi-contiguous physical memory.  Second, machine-dependent code can
implement pmap_steal_memory to allocate memory more efficiently than
vanilla kernel VM (for example, using no/fewer TLB entries, not backed
by page structures).  The zone package gets 420K from
pmap_steal_memory.

I fixed a deadlock problem in kmem_alloc.  It can't hold a kernel map
locked while allocating memory.

I fixed vm_page_deactivate as suggested by rfr,
to clear the reference bit on inactive/referenced pages.

I changed the stack-privilege algorithm, which reserves kernel stacks
for important kernel threads like the idle threads, pageout deamon, etc.
The old method had a bug that could result in stack_alloc_try panics.

I fixed kernel stack allocation so that non-page-sized stacks work.
All current architectures use page-sized stacks by default.

I beefed-up the simple-lock debugging code.  Now it keeps track
of which locks are held and who took the locks.  check_simple_locks()
should be used in code which may block, to check that no simple locks
are held.

I changed the timeout/timer code to use a fixed-size array of timers
instead of a zone, because it allocates timers from interrupt handlers.
Only device drivers use this code.  I changed all machine-independent
uses of timers to use "private" timers.  In particular, priority depression
timeouts use another timer in the thread structure.  If possible, this
timer should be merged with the previous per-thread timer.
I didn't fix the long-standing races in the timeout code.

I fixed host_set_time to update the mapped time value.
I changed the mapped time value to include a check field,
so readers can get a consistent value without locking.

I picked up a processor_doaction fix from dlb.

I made some minor changes to the xpr code so that recorded xpr activity
can survive across a reboot and be examined.

I cleaned up the semantics of the syscall forms of kernel RPCs,
so that they better mimic the RPC forms.  If the syscall can't
handle request, it returns MACH_SEND_INTERRUPTED.  This is a
backwards compatible change, because current user stubs check
for any non-success return.  They should be changed to check
for send-interrupted specifically.  This will not be compatible
with older kernels, but it will fix a bug.  (For example,
the current ipc_test binaries in the release area report a problem
because they are linked with syscall forms that don't have quite
the right semantics.  The corresponding change in libmach for
the user stubs fixes ipc_test.)

[PMAX]	  I simplified the handling to tlb misses.
This made the user tlb-miss handler faster.  It fixed a bug;
now VM exceptions always have the correct address.

[PMAX]	  I removed spls in the pmap module.

[PMAX]	  I put a nop after splhigh so that it can be stepped through.

[SUN3]	  I converted the remaining uses of vm_map_find to vm_map_enter.

[SUN3]	  I removed a debugging panic in the user breakpoint path.

[SUN3]	  I fixed the fpa conditionals in genassym.


Special notes:
------- -----

Tested on rpd, waldo, rocky, nova, r2d2, boris.


[ ./conf/version.edit ]
47
[ ./kernel/boot_ufs/default_pager.c ]
Don't give privileges to threads handling external objects.
[91/04/06            rpd]
Enhanced to use multiple threads, for performance and to avoid
a deadlock caused by default_pager_object_create.
Added locking to partitions.
Added locking to pager_port_hashtable.
Changed pager_port_hash to something reasonable.
[91/04/03            rpd]
[ ./kernel/boot_ufs/file_io.c ]
Changed block_map to avoid blocking operations
while holding an exclusive lock.
[91/04/06            rpd]
Added locking in block_map.
[91/04/03            rpd]
[ ./kernel/boot_ufs/file_io.h ]
Added f_lock.
[91/04/03            rpd]
[ ./kernel/conf/MASTER.mips ]
Removed the COMPACTED (tag "mod_bits") option.
[91/03/19            rpd]
[ ./kernel/conf/MASTER.mips.local ]
Removed mod_bits.
[91/03/19            rpd]
[ ./kernel/conf/files.mips ]
Removed the compacted option.
[91/03/19            rpd]
[ ./kernel/ddb/db_trap.c ]
Protect against faults in db_print_loc_and_inst.
[91/05/14            rpd]
[ ./kernel/device/dev_lookup.c ]
Fixed device_deallocate to always unlock the reference count.
[91/04/03            rpd]
[ ./kernel/device/dev_pager.c ]
Added proper locking for vm_page_insert.
[91/04/21            rpd]
Changed vm_page_init.
[91/03/24            rpd]
[ ./kernel/device/ds_routines.c ]
Added vm/memory_object.h.
[91/03/22            rpd]
[ ./kernel/i386/phys.c ]
Added vm_page_fictitious_addr assertions.
[91/04/10            rpd]
[ ./kernel/i386/read_fault.c ]
Picked up software_reference_bits-related changes from vm_fault.
[91/04/06            rpd]
Added VM_FAULT_FICTITIOUS_SHORTAGE.
[91/03/29            rpd]
[ ./kernel/i386at/kd.c ]
Fixed kdopen to call ttychars with the tty unlocked.
[91/03/31            rpd]
[ ./kernel/i386at/model_dep.c ]
Changed pmap_bootstrap arguments.
Moved pmap_free_pages and pmap_next_page here.
[91/05/15            rpd]
[ ./kernel/i386ipsc/model_dep.c ]
Changed pmap_bootstrap arguments.
Moved pmap_free_pages and pmap_next_page here.
[91/05/15            rpd]
[ ./kernel/i860/phys.c ]
Added vm_page_fictitious_addr assertions.
[91/05/15            rpd]
[ ./kernel/i860ipsc/i860_init.c ]
Moved pmap_valid_page, pmap_free_pages, pmap_next_page here.
[91/05/17            rpd]

Changed pmap_bootstrap arguments.
[91/03/25            rpd]
[ ./kernel/intel/pmap.c ]
Moved pmap_free_pages, pmap_next_page to a model-dependent file.
[91/05/15            rpd]

Make sure hole_start and hole_end are page-aligned.
[91/05/01            rpd]

Removed pmap_update.
[91/04/12            rpd]

Added inuse_ptepages_count.
Added vm_page_fictitious_addr assertions.
[91/04/10            rpd]
Added check_simple_locks to pmap_expand.
[91/03/31            rpd]
Changed vm_page_init to vm_page_insert.
Added pmap_free_pages, pmap_next_page, pmap_virtual_space.
[91/03/25            rpd]
[ ./kernel/kern/bootstrap.c ]
Added argument to kernel_thread.
[91/04/03            rpd]
[ ./kernel/kern/ipc_kobject.c ]
Added check_simple_locks.
[91/04/01            rpd]
[ ./kernel/kern/ipc_sched.c ]
Updated thread_handoff to check stack_privilege.
[91/03/30            rpd]
[ ./kernel/kern/kalloc.h ]
Added kalloc_init.
[91/03/22            rpd]
[ ./kernel/kern/lock.c ]
Added simple_locks_info, to keep track of which locks are held.
[91/05/02            rpd]
Added check_simple_locks.
[91/03/31            rpd]
[ ./kernel/kern/lock.h ]
Added check_simple_locks.
[91/03/31            rpd]
[ ./kernel/kern/mach_clock.c ]
Fixed timeout/untimeout to use a fixed-size array of timers
instead of a zone.
[91/03/31            rpd]
Fixed host_set_time to update the mapped time value.
Changed the mapped time value to include a check field.
[91/03/19            rpd]
[ ./kernel/kern/machine.c ]
Picked up processor_doaction fix from dlb.
[91/04/08            rpd]
[ ./kernel/kern/sched_prim.c ]
Added check_simple_locks to thread_block and thread_run.
[91/05/02            rpd]
Changed recompute_priorities to use a private timer.
Changed thread_timeout_setup to initialize depress_timer.
[91/03/31            rpd]

Updated thread_invoke to check stack_privilege.
[91/03/30            rpd]
[ ./kernel/kern/sched_prim.h ]
Added recompute_priorities.
[91/03/31            rpd]
[ ./kernel/kern/server_loop.c ]
Made max_size an argument to the loop.
Changed from kmem_alloc_wired to kalloc.
[91/04/04            rpd]
[ ./kernel/kern/startup.c ]
Added argument to kernel_thread.
[91/04/03            rpd]
[ ./kernel/kern/syscall_emulation.c ]
Fixed eml_task_deallocate to always unlock.
[91/05/02            rpd]
[ ./kernel/kern/syscall_subr.c ]
Changed to use thread->depress_timer.
[91/03/31            rpd]
[ ./kernel/kern/syscall_subr.h ]
Added thread_depress_timeout.
[91/03/31            rpd]
[ ./kernel/kern/thread.c ]
Fixed stack_alloc to use kmem_alloc_aligned.
[91/05/14            rpd]
Added argument to kernel_thread.
[91/04/03            rpd]

Changed thread_deallocate to reset timer and depress_timer.
[91/03/31            rpd]

Replaced stack_free_reserved and swap_privilege with stack_privilege.
[91/03/30            rpd]
[ ./kernel/kern/thread.h ]
Added depress_timer.
[91/03/31            rpd]

Replaced swap_privilege with stack_privilege.
[91/03/30            rpd]
[ ./kernel/kern/xpr.c ]
Added xprenable and other minor changes so that the xpr buffer
may be examined after a spontaneous reboot.
[91/05/03            rpd]
Fixed the initialization check in xpr.
Fixed xpr_dump.
[91/04/02            rpd]
[ ./kernel/kern/zalloc.c ]
Added check_simple_locks.
Moved ADD_TO_ZONE, REMOVE_FROM_ZONE here.
Moved extraneous zone GC declarations here.
[91/03/31            rpd]

Minor cleanup in zget_space.
[91/03/28            rpd]
Changed to use zdata to initialize zalloc_next_space.
[91/03/22            rpd]
[ ./kernel/kern/zalloc.h ]
Removed ZALLOC, ZGET, ZFREE.
Moved ADD_TO_ZONE, REMOVE_FROM_ZONE to kern/zalloc.c.
Moved extraneous zone GC declarations to kern/zalloc.c.
[91/03/31            rpd]
Added zdata, zdata_size.
[91/03/22            rpd]
[ ./kernel/mach/memory_object.h ]
Removed memory_manager_default.
[91/03/22            rpd]
[ ./kernel/mach/time_value.h ]
Added mapped_time_value_t.
[91/03/21            rpd]
[ ./kernel/mips/PMAX/screen.c ]
Picked up mouse-movement bug fix for screen_motion_event from Sandro.
Also changed compress_mouse_events to TRUE.
[91/04/08            rpd]
[ ./kernel/mips/locore.s ]
Picked up Sandro's interrupt-enable fix for TRAP_exception_exit.
[91/04/04            rpd]
Removed tlb_umiss_cause.
[91/03/21            rpd]
[ ./kernel/mips/mips_cpu.s ]
Put a nop between splhigh and kdbsplhigh.
[91/03/26            rpd]
[ ./kernel/mips/mips_init.c ]
Removed zalloc_physical.
Removed arguments to pmap_bootstrap.
[91/03/22            rpd]
[ ./kernel/mips/parse_args.c ]
Replaced zalloc_physical with zdata_size.
[91/03/24            rpd]
[ ./kernel/mips/pcb.c ]
Replaced stack_free_reserved and swap_privilege with stack_privilege.
[91/03/30            rpd]
[ ./kernel/mips/pmap.c ]
Removed pmap_update.
[91/04/12            rpd]

Added inuse_ptepages_count.
Added vm_page_fictitious_addr assertions.
[91/04/10            rpd]
Commented out pmap_lock.
[91/04/01            rpd]

Added check_simple_locks to get_free_ptepage.
[91/03/31            rpd]
Removed pmap_valid_page, arguments to pmap_bootstrap, pmap_init.
Added pmap_free_pages, pmap_steal_memory, pmap_startup.
[91/03/24            rpd]
Removed spl/splx calls.
Made compacted modify bits the default.
Fixed return_modify_bit.
[91/03/19            rpd]
[ ./kernel/mips/pmap.h ]
Removed pmap_update.
[91/04/12            rpd]
Added MACHINE_PAGES.
[91/03/23            rpd]
[ ./kernel/mips/trap.c ]
Fixed double-miss handling in tlb_miss.  Now it maps an
invalid entry into the tlb instead of going to trap.
[91/04/04            rpd]
[ ./kernel/mips/vm_tuning.h ]
Removed VM_PAGEOUT_BURST_WAIT.
[91/04/07            rpd]
[ ./kernel/sqt/model_dep.c ]
Changed pmap_bootstrap arguments.
Moved pmap_free_pages and pmap_next_page here.
[91/05/15            rpd]
[ ./kernel/sun3/model_dep.c ]
Changed arguments to vm_page_create.
[91/05/16            rpd]
[ ./kernel/sun3/pmap.c ]
Replaced pmap_valid_page with pmap_free_pages, pmap_next_page,
and pmap_virtual_space.  Changed the arguments to pmap_init.
[91/05/15            rpd]

Removed pmap_update.
Added vm_page_fictitious_addr assertions.
[91/04/12            rpd]
[ ./kernel/sun3/sun_init.c ]
Added avail_remaining, avail_next, hole_start, hole_end.
[91/05/15            rpd]
[ ./kernel/sun3/trap.c ]
Removed debugging code in dotrace.
[91/04/08            rpd]
[ ./kernel/sunif/if_ie.c ]
Replaced vm_map_find with vm_map_enter.
[91/04/08            rpd]
[ ./kernel/vax/pmap.c ]
Replaced pmap_valid_page with pmap_free_pages, pmap_next_page,
and pmap_virtual_space.  Changed the arguments to pmap_init.
Removed ZALLOC, ZFREE.
[91/05/15            rpd]

Removed pmap_update.
[91/04/12            rpd]

Added vm_page_fictitious_addr assertions.
[91/04/10            rpd]
[ ./kernel/vm/memory_object.c ]
Fixed memory_object_lock_page to handle fictitious pages.
[91/04/06            rpd]
Changed memory_object_data_provided, etc,
to allow for fictitious pages.
[91/03/29            rpd]
Added vm/memory_object.h.
[91/03/22            rpd]
[ ./kernel/vm/memory_object.h ]
Created.
[91/03/22            rpd]
[ ./kernel/vm/pmap.h ]
Removed pmap_update.
[91/04/12            rpd]
Removed pmap_bootstrap, pmap_map, pmap_valid_page.
Added pmap_startup, pmap_steal_memory, pmap_free_pages,
pmap_virtual_space, pmap_next_page.
[91/03/22            rpd]
[ ./kernel/vm/vm_fault.c ]
Added proper locking for vm_page_insert.
[91/04/21            rpd]
Changed vm_fault_page to use fictitious pages.
Increased vm_object_absent_max to 50.
[91/03/29            rpd]
[ ./kernel/vm/vm_fault.h ]
Added VM_FAULT_FICTITIOUS_SHORTAGE.
[91/03/29            rpd]
[ ./kernel/vm/vm_init.c ]
Replaced vm_page_startup with vm_page_bootstrap.
[91/04/10            rpd]
[ ./kernel/vm/vm_kern.c ]
Added kmem_alloc_aligned.
[91/05/02            rpd]
Added VM_FAULT_FICTITIOUS_SHORTAGE.
Revised vm_map_find_entry to allow coalescing of entries.
Fixed deadlock problem in kmem_alloc.
[91/03/29            rpd]
Fixed kmem_init to not create a zero-size entry.
[91/03/25            rpd]
[ ./kernel/vm/vm_kern.h ]
Added kmem_alloc_aligned.
[91/05/02            rpd]
[ ./kernel/vm/vm_map.c ]
Restored mask argument to vm_map_find_entry.
[91/05/02            rpd]
Removed ZALLOC and ZFREE.
[91/03/31            rpd]

Revised vm_map_find_entry to allow coalescing of entries.
[91/03/28            rpd]
Removed map_data.  Moved kentry_data here.
[91/03/22            rpd]
[ ./kernel/vm/vm_map.h ]
Added kentry_data and friends, for vm_map_init.
[91/03/22            rpd]
[ ./kernel/vm/vm_object.c ]
Changed vm_object_deactivate_pages to call vm_page_deactivate
on inactivate pages, because that is no longer a no-op.
[91/04/20            rpd]

Fixed vm_object_pmap_protect, vm_object_pmap_remove,
vm_object_page_remove, vm_object_copy_call, vm_object_copy_delayed
to check for fictitious pages.
[91/04/10            rpd]
Fixed vm_object_terminate to allow for busy/absent pages.
[91/04/02            rpd]

Added VM_FAULT_FICTITIOUS_SHORTAGE.
[91/03/29            rpd]
Added vm/memory_object.h.
[91/03/22            rpd]
[ ./kernel/vm/vm_page.h ]
Removed vm_page_fictitious_zone.
[91/05/16            rpd]

Added vm_page_fictitious_addr.
Removed VM_PAGE_TO_PHYS.
[91/04/10            rpd]

Changed vm_page_free_wanted to unsigned int.
[91/04/05            rpd]
Added vm_page_grab_fictitious, etc.
[91/03/29            rpd]
Removed VM_PAGE_DEBUG and associated variables,
leaving a dummy VM_PAGE_CHECK definition.
Added vm_page_attach.
[91/03/22            rpd]
[ ./kernel/vm/vm_pageout.c ]
Fixed vm_pageout_continue to always call vm_pageout_scan.
Revamped vm_pageout_scan.  Now it recalculates vm_page_inactive_target,
gradually moves pages from the active list to the inactive list,
looks at vm_page_free_wanted, handles absent and fictitious pages,
and blocks with a continuation (vm_pageout_scan_continue), which
uses vm_page_laundry_count to adjust vm_pageout_burst_wait.
[91/04/06            rpd]

Changed vm_page_free_wanted to unsigned int.
[91/04/05            rpd]
Added vm_page_grab_fictitious.
[91/03/29            rpd]
Changed vm_page_init.
[91/03/24            rpd]
[ ./kernel/vm/vm_resident.c ]
Renamed vm_page_fictitious_zone to vm_page_zone.
[91/05/16            rpd]

Moved deactivate-behind code from vm_page_alloc to vm_page_insert.
[91/04/21            rpd]

Fixed vm_page_deactivate as suggested by rfr,
to clear the reference bit on inactive/referenced pages.
[91/04/20            rpd]

Added vm_page_fictitious_addr.
[91/04/10            rpd]

Restored vm_page_laundry_count.
[91/04/07            rpd]

Changed vm_page_release to use thread_wakeup_one.
[91/04/05            rpd]
Added vm_page_grab_fictitious, etc.
[91/03/29            rpd]
Added vm_page_bootstrap, pmap_startup, pmap_steal_memory.
[91/03/25            rpd]
[ ./kernel/sun3/genassym.c ]
Fixed fpa conditionals.
[91/05/20            rpd]
[ ./kernel/kern/ipc_mig.c ]
Cleaned up the semantics of the syscall forms of kernel RPCs.
[91/05/20            rpd]
[ ./kernel/sqt/model_dep.c ]
Fixed avail_remaining, avail_next initialization.
    
    
    
==========================================================================
   ***** MK Version MK48  (jsb) *****
    
    
New features:
--- --------

This merge mostly contains NORMA work, including
	Whizzy fast internode IPC,
	Rough cut at VM support for fast internode IPC, and
	Beginnings of internode task creation.

Added task_get_emulation_vector; previously, it was impossible to obtain
this information, making task migration impossible.
For symmetry, added task_set_emulation_vector.
Task_set_emulation is now a call to task_set_emulation_vector.

Added a gets function in kern/printf.c (derived from boot_gets).

Bug fixes:
--- -----

[i386]	  Defined SPLVM, SPLX as null (vs. splvm, splx) in uniprocessor case.

Organizational changes:
-------------- -------

Added MACH_CLTASK conditional.

Added a kernel/norma/ directory for norma-specific files. I'll be moving
more things into this directory in subsequent releases.

Added mach/mach_norma.defs, for NORMA specific kernel functions.

Added mach/norma_task.defs, for task creation upcalls.

[i386]	  Moved i386/read_fault.c to intel/read_fault.c so that i860
	  can use it as well.

[i386]	  Added spldcm to i386/spl.s.

Log messages:
--- --------

[ ./conf/version.edit ]
48
[ ./kernel/intel/read_fault.c ]
First checkin as intel/read_fault.c.
[ ./kernel/i386/read_fault.c ]
Moved to intel/read_fault.c.
[ ./kernel/i386ipsc/dcm.c ]
Defuncted.
[ ./Directories/ALL ]
Added ./kernel/norma.
[91/06/06  16:14:56  jsb]
[ ./Directories/MI ]
Added ./kernel/norma.
[91/06/06  16:15:11  jsb]
[ ./kernel/conf/MASTER ]
Added MACH_CLTASK, under NORMA.
[91/05/13  16:46:15  jsb]
[ ./kernel/conf/Makefile.template ]
Added rules for mach_norma.defs, norma_task.defs.
[91/05/13  16:47:34  jsb]
[ ./kernel/conf/files ]
More MACH_CLxxx files.
[91/06/06  16:16:55  jsb]
[ ./kernel/conf/files.i386 ]
Moved read_fault.c from i386 to intel.
Split i386ipsc/dcm.c into dcm_{input,output}.c.
[91/06/06  16:18:09  jsb]
[ ./kernel/ddb/db_command.c ]
NORMA support: prompt includes node number, e.g., db4>.
[91/05/25  10:47:35  jsb]
[ ./kernel/ddb/db_run.c ]
Removed redundant newlines and tabs.
Added delta to instruction count printf.
[91/05/25  10:55:01  jsb]
[ ./kernel/device/device_init.c ]
MACH_CLPORT: master_device_port initialization change.
[91/05/13  16:51:18  jsb]
[ ./kernel/i386/spl.s ]
Added spldcm for i386ipsc.
[91/05/13  16:53:38  jsb]
[ ./kernel/i386/trap.c ]
i386_read_fault is now intel_read_fault.
[91/05/13  16:56:39  jsb]
[ ./kernel/i386ipsc/asm_startup.h ]
Added support for Paul's new bootstrapper.
[91/05/13  16:58:04  jsb]
[ ./kernel/i386ipsc/autoconf.c ]
Added implementation and call to ask_root_device.
[91/05/13  16:59:05  jsb]
[ ./kernel/i386ipsc/dcm.h ]
First checkin.
[91/05/14  13:24:02  jsb]
[ ./kernel/i386ipsc/dcm_input.c ]
First checkin.
[91/05/14  13:27:06  jsb]
[ ./kernel/i386ipsc/dcm_output.c ]
First checkin.
[91/05/14  13:27:30  jsb]
[ ./kernel/i386ipsc/dcm_route.s ]
Support for new dcm code.
[91/05/13  17:01:17  jsb]
[ ./kernel/i386ipsc/if_cnp.c ]
Use cnppoll (instead of cnptimeout) to check for packets.
[91/05/13  17:06:14  jsb]
[ ./kernel/i386ipsc/led.c ]
Added led_idle, led_active.
[91/05/13  17:07:21  jsb]
[ ./kernel/i386ipsc/model_dep.c ]
Changes for new bootstrapper; see asm_startup.h.
[91/05/13  17:08:15  jsb]
[ ./kernel/i386ipsc/pic_ipsc.c ]
Hang cnppoll off of hardclock (since cnp doesn't get interrupts).
[91/05/13  17:09:57  jsb]
[ ./kernel/i386ipsc/sd.h ]
From Don Cameron: changed NDRIVES from 1 to 4.
[91/05/13  17:10:29  jsb]
[ ./kernel/intel/pmap.c ]
Defined SPLVM, SPLX as null (vs. splvm, splx) in uniprocessor case.
[91/05/13  17:12:34  jsb]
[ ./kernel/ipc/ipc_cldefs.h ]
Fixed copyright.
[91/05/24  13:16:39  jsb]

First checkin.
[91/05/14  13:28:14  jsb]
[ ./kernel/ipc/ipc_clinput.c ]
Fixed copyright.
[91/05/24  13:18:23  jsb]

First checkin.
[91/05/14  13:29:10  jsb]
[ ./kernel/ipc/ipc_clkobject.c ]
First checkin.
[91/05/24  13:10:00  jsb]
[ ./kernel/ipc/ipc_cloutput.c ]
Fixed copyright.
[91/05/24  13:19:37  jsb]

First checkin.
[91/05/14  13:30:09  jsb]
[ ./kernel/ipc/ipc_clpacket.h ]
Almost obsoleted...
[91/05/13  17:14:22  jsb]
[ ./kernel/ipc/ipc_clport.c ]
Added norma_get_special_port, norma_set_special_port.
[91/05/25  10:28:14  jsb]

Much code moved to other ipc_clxxx files.
[91/05/13  17:16:24  jsb]
[ ./kernel/ipc/ipc_clvm.c ]
First checkin.
[91/05/24  13:12:39  jsb]
[ ./kernel/ipc/ipc_init.c ]
Added call to ipc_clport_init.
[91/05/13  17:17:10  jsb]
[ ./kernel/ipc/ipc_kmsg.c ]
More MACH_CLPORT stuff. Cleanup will follow.
[91/06/06  16:00:08  jsb]
[ ./kernel/ipc/ipc_mqueue.c ]
Added call to ip_unlock after calling ipc_clport_send.
Added support for clport handoff.
[91/06/06  16:05:12  jsb]
[ ./kernel/ipc/mach_msg.c ]
A little more MACH_CLPORT support.
[91/05/13  17:22:08  jsb]
[ ./kernel/ipsc/dcmcom.c ]
Removed bogus include.
[91/05/14  11:31:41  jsb]

Total rewrite.
[91/05/13  17:27:30  jsb]
[ ./kernel/ipsc/dcmcom.h ]
Total rewrite.
[91/05/13  17:26:25  jsb]
[ ./kernel/ipsc/dev_forward_name.c ]
Add entries to compensate for ux's generation of names like sd0i
when it should be generating names like sd1a.
(This is a stopgap, not a real fix.)
[91/05/13  17:29:24  jsb]
[ ./kernel/ipsc/usm.c ]
Ignore this line.
[91/05/13  17:33:29  jsb]
[ ./kernel/kern/ast.c ]
Added AST_CLPORT.
[91/05/13  17:34:31  jsb]
[ ./kernel/kern/ast.h ]
Added AST_CLPORT.
[91/05/13  17:35:08  jsb]
[ ./kernel/kern/bootstrap.c ]
Allow slaves to act as masters (for now).
[91/05/13  17:36:17  jsb]
[ ./kernel/kern/ipc_host.c ]
Redid host port initialization under MACH_CLPORT.
[91/05/13  17:37:21  jsb]
[ ./kernel/kern/ipc_kobject.c ]
Added MACH_CLTASK support.
[91/05/14  09:05:48  jsb]
[ ./kernel/kern/ipc_mig.c ]
MACH_CLTASK: We still need mach_msg_rpc_from_kernel.
[91/05/14  09:13:45  jsb]
[ ./kernel/kern/ipc_tt.c ]
MACH_CLTASK support.
[91/05/14  09:17:09  jsb]
[ ./kernel/kern/printf.c ]
Added gets (derived from boot_gets).
[91/05/14  09:18:50  jsb]
[ ./kernel/kern/startup.c ]
Changed MACH_CLPORT specific startup.
[91/05/14  09:19:55  jsb]
[ ./kernel/kern/syscall_emulation.c ]
Added task_get_emulation_vector, task_set_emulation_vector.
Task_set_emulation is now a call to task_set_emulation_vector.
[91/05/24  18:30:16  jsb]
[ ./kernel/kern/syscall_emulation.h ]
Added emulation_vector_t for new get/set emulation vector calls.
[91/05/24  17:47:38  jsb]
[ ./kernel/kern/task.c ]
MACH_CLTASK: support for remote task_create.
[91/05/25  11:46:21  jsb]
[ ./kernel/mach/mach.defs ]
Added task_get_emulation_vector, task_set_emulation_vector.
[91/05/24  18:26:01  jsb]
[ ./kernel/mach/mach_norma.defs ]
First checkin.
[91/05/25  10:37:22  jsb]
[ ./kernel/mach/mach_types.defs ]
Added emulation_vector_t for new get/set emulation vector calls.
[91/05/24  17:45:33  jsb]
[ ./kernel/mach/mach_types.h ]
Added emulation_vector_t for new get/set emulation vector calls.
[91/05/24  17:46:31  jsb]
[ ./kernel/mach/norma_task.defs ]
First checkin.
[91/05/25  10:37:56  jsb]
[ ./kernel/norma/kern_task.c ]
First checkin.
[91/05/25  11:47:39  jsb]
[ ./kernel/vm/vm_map.c ]
MACH_CLPORT support (first cut):
Work with page lists instead of copy objects.
Make coalescing more useful.
[91/05/14  09:34:41  jsb]
[ ./kernel/vm/vm_resident.c ]
MACH_CLPORT: added vm_page_replace.
[91/05/14  09:40:19  jsb]
[ ./kernel/norma/clport_ether.c ]
First checkin.
[91/06/06  17:52:24  jsb]
[ ./kernel/norma/ipc_wait.c ]
First checkin.
[91/06/06  17:51:41  jsb]
    
    
    
==========================================================================
   ***** MK Version MK49  (jsb) *****
    
    
New features:
--- --------

First cut at NORMA vm support. Uses mythical xmm technology.

[I860]	  Merged in i860 code from March, when I MK43ified what Intel
	  had at the time. The next merge will have the most recent Intel
	  code, plus friendlier licensing language.

[I860]	  Wrote an (unoptimized) internode ipc driver for the i860,
	  based on Intel code for old internode ipc protocol.

Bug fixes:
--- -----

Updated ddb man page. Added documentation for continue/c, match, search,
and watchpoints. I've not actually explained what a watchpoint is;
maybe Rich can do that (since he added them in the first place).

[I860]	  Better trap handling code, adopted from Intel's NX OS.

[I860]	  Use new (delta-compatible) booting technology.

[I386]	  Use new (delta-compatible) booting technology.

Organizational changes:
-------------- -------

Renamed NORMA conditionals; for example, MACH_CLPORT becomes NORMA_IPC.
Better support for partial enabling of NORMA support; for example, one should
now be able to build with just NORMA_IPC.

Moved NORMA ipc support from ipc directory to norma directory.

[I860]	  Rearranged dev_forward_name.c table for non-integrated I/O nodes.

Special notes:
------- -----

Everything in this merge is either i860 dependent or hidden under NORMA
conditionals. I built and tested on i860 (dimitri), i386 (dimitri and ubik),
andmips (jsb).

The i860ipsc console driver is flaky. This will be fixed in the next merge,
when I pick up the newest Intel code.

Log messages:
--- --------

[ ./conf/version.edit ]
49
[ ./kernel/conf/MASTER ]
Rearranged and renamed NORMA options.
[91/06/17  09:54:37  jsb]
[ ./kernel/conf/Makefile.template ]
NORMA_VM: added rule for xmm_proxy.defs.
[91/06/17  13:49:10  jsb]
[ ./kernel/conf/files ]
Moved files from ipc to norma; added norma xmm files.
[91/06/17  13:51:16  jsb]
[ ./kernel/conf/files.i860 ]
Added fpe* files; moved read_fault.c to intel directory;
added new dcm support.
[91/06/17  09:56:47  jsb]
[ ./kernel/ddb/db_command.c ]
Renamed NORMA conditionals.
[91/06/17  09:57:51  jsb]
[ ./kernel/device/dev_pager.c ]
NORMA_VM: use xmm_vm_object_lookup, since we really need a vm_object_t;
use xmm_add_exception to mark device pagers as non-interposable.
[91/06/17  13:22:58  jsb]
[ ./kernel/device/device_init.c ]
Renamed NORMA conditionals.
[91/06/17  09:58:32  jsb]
[ ./kernel/device/ds_routines.c ]
Renamed NORMA conditionals.
[91/06/17  09:58:59  jsb]
[ ./kernel/i386ipsc/asm_startup.h ]
Enabled support for new boot protocol, and eliminated support for old.
[91/06/17  10:00:10  jsb]
[ ./kernel/i386ipsc/dcm_input.c ]
Changed include of renamed norma file. Changed call to vm_page_init
to match its redefinition (it lost two parameters). 
[91/06/17  10:06:40  jsb]
[ ./kernel/i386ipsc/dcm_output.c ]
Changed include of renamed norma file.
[91/06/17  10:07:18  jsb]
[ ./kernel/i386ipsc/model_dep.c ]
Changed intialization printf.
[91/06/17  10:08:20  jsb]
[ ./kernel/i860/db_disasm.c ]
Fixed call to db_find_sym_and_offset.
[91/06/17  10:22:41  jsb]
[ ./kernel/i860/db_interface.c ]
An attempts to follow recent i386 changes.
[91/06/17  10:24:55  jsb]
[ ./kernel/i860/db_machdep.h ]
Added inst_load, inst_store definitions.
[91/06/17  10:25:34  jsb]
[ ./kernel/i860/exec.c ]
First functional version.
[91/06/17  10:27:30  jsb]
[ ./kernel/i860/exec.h ]
First checkin.
[91/06/17  10:31:12  jsb]
[ ./kernel/i860/fpdefs.h ]
From Paul Pierce: created from iPSC/860 NX code.
[91/06/17  13:43:28  jsb]
[ ./kernel/i860/fpeh.c ]
From Paul Pierce: created from iPSC/860 NX code.
[91/06/17  13:42:50  jsb]
[ ./kernel/i860/fpehutila.s ]
From Paul Pierce: created from iPSC/860 NX code.
[91/06/17  13:41:58  jsb]
[ ./kernel/i860/fpehutils.c ]
From Paul Pierce: created from iPSC/860 NX code.
[91/06/17  13:40:37  jsb]
[ ./kernel/i860/hardclock.c ]
Use machine/thread.h instead of machine/reg.h.
[91/06/17  10:12:13  jsb]
[ ./kernel/i860/pcb.c ]
Added stack_attach, stack_detach, etc. for continuation support.
[91/06/17  10:13:46  jsb]
[ ./kernel/i860/psl.h ]
Corrected USERMODE definition; eliminated ptrace garbage.
[91/06/17  10:14:34  jsb]
[ ./kernel/i860/start.s ]
Use r26 in place of r20.
[91/06/17  10:15:36  jsb]
[ ./kernel/i860/state.h ]
First checkin.
[91/06/17  10:16:53  jsb]
[ ./kernel/i860/thread.h ]
From Paul Pierce: modified for new trap handler.
[91/06/17  13:38:29  jsb]
[ ./kernel/i860/trap.c ]
From Paul Pierce: replaced with new version created from i386.
[91/06/17  13:37:26  jsb]
[ ./kernel/i860/trap.h ]
Cleaned up.
[91/06/17  10:21:15  jsb]
[ ./kernel/i860/ttrap.s ]
From prp: replaced entirely.
[91/06/17  13:35:50  jsb]
[ ./kernel/i860/user.s ]
Changes to copyin, copyout. Also added copy{in,out}msg aliases.
[91/06/17  10:30:42  jsb]
[ ./kernel/i860ipsc/autoconf.c ]
Changed to match i386ipsc autoconf.c.
[91/06/17  10:35:07  jsb]
[ ./kernel/i860ipsc/dcm_input.c ]
Removed bogus bcopy definition.
[91/06/17  15:28:56  jsb]

Updated for newer, faster internode IPC implementation.
[91/06/17  10:41:40  jsb]
[ ./kernel/i860ipsc/dcm_output.c ]
Updated for newer, faster internode IPC implementation.
[91/06/17  10:41:59  jsb]
[ ./kernel/i860ipsc/i860_init.c ]
From Paul Pierce: support for new boot protocol.
[91/06/17  13:33:44  jsb]
[ ./kernel/i860ipsc/intr.c ]
From Paul Pierce: replaced old dcm intr callouts with new.
[91/06/17  13:29:23  jsb]
[ ./kernel/i860ipsc/led.c ]
Added led_idle, led_active definitions.
[91/06/17  10:39:38  jsb]
[ ./kernel/intel/pmap.c ]
Fixed reference to XEOD_OFF_PH for i860ipsc dcm module.
[91/06/17  10:43:40  jsb]
[ ./kernel/ipc/ipc_init.c ]
Renamed NORMA conditionals.
[91/06/17  10:45:48  jsb]
[ ./kernel/ipc/ipc_kmsg.c ]
Renamed NORMA conditionals.
[91/06/17  10:45:05  jsb]
[ ./kernel/ipc/ipc_kmsg.h ]
Renamed NORMA conditionals.
[91/06/17  10:46:12  jsb]
[ ./kernel/ipc/ipc_mqueue.c ]
Renamed NORMA conditionals.
[91/06/17  10:44:39  jsb]
[ ./kernel/ipc/ipc_port.c ]
Renamed NORMA conditionals.
[91/06/17  10:44:21  jsb]
[ ./kernel/ipc/ipc_port.h ]
Renamed NORMA conditionals.
[91/06/17  10:44:06  jsb]
[ ./kernel/ipc/ipc_space.h ]
Renamed NORMA conditionals.
[91/06/17  10:45:36  jsb]
[ ./kernel/ipc/mach_msg.c ]
Renamed NORMA conditionals.
[91/06/17  10:46:35  jsb]
[ ./kernel/ipsc/dcmcom.c ]
Renamed NORMA conditionals. Updated i860 dcm_init().
[91/06/17  10:47:15  jsb]
[ ./kernel/ipsc/dev_forward_name.c ]
Renamed NORMA conditionals. Modified for non-integrated I/O nodes.
[91/06/17  13:48:13  jsb]
[ ./kernel/ipsc/node.c ]
Renamed NORMA conditionals. Redefined master node.
[91/06/17  10:48:32  jsb]
[ ./kernel/kern/ast.c ]
Renamed NORMA conditionals.
[91/06/17  10:48:46  jsb]
[ ./kernel/kern/bootstrap.c ]
Renamed NORMA conditionals.
[91/06/17  10:49:04  jsb]
[ ./kernel/kern/debug.c ]
Renamed NORMA conditionals.
[91/06/17  10:49:18  jsb]
[ ./kernel/kern/ipc_host.c ]
Renamed NORMA conditionals.
[91/06/17  10:49:34  jsb]
[ ./kernel/kern/ipc_kobject.c ]
Renamed NORMA conditionals. Added NORMA_VM support.
[91/06/17  13:46:55  jsb]
[ ./kernel/kern/ipc_mig.c ]
Renamed NORMA conditionals.
[91/06/17  10:50:07  jsb]
[ ./kernel/kern/ipc_tt.c ]
Renamed NORMA conditionals. Moved norma code to norma/kern_task.c.
[91/06/17  10:50:57  jsb]
[ ./kernel/kern/startup.c ]
Renamed NORMA conditionals.
[91/06/17  10:51:38  jsb]
[ ./kernel/kern/task.c ]
Added norma_task hooks. See norma/kern_task.c for code.
[91/06/17  10:53:30  jsb]
[ ./kernel/mach/memory_object.defs ]
If KERNEL and NORMA_VM, then use a userprefix (to allow interposition).
[91/06/17  10:55:06  jsb]
[ ./kernel/man/ddb.man ]
Added documentation for continue/c, match, search, and watchpoints.
I've not actually explained what a watchpoint is; maybe Rich can
do that (hint, hint).
[91/06/17  10:58:08  jsb]
[ ./kernel/norma/clport_ether.c ]
Use a less bogus conditional to enable code.
[91/06/17  10:59:36  jsb]
[ ./kernel/norma/ipc_defs.h ]
Moved here from ipc/ipc_cldefs.h.
[91/06/17  11:04:33  jsb]
[ ./kernel/norma/ipc_input.c ]
Moved here from ipc/ipc_clinput.c.
[91/06/17  11:02:28  jsb]
[ ./kernel/norma/ipc_kserver.c ]
Moved here from ipc/ipc_clkobject.c.
[91/06/17  11:05:35  jsb]
[ ./kernel/norma/ipc_output.c ]
Moved here from ipc/ipc_cloutput.c.
[91/06/17  11:06:38  jsb]
[ ./kernel/norma/ipc_packet.h ]
Moved here from ipc/ipc_clpacket.h.
[91/06/17  11:07:00  jsb]
[ ./kernel/norma/ipc_port.h ]
Moved here from ipc/ipc_clport.h.
[91/06/17  11:08:34  jsb]
[ ./kernel/norma/ipc_vm.c ]
Moved here from ipc/ipc_clvm.c.
[91/06/17  11:07:45  jsb]
[ ./kernel/norma/ipc_wait.c ]
Changed norma include.
[91/06/17  11:01:02  jsb]
[ ./kernel/norma/ipc_xxx.c ]
Moved here from ipc/ipc_clport.c.
[91/06/17  11:07:25  jsb]
[ ./kernel/norma/kern_task.c ]
Moved routines here from kern/ipc_tt.c and kern/task.c.
[91/06/17  11:01:51  jsb]
[ ./kernel/norma/xmm.c ]
First checkin.
[91/06/17  10:58:38  jsb]
[ ./kernel/norma/xmm_debug.c ]
First checkin.
[91/06/17  11:05:55  jsb]
[ ./kernel/norma/xmm_export.c ]
First checkin.
[91/06/17  11:06:11  jsb]
[ ./kernel/norma/xmm_import.c ]
First checkin.
[91/06/17  11:03:28  jsb]
[ ./kernel/norma/xmm_interpose.c ]
First checkin.
[91/06/17  11:08:05  jsb]
[ ./kernel/norma/xmm_invalid.c ]
First checkin.
[91/06/17  11:03:08  jsb]
[ ./kernel/norma/xmm_obj.h ]
First checkin.
[91/06/17  11:03:46  jsb]
[ ./kernel/norma/xmm_proxy.defs ]
First checkin.
[91/06/17  13:45:41  jsb]
[ ./kernel/norma/xmm_server.c ]
First checkin.
[91/06/17  11:05:10  jsb]
[ ./kernel/norma/xmm_server_rename.h ]
First checkin.
[91/06/17  11:09:08  jsb]
[ ./kernel/norma/xmm_split.c ]
First checkin.
[91/06/17  11:04:50  jsb]
[ ./kernel/norma/xmm_svm.c ]
First checkin.
[91/06/17  11:04:03  jsb]
[ ./kernel/norma/xmm_user.c ]
Renamed xmm_vm_object_lookup.
[91/06/17  13:20:06  jsb]

First checkin.
[91/06/17  11:02:47  jsb]
[ ./kernel/norma/xmm_user_rename.h ]
First checkin.
[91/06/17  11:08:51  jsb]
[ ./kernel/vm/memory_object.c ]
NORMA_VM: include xmm_server_rename.h, for interposition.
[91/06/17  11:09:52  jsb]
[ ./kernel/vm/vm_map.c ]
Renamed NORMA conditionals.
[91/06/17  11:11:13  jsb]
[ ./kernel/vm/vm_object.c ]
Added NORMA_VM support.
[91/06/17  15:28:16  jsb]
[ ./kernel/vm/vm_pageout.c ]
NORMA_VM: declare definitions for memory_object_data_{initialize,write}
since they won't be provided by interposed-on memory_object_user.h.
[91/06/17  11:13:22  jsb]
[ ./kernel/vm/vm_resident.c ]
Renamed NORMA conditionals. Fixed vm_page_rename implementation.
[91/06/17  11:25:16  jsb]
[ ./kernel/ipc/ipc_cldefs.h ]
Moved to norma/ipc_defs.h.
[ ./kernel/ipc/ipc_clinput.c ]
Moved to norma/ipc_input.c.
[ ./kernel/ipc/ipc_clkobject.c ]
Moved to norma/ipc_kserver.c.
[ ./kernel/ipc/ipc_cloutput.c ]
Moved to norma/ipc_output.c.
[ ./kernel/ipc/ipc_clpacket.h ]
Moved to norma/ipc_packet.h.
[ ./kernel/ipc/ipc_clport.c ]
Moved to norma/ipc_xxx.c.
[ ./kernel/ipc/ipc_clport.h ]
Moved to norma/ipc_clport.h.
[ ./kernel/ipc/ipc_clvm.c ]
Moved to norma/ipc_vm.c.
[ ./kernel/i860ipsc/dcm.c ]
Replaced by dcm_input.c and dcm_output.c.
    
    
    
==========================================================================
   ***** MK Version MK50  (jsb) *****
    
    
New copyright from Intel: i860, i860ipsc, i386ipsc, and ipsc directories
now contain freely distributable files. Unfortunately, the i386ipsc ethernet
driver is still encumbered, so I've stuffed it into its own directory,
i386ipsc/cnp.

Also picked up recent i860 fixes from Intel.

Bug fixes:
--- -----

[I860]	  Many.

Organizational changes:
-------------- -------

[I386]	  Moved i386ipsc/if_cnp.[ch] to i386ipsc/cnp/if_cnp.[ch].

Tested On:
------ --

[I386]	  dimitri (i386ipsc), ubik.

[I860]	  dimitri.

[PMAX]	  jsb.

Log Messages:
--- --------

[ ./conf/version.edit ]
50
[ ./kernel/conf/Makefile.template ]
Moved mach/proxy.defs to norma/xmm_proxy.defs.
[91/06/18  18:46:36  jsb]
[ ./kernel/conf/files.i386 ]
Moved i386ipsc/if_cnp.c into cnp subdirectory for licensing reasons.
[91/06/18  20:21:15  jsb]
[ ./kernel/conf/files.i860 ]
For now, use i860ipsc/usm.c instead of ipsc/usm.c.
[91/06/18  18:47:06  jsb]
[ ./kernel/device/dev_pager.c ]
Removed extra include of norma_vm.h.
[91/06/18  18:47:29  jsb]
[ ./kernel/i386ipsc/asm_startup.h ]
New copyright from Intel.
[91/06/18  20:05:19  jsb]
[ ./kernel/i386ipsc/autoconf.c ]
New copyright from Intel.
[91/06/18  20:05:31  jsb]
[ ./kernel/i386ipsc/bia.h ]
New copyright from Intel.
[91/06/18  20:05:41  jsb]
[ ./kernel/i386ipsc/cnp/if_cnp.c ]
Corrected include of if_cnp.h to reflect new i386ipsc/cnp directory.
[91/06/18  19:49:46  jsb]

Moved here from i386ipsc for licensing reasons.
[91/06/18  19:44:34  jsb]
[ ./kernel/i386ipsc/cnp/if_cnp.h ]
Moved here from i386ipsc for licensing reasons.
[91/06/18  19:45:04  jsb]
[ ./kernel/i386ipsc/conf.c ]
New copyright from Intel.
[91/06/18  20:05:51  jsb]
[ ./kernel/i386ipsc/dcm.h ]
New copyright from Intel.
[91/06/18  20:06:00  jsb]
[ ./kernel/i386ipsc/dcm_input.c ]
New copyright from Intel.
[91/06/18  20:06:09  jsb]
[ ./kernel/i386ipsc/dcm_output.c ]
New copyright from Intel.
[91/06/18  20:06:21  jsb]
[ ./kernel/i386ipsc/dcm_route.s ]
New copyright from Intel.
[91/06/18  20:06:30  jsb]
[ ./kernel/i386ipsc/iopl.c ]
New copyright from Intel.
[91/06/18  20:06:41  jsb]
[ ./kernel/i386ipsc/led.c ]
New copyright from Intel.
[91/06/18  20:06:51  jsb]
[ ./kernel/i386ipsc/model_dep.c ]
New copyright from Intel.
[91/06/18  20:07:00  jsb]
[ ./kernel/i386ipsc/pic_ipsc.c ]
New copyright from Intel.
[91/06/18  20:07:09  jsb]
[ ./kernel/i386ipsc/port.h ]
New copyright from Intel.
[91/06/18  20:07:23  jsb]
[ ./kernel/i386ipsc/scsi.h ]
New copyright from Intel.
[91/06/18  20:07:32  jsb]
[ ./kernel/i386ipsc/sd.c ]
New copyright from Intel.
[91/06/18  20:07:42  jsb]
[ ./kernel/i386ipsc/sd.h ]
New copyright from Intel.
[91/06/18  20:07:53  jsb]
[ ./kernel/i386ipsc/sdintr.c ]
New copyright from Intel.
[91/06/18  20:08:01  jsb]
[ ./kernel/i860/_setjmp.s ]
New code and copyright from Intel.
[91/06/18  18:48:26  jsb]
[ ./kernel/i860/ast.h ]
New copyright from Intel.
[91/06/18  18:48:39  jsb]
[ ./kernel/i860/bcopy.s ]
New code and copyright from Intel.
[91/06/18  18:49:00  jsb]
[ ./kernel/i860/cswitch.c ]
New copyright from Intel.
[91/06/18  18:49:12  jsb]
[ ./kernel/i860/db_disasm.c ]
New code and copyright from Intel.
[91/06/18  18:49:32  jsb]
[ ./kernel/i860/db_interface.c ]
New code and copyright from Intel.
[91/06/18  18:50:15  jsb]
[ ./kernel/i860/db_machdep.h ]
New copyright, and support for single stepping, from Intel.
[91/06/18  18:50:45  jsb]
[ ./kernel/i860/db_trace.c ]
New code and copyright from Intel.
[91/06/18  18:50:59  jsb]
[ ./kernel/i860/exec.c ]
New copyright from Intel. Corrected setting of regs.sp.
Printfs ifdef'd out.
[91/06/18  18:52:42  jsb]
[ ./kernel/i860/exec.h ]
New copyright from Intel.
[91/06/18  18:52:53  jsb]
[ ./kernel/i860/fpdefs.h ]
New copyright from Intel.
[91/06/18  18:53:12  jsb]
[ ./kernel/i860/fpeh.c ]
New code and copyright from Intel.
[91/06/18  18:53:32  jsb]
[ ./kernel/i860/fpehutila.s ]
New code and copyright from Intel.
[91/06/18  18:53:50  jsb]
[ ./kernel/i860/fpehutils.c ]
New code and copyright from Intel.
[91/06/18  18:54:12  jsb]
[ ./kernel/i860/genassym.c ]
New copyright from Intel.
[91/06/18  18:54:28  jsb]
[ ./kernel/i860/hardclock.c ]
New code and copyright from Intel.
[91/06/18  18:54:42  jsb]
[ ./kernel/i860/init.c ]
New copyright from Intel.
[91/06/18  18:55:41  jsb]
[ ./kernel/i860/ipl.h ]
New copyright from Intel.
[91/06/18  18:56:14  jsb]
[ ./kernel/i860/loose_ends.c ]
New copyright from Intel.
[91/06/18  18:56:25  jsb]
[ ./kernel/i860/mach_param.h ]
New copyright from Intel.
[91/06/18  18:56:40  jsb]
[ ./kernel/i860/machparam.h ]
New copyright from Intel.
[91/06/18  18:56:52  jsb]
[ ./kernel/i860/ntoh.s ]
New copyright from Intel.
[91/06/18  18:57:02  jsb]
[ ./kernel/i860/pcb.c ]
New copyright from Intel.
[91/06/18  18:57:14  jsb]
[ ./kernel/i860/phys.c ]
New copyright from Intel.
[91/06/18  18:57:26  jsb]
[ ./kernel/i860/pmap.h ]
New copyright from Intel.
[91/06/18  18:57:35  jsb]
[ ./kernel/i860/psl.h ]
New copyright from Intel.
[91/06/18  18:57:44  jsb]
[ ./kernel/i860/reg.h ]
New copyright from Intel. Fixed i860REGCOUNT definition.
[91/06/18  18:58:15  jsb]
[ ./kernel/i860/setjmp.h ]
New copyright from Intel.
[91/06/18  18:58:28  jsb]
[ ./kernel/i860/start.s ]
New code and copyright from Intel.
[91/06/18  18:58:42  jsb]
[ ./kernel/i860/state.h ]
New copyright from Intel.
[91/06/18  18:58:53  jsb]
[ ./kernel/i860/swapgeneric.c ]
New copyright from Intel.
[91/06/18  18:59:02  jsb]
[ ./kernel/i860/thread.h ]
New copyright from Intel.
[91/06/18  18:59:12  jsb]
[ ./kernel/i860/time_stamp.h ]
New copyright from Intel.
[91/06/18  18:59:22  jsb]
[ ./kernel/i860/trap.c ]
New copyright from Intel.
[91/06/18  18:59:43  jsb]
[ ./kernel/i860/trap.h ]
New copyright from Intel.
[91/06/18  18:59:54  jsb]
[ ./kernel/i860/ttrap.s ]
New copyright from Intel.
[91/06/18  19:00:11  jsb]
[ ./kernel/i860/user.s ]
New copyright from Intel.
[91/06/18  19:00:26  jsb]
[ ./kernel/i860/vm_tuning.h ]
New copyright from Intel.
[91/06/18  19:00:35  jsb]
[ ./kernel/i860/xpr.h ]
New copyright from Intel.
[91/06/18  19:00:44  jsb]
[ ./kernel/i860ipsc/autoconf.c ]
New copyright from Intel.
[91/06/18  19:00:55  jsb]
[ ./kernel/i860ipsc/conf.c ]
New copyright from Intel.
[91/06/18  19:01:05  jsb]
[ ./kernel/i860ipsc/ctlreg.h ]
New copyright from Intel.
[91/06/18  19:01:18  jsb]
[ ./kernel/i860ipsc/dcm_input.c ]
New copyright from Intel.
[91/06/18  19:01:38  jsb]

From Paul Pierce: first implementation of this module.
[91/01/07  10:49:00  jsb]
[ ./kernel/i860ipsc/dcm_output.c ]
New copyright from Intel.
[91/06/18  19:01:51  jsb]

From Paul Pierce: first implementation of this module.
[91/01/07  10:49:00  jsb]
[ ./kernel/i860ipsc/i860_init.c ]
New code and copyright from Intel.
[91/06/18  19:02:12  jsb]
[ ./kernel/i860ipsc/intr.c ]
New code and copyright from Intel.
[91/06/18  19:02:30  jsb]
[ ./kernel/i860ipsc/led.c ]
New code and copyright from Intel.
[91/06/18  19:02:45  jsb]
[ ./kernel/i860ipsc/nodehw.h ]
New copyright from Intel.
[91/06/18  19:02:57  jsb]
[ ./kernel/i860ipsc/spl.c ]
New code and copyright from Intel.
[91/06/18  19:03:22  jsb]
[ ./kernel/i860ipsc/spl.h ]
First checkin.
[91/06/18  19:04:29  jsb]
[ ./kernel/i860ipsc/usm.c ]
First checkin. Just a hack until ipsc/usm.c gets merged again.
[91/06/18  19:04:14  jsb]
[ ./kernel/ipsc/dcmcom.c ]
New copyright from Intel.
[91/06/18  19:04:41  jsb]
[ ./kernel/ipsc/dcmcom.h ]
New copyright from Intel.
[91/06/18  19:04:53  jsb]
[ ./kernel/ipsc/dev_forward_name.c ]
New copyright from Intel.
[91/06/18  19:05:03  jsb]
[ ./kernel/ipsc/node.c ]
New copyright from Intel.
[91/06/18  19:05:13  jsb]
[ ./kernel/ipsc/rtc.c ]
New copyright from Intel.
[91/06/18  19:05:32  jsb]
[ ./kernel/ipsc/usm.c ]
New copyright from Intel.
[91/06/18  19:05:52  jsb]
[ ./kernel/ipsc/usm.h ]
New copyright from Intel.
[91/06/18  19:06:07  jsb]
[ ./kernel/norma/xmm_obj.h ]
Removed bogus include.
[91/06/18  19:06:29  jsb]
[ ./kernel/sys/varargs.h ]
Moved i860 varargs code here from i860/i860_varargs.h, thanks to
new copyright from Intel.
[91/06/18  19:15:02  jsb]
    
    
    
==========================================================================
   ***** MK Version MK51  (rvb) *****
    
    
New features:
--- --------

[VAX]	We now support the VAXSTATION 3100.  This is a Vax processor
	with PMAX peripherals


Bug fixes:
--- -----

[SUN3]	  
[VAX]	  Now build again.  And I build a STD+BI+16 and discovered that
	  it could never have been built; it now can.



Organizational changes:
-------------- -------

Two big ones:

  1. Since the pmax and vaxstation 3100 now share the same devices and since
	we believe that in the future that machines will be made of off the
	shelf chips, we pulled out almost all of the files in mips/PMAX
	and moved them to either the scsi/ toplevel directory or the chips/
	toplevel directory.  Note also that scsi/ has an "adapters" 
	subdirectory.

  2. In setting up the chips/ directory, we puked over having to include
	"cputypes.h" so that we could differentiate some lines of code
	that were necessary for DECSTATIONS vs VAXSTATION.  So we globally
	changes cputypes.h to platforms.h.


Special notes:
------- -----

<Replace this text with any special information of interest for this version.>

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
51
[ ./kernel/mips/PMAX/bt459.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/bt459.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/bt478.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/bt478.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/build_font.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/cfb_hdw.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/cfb_misc.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/compat_30.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/dc503.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/dc503.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/dz_7085.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/dz_defs.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/dz_hdw.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/dz_tty.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/if_se.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/if_se.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/if_se_mapped.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/kernel_font.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/kernel_font.data ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/lk201.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/lk201.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/mapped_scsi.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/mapped_scsi.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/mc_clock.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/mc_clock.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/mouse.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/pm_defs.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/pm_hdw.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/pm_misc.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/rz.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/rz.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/rz_disk.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/rz_disk_bbr.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/rz_labels.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/rz_tape.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/screen.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/screen.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/screen_defs.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/screen_switch.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/screen_switch.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi2.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_53C94.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_53C94_hdw.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_7061.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_7061_hdw.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_alldevs.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_comm.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_cpu.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_defs.h ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_disk.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_jukebox.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_optical.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_printer.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_rom.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_scanner.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_tape.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/mips/PMAX/scsi_worm.c ]
defunct; moved to chips/ or scsi/
[ ./kernel/i386ipsc/if_cnp.c ]
if_cnp.? -> cnp/ & varargs to sys
[ ./kernel/i386ipsc/if_cnp.h ]
if_cnp.? -> cnp/ & varargs to sys
[ ./kernel/i860/i860_varargs.h ]
if_cnp.? -> cnp/ & varargs to sys
[ ./Directories/ALL ]
new: kernel/{chips,scsi{,/adapter},i386ipsc/cnp}
[ ./Directories/i386 ]
new: kernel/{chips,scsi{,/adapter},i386ipsc/cnp}
[ ./Directories/mips ]
new: kernel/{chips,scsi{,/adapter},i386ipsc/cnp}
[ ./Directories/vax ]
new: kernel/{chips,scsi{,/adapter},i386ipsc/cnp}
[ ./kernel/chips/bt459.c ]
File moved here from mips/PMAX since it tries to be generic.
[91/06/04            rvb]
[ ./kernel/chips/bt459.h ]
File moved here from mips/PMAX since it tries to be generic.
[91/06/04            rvb]
[ ./kernel/chips/bt478.c ]
File moved here from mips/PMAX since it tries to be generic.
[91/06/04            rvb]
[ ./kernel/chips/bt478.h ]
File moved here from mips/PMAX since it tries to be generic.
[91/06/04            rvb]
[ ./kernel/chips/build_font.c ]
File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/busses.c ]
File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]

Added check in configure_bus_master for device's controller# to match
the controller's unit#, if not wildcarded.
Also, made device->ctlr correct *before* calling the slave function.
[91/06/02            af]
[ ./kernel/chips/busses.h ]
File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/cfb_misc.c ]
File moved here from mips/PMAX since it tries to be generic.
[91/06/04            rvb]
[ ./kernel/chips/dc503.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:22  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/dc503.h ]
File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/dz_7085.h ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:26  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]

Split out machine specific details to machine/dev/dz_7085.h
[91/05/20            rvb]
[ ./kernel/chips/dz_defs.h ]
File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/dz_hdw.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:30  rvb]

	File moved here from mips/PMAX since it tries to be generic;
	it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/dz_tty.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:35  rvb]

	File moved here from mips/PMAX since it tries to be generic;
	it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/kernel_font.c ]
File moved here from mips/PMAX since it tries to be generic.
[91/06/04            rvb]
[ ./kernel/chips/kernel_font.data ]
	File moved here from mips/PMAX since it tries to be generic;
	it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/lance.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:39  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/lance.h ]
File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/lance_mapped.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:45  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and could be used on the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/lk201.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:50  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/lk201.h ]
File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/mc_clock.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:54  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and could be used on the Vax3100.
It would need a few ifdef vax & ifdef mips for the latter.
[91/06/04            rvb]
[ ./kernel/chips/mc_clock.h ]
File moved here from mips/PMAX since it tries to be generic.
[91/06/04            rvb]
[ ./kernel/chips/mouse.c ]
File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/pm_defs.h ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:57  rvb]

	File moved here from mips/PMAX since it tries to be generic;
	it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/pm_hdw.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:01  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/pm_misc.c ]
X support
[91/06/18  21:36:46  rvb]

mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:05  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/screen.c ]
X support
[91/06/18  21:36:53  rvb]

mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:09  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/screen.h ]
File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/screen_defs.h ]
File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/screen_switch.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:13  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/screen_switch.h ]
File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/vs42x_rb.h ]
Created, from the DEC specs:
"VS42X-RB Storage Controller, Engineering Specification"
January 1989, DEC Maynard Ma.
[91/04/23            af]
[ ./kernel/conf/MASTER.i386 ]
cputypes.h->platforms.h
[91/06/12  13:44:24  rvb]
[ ./kernel/conf/MASTER.i860 ]
cputypes.h->platforms.h
[91/06/12  13:44:33  rvb]
[ ./kernel/conf/MASTER.mips ]
dz got renamed dz_, because the driver was renamed.
[91/06/07            rvb]
[ ./kernel/conf/MASTER.sun3 ]
cputypes.h->platforms.h
[91/06/12  13:44:29  rvb]
[ ./kernel/conf/MASTER.vax ]
Support for VaxStation 3100
[91/06/07            rvb]
[ ./kernel/conf/files.mips ]
Most files in mips/PMAX got moved to scsi/ or chips/.
[91/06/07            rvb]
[ ./kernel/conf/files.vax ]
Support for VaxStation 3100
[91/06/07            rvb]
[ ./kernel/i386/cswitch.s ]
cputypes.h->platforms.h
[91/06/12  13:44:37  rvb]
[ ./kernel/i386/fpu.c ]
cputypes.h->platforms.h
[91/06/12  13:44:41  rvb]
[ ./kernel/i386/genassym.c ]
cputypes.h->platforms.h
[91/06/12  13:44:45  rvb]
[ ./kernel/i386/hardclock.c ]
cputypes.h->platforms.h
[91/06/12  13:44:49  rvb]
[ ./kernel/i386/interrupt.s ]
cputypes.h->platforms.h
[91/06/12  13:44:55  rvb]
[ ./kernel/i386/locore.s ]
cputypes.h->platforms.h
[91/06/12  13:44:59  rvb]
[ ./kernel/i386/pic.c ]
cputypes.h->platforms.h
[91/06/12  13:45:08  rvb]
[ ./kernel/i386/pic.h ]
cputypes.h->platforms.h
[91/06/12  13:45:13  rvb]
[ ./kernel/i386/pit.c ]
cputypes.h->platforms.h
[91/06/12  13:45:16  rvb]
[ ./kernel/i386/pit.h ]
cputypes.h->platforms.h
[91/06/12  13:45:21  rvb]
[ ./kernel/i386/setroot.c ]
cputypes.h->platforms.h
[91/06/12  13:45:24  rvb]
[ ./kernel/i386/start.s ]
cputypes.h->platforms.h
[91/06/12  13:45:27  rvb]
[ ./kernel/i386at/autoconf.c ]
cputypes.h->platforms.h
[91/06/12  13:45:33  rvb]
[ ./kernel/i386at/model_dep.c ]
cputypes.h->platforms.h
[91/06/12  13:45:37  rvb]
[ ./kernel/i386ipsc/model_dep.c ]
cputypes.h->platforms.h
[91/06/12  13:45:41  rvb]
[ ./kernel/kern/bootstrap.c ]
Ask for startup program to override default.
[91/06/18  21:39:17  rvb]
[ ./kernel/mips/PMAX/ga_hdw.c ]
The busses.h and other header files have moved to the "chips"
directory.
[91/06/07            rvb]
[ ./kernel/mips/PMAX/gq_hdw.c ]
The busses.h and other header files have moved to the "chips"
directory.
[91/06/07            rvb]
[ ./kernel/mips/PMAX/mips_box.c ]
The busses.h and other header files have moved to the "chips"
directory.
[91/06/07            rvb]
[ ./kernel/mips/PMAX/tc.c ]
The busses.h and other header files have moved to the "chips"
directory.
[91/06/07            rvb]
[ ./kernel/mips/autoconf.c ]
#ifdef PMAX -> #ifdef DECSTATION and we include <platforms.h>
[91/06/12  14:08:42  rvb]
[ ./kernel/mips/mach_param.h ]
#ifdef PMAX -> #ifdef DECSTATION and we include <platforms.h>
[91/06/12  14:08:46  rvb]
[ ./kernel/mips/mips_box.h ]
#ifdef PMAX -> #ifdef DECSTATION and we include <platforms.h>
[91/06/12  14:08:49  rvb]
[ ./kernel/mips/mips_init.c ]
#ifdef PMAX -> #ifdef DECSTATION and we include <platforms.h>
[91/06/12  14:09:50  rvb]

cons_enable() now takes an argument -- which should be 1.
[91/06/07            rvb]
[ ./kernel/mips/pmap.c ]
#ifdef PMAX -> #ifdef DECSTATION and we include <platforms.h>
[91/06/12  14:08:54  rvb]
[ ./kernel/mips/prom_interface.h ]
#ifdef PMAX -> #ifdef DECSTATION and we include <platforms.h>
[91/06/12  14:09:01  rvb]
[ ./kernel/scsi/compat_30.h ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/mapped_scsi.c ]
minor improvements
[91/06/18  21:34:58  rvb]

mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:17  rvb]

File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/mapped_scsi.h ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/rz.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/rz.h ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]

A couple of macros were not fully parenthesized, which screwed
up the second scsi bus on Vaxen.  [This was the only bug in the
multi-bus code, amazing].
[91/05/30            af]
[ ./kernel/scsi/rz_disk.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/rz_disk_bbr.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/rz_labels.h ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/rz_tape.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:21  rvb]

	File moved here from mips/PMAX since it is now "MI" code, also
	used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]

	Printing of 'unsupported..' in scsi_slave was screwed cuz
	ui->mi and ui->unit could be bogus at that point in time.
[91/05/30            af]
[ ./kernel/scsi/scsi.h ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi2.h ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_alldevs.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_comm.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_cpu.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_defs.h ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_disk.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_jukebox.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_optical.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_printer.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_rom.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_scanner.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_tape.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_worm.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/src/config/config.h ]
cputypes.h->platforms.h
[91/06/12  13:45:45  rvb]
[ ./kernel/src/config/config.l ]
cputypes.h->platforms.h
[91/06/12  13:45:50  rvb]
[ ./kernel/src/config/config.y ]
cputypes.h->platforms.h
[91/06/12  13:45:55  rvb]
[ ./kernel/src/config/main.c ]
cputypes.h->platforms.h
[91/06/12  13:46:00  rvb]
[ ./kernel/src/config/mkglue.c ]
cputypes.h->platforms.h
[91/06/12  13:46:04  rvb]
[ ./kernel/src/config/mkheaders.c ]
cputypes.h->platforms.h
[91/06/12  13:46:08  rvb]
[ ./kernel/src/config/mkioconf.c ]
cputypes.h->platforms.h
[91/06/12  13:46:13  rvb]
[ ./kernel/src/config/mkmakefile.c ]
cputypes.h->platforms.h
[91/06/12  13:46:20  rvb]
[ ./kernel/src/config/mkswapconf.c ]
cputypes.h->platforms.h
[91/06/12  13:46:26  rvb]
[ ./kernel/sun3/autoconf.c ]
cputypes.h->platforms.h
[91/06/12  13:46:30  rvb]
[ ./kernel/sun3/cpu.h ]
cputypes.h->platforms.h
[91/06/12  13:46:34  rvb]
[ ./kernel/sun3/map.s ]
cputypes.h->platforms.h
[91/06/12  13:46:38  rvb]
[ ./kernel/sun3/model_dep.c ]
cputypes.h->platforms.h
[91/06/12  13:46:41  rvb]
[ ./kernel/sun3/pmap.c ]
cputypes.h->platforms.h
[91/06/12  13:46:46  rvb]
[ ./kernel/sun3/sun_init.c ]
cputypes.h->platforms.h
[91/06/12  13:46:53  rvb]
[ ./kernel/sun3/trap.c ]
cputypes.h->platforms.h
[91/06/12  13:46:56  rvb]
[ ./kernel/sundev/mb.c ]
cputypes.h->platforms.h
[91/06/12  13:47:02  rvb]
[ ./kernel/sys/reboot.h ]
Second byte of boothowto is flags for "startup" program.
[91/06/18            rvb]
Add ifndef ASSEMBLER so that vax_init.s can include it.
[91/06/11            rvb]
[ ./kernel/vax/Locore.c ]
cputypes.h->platforms.h
[91/06/12  13:57:39  rvb]

Support for VaxStation 3100: cvax like VAX6x0
[91/06/04            rvb]
[ ./kernel/vax/autoconf.c ]
cputypes.h->platforms.h
[91/06/12  13:47:08  rvb]
[ ./kernel/vax/clock.c ]
cputypes.h->platforms.h
[91/06/12  13:57:41  rvb]

Support for VaxStation 3100: like Cvax II
[91/06/04            rvb]
[ ./kernel/vax/conf.c ]
X support
[91/06/18  21:36:41  rvb]

Support for VaxStation 3100: devices like DEC Station 3100
[91/06/04            rvb]
[ ./kernel/vax/cons.c ]
cputypes.h->platforms.h
[91/06/12  13:57:44  rvb]

Support for VaxStation 3100: NO STANDARD CONSOLE,
NO ROM PRINT CALLOUT, console is like the DEC Station 3100
[91/06/04            rvb]
[ ./kernel/vax/cons.h ]
cputypes.h->platforms.h
[91/06/12  13:47:17  rvb]
[ ./kernel/vax/cpmbx.h ]
cputypes.h->platforms.h
[91/06/12  13:57:47  rvb]

Support for VaxStation 3100: cvax like VAX6x0
[91/06/04            rvb]
[ ./kernel/vax/cpu_data.c ]
cputypes.h->platforms.h
[91/06/12  13:57:50  rvb]

Support for VaxStation 3100: new processor cvax + different
memory and bus.
[91/06/04            rvb]
[ ./kernel/vax/cpu_data.h ]
Support for VaxStation 3100: new processor number
[91/06/04            rvb]
[ ./kernel/vax/ka3100.c ]
cputypes.h->platforms.h
[91/06/12  13:57:52  rvb]

Support for VaxStation 3100: new processor cvax + different
memory and bus.
[91/06/04            rvb]

Created.
[91/05/24            rvb]
[ ./kernel/vax/ka3100.h ]
Support for VaxStation 3100: new processor cvax + different
memory and bus.
[91/06/04            rvb]

Created
[91/04/26            rvb]
[ ./kernel/vax/ka6200.c ]
cputypes.h->platforms.h
[91/06/12  13:47:56  rvb]
[ ./kernel/vax/ka630.c ]
cputypes.h->platforms.h
[91/06/12  13:48:01  rvb]
[ ./kernel/vax/ka630.h ]
cputypes.h->platforms.h
[91/06/12  13:48:11  rvb]
[ ./kernel/vax/ka650.c ]
cputypes.h->platforms.h
[91/06/12  13:48:15  rvb]
[ ./kernel/vax/ka7xx.c ]
cputypes.h->platforms.h
[91/06/12  13:49:49  rvb]
[ ./kernel/vax/ka820.c ]
cputypes.h->platforms.h
[91/06/12  13:49:53  rvb]
[ ./kernel/vax/ka8600.c ]
cputypes.h->platforms.h
[91/06/12  13:49:58  rvb]
[ ./kernel/vax/locore.s ]
Support for VaxStation 3100: new processor number added to tables
and ka42_<> interrupt trampoline.
[91/06/04            rvb]
[ ./kernel/vax/mem.h ]
cputypes.h->platforms.h
[91/06/12  13:50:01  rvb]
[ ./kernel/vax/model_dep.c ]
cputypes.h->platforms.h
[91/06/12  13:57:55  rvb]

Support for VaxStation 3100: new processor
[91/06/04            rvb]
[ ./kernel/vax/mtpr.h ]
cputypes.h->platforms.h
[91/06/12  13:50:07  rvb]
[ ./kernel/vax/nexus.h ]
cputypes.h->platforms.h
[91/06/12  13:50:11  rvb]
[ ./kernel/vax/qbus.c ]
cputypes.h->platforms.h
[91/06/12  13:50:15  rvb]
[ ./kernel/vax/scb.s ]
cputypes.h->platforms.h
[91/06/12  13:50:19  rvb]
[ ./kernel/vax/setroot.c ]
a kinder gentler setroot
[91/06/18  21:37:37  rvb]

Fix setroot for scsi device.
[91/06/11            rvb]
Support for VaxStation 3100: use rz disk and two digit
unit number
[91/06/04            rvb]
[ ./kernel/vax/vax_init.s ]
cputypes.h->platforms.h
[91/06/12  13:58:02  rvb]

VAX3100: Get device and mem_bitmap parameters from ultrix.
[91/06/11            rvb]
Support for VaxStation 3100: new processor number
[91/06/04            rvb]
[ ./kernel/vax/watch_chip.c ]
Support for VaxStation 3100:	shift two bits
[91/06/04            rvb]
[ ./kernel/vax/watch_chip.h ]
Support for VaxStation 3100:	shift two bits
[91/06/04            rvb]
[ ./kernel/vaxmba/mba.c ]
cputypes.h->platforms.h
[91/06/12  13:50:27  rvb]
[ ./kernel/vaxuba/ubareg.h ]
cputypes.h->platforms.h
[91/06/12  13:50:33  rvb]
[ ./kernel/vaxuba/ubavar.h ]
cputypes.h->platforms.h
[91/06/12  13:50:37  rvb]
[ ./kernel/vaxuba/uda_umd.c ]
cputypes.h->platforms.h
[91/06/12  13:50:44  rvb]
[ ./kernel/conf/MASTER.vax ]
Support for VaxStation 3100
[91/06/07            rvb]
[ ./kernel/conf/MASTER.mips ]
dz got renamed dz_, because the driver was renamed.
[91/06/07            rvb]
[ ./kernel/chips/lance.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:39  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/lance_mapped.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:45  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and could be used on the Vax3100.
[91/06/04            rvb]
[ ./kernel/scsi/scsi_endian.h ]
Created.
[91/06/11            af]
[ ./kernel/conf/files.vax ]
Support for VaxStation 3100
[91/06/07            rvb]
[ ./kernel/conf/files.mips ]
Most files in mips/PMAX got moved to scsi/ or chips/.
[91/06/07            rvb]
[ ./kernel/conf/MASTER.vax ]
Support for VaxStation 3100
[91/06/07            rvb]
[ ./kernel/conf/MASTER.mips ]
dz got renamed dz_, because the driver was renamed.
ln got renamed se_, because the driver was renamed.
[91/06/07            rvb]
[ ./kernel/chips/lance.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:39  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/lance_mapped.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:01:45  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and could be used on the Vax3100.
[91/06/04            rvb]
[ ./kernel/scsi/adapters/scsi_5380.h ]
From the NCR data sheets
"NCR 5380 Family, SCSI Protocol Controller Data Manual"
NCR Microelectronics Division, Colorado Spring, 6/98 T01891L
[91/04/21            af]
[ ./kernel/scsi/adapters/scsi_5380_hdw.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:28  rvb]

Created, from the NCR specs:
"NCR 5380 Family, SCSI Protocol Controller Data Manual"
NCR Microelectronics Division, Colorado Spring, 6/98 T01891L
and from code taken from the scsi_7061_hdw.c file
[91/04/23            af]
[ ./kernel/scsi/adapters/scsi_53C94.h ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:35  rvb]

	File moved here from mips/PMAX since it is now "MI" code, also
	used by Vax3100 and soon -- the omron luna88k.
[91/06/07            rvb]
[ ./kernel/scsi/adapters/scsi_7061.h ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/adapters/scsi_7061_hdw.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/conf/files.vax ]
Support for VaxStation 3100
[91/06/07            rvb]
[ ./kernel/conf/files.mips ]
Most files in mips/PMAX got moved to scsi/ or chips/.
[91/06/07            rvb]
[ ./kernel/sun3/setroot.c ]
gets() must be static to not conflict with kern/printf:gets()
[ ./kernel/scsi/adapters/scsi_5380.h ]
From the NCR data sheets
"NCR 5380 Family, SCSI Protocol Controller Data Manual"
NCR Microelectronics Division, Colorado Spring, 6/98 T01891L
[91/04/21            af]
[ ./kernel/scsi/adapters/scsi_5380_hdw.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:28  rvb]

Created, from the NCR specs:
"NCR 5380 Family, SCSI Protocol Controller Data Manual"
NCR Microelectronics Division, Colorado Spring, 6/98 T01891L
and from code taken from the scsi_7061_hdw.c file
[91/04/23            af]
[ ./kernel/scsi/adapters/scsi_53C94.h ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:35  rvb]

	File moved here from mips/PMAX since it is now "MI" code, also
	used by Vax3100 and soon -- the omron luna88k.
[91/06/07            rvb]
[ ./kernel/scsi/adapters/scsi_7061.h ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/scsi/adapters/scsi_7061_hdw.c ]
File moved here from mips/PMAX since it is now "MI" code, also
used by Vax3100 and soon -- the omron luna88k.
[91/06/04            rvb]
[ ./kernel/chips/pm_misc.c ]
X support
[91/06/18  21:36:46  rvb]

mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:05  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/cfb_hdw.c ]
	File moved here from mips/PMAX since it tries to be generic.
[91/06/04            rvb]
[ ./kernel/vax/ka3100.c ]
Changes from sandro
[91/06/19            rvb]

	cputypes.h->platformsh.
[91/06/12            rvb]

Support for VaxStation 3100: new processor cvax + different
memory and bus.
[91/06/04            rvb]

Created.
[91/05/24            rvb]
[ ./kernel/vax/ka3100.h ]
Changes from sandro
[91/06/19            rvb]

Support for VaxStation 3100: new processor cvax + different
memory and bus.
[91/06/04            rvb]

Created
[91/04/26            rvb]
[ ./kernel/vax/setroot.c ]
gets() defined in kern/printf strikes again.

[ ./kernel/scsi/adapters/scsi_5380_hdw.c ]
Only one interrupt to be cleared on reset for now
[ ./kernel/scsi/adapters/scsi_5380_hdw.c ]
Don't allow disconnects for now.

[ ./kernel/vm/vm_resident.c ]
Add pmap_page_grap_phys_addr() so that we don't have to export vm_page_t.

[ ./kernel/chips/pm_misc.c ]
X support
[91/06/18  21:36:46  rvb]

mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:05  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/chips/pm_misc.c ]
X support
[91/06/18  21:36:46  rvb]

mips->DECSTATION; vax->VAXSTATION
[91/06/12  14:02:05  rvb]

File moved here from mips/PMAX since it tries to be generic;
it is used on the PMAX and the Vax3100.
[91/06/04            rvb]
[ ./kernel/vax/clock.c ]
funny thing: before you could not build STD+BI because ka650.h was necessary to define ssc
[ ./kernel/vax/locore.s ]
funny thing: before you could not build STD+BI because ka650.h was necessary to define ssc
[ ./kernel/vax/genassym.c ]
funny thing: before you could not build STD+BI because ka650.h was necessary to define ssc
[ ./kernel/vax/conf.c ]
X support
[91/06/18  21:36:41  rvb]

Support for VaxStation 3100: devices like DEC Station 3100
[91/06/04            rvb]
[ ./kernel/vax/ka3100.c ]
cputypes.h->platforms.h
[91/06/12  13:57:52  rvb]

Support for VaxStation 3100: new processor cvax + different
memory and bus.
[91/06/04            rvb]
    
    
    
==========================================================================
   ***** MK Version MK52  (rvb) *****
    
    
THESE CHANGES ARE MIPS AND VAX ONLY.

Mainly we forgot to export the include files into the release/chips and release/scsi
directories that had been in release/mips/PMAX.  This means trouble for the
unix server and other users of release.

Also a few tweaks from sandro for mips.

NOTE: only the 3100 platforms were compiled for.

ALSO NOTE: on the previous release MK51, we build for
	sun3, i386, sqt, mips, vax6bb and r2d2.  We
	tested on mips and vax6bb.


[ ./conf/version.edit ]
52
[ ./kernel/mips/busses.c ]
defunct; now in chips
[ ./kernel/mips/busses.h ]
defunct; now in chips
[ ./kernel/mips/busses.c ]
defunct; now in chips
[ ./kernel/mips/busses.h ]
defunct; now in chips
[ ./kernel/mips/start.s ]
Make it assemble with the 2.1 compiler
[ ./kernel/mips/PMAX/boot/c_misc.c ]
Scsi include files have moved, plus we use BSD label defs
from disk_status.h
[91/06/20            af]
[ ./kernel/mips/PMAX/boot/mkboot.c ]
Scsi include files have moved, plus we use BSD label defs
from disk_status.h
[91/06/20            af]
[ ./include/Makefile ]
Account for the new chips/ and scsi/ directories.
[ ./include/Makefile ]
Account for new scsi/ and chips/ directories.

    
    
    
==========================================================================
   ***** MK Version MK53  (rvb) *****
    
    
Bug fixes:
--- -----
Organizational changes:
-------------- -------
[VAX]
[PMAX]
	Well, the last release defuncted busses.[ch] from the mips/PMAX/ 
directory and as luck would have it there was still one reference in the tree
to it.

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
53
[ ./kernel/chips/busses.c ]
Sigh, busses.h really is in chips/ and until MK52 it was also in
mips/

    
    
    
==========================================================================
   ***** MK Version MK54  (rpd) *****
    
    
New features:
--- --------

Mig now understands a new option, "-sheader <file>", which causes
it to output a header file containing declarations/prototypes
of server-side functions.  I restored the prototypes in the standard
header file ("-header <file>"), which contains declarations
for the user-side stubs.

I removed some old code which caused Mig to produce
an "init_<module>" function in the user file.  It hasn't done
anything in a long time and nobody should be calling it.

I hacked Mig to use the type "ipc_port_t" instead of "mach_port_t"
in appropriate places when generating files for the kernel.
This way prototypes use the right type and I could remove
a bunch of casts from the kernel, especially in the vm system.


Bug fixes:
--- -----

I fixed a bug in the message-buffer caching code from MK43.

I picked up a fix from dlb for no-op assignments of threads
to processor sets.

In MK47, I changed the kernel so that syscall forms of kernel RPCs
return MACH_SEND_INTERRUPTED to indicate that libmach should retry.
In this merge, I made the companion fix to libmach to check
for MACH_SEND_INTERRUPTED instead of any non-success return code.
A Unix server built with this release won't work on pre-MK47 kernels.

I picked up some minor changes from jsb so that the norma/
directory is only used when building NORMA configurations.

[VAX]	  I fixed files in the chips/ and scsi/ directories
so that they compile with gcc.  I fixed a problem with the recent
vaxstation support that screwed up r2d2.

[I386]	  A minor fix so that STD+WS+TEST works.
I added kernel/src/makeboot to the appropriate Directories/ files.

[PMAX]    I fixed the mips/PMAX/boot/ directory so that people
without dot in their paths can build it.


Special notes:
------- -----

I tested the following configurations:

vax	STD+VAX6bb+gcc			nova, sf
	STD+16+fixpri+VAX6bb+BI+de+gcc	r2d2
i386	STD+WS				waldo
	STD+SQT+32			boris
	STD+iPSC+NORMA			dimitri
sun3	STD+SWS				rocky
pmax	STD+ANY				rpd
    
    
    
==========================================================================
   ***** MK Version MK55  (jsb) *****
    
    
Bug fixes:
--- -----

NORMA_VM:	Eliminated leaks; cleaned up implementation.

NORMA_IPC:	Improved buffer management code.

New features:
--- --------

From David Black: memory_object_data_supply, and generalization
of NORMA_IPC page list technology. Code currently turned off
by default. More details when I pick up the rest of David's work.

Special notes:
------- -----

Built for and tested on
	ubik		i386		STD+WS
	jsb		pmax		STD+ANY
	dimitri		i386ipsc	STD+iPSC+NORMA

Build, not tested:
			vax		STD+16+fixpri+VAX6bb+BI+de
			sun3		STD+SWS


I could not build

	STD+16+fixpri+VAX6bb+BI+de+gcc

because the build died on gcc -ES ... locore.s. It looks like gcc doesn't
know what a '-ES' means. (Perhaps ius3 has an old gcc?)

Log messages:
--- --------

[ ./conf/version.edit ]
55
[ ./kernel/ddb/db_command.c ]
Added support for 'show all slocks'.
[91/06/29  15:59:01  jsb]
[ ./kernel/i386ipsc/autoconf.c ]
Call ask_bootstrap_server.
[91/06/29  16:39:11  jsb]
[ ./kernel/i386ipsc/dcm_input.c ]
Use clport_page_grab instead of vm_page_grab.
Removed bogus null definition of clport_replenish.
[91/06/29  16:08:08  jsb]
[ ./kernel/i386ipsc/model_dep.c ]
Temporary hack to prevent kernel text and data from being used
as free memory.
[91/06/29  17:48:16  jsb]
[ ./kernel/i386ipsc/sd.c ]
Replaced first_sdopen_ever with sd_initialized.
[91/06/29  16:09:42  jsb]
[ ./kernel/i386ipsc/sdintr.c ]
Replace "Wrong direction DATAOUT" assertion with printf.
I seem to hit this a lot when running a STD+iPSC+NORMA+TEST kernel.
[91/06/29  16:13:34  jsb]
[ ./kernel/i860ipsc/autoconf.c ]
Call ask_bootstrap_server.
[91/06/29  16:39:30  jsb]
[ ./kernel/ipc/ipc_kmsg.c ]
From David Black at OSF: generalized page list support.
[91/06/29  16:29:29  jsb]
[ ./kernel/ipsc/dcmcom.c ]
Implemented clport_replenish and clport_page_grab.
[91/06/29  16:49:46  jsb]
[ ./kernel/ipsc/node.c ]
Removed master_node(). Added ask_bootstrap_server.
[91/06/29  16:32:06  jsb]
[ ./kernel/ipsc/usm.c ]
Fixed usmopen to call ttychars with the tty unlocked.
[91/06/29  16:33:36  jsb]
[ ./kernel/kern/bootstrap.c ]
Removed notion of master/slave. Instead, refuse to start up
a bootstrap task whenever startup_name is null.
[91/06/29  16:48:14  jsb]
[ ./kernel/kern/ipc_kobject.h ]
For NORMA_VM: added IKOT_XMM_PAGER, for memory_objects mapped only
by other kernels.

From David Black at OSF: added ipc_kobject_vm_special.
[91/06/29  14:33:34  jsb]
[ ./kernel/kern/lock.c ]
Implemented db_show_all_slocks.
[91/06/29  16:52:53  jsb]
[ ./kernel/mach/mach.defs ]
From David Black at OSF: added memory_object_data_supply.
[91/06/29  14:59:47  jsb]
[ ./kernel/mach/memory_object.defs ]
From David Black at OSF: added memory_object_supply_completed
and memory_object_data_return.
[91/06/29  14:54:47  jsb]
[ ./kernel/mach/memory_object_default.defs ]
If KERNEL and NORMA_VM, then use a userprefix (to allow interposition).
[91/06/29  16:35:53  jsb]
[ ./kernel/norma/ipc_kserver.c ]
Changes for new vm_map_copy_t definition.
[91/06/29  16:38:27  jsb]
[ ./kernel/norma/ipc_output.c ]
Changes for new vm_map_copy_t definition.
Locking changes in ipc_clport_send.
[91/06/29  15:06:45  jsb]
[ ./kernel/norma/ipc_vm.c ]
Changes for new vm_map_copy_t definition.
[91/06/29  15:08:54  jsb]
[ ./kernel/norma/ipc_xxx.c ]
Some locking changes.
[91/06/29  15:10:46  jsb]
[ ./kernel/norma/xmm.c ]
Removed non-KERNEL code.
Replaced Xobj_allocate with xmm_obj_allocate.
Added xmm_obj_deallocate.
Use per-class zone for obj allocation.
[91/06/29  15:21:33  jsb]
[ ./kernel/norma/xmm_debug.c ]
Collect garbage. Return valid return values.
[91/06/29  15:25:16  jsb]
[ ./kernel/norma/xmm_export.c ]
Fixed object importation protocol.
Corrected declaration of _proxy_lock_completed.
[91/06/29  15:28:46  jsb]
[ ./kernel/norma/xmm_import.c ]
Fixed object importation protocol. Return valid return values.
[91/06/29  15:30:10  jsb]
[ ./kernel/norma/xmm_interpose.c ]
Collect garbage. Return valid return values.
[91/06/29  15:31:20  jsb]
[ ./kernel/norma/xmm_invalid.c ]
Added declaration of invalid_mclass, for debugging use.
[91/06/29  15:32:54  jsb]
[ ./kernel/norma/xmm_obj.h ]
Removed malloc, free definitions.
Added xmm_decl macro.
Renamed Xobj_allocate to xmm_obj_allocate.
Added zone element to xmm_class structure.
[91/06/29  14:41:25  jsb]
[ ./kernel/norma/xmm_server.c ]
Added support for memory_object_create.
Now export normal memory_object_init with standard arguments.
Improved object initialization logic.
Added garbage collection.
[91/06/29  15:39:01  jsb]
[ ./kernel/norma/xmm_split.c ]
Use zone for requests.
[91/06/29  15:34:20  jsb]
[ ./kernel/norma/xmm_svm.c ]
Now allow objects to grow in size (as temporary objects do).
Merged user_t and kobj structures. Do garbage collection.
Now pass up all set_attribute calls, not just first.
Use zone for request structures.
[91/06/29  15:43:16  jsb]
[ ./kernel/norma/xmm_user.c ]
Collect garbage. Support memory_object_create.
Disassociate kobj from memory_control before calling
memory_object_terminate to prevent upcalls on terminated kobj.
[91/06/29  15:51:50  jsb]
[ ./kernel/vm/memory_object.c ]
21-Jun-91 David L. Black (dlb) at Open Software Foundation
Add memory_object_data_supply.
[91/06/29  16:36:43  jsb]
[ ./kernel/vm/vm_fault.c ]
Changed remaining pager_* references to memory_object_*.
[91/06/29  16:26:22  jsb]
[ ./kernel/vm/vm_map.c ]
20-Jun-91 David L. Black (dlb) at Open Software Foundation
Add support for page list format map copies.  NORMA/CLPORT code
will be cut over later.

18-Jun-91 David L. Black (dlb) at Open Software Foundation
Convert to use multiple format map copies.
[91/06/29  16:37:03  jsb]
[ ./kernel/vm/vm_map.h ]
18-Jun-91 David L. Black (dlb) at Open Software Foundation
	Declarations for multiple-format vm map copy support.
[91/06/29  14:36:42  jsb]
[ ./kernel/vm/vm_object.c ]
Improved NORMA_VM support, including support for memory_object_create.
[91/06/29  17:06:11  jsb]
[ ./kernel/vm/vm_page.h ]
28-Jun-91 David L. Black (dlb) at Open Software Foundation
Change unused was_absent field to precious field.

21-Jun-91 David L. Black (dlb) at Open Software Foundation
Remove extraneous include of kern/thread.h.
[91/06/29  14:39:05  jsb]
[ ./kernel/vm/vm_pageout.c ]
18-Jun-91 David L. Black (dlb) at Open Software Foundation
Add missing includes of vm/vm_map.h and kern/thread.h.
[91/06/29  16:53:36  jsb]
[ ./kernel/vm/vm_resident.c ]
Removed accidently merged hack.
[91/06/29  17:47:21  jsb]

20-Jun-91 David L. Black (dlb) at Open Software Foundation
Need vm_page_replace in all configurations.
[91/06/29  16:37:31  jsb]
[ ./kernel/vm/memory_object.c ]
Changed mach_port_t to ipc_port_t in memory_object_data_supply.
    
    
    
==========================================================================
   ***** MK Version MK56  (danner) *****
    
    
New features:
--- --------

The purpose of this release is essentially to get the luna88k code
under source control. Other minor upgrades occured in the process. The
code is incomplete and currently broken. 

The luna build environment is still less than ideal. If your are
interested in building such kernels, please contact me or bob.

The software single step code is now smart enough to avoid putting
breakpoints directly after unconditional flow transfer instructions.
This causes problems on both the pmax and luna. 

DDB can now take a table of machine specific commands to be installed
in addition to the normal commands under the command prefix "machine".
This necessitated some changes to the ddb header files. See
luna88k/db_interface.c for a use of the functionality.

The SSSCSI (Sandro Spiffy SCSI) code now understands dec, omron and
bsd labels, which form a maze of disk labels, all alike.

Copyrights on the omron code are somewhat suspect, and I expect I
caused retrograde motion on several MI file copyrights. Apologies in
advance.

Built on amalia.mach (luna), and booted single, dual, and quad cpu.
Works as well as ever. (gets through SCSI autoconfig, finds paging
file, dies).

Built and booted on rvb4.mach.cs.cmu.edu (Decstation 5000). DDB
changes tested. Comes up multiuser.

Built STD+VAX6bb on sf.mach.cs.cmu.edu. 

Bug fixes:
--- -----

Organizational changes:
-------------- -------

A bunch of luna specific directories were created.

Special notes:
------- -----

I created an new version of the utils/mktree.sh script that is used to
create kernel trees. Gratitously replicated directory creation code
has been collapsed to loops. Until Mary or someone can figure out how
to install this in its proper place
(/afs/cs/project/mach-7/mk/bin/mktree), please manually pull the script
out of /afs/cs/project/mach-7/mk/src/latest/utils/mktree.sh. 

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
56
[ ./kernel/mach/luna88k/thread_status.h ]
Initial Checkin
[91/06/26  12:40:20  danner]
[ ./kernel/mach/luna88k/vm_param.h ]
Initial Checkin
[91/06/26  12:40:27  danner]

Added some macros which be related to m88k segment.
[89/08/16            kick]

Changed the vax declarations for M88000.
note: incomplete MIN_ADDRESS, MAX_ADDRESS and STACH_SIZE.
[89/08/12            kick]
[ ./kernel/mach/luna88k/vm_types.h ]
Initial Checkin
[91/06/26  12:40:33  danner]
[ ./kernel/src/config/config.h ]
Luna88k support.
[91/06/26            danner]
[ ./kernel/src/config/config.l ]
Luna88k support.
[91/06/26            danner]
[ ./kernel/src/config/config.y ]
Luna88k support.
[91/06/26            danner]
[ ./kernel/src/config/main.c ]
Luna88k support.
[91/06/26            danner]
[ ./kernel/src/config/mkglue.c ]
Luna88k support.
[91/06/26            danner]
[ ./kernel/src/config/mkheaders.c ]
Luna88k support.
[91/06/26            danner]
[ ./kernel/src/config/mkioconf.c ]
Luna88k support.
[91/06/26            danner]
[ ./kernel/src/config/mkmakefile.c ]
Luna88k support.
[91/06/26            danner]
[ ./kernel/src/config/mkswapconf.c ]
Added support for null ioconf.c for luna88k.
[91/07/08  16:16:56  danner]
[ ./utils/mktree.sh ]
Added luna88k support.
Reorganized code to use loops instead of endlessly repeated code.
[91/06/26            danner]
[ ./kernel/mips/mips_instruction.c ]
Add inst_unconditional_flow_transfer to support ddb.
[91/07/09            danner]
[ ./kernel/mips/mips_instruction.c ]
Fixed bug in inst_unconditional_flow_transfer.
[ ./kernel/conf/files.vax ]
Added scsi/rz_labels.c
[91/07/09            danner]
[ ./Directories/luna88k ]
Few more luna specific directories.
[91/06/26  11:25:53  danner]

	Created from Mips
[91/06/26            danner]

 
[ ./kernel/Makeconf ]
Luna88k support.
[91/06/26            danner]
[ ./kernel/Makefile ]
Luna88k support.
[91/06/26            danner]
[ ./kernel/conf/MASTER ]
Added support for luna88k (pseudo-device cpus 4).
[91/05/06            danner]
[ ./kernel/conf/MASTER.luna88k ]
Created

 Revision 2.2  91/04/05  13:53:25  mbj
 	Stripped out all vax stuff
 	[91/03/17  22:49:26  rvb]
 
 Revision 2.1  91/03/07  12:06:45  rvb
 to 2.1
 
[ ./kernel/conf/Makefile.luna88k ]
Created
[91/06/26  10:58:58  danner]
[ ./kernel/conf/devices.luna88k ]
Created

 Revision 2.2  91/04/05  13:55:17  mbj
 	install on branch too
 	[91/03/17  22:54:22  rvb]
 
[ ./kernel/conf/files.luna88k ]
Added scsi/rz_labels.c
[91/07/08  22:55:54  danner]

Initial Checkin

 Revision 2.2  91/04/05  13:55:21  mbj
 	No more db_obsolete.
 	[91/03/15  18:04:58  rvb]
 
 	Added kern/printf.c (on mach_kdb) to support ddb.
 	Added db_obsolete.c in support of iprintf.c
 	[91/03/14            danner]
 
 	Added ddb support files; obsoleted kdb which never 
 	was in use
 	[91/03/08            danner]
 
[ ./kernel/conf/files.mips ]
Added scsi/rz_labels.c to support new label technology.

[ ./kernel/ddb/db_aout.c ]
On luna, kdb_init needs to be called ddb_init. Add ifndef
 DB_SYMBOLS_PRELOADED for machines that use a.out format but
 whose prom loaders load generously load the symbol table.
[91/07/08            danner]
[ ./kernel/ddb/db_break.c ]
Conditionalized db_map_addr to work right on the luna. Used a
 ifdef luna88k. This is evil, and needs to be fixed.
[91/07/08            danner]
[ ./kernel/ddb/db_command.c ]
Modified the command loop to include the cpu number in the
 command prompt on multicpu machines, and node number in norma
      systems.
[91/04/12            danner]
[ ./kernel/ddb/db_command.h ]
Grabbed up to date copyright.
[91/07/08            danner]
[ ./kernel/ddb/db_input.c ]
Add include of machine/db_machdep.h to allow machine-specific
 overrides via defines.
[91/07/08            danner]
[ ./kernel/ddb/db_output.c ]
Include machine/db_machdep.c.
When db_printf is invoked, call db_printing on luna. This is used
 to trigger a screen clear. Under luna88k conditional.
[91/07/08            danner]
[ ./kernel/ddb/db_print.c ]
Fixed a few printf that should be db_printfs. 
[91/07/08            danner]
[ ./kernel/ddb/db_run.c ]
Added logic to db_set_single_step not to set a breakpoint at the
 next sequential instruction if the current instruction is an
 unconditional transfer of flow of control instruction. This
 avoids problems with the debugger overwriting data or clobbering
 routines that the debugger itself might need. This is determined
 by calling the predicate inst_unconditional_flow_transfer. This
 predicate now needs to be defined for all architectures using
 the software single step. 

     Added include of ddb/db_run.h, where all the STEP defines have been
      moved.
 
[91/07/08            danner]
[ ./kernel/ddb/db_run.h ]
Broken out of db_run.c because I needed access to the step mode in the 
machine dependent luna88k debugger code.
[91/07/09  00:47:31  danner]
[ ./kernel/ddb/db_sym.c ]
Changed a printf.
[91/07/08            danner]
[ ./kernel/device/tty.h ]
   Added omron tty specific flags; conditionalized under luna88k.
[91/05/25            danner]
[ ./kernel/kern/debug.c ]
Luna88k support.
[91/06/26            danner]
[ ./kernel/luna88k/asm.h ]
Initial 3.0 Checkin
[91/06/26  11:57:57  danner]
[ ./kernel/luna88k/asm_macro.h ]
Initial Checkin. Currently unused. In fact, I'm not sure where
 this file came from.
[91/07/08            danner]
[ ./kernel/luna88k/ast.h ]
Taken from mips.
[91/07/08            danner]
[ ./kernel/luna88k/ast_types.h ]
3.0 Initial Checkin
[91/07/09  10:26:02  danner]
[ ./kernel/luna88k/autoconf.c ]
cputypes.h -> platforms.h
[91/06/24            danner]

Butchered for 3.0
[91/05/06            danner]
[ ./kernel/luna88k/board.h ]
Initial 3.0 Checkin
[91/06/26  11:58:14  danner]
[ ./kernel/luna88k/clock.c ]
cputypes.h -> platforms.h
[91/06/24            danner]

Butchered for 3.0
[91/05/06            danner]
[ ./kernel/luna88k/clock.h ]
Added CLOCK_INTR_HZ, the frequency of the system interrupt clock.
[91/05/10            danner]
[ ./kernel/luna88k/cmmu.c ]
Initial 3.0 Checkin
[91/06/26  11:58:39  danner]
[ ./kernel/luna88k/conf.c ]
Initial 3.0 Checkin
[91/06/26  11:58:45  danner]
[ ./kernel/luna88k/cpu.h ]
Initial 3.0 Checkin
[91/06/26  11:58:51  danner]
[ ./kernel/luna88k/cpu_number.h ]
Created for luna.
[91/07/08            danner]
[ ./kernel/luna88k/db_disasm.c ]
Initial 3.0 Checkin
[91/06/26  12:01:05  danner]
[ ./kernel/luna88k/db_interface.c ]
Picked up include of assym.s
[91/07/09            danner]

Added printing of epsr, vector to frame printing routine. Disabled
      frame crawling support, since locore support is gone.
[91/07/08            danner]

Changed db_interface to use ENTRY_ASM in gimmeabreak.
[91/07/08            danner]
Conditionalized db_read_bytes, db_write_bytes to deal with
 unitialized pmap subsystem.
[91/05/13            danner]
[ ./kernel/luna88k/db_machdep.h ]
Removed unnecessary include of assym.s
[91/07/09            danner]

Purged 2.5 RCS log. Added ENTRY_ASM for neatness.
[91/07/08            danner]

Added include of assym.s (really a C header file).
[91/07/05            danner]
Initial 3.0 Checkin
[91/06/26  11:59:14  danner]
[ ./kernel/luna88k/db_sstep.c ]
Initial 3.0 Checkin
[91/06/26  11:59:21  danner]
[ ./kernel/luna88k/db_trace.c ]
Initial 3.0 Checkin
[91/06/26  11:59:31  danner]
[ ./kernel/luna88k/exec.c ]
Created (borrowed from Sandro)
[91/05/10            danner]
[ ./kernel/luna88k/genassym.c ]
Added generation of ENTRY_ASM, the assembly instruction to
 enter the debugger.
[91/07/08            danner]

Added THREAD_SWAP_FUNC for switch_to_shutdown_context
[91/06/25            danner]
[ ./kernel/luna88k/jtermio.h ]
Initial 3.0 Checkin
[91/06/26  11:59:47  danner]
[ ./kernel/luna88k/lock.h ]
Created.
[91/06/24            danner]
[ ./kernel/luna88k/locore/asm_utils.h ]
Initial 3.0 Checkin
[91/06/26  11:59:58  danner]
[ ./kernel/luna88k/locore/debug_msg.c ]
Initial 3.0 Checkin
[91/06/26  12:00:05  danner]
[ ./kernel/luna88k/locore/eh.c ]
Reorganized to support stack handoff. All exceptions from user
 mode now store registers in the pcb in the thread structure.
 This has increased ugliness, esp. in the case when turning on
 the FPU causes an exception.

Removed stack crawling support because the exception frame is now
 not always on the stack. Sigh

     Still a bug in cleaning up DMT0. 
[91/07/04            danner]
Upgraded to last pre_trap and pre_ext_int technology
[91/05/13            danner]
[ ./kernel/luna88k/locore/exception_vectors.h ]
Initial 3.0 Checkin
[91/06/26  12:00:23  danner]

Flush jkdb.
[91/04/01            rvb]
[ ./kernel/luna88k/locore/locore.c ]
Removed OLD_MACH2_5 code (where did it come from). Also
 switch_task_context, which is obsolete.
[91/07/08            danner]

Updated save_context to use new pcb definition.
[91/07/05            danner]
Added switch_to_shutdown_context
[91/06/25            danner]

Added intstack definition for boot.
[91/05/09            danner]

Removed sigcode (2.5 trampoline code)
Other 2.5isms ifdef 0 out.
[91/05/05            danner]

Removed include of sys/syscall.h
[91/05/05            danner]
Flush jkdb.
[91/04/01            rvb]
Removed a comma that violated motorola assembler syntax
[91/03/07            danner]
[ ./kernel/luna88k/locore/locore.h ]
Removed old OMRON RCS Log, SIZEOF_EF
[91/07/08            danner]

Removed SIZEOF_EF. Now generated by genasssym.
[91/07/04            danner]
Added USERMODE definition
[91/05/10            danner]
[ ./kernel/luna88k/locore/locore_asm_routines.c ]
Copyinmsg and copyoutmsg aliased to copyin and copyout, resp.
[91/05/08            danner]

Removed include of sys/errno.h and copyinstr, copyoutstr,
     addupc, copystr.
[91/05/05            danner]

Removed include sys/syscall.h
[91/05/05            danner]
Flush jkdb.
[91/04/01            rvb]
We will now use gcc routines for copy/zero.
[91/04/01            rvb]
Add are_interrupts_disabled for the debugger.
[91/03/12            danner]

add simple_lock_held for debugger
[91/03/12            danner]

fixed a bcnd statement that use ne as the test instead of ne0
[91/03/07            danner]

Replaced \\ with NEWLINE for ENTRY macro
[91/03/07            danner]
[ ./kernel/luna88k/locore/locore_c_routines.c ]
Initial Checkin
[91/06/26  12:23:24  danner]
[ ./kernel/luna88k/locore/vsnprintf.c ]
Initial Checkin.
[91/06/26  12:24:19  danner]
[ ./kernel/luna88k/luna_fp.c ]
Added inclusion of assym.s
[91/07/04            danner]
Initial Checkin
[91/06/26  12:25:30  danner]
[ ./kernel/luna88k/luna_init.c ]
Added avail_next.
[91/06/25            danner]

Moved kdb_init here from machdep.
[91/05/13            danner]
[ ./kernel/luna88k/m88k.h ]
Removed all the EF_* defines - they are now created by genassym.
[91/07/04            danner]
Initial Checkin
[91/06/26  12:25:58  danner]
[ ./kernel/luna88k/mach_param.h ]
Snarfed from 386
[91/05/06            danner]
[ ./kernel/luna88k/machdep.c ]
Support for remunged pcb. Untested.
[91/07/05            danner]
cputypes.h -> platforms.h
[91/06/24            danner]

Added halt_all_cpus.
[91/05/10            danner]
[ ./kernel/luna88k/machine_thread.c ]
Created
[91/05/10            danner]
[ ./kernel/luna88k/machparam.h ]
Created for luna88k.
[91/05/06            danner]
[ ./kernel/luna88k/mem.c ]
Initial Checkin
[91/06/26  12:29:15  danner]
[ ./kernel/luna88k/nvram.h ]
Initial Checkin
[91/06/26  12:29:22  danner]
[ ./kernel/luna88k/pcb.c ]
Support for 3.0 style pcb's, where the user registers are dumped
 into the pcb on all traps/interrupts from user mode.
[91/07/08            danner]
Nuked thread dup
[91/05/07            danner]
[ ./kernel/luna88k/pcb.h ]
Modified to include thread.h instead of redefining the pcb structure.
[91/07/03            danner]
Initial Checkin
[91/06/26  12:30:20  danner]
[ ./kernel/luna88k/pio.h ]
Initial Checkin
[91/06/26  12:30:36  danner]
[ ./kernel/luna88k/pmap.c ]
Added pmap_virtual_space, pmap_free_pages, and pmap_next_page.
[91/06/25            danner]

Modified to protect the page which has the exception vector 
     table. (SYSV_BASE).
[91/05/22            danner]

ASSERT -> assert
[91/05/10            danner]

Removed mach_xp include and conditionals.
[91/05/07            danner]
[ ./kernel/luna88k/pmap.h ]
Added noops for pmap_list_resident_pages and
 pmap_remove_attributes.
[91/05/09            danner]
[ ./kernel/luna88k/psl.h ]
Initial Checkin
[91/06/26  12:31:10  danner]
[ ./kernel/luna88k/pte.h ]
Initial Checkin
[91/06/26  12:31:16  danner]
[ ./kernel/luna88k/reg.h ]
Initial Checkin
[91/06/26  12:31:22  danner]
[ ./kernel/luna88k/rom1ep.h ]
Initial Checkin
[91/06/26  12:31:29  danner]
[ ./kernel/luna88k/scb.h ]
Initial Checkin
[91/06/26  12:31:36  danner]
[ ./kernel/luna88k/scr.h ]
Initial Checkin
[91/06/26  12:31:46  danner]
[ ./kernel/luna88k/setjmp.h ]
Initial 3.0 Checkin.
[91/07/09  09:55:58  danner]
[ ./kernel/luna88k/setroot.c ]
Lifted from i386at directory.
[91/05/09            danner]
[ ./kernel/luna88k/softint.c ]
Initial Checkin
[91/06/26  12:32:00  danner]
[ ./kernel/luna88k/softint.h ]
Initial Checkin
[91/06/26  12:32:06  danner]
[ ./kernel/luna88k/sys_machdep.c ]
Initial Checkin
[91/06/26  12:32:15  danner]
[ ./kernel/luna88k/thread.h ]
Keep_Stacks currently defined.
[91/07/08            danner]
Added include of mach/kern_return.h
[91/05/06            danner]
[ ./kernel/luna88k/time_stamp.h ]
Snarfed from i386
[91/05/06            danner]
[ ./kernel/luna88k/trap.c ]
Removed frame is bogus warning that depended on scribbling magic
 constants into frames.
[91/07/08            danner]
Initial Checkin
[91/06/26  12:32:46  danner]
[ ./kernel/luna88k/trap.h ]
Initial Checkin
[91/06/26  12:32:53  danner]
[ ./kernel/luna88k/ufs_machdep.c ]
Initial Checkin
[91/06/26  12:33:37  danner]
[ ./kernel/luna88k/varargs.h ]
Typo fixup.
[91/06/26            danner]
Initial Checkin
[91/06/26  12:37:40  danner]
[ ./kernel/luna88k/vm_machdep.c ]
Initial Checkin
[91/06/26  12:38:33  danner]
[ ./kernel/luna88k/vm_tuning.h ]
3.0 Checkin.
[91/07/09  10:48:44  danner]
[ ./kernel/luna88k/vmparam.h ]
Initial Checkin
[91/06/26  12:38:41  danner]
[ ./kernel/luna88k/xpr.h ]
Initial 3.0 Checkin.
[91/07/09  10:38:06  danner]
[ ./kernel/luna88kdev/codetbl.t ]
Initial Checkin
[91/06/26  11:43:05  danner]
[ ./kernel/luna88kdev/compat_25.h ]
Initial Checkin
[91/06/26  11:43:15  danner]
[ ./kernel/luna88kdev/cons.c ]
Initial Checkin
[91/06/26  11:42:24  danner]
[ ./kernel/luna88kdev/cons.h ]
Initial Checkin
[91/06/26  11:42:30  danner]
[ ./kernel/luna88kdev/deftbl.t ]
Initial Checkin
[91/06/26  11:43:25  danner]
[ ./kernel/luna88kdev/esctbl.t ]
Initial Checkin
[91/06/26  11:43:36  danner]
[ ./kernel/luna88kdev/kbmain.c ]
Initial Checkin
[91/06/26  11:47:02  danner]
[ ./kernel/luna88kdev/kbms.h ]
Initial Checkin
[91/06/26  11:42:36  danner]
[ ./kernel/luna88kdev/keymap.t ]
Initial Checkin
[91/06/26  11:45:36  danner]
[ ./kernel/luna88kdev/msmain.c ]
Initial Checkin
[91/06/26  11:46:02  danner]
[ ./kernel/luna88kdev/ramdisk.h ]
Initial Checkin
[91/06/26  11:45:55  danner]
[ ./kernel/luna88kdev/table.h ]
Initial Checkin
[91/06/26  11:45:46  danner]
[ ./kernel/luna88kdev/uart.c ]
Initial Checkin
[91/06/26  11:46:18  danner]
[ ./kernel/luna88kdev/uart.h ]
Initial Checkin
[91/06/26  11:46:09  danner]
[ ./kernel/luna88kif/if_qb.h ]
Initial Checkin
[91/06/26  12:40:42  danner]
[ ./kernel/mach/luna88k/boolean.h ]
Created
[91/07/08  22:38:27  danner]
[ ./kernel/mach/luna88k/exception.h ]
Created
[91/07/08  22:40:45  danner]

Rearranged.
[89/08/16            hattori]
[ ./kernel/mach/luna88k/kern_return.h ]
Created
[91/07/08  22:39:30  danner]
[ ./kernel/mach/luna88k/syscall_sw.h ]
Created
[91/07/08  22:39:56  danner]
[ ./kernel/mach/luna88k/vm_param.h ]
Initial Checkin
[91/06/26  12:40:27  danner]
[ ./kernel/mach/machine.h ]
   Added CPU_SUBTYPE_LUNA88K
[91/05/06            danner]
[ ./kernel/scsi/adapters/scsi_89352.h ]
<<<log message for ./kernel/scsi/adapters/scsi_89352.h>>>
28,31c28
<  * $ Log:	MERGE_HISTORY,v $
<  * Revision 2.1  91/07/09  10:58:05  danner
<  * Created.
<  * 
---
>  * $ Log:	MERGE_HISTORY,v $

...
Created from the Fujitsu specs:
"SCSI Processor Manual MB89352", EM11-03319-2, Japan 1987,
and
"MB87033B SCSI Protocol Controller (SPC) With On-Chip Drivers/Receivers"
Fujitsu Limited, August 1989, Ed 1.0
and later from information in
"Fast Track to SCSI", Fujitsu
ISBN 0-13-307000-X, 1991 Prentice Hall, NJ
[91/07/09  10:59:31  danner]
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
3.0 SCSI Chip support for the Fujistu MB89352, the SCSI chip
 present on the Omron Luna88k motherboard. This chip is a first
 generation SCSI controller, and does not support synchronous SCSI.
[91/07/09            danner]

...
Created from the Fujitsu specs:
"SCSI Processor Manual MB89352", EM11-03319-2, Japan 1987,
and
"MB87033B SCSI Protocol Controller (SP) With On-Chip Drivers/Receivers"
Fujitsu Limited, August 1989, Ed 1.0
[91/07/09  10:56:03  danner]
[ ./kernel/scsi/rz.c ]
Added gross ifdef luna88k to use <sd.h> instead of <scsi.h>. Will
 be fixed as soon as I figure out the configuration tools.
[91/07/09            danner]

<<<log message for ./kernel/scsi/rz.c>>>
[91/07/09  11:05:28  danner]
[ ./kernel/scsi/rz_disk.c ]
Upgraded to support new label technology.
[91/07/09  11:15:50  danner]
[ ./kernel/scsi/rz_disk_bbr.c ]
Upgraded to new label technology.
[91/07/09  11:16:12  danner]
[ ./kernel/scsi/rz_labels.c ]
Created, splitting out DEC-specific code from rz_disk.c and
adding some more.
[91/06/26            af]
[ ./kernel/scsi/rz_labels.h ]
Support for DEC, BSD, Omron labels.
[91/07/09  11:15:23  danner]
[ ./kernel/scsi/scsi.c ]
Added gross luna88k ifdef to use <sd.h> instead of <scsi.h>. Will be
fixed when I understand how to use the configuration tools.
[91/07/09  11:08:15  danner]
[ ./kernel/scsi/scsi_defs.h ]
Added include of <scsi/rz_labels.h>
[91/07/09  11:16:30  danner]
[ ./kernel/sys/varargs.h ]
Added luna88k support.
[91/06/24            danner]
[ ./user/libmach/Makefile ]
Added LUNA88K cpp override.
[91/07/08  22:59:09  danner]
[ ./user/libmach/luna88k/_setjmp.h ]
Created. Incomplete
[91/07/08  23:01:08  danner]
[ ./user/libmach/luna88k/bcopy.c ]
Additions.
[91/07/08  23:01:44  danner]
[ ./user/libmach/setjmp.h ]
Added luna88k support, some missing comments.
[91/06/27            danner]
    
    
    
==========================================================================
   ***** MK Version MK57  (danner) *****
    
    
Bug fixes:
--- -----

Fixed Copyrights for mrt.

Built nowhere. Tested nowhere.

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
57
[ ./kernel/conf/Makefile.luna88k ]
Copyright Fixes
[ ./kernel/ddb/db_command.c ]
Copyright Fixes
[ ./kernel/ddb/db_run.h ]
Copyright Fixes
[ ./kernel/luna88k/ast.h ]
Copyright Fixes
[ ./kernel/luna88k/conf.c ]
Copyright Fixes
[ ./kernel/luna88k/cpu_number.h ]
Copyright Fixes
[ ./kernel/luna88k/genassym.c ]
Copyright Fixes
[ ./kernel/luna88k/mach_param.h ]
Copyright Fixes
[ ./kernel/luna88k/machparam.h ]
Copyright Fixes
[ ./kernel/luna88k/pcb.h ]
Copyright Fixes
[ ./kernel/luna88k/setroot.c ]
Copyright Fixes
[ ./kernel/luna88k/thread.h ]
Copyright Fixes
[ ./kernel/luna88k/time_stamp.h ]
Copyright Fixes
[ ./kernel/luna88k/ufs_machdep.c ]
Copyright Fixes
[ ./kernel/luna88k/varargs.h ]
Copyright Fixes
[ ./kernel/luna88k/vm_machdep.c ]
Copyright Fixes
[ ./kernel/mach/luna88k/thread_status.h ]
Copyright Fixes
[ ./kernel/mach/luna88k/vm_param.h ]
Copyright Fixes
[ ./kernel/mach/luna88k/vm_types.h ]
Copyright Fixes
[ ./kernel/scsi/adapters/scsi_89352.h ]
Copyright Fixes
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
Copyright Fixes
[ ./utils/mktree.sh ]
Copyright Fixes
    
    
    
==========================================================================
   ***** MK Version MK58  (rvb) *****
    
    
UX25 and MK58 have been built and tested together on
all 4 major(?) architectures,  i386, pmax, vax, sun3.
They can be built and they are consistent.

(Also we added a few minor changes.)
    
    
    
==========================================================================
   ***** MK Version MK59  (dbg) *****
    
    
New features:
--- --------

MiG changes:

    User-specified deallocate flag: use 'dealloc[]'.
    It's an argument in the sender but not in the receiver.
    
    Variable-length C strings now take up only as much space as
    necessary in the message.  Use 'c_string[maxlen]' to get this
    behavior, instead of '(MSG_TYPE_STRING_C, 8*maxlen)'.
    
    Variable-length array arguments passed from client to server
    will now be passed either in-line or out-of-line, depending
    on size.  To get this behavior, specify 'array[] of foo' (not
    out-of-line, no maximum size).  Specifying 'serverCopy' passes
    the inline/out-of-line flag through to the server; otherwise,
    out-of-line data is deallocated when the server procedure
    returns.
    
    (It doesn't handle returning data the same way.  The semantics
     are ugly and need more thought.  Use at your own risk.)

Kernel changes:

    vm_pageable() is gone.  It has been replaced by David Black's proposed
    vm_wire(host_port, task, start, size, protection) call.
    The thread_wire() call is also in, but doesn't quite work yet.

    The mach_debug interface has a call to load a symbol table into the kernel
    debugger: host_load_symbol_table(host, start, count, task).  It takes an
    arbitrary array of bytes whose format the loader and debugger agree on.
    If the task is specified, DDB will only look for these symbols when in
    the task.

    host_adjust_time() has been implemented - I copied the BSD code.
    Haven't tested it: the U*X server needs to call it.

    Memory_object_data_supply uses the new MiG feature to let the client
    supply the deallocate bit.

    Improved scheduling state machine.  Consolidates several thread state
    fields into one.

    There is a generic vm-object_map_pages routine to allocate pages mapping
    physical device memory.

    Thread-termination is quicker.  If a thread is at a known continuation,
    its state can be cleaned up immediately, without re-awakening the thread.

libmach and cthread changes:

    Both libraries build with GCC: use 'make CC=gcc'.

    VAX, SUN3 and i386 use GCC inline substitution for the cthread_sp(),
    spin_lock_try(), and spin_unlock() functions.

[Sequent]
   Supports microsecond timing.

[i386]
   The V8086 mode interrupt assist is in.

   There is a call to map a device's IO registers into a thread:
   i386_io_map.  It should eventually replace the ISA_PORT_MAP thread
   state and /dev/iopl.

   Context switching no longer has to copy registers between the stack
   and the PCB.

   Copyin/copyout use longword move if possible.

[sun3]
   Supports stack switching.


Bug fixes:
--- -----

Fixed time-out race condition.

Fixed scheduling problem: a thread could be suspended even though it
was sleeping uninterruptibly (e.g. grabbing a vm_map lock), hanging the
task and anyone trying to suspend it.

thread_handoff() now checks for the new thread being bound to another
processor.

thread_block(continuation) always resumes execution in the continuation.
Previously, if it decided to continue running the current thread, it
returned to the point of call even if a continuation was supplied.

The definitions of dev_name_t in the .h and .defs file now match.

[vax]
    Fixed switch_to_shutdown_context.

    Fixed the qd driver so that debugger output is visible even
    if X was running.


Organizational changes:
-------------- -------

Interrupt_stack_alloc() has been removed from kern/startup.c.
Not all multiprocessors need interrupt stacks.

pcb_module_init() is now called from thread_init(), not from machine-dependent
code.

All microsecond timing routines can now be defined in machine-dependent code.

Each machine's PCB module needs a new routine:
thread_set_syscall_return(thread_t, kern_return_t)
to make a thread return a kern_return value (typically MACH_RCV_INTERRUPTED)
from an aborted system call.

[VAX]
    The kernel is built with GCC by default.  A compiler and assembler
    that work are in the mach-7/release area: do
	setpath -ib /usr/misc /afs/cs/project/mach-7/release/@sys
	setenv GCC_EXEC_PREFIX /afs/cs/project/mach-7/release/@sys/lib/gcc-
    to get the compiler.
    
    (AS is a filter that strips the nesting depth off the
     '# file line nesting' lines that GCC produces, to keep
     the BSD assembler happy.)

[SUN3]
    The kernel is built with GCC by default.  A compiler and assembler
    that work are in the mach-7/release area: do
	setpath -ib /usr/misc /afs/cs/project/mach-7/release/@sys
	setenv GCC_EXEC_PREFIX /afs/cs/project/mach-7/release/@sys/lib/gcc-
    to get the compiler.
    
[Sequent]
    The Sequent code is publically distributable.



Special notes:
------- -----

The latest UX servers will run but NOT build with this release.
The calls to vm_pageable() must be removed.



******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
59
[ ./kernel/boot_ufs/def_pager_setup.c ]
Pass master host port to file_wire.
[91/07/30  16:37:07  dbg]
[ ./kernel/boot_ufs/file_io.c ]
Call vm_wire instead of vm_pageable.
[91/07/30  16:38:01  dbg]
[ ./kernel/boot_ufs/load.c ]
Replace blkclr with bzero.
[91/07/26            dbg]

Moved read_symtab_from_file here and made independent of load
format.
[91/06/25            dbg]

[ ./kernel/conf/MASTER.sun3 ]
Add rules for GCC.
[91/07/19            dbg]
[ ./kernel/conf/MASTER.vax ]
Remove 'sed' pass over assembler files - there's a filter that
does the same job.
[91/07/26            dbg]
[ ./kernel/conf/Makefile.i386 ]
Add rules for mach_i386.defs.
[91/07/30  16:39:42  dbg]
[ ./kernel/conf/Makefile.template ]
Removed vm_pageable.  Added mach_host functions to libmig.a.
[91/07/30  16:41:07  dbg]
[ ./kernel/conf/Makefile.vax ]
Remove GCC_ASM_SED - there's a filter that strips the offending
lines and invokes the BSD assembler.
[91/07/26            dbg]
[ ./kernel/conf/files ]
Added db_ext_symtab.c.
[91/07/30  16:41:37  dbg]
[ ./kernel/conf/files.i386 ]
Added mach_i386_server.c and io_map_interface.c.
[91/07/30  16:42:09  dbg]
[ ./kernel/conf/files.vax ]
Add blkops.s.
[91/07/26            dbg]
[ ./kernel/ddb/db_aout.c ]
Removed read_symtab_from_file.
Added task argument to X_db_sym_init.
[91/07/30  16:42:51  dbg]
[ ./kernel/ddb/db_ext_symtab.c ]
Created.
[91/07/30  16:43:20  dbg]
[ ./kernel/ddb/db_print.c ]
Revise scheduling state machine.
[91/07/30  16:43:42  dbg]
[ ./kernel/ddb/db_sym.c ]
Add task pointer and space for string storage to symbol table
descriptor.
[91/07/31            dbg]
[ ./kernel/ddb/db_sym.h ]
Add map pointer and storage for name to db_symtab_t.
[91/07/30  16:45:08  dbg]
[ ./kernel/device/cirbuf.c ]
Put CB_CHECK under debugging switch.
[91/07/30  16:45:34  dbg]
[ ./kernel/device/dev_name.c ]
Fixed to not modify the string passed in.
[91/07/23            dbg]
[ ./kernel/device/dev_pager.c ]
Use vm_object_page_map to allocate pages for a device-map object.
Its vm_page structures are allocated and freed by the VM system.
[91/07/30  16:46:43  dbg]
[ ./kernel/device/device_types.h ]
Fix dev_name_t to match definition in
device/device_types.defs.
[91/07/30  16:47:13  dbg]
[ ./kernel/device/subrs.c ]
Add strcpy.
[91/07/30  16:47:37  dbg]
[ ./kernel/i386/cswitch.s ]
Push user state directly in PCB and switch to kernel stack on
trap entry.
[91/07/30  16:48:18  dbg]
[ ./kernel/i386/db_interface.c ]
Registers are in different locations on keyboard interrupt.
[91/07/30  16:48:52  dbg]
[ ./kernel/i386/exec.c ]
Changed get_symtab to copy out the size of the symbol table and
return the symbol table size + string table size.
[91/07/31            dbg]
[ ./kernel/i386/genassym.c ]
Add microsecond timing.

Save user registers in PCB and switch to separate kernel stack
on entry.
[91/07/30  16:50:29  dbg]
[ ./kernel/i386/hardclock.c ]
New interrupt save area.
[91/07/30  16:50:59  dbg]
[ ./kernel/i386/idt.s ]
Save fewer registers on interrupt entry.
[91/07/30  16:51:33  dbg]
[ ./kernel/i386/interrupt.s ]
Support separate interrupt stack.  Interrupt handler may now be
called from different places.
[91/07/30  16:52:19  dbg]
[ ./kernel/i386/io_map_interface.c ]
Created.
[91/07/30  16:52:44  dbg]
[ ./kernel/i386/locore.s ]
Add microsecond timing.

Save user regs directly in PCB on trap, and switch to separate
kernel stack.

Make copyin and copyout use longword move if possible.
[91/07/30  16:53:39  dbg]
[ ./kernel/i386/mp_desc.c ]
Move interrupt-stack allocation for multiprocessors here.
[91/07/30  16:54:10  dbg]
[ ./kernel/i386/pcb.c ]
Add thread_set_syscall_return.

Save user regs directly in PCB on trap, and switch to separate
kernel stack.

Add v8086 mode interrupt support.
[91/07/30  16:56:09  dbg]
[ ./kernel/i386/sched_param.h ]
Created.
[91/07/30  16:56:40  dbg]
[ ./kernel/i386/start.s ]
Add pointers to interrupt stack (for uniprocessor).
[91/07/30  16:57:13  dbg]
[ ./kernel/i386/thread.h ]
Save user regs directly in PCB on trap, and switch to separate
kernel stack.

Add fields for v86 interrupt simulation.
[91/07/30  16:58:18  dbg]
[ ./kernel/i386/timer.h ]
Created.
[91/07/30  16:58:38  dbg]
[ ./kernel/i386/trap.c ]
Separate user and kernel trap cases.  Combine user and v86-mode
trap cases (except for calling instruction assist).

New v86 interrupt simulation.

Check for two copyout failure locations.
[91/07/30  17:01:10  dbg]
[ ./kernel/i386at/model_dep.c ]
Remove call to pcb_module_init (in machine-independent code).
[91/07/26            dbg]
[ ./kernel/i386ipsc/model_dep.c ]
Remove call to pcb_module_init (in machine-independent code).
[91/07/26            dbg]
[ ./kernel/i386ipsc/pic_ipsc.c ]
Changed hardclock for stack_switching support.
[91/07/29            dbg]
[ ./kernel/ipc/mach_msg.c ]
Add mach_msg_interrupt to force a thread waiting in mach_msg_continue
or mach_msg_receive_continue into a stable state.
[91/07/30  17:02:11  dbg]
[ ./kernel/kern/bootstrap.c ]
Pass host port to boot_load_program and read_emulator_symbols.
[91/07/30  17:02:40  dbg]
[ ./kernel/kern/debug.c ]
Minor SUN changes.
[91/07/12            dbg]
[ ./kernel/kern/ipc_sched.c ]
Check for new thread bound to wrong processor in thread_handoff.
[91/07/25            dbg]

Fix timeout race.
[91/05/23            dbg]

Revise scheduling state machine.
[91/05/22            dbg]
[ ./kernel/kern/mach_clock.c ]
Fixed timeout race.  Implemented host_adjust_time.
[91/07/30  17:03:54  dbg]
[ ./kernel/kern/machine.c ]
Removed interrupt_stack - it's machine-dependent.
[91/07/26            dbg]
[ ./kernel/kern/sched_prim.c ]
When re-invoking the running thread (thread_block, thread_run):
. Mark the thread interruptible.
. If there is a continuation, call it instead of returning.
[91/07/26            dbg]

Fix timeout race.
[91/05/23            dbg]

Revised scheduling state machine.
[91/05/22            dbg]
[ ./kernel/kern/startup.c ]
Remove interrupt_stack_alloc - not all multiprocessors use it.

Revised scheduling state machine.
[91/07/30  17:05:11  dbg]
[ ./kernel/kern/syscall_subr.c ]
Fix timeout race.
[91/07/30  17:05:37  dbg]
[ ./kernel/kern/thread.c ]
Call pcb_module_init from thread_init.
[91/07/26            dbg]

When halting a thread: if it is waiting at a continuation with a
known cleanup routine, call the cleanup routine instead of
resuming the thread.
[91/06/21            dbg]

Revise scheduling state machine.
[91/05/22            dbg]

Add thread_wire.
[91/05/14            dbg]
[ ./kernel/kern/thread.h ]
Consolidated interruptible, swap_state, halted into state field.
Revised state machine.
[91/07/30  17:06:37  dbg]
[ ./kernel/kern/thread_swap.c ]
Revise scheduling state machine.
[91/07/30  17:07:03  dbg]
[ ./kernel/kern/thread_swap.h ]
Merge remaining swap states with state field in thread.
[91/07/30  17:07:30  dbg]
[ ./kernel/kern/time_out.h ]
Fix race condition.
[91/07/30  17:08:00  dbg]
[ ./kernel/kern/timer.c ]
Allow all routines to be defined in machine-dependent code.
[91/07/30  17:08:39  dbg]
[ ./kernel/mach/i386/mach_i386.defs ]
Created.
[91/07/30  17:09:09  dbg]
[ ./kernel/mach/i386/thread_status.h ]
Add V86 mode interrupt assist.
[91/07/30  17:09:37  dbg]
[ ./kernel/mach/mach.defs ]
Added user-settable 'dealloc' flag to data argument of
memory_object_data_supply.  Needs new MiG.
USERS OF THIS FUNCTION MUST RE-LINK!!
[91/07/29            dbg]

MACH_IPC_COMPAT: set C type for backup argument to
port_set_backup to be 'mach_port_t'.  If mach_interface.h is
included with MACH_IPC_COMPAT == 0, the type 'port_t' is not
defined.

Removed vm_pageable.
[91/06/24            dbg]
[ ./kernel/mach/mach_host.defs ]
Add vm_wire and thread_wire.
[91/07/30  17:10:17  dbg]
[ ./kernel/mach/machine.h ]
Remove declaration of interrupt_stack - it is machine-dependent.
Changed CPU_SUBTYPE_LUNA88K - there's already a (potential)
mc88000 port.
[91/07/26            dbg]
[ ./kernel/mach/sun3/reg.h ]
Fix typedefs with no name for ANSI C.
Remove unused definitions for integer register save area.
[91/07/19            dbg]
[ ./kernel/mach/sun3/syscall_sw.h ]
Fixes for ANSI C preprocessor.
[91/07/23            dbg]
[ ./kernel/mach/vax/syscall_sw.h ]
Fixes for ANSI and GNU C preprocessors.
[91/07/23            dbg]
[ ./kernel/mach_debug/mach_debug.defs ]
Added host_load_symbol_table.
[91/07/30  17:11:15  dbg]
[ ./kernel/mach_debug/mach_debug_types.defs ]
Add symtab_name_t.
[91/07/30  17:11:38  dbg]
[ ./kernel/mach_debug/mach_debug_types.h ]
Add symtab_name_t.
[91/07/30  17:12:01  dbg]
[ ./kernel/mips/autoconf.c ]
Moved call to pcb_module_init to machine-independent code.
[91/07/26            dbg]
[ ./kernel/mips/db_mips_sym.c ]
Added X_db_sym_init.
[91/07/29            dbg]
[ ./kernel/mips/exec.c ]
Added get_symtab.
[91/07/29            dbg]
[ ./kernel/mips/pcb.c ]
Add thread_set_syscall_return.
[91/07/26            dbg]
[ ./kernel/sqt/SGSmem.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/SGSproc.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/asm_macros.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/autoconf.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/bdp.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/bic.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/buscycles.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/cfg.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/chiptypes.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/clkarb.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/clock.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/clock.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/consio.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/engine.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/hwparam.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/intctl.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/interrupt.s ]
Changed copyright.

Call interrupt routine, since we may be on a different stack.
[91/05/22            dbg]
[ ./kernel/sqt/ioconf.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/macros.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/memory.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/misc.s ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/model_dep.c ]
Changed copyright.

Removed call to pcb_module_init (now called from
machine-independent code).
[91/07/26            dbg]

Call interrupt_stack_alloc.
[91/06/27            dbg]
[ ./kernel/sqt/mutex.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/mutex.s ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/sema.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/setconf.c ]
Changed copyright.
Moved root_name string out of text segment.
[91/07/31            dbg]
[ ./kernel/sqt/slic.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/slic.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/slicreg.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/spl.s ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/sqtasm.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/sqtparam.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/stubs.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/trap.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqt/vm_defs.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtconf/conf.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtconf/conf_co.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtconf/conf_if_se.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtconf/conf_led.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtconf/conf_sd.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtconf/conf_vec.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtconf/conf_zd.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtconf/sqt_io_conf.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtconf/sqtparam.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtmbad/ioconf.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtsec/co.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtsec/co.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtsec/if_se.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtsec/if_se.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtsec/ioconf.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtsec/scsi.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtsec/sd.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtsec/sd.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtsec/sec.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtsec/sec.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtsec/sec_ctl.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtzdc/ioconf.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtzdc/zd.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtzdc/zdbad.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtzdc/zdc.h ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/sqtzdc/zdinit.c ]
Changed copyright.
[91/07/31            dbg]
[ ./kernel/src/mig/lexxer.l ]
Add 'serverCopy' keyword.
[91/06/05            dbg]

Add 'c_string' keyword.
[91/04/03            dbg]
[ ./kernel/src/mig/mig.sh ]
Allow both -header and -sheader switches.
Fix copyright.
[91/07/30  17:14:28  dbg]
[ ./kernel/src/mig/parser.y ]
Allow 'dealloc[]' to mean user-specified deallocate flag.

Added c_string.
[91/04/03            dbg]
[ ./kernel/src/mig/routine.c ]
Support indefinite-length (inline or out-of-line) variable
arrays.
[91/04/10            dbg]

Change argDeallocate to an enumerated type, to allow for
user-specified deallocate flag.

Special handling for varying C_Strings in rtAddCountArg.

Add rtCheckMaskFunction.  Add rtNoReplyArgs to routine
structure.
[91/04/03            dbg]
[ ./kernel/src/mig/routine.h ]
Add akbIndefinite, argServerCopy.
[91/04/10            dbg]

Change argDeallocate to an enumerated type, to allow for
user-specified deallocate flag.

Add rtCheckMaskFunction.  Add rtNoReplyArgs to routine
structure.
[91/04/03            dbg]
[ ./kernel/src/mig/server.c ]
Allow indefinite-length variable arrays.  They may be copied
either in-line or out-of-line, depending on size.

Copy variable-length C Strings with mig_strncpy, to combine
'strcpy' and 'strlen' operations.

New method for advancing request message pointer past
variable-length arguments.  We no longer have to know the order
of variable-length arguments and their count arguments.

Remove redundant assignments (to msgh_simple, msgh_size) in
generated code.
[91/07/17            dbg]
[ ./kernel/src/mig/type.c ]
Indefinite-length inline arrays.

Change itDeallocate to an enumerated type, to allow for
user-specified deallocate flag.

Add itCStringDecl.
[91/07/17            dbg]
[ ./kernel/src/mig/type.h ]
Add flServerCopy.
[91/06/05            dbg]

Add itIndefinite.
[91/04/10            dbg]

Change itDeallocate to an enumerated type, to allow for
user-specified deallocate flag.

Add itCStringDecl.
[91/04/03            dbg]
[ ./kernel/src/mig/user.c ]
Allow indefinite-length variable arrays.  They may be copied
either in-line or out-of-line, depending on size.

Copy variable-length C Strings with mig_strncpy, to combine
'strcpy' and 'strlen' operations.

New method for advancing request message pointer past
variable-length arguments.  We no longer have to know the order
of variable-length arguments and their count arguments.

Remove redundant assignments (to msgh_simple, msgh_size) in
generated code.
[91/07/17            dbg]
[ ./kernel/src/mig/utils.c ]
Accept new dealloc_t argument type in WriteStaticDecl,
WritePackMsgType.

Don't need to zero last character of C string.  Mig_strncpy does
the proper work.

Add SkipVFPrintf, so that WriteCopyType doesn't print fields in
comments.
[91/07/17            dbg]
[ ./kernel/sun/exec.c ]
Changed get_symtab to copy out the size of the symbol table and
return the symbol table size + string table size.
[91/07/31            dbg]
[ ./kernel/sun3/asm_linkage.h ]
Changes for stack switching, GCC.
[91/06/18            dbg]
[ ./kernel/sun3/clock.h ]
Added volatile declarations.
[91/07/23            dbg]
[ ./kernel/sun3/cpu.h ]
Remove cpu_number and related definitions.
[91/07/19            dbg]
[ ./kernel/sun3/cswtch.s ]
Support stack switching.
[91/03/25            dbg]
[ ./kernel/sun3/db_interface.c ]
Stack switching support.
[91/07/12            dbg]
[ ./kernel/sun3/db_machdep.h ]
Changed register save area name.
[91/07/12            dbg]
[ ./kernel/sun3/db_trace.c ]
Stack switching support.
[91/07/12            dbg]
[ ./kernel/sun3/genassym.c ]
Define 'volatile' as empty string for pre-ANSI compilers.
[91/07/19            dbg]

Added support for stack switching.
[91/07/12            dbg]
[ ./kernel/sun3/interreg.h ]
Declared 'volatile'.
[91/07/23            dbg]
[ ./kernel/sun3/locore.s ]
Stack switching support.
[91/03/25            dbg]
[ ./kernel/sun3/machparam.h ]
Update inline spl macros for latest version of GCC.
[91/07/23            dbg]
[ ./kernel/sun3/map.s ]
ANSI C preprocessor fixes.
[91/07/19            dbg]
[ ./kernel/sun3/pcb.c ]
Add stack_switching support.
[91/03/25            dbg]
[ ./kernel/sun3/pmap.c ]
pmap_activate and pmap_deactivate are unnecessary.
[91/07/15            dbg]
[ ./kernel/sun3/pmap.h ]
Separated user and kernel cases of PMAP_ACTIVATE
and PMAP_DEACTIVATE.
[91/07/30  17:18:36  dbg]
[ ./kernel/sun3/reg.h ]
Fix typedefs with no name for ANSI C.
[91/07/19            dbg]
[ ./kernel/sun3/setroot.c ]
Move root_name string out of text segment for ANSI C.
[91/07/23            dbg]
[ ./kernel/sun3/thread.h ]
Support stack switching.
[91/03/25            dbg]
[ ./kernel/sun3/trap.c ]
Support stack switching.
[91/03/25            dbg]
[ ./kernel/sundev/bwtwo.c ]
Fixed typo in include file list.
Fixes for ANSI C.
[91/07/19            dbg]
[ ./kernel/sundev/cgfour.c ]
Fixes for ANSI C.
[91/07/19            dbg]
[ ./kernel/sundev/cgtwo.c ]
Replace splx(pritospl(...)) with splpri().
[91/07/23            dbg]
[ ./kernel/sundev/kbd.c ]
Fixes for ANSI C.
[91/07/19            dbg]
[ ./kernel/sundev/mb.c ]
Replace splx(pritospl(...)) with splpri().
[91/07/23            dbg]
[ ./kernel/sundev/sc.c ]
Replace splx(pritospl(...)) with splpri().
[91/07/23            dbg]

Fixes for ANSI C.
[91/07/19            dbg]
[ ./kernel/sundev/scsi.h ]
Fixes for ANSI C.
[91/07/19            dbg]
[ ./kernel/sundev/sd.c ]
Replace splx(pritospl(...)) with splpri().
[91/07/23            dbg]

Fixes for ANSI C.
[91/07/19            dbg]
[ ./kernel/sundev/si.c ]
Replace splx(pritospl(...)) with splpri().
[91/07/23            dbg]

Fixes for ANSI C.
[91/07/19            dbg]
[ ./kernel/sundev/st.c ]
Replace splx(pritospl(...) with splpri().
[91/07/23            dbg]

Fixes for ANSI C.
[91/07/23            dbg]
[ ./kernel/sundev/vuid_event.h ]
Fixed for ANSI C.
[91/07/19            dbg]
[ ./kernel/sundev/xy.c ]
Replace splx(pritospl(...)) with splpri().
[91/07/23            dbg]
[ ./kernel/sundev/zs_asm.s ]
ANSI C preprocessor fixes.
[91/07/19            dbg]
[ ./kernel/sunif/if_subr.c ]
Update to latest version of GCC.
[91/07/23            dbg]
[ ./kernel/vax/blkops.s ]
Created.
[91/07/26            dbg]
[ ./kernel/vax/conf.c ]
Correct an '#ifdef' to an '#if'.
[91/07/30  17:22:22  dbg]
[ ./kernel/vax/exec.c ]
Changed get_symtab to copy out the size of the symbol table and
return the symbol table size + string table size.
[91/07/31            dbg]
[ ./kernel/vax/gcc_asm.h ]
Make bcopy and bzero handle sizes over 64K, so that we can
eliminate blkcpy and blkclr.
[91/07/26            dbg]
[ ./kernel/vax/locore.s ]
Fix switch_to_shutdown_context.
[91/07/30  17:23:35  dbg]
[ ./kernel/vax/model_dep.c ]
Allocate interrupt stacks here for multiprocessors.
Remove call to pcb_module_init.
Replace blkclr with bzero.
[91/07/25            dbg]
[ ./kernel/vax/pcb.c ]
Add thread_set_syscall_return.
[91/07/30  17:24:07  dbg]
[ ./kernel/vaxuba/qd.c ]
Fix up screen when entering debugger if graphics device open;
restore it when exiting.  Settings are correct for X11 R4.
[91/07/30  17:25:16  dbg]
[ ./kernel/vm/memory_object.c ]
Removed explicit data_dealloc argument to
memory_object_data_supply.  MiG now handles a user-specified
dealloc flag.
[91/07/29            dbg]
[ ./kernel/vm/vm_object.c ]
Add vm_object_page_map, to attach a set of physical pages to an
object.
[91/07/30  17:26:58  dbg]
[ ./kernel/vm/vm_resident.c ]
Redefine 'private' to mean private memory, not private page
structure.  Calling vm_page_free on a private page frees the
page structure but not the page.
[91/07/30  17:27:50  dbg]
[ ./kernel/vm/vm_user.c ]
Change vm_pageable to vm_wire.  Require host_priv port to gain
wiring privileges.
[91/07/30  17:28:22  dbg]
[ ./user/libmach/Makefile ]
Add mach_debug interface.
[91/07/30  17:28:54  dbg]
[ ./user/libmach/i386/asm.h ]
Changes for STDC (from kernel version).
[91/07/30  17:29:23  dbg]
[ ./user/libmach/i386/crt0.c ]
Fix for ANSI C.
[91/07/30  17:29:44  dbg]
[ ./user/libmach/mig_strncpy.c ]
Changed to return the length of the string, including
the trailing 0.
[91/07/25            dbg]
[ ./user/libmach/sun3/DEFS.h ]
Fixes for standard C.
[91/07/23            dbg]
[ ./user/libmach/sun3/crt0.s ]
Fixes for ANSI C preprocessor.
[91/07/23            dbg]
[ ./user/libmach/vax/DEFS.h ]
Fixes for standard C.
[91/07/30  17:30:34  dbg]
[ ./user/libmach/vax/crt0.cc ]
Fixes for ANSI C and GCC inline assembler.
[91/07/30  17:31:03  dbg]
[ ./user/threads/Makefile ]
Directly compile C files if INLINE is null (depends
on the machine).
Remove IBMRT-dependent fiddling for malloc.
[91/07/30  17:32:13  dbg]
[ ./user/threads/cprocs.c ]
Fix some more bad types.  Ints are NOT pointers.

Fix argument type mismatch in cproc_create.
[91/07/30  17:32:59  dbg]
[ ./user/threads/cthread_internals.h ]
Protect against redefinition of ASSERT.
[91/07/30  17:33:21  dbg]
[ ./user/threads/cthreads.c ]
Fix bad self-pointer reference.

Don't declare _setjmp and _longjmp; they are included by
cthreads.h.
[91/07/30  17:33:50  dbg]
[ ./user/threads/cthreads.h ]
Fix the standard-C conditional: it's __STDC__.

Allow for macro-redefinition of cthread_sp, spin_try_lock,
spin_unlock (from machine/cthreads.h).
[91/07/30  17:34:28  dbg]
[ ./user/threads/i386/asm.h ]
Changes for STDC (from kernel version).
[91/07/30  17:34:54  dbg]
[ ./user/threads/i386/csw.s ]
Fix for ANSI C preprocessor.
[91/07/30  17:35:16  dbg]
[ ./user/threads/i386/cthreads.h ]
Add inline substitution for cthread_sp, spin_unlock,
spin_try_lock.
[91/07/30  17:35:53  dbg]
[ ./user/threads/i386/thread.c ]
Undefine cthread_sp macro around function definition.
[91/07/30  17:36:23  dbg]
[ ./user/threads/stack.c ]
Fix some bad stack references (stack direction).
[91/07/30  17:36:50  dbg]
[ ./user/threads/sun3/cthreads.h ]
Add inline substitution for cthread_sp, spin_unlock,
spin_try_lock.
[91/07/23            dbg]
[ ./user/threads/sun3/thread.c ]
Undefine cthread_sp macro around function definition.
[91/07/23            dbg]
[ ./user/threads/vax/cthreads.h ]
Add inline substitution for cthread_sp, spin_unlock,
spin_try_lock.
[91/07/25            dbg]
[ ./user/threads/vax/thread.c ]
Undefine cthread_sp macro around function.
[91/07/25            dbg]
[ ./user/threads/vax/thread.c ]
Let this file still compile with PCC.
[91/08/01            dbg]
[ ./kernel/sun3/trap.c ]
Restore thread_should_halt test to exit path of
user_page_fault_continue.  Fix user single-step handling.
[91/08/01            dbg]
[ ./kernel/conf/files ]
Add mach_machine_routines.h options file.
[91/08/01            dbg]
[ ./kernel/conf/MASTER.i386 ]
Define mach_machine_routines to call mach_i386_server.
[91/08/01            dbg]
[ ./kernel/i386/machine_routines.h ]
Created.
[91/08/01            dbg]
[ ./kernel/kern/ipc_kobject.c ]
Call machine-dependent interface routine, under
MACH_MACHINE_ROUTINES.
[91/08/01            dbg]
[ ./kernel/conf/MASTER.sun3 ]
Make GCC build standard.
[91/08/01            dbg]
[ ./kernel/conf/MASTER.vax ]
Make GCC build standard.
[91/08/01            dbg]
[ ./kernel/conf/MASTER.i386 ]
Add microsecond timing to Sequent configuration.
[91/08/01            dbg]
    
    
    
==========================================================================
   ***** MK Version MK60  (jsb) *****
    
    
New features:
--- --------

NORMA IPC works over ethernet, using retransmission when necessary.
It's built on top of the device/net_io.c interface to the ethernet
drivers, so no driver modification is necessary.

Removed the infamous line 122 from cthreads.h (the nested comment
(that wasn't really a nested comment).

Completed conversion to new page lists.

Removed norma_get_{host,host_priv,device}_port;
Use norma_{get,set}_special_port instead, combined with
mach/norma_special_ports.h.

Added ``show msg'' and ``show kmsg'' ddb commands.

``Show all threads'' now prints continuation names instead of ``(swapped)''.

Added an IO_LOANED flag for io_requests which are created with valid data
(and thus device_write_get should leave them alone) and which should be
returned directly via (*ior->io_done)() (instead of awakening a thread to
do so).

Organizational changes:
-------------- -------

Eliminated NORMA_BOOT conditional; replaced uses with either preexisting
NORMA_IPC conditional or new NORMA_DEVICE conditional. NORMA_DEVICE
allows nodes to access remote devices and provides a unified device
name space across all nodes. Among other things, this automatically
allows diskless nodes to boot by using a remote device, which is why
it used to be included under the NORMA_BOOT conditional.

Added a new option, norma_ether, for ethernet support for NORMA IPC.

Log Messages:
--- --------

[ ./conf/version.edit ]
60
[ ./kernel/ipsc/node.c ]
Defuncted.
[ ./kernel/ipsc/dcmcom.c ]
Defuncted.
[ ./kernel/norma/clport_ether.c ]
Defuncted.
[ ./kernel/norma/ipc_defs.h ]
Defuncted.
[ ./kernel/norma/ipc_packet.h ]
Defuncted.
[ ./kernel/norma/ipc_port.h ]
Defuncted.
[ ./kernel/norma/ipc_vm.c ]
Defuncted.
[ ./kernel/conf/MASTER ]
Replaced NORMA_BOOT with more specific NORMA_DEVICE.
[91/07/27  18:24:47  jsb]

Added NORMA_ETHER option.
[91/07/24  22:34:52  jsb]
[ ./kernel/conf/files ]
Replaced NORMA_BOOT with NORMA_DEVICE.
[91/07/27  18:25:13  jsb]

NORMA_IPC: added norma/ipc_net.c.
NORMA_ETHER: added norma/ipc_ether.c.
[91/07/24  22:43:57  jsb]

Removed norma/ipc_vm.c (functionality moved to vm/vm_map.c).
[91/07/04  09:53:11  jsb]
[ ./kernel/conf/files.i386 ]
ipsc/dev_forward_name.c now triggered by norma_device.
[91/07/27  18:18:36  jsb]
[ ./kernel/ddb/db_command.c ]
Added `show kmsg' and `show msg'.
Replaced NORMA_BOOT conditionals with NORMA_IPC.
Use _node_self instead of node_self() for prompt,
since node_self() will panic if _node_self not intialized.
[91/07/24  22:48:48  jsb]
[ ./kernel/ddb/db_print.c ]
In db_print_thread, if the thread is swapped and there is a
continuation function, print the function name in parentheses
instead of '(swapped)'.
[91/07/04  09:59:27  jsb]
[ ./kernel/device/dev_pager.c ]
Corrected declaration of xmm_vm_object_lookup.
[91/07/17  13:54:47  jsb]
[ ./kernel/device/device_init.c ]
Removed NORMA hooks.
[91/07/17  23:06:14  jsb]
[ ./kernel/device/ds_routines.c ]
Device_write_get doesn't need to do anything for loaned ior's.
[91/08/02  12:13:15  jsb]

Create the right flavor of copy object in ds_read_done.
Replace NORMA_BOOT conditionals with NORMA_DEVICE.
Free loaned ior's directly in iodone().
[91/07/27  22:45:09  jsb]
[ ./kernel/device/if_ether.h ]
Protected against multiple inclusion.
[91/07/24  22:57:01  jsb]
[ ./kernel/device/io_req.h ]
Added IO_LOANED flag, initially for norma_ipc support.
Loaned ior's are returned directly at interrupt level;
see iodone() for details.
[91/07/27  22:28:29  jsb]
[ ./kernel/device/net_io.c ]
Added NORMA_ETHER support.
[91/07/24  22:54:41  jsb]
[ ./kernel/i386ipsc/autoconf.c ]
Eliminated call to ask_bootstrap_server.
Only call ask_root_device if RB_ASKNAME.
Split dcm_init call into dcm_init_{send,recv}.
[91/07/25  18:38:51  jsb]
[ ./kernel/i386ipsc/cnp/if_cnp.c ]
Added cnpintr_count, and code in cnpintr to set unit to zero
when cnpintr is actually called from an interrupt.
[91/07/17  13:56:50  jsb]
[ ./kernel/i386ipsc/dcm.h ]
Removed PHYSADDR definition.
[91/07/24  22:59:34  jsb]
[ ./kernel/i386ipsc/dcm_input.c ]
Moved all device independent code to norma/ipc_net.c.
[91/07/25  18:30:13  jsb]
[ ./kernel/i386ipsc/dcm_output.c ]
Added setting of size field in dcm_header for i860ipsc support.
[91/07/27  19:04:34  jsb]

Moved all device independent code to norma/ipc_net.c.
[91/07/25  18:30:44  jsb]
[ ./kernel/i386ipsc/dcm_route.s ]
Removed dcm_send_k, dcm_send_a. Changed send_chan_* to dcm_send_chan_*.
[91/07/24  23:18:30  jsb]

Changed for rename of recv_chan to dcm_recv_chan.
[91/07/17  23:26:00  jsb]

Added dcm_send_a; added outb_dx, outw_dx, outb_i macros.
[91/07/17  13:58:26  jsb]
[ ./kernel/i386ipsc/model_dep.c ]
Force RB_ASKNAME into boothowto, since we cannot do so at boot time.
[91/07/25  18:40:17  jsb]

Added node_self(), _node_self.
[91/07/24  23:15:52  jsb]
[ ./kernel/i386ipsc/pic_ipsc.c ]
Added cnpintr.
[91/07/17  13:59:08  jsb]
[ ./kernel/ipc/ipc_init.c ]
Removed call to ipc_clport_init.
[91/07/24  22:11:04  jsb]
[ ./kernel/ipc/ipc_kmsg.c ]
Added support for ddb commands ``show msg'' and ``show kmsg''.
Made changes for elimination of intermediate clport structure.
[91/07/27  22:25:06  jsb]

Moved MACH_MSGH_BITS_COMPLEX_{PORTS,DATA} to mach/message.h.
Removed complex_data_hint_xxx[] garbage.
Adopted new vm_map_copy_t page_list technology.
[91/07/04  13:09:45  jsb]
[ ./kernel/ipc/ipc_kmsg.h ]
NORMA_IPC: added ikm_page field to struct ipc_kmsg.
[91/07/17  14:01:38  jsb]
[ ./kernel/ipc/ipc_mqueue.c ]
Renamed replenish routine.
[91/08/01  23:00:06  jsb]

Removed obsolete include.
Added option, timeout parameters to ipc_clport_send.
[91/07/17  14:04:15  jsb]
[ ./kernel/ipc/ipc_port.c ]
Call norma_ipc_destroy when destroying port.
Added clport fields to ipc_port_print.
[91/07/24  22:14:01  jsb]

Fixed include. Changed clport field initialization.
[91/07/17  14:05:38  jsb]
[ ./kernel/ipc/ipc_port.h ]
Fixed include. Added clport fields directly to struct ipc_port.
[91/07/17  14:06:25  jsb]
[ ./kernel/ipsc/dcmcom.h ]
Added size field to dcm_header for i860ipsc support.
[91/07/27  19:03:12  jsb]

Simplified.
[91/07/25  16:45:08  jsb]
[ ./kernel/ipsc/dev_forward_name.c ]
Removed norma conditionals; use conf/file technology instead.
[91/07/27  18:16:09  jsb]
[ ./kernel/kern/bootstrap.c ]
Moved bootstrap query earlier. Removed all NORMA specific code.
[91/07/25  18:25:35  jsb]
[ ./kernel/kern/debug.c ]
Replaced obsolete NORMA tag with NORMA_IPC.
[91/07/27  18:13:01  jsb]
[ ./kernel/kern/ipc_host.c ]
Removed NORMA hooks.
[91/07/17  23:05:10  jsb]
[ ./kernel/kern/ipc_mig.c ]
Corrected comment for mach_msg_send_from_kernel.
[91/07/04  10:08:23  jsb]
[ ./kernel/kern/mach_clock.c ]
NORMA_IPC: added call to netipc_timeout in hardclock.
[91/07/24  22:30:22  jsb]
[ ./kernel/kern/startup.c ]
Changed NORMA specific startup again.
[91/07/24  22:32:51  jsb]
[ ./kernel/mach/mach_norma.defs ]
Removed norma_get_{host,host_priv,device}_port;
Use norma_{get,set}_special_port instead.
[91/07/25  07:51:11  jsb]
[ ./kernel/mach/message.h ]
Added MACH_MSGH_BITS_COMPLEX_{PORTS,DATA}.
[91/07/04  12:38:13  jsb]
[ ./kernel/mach/norma_special_ports.h ]
First checkin.
[91/07/25  07:52:36  jsb]
[ ./kernel/norma/ipc_ether.c ]
Restructured to work with completely unmodified ethernet driver.
Added code to automatically find a usable ethernet device.
Removed NODE_BY_SUBNET case. Perform initialization earlier.
[91/08/02  14:21:08  jsb]

Use IO_LOANED technology.
[91/07/27  22:56:42  jsb]

Added fragmentation.
[91/07/27  18:54:37  jsb]

First checkin.
[91/07/24  23:38:03  jsb]
[ ./kernel/norma/ipc_ether.h ]
Made netipc_udpip_header field names more regular.
[91/07/27  18:59:59  jsb]

First checkin.
[91/07/24  23:37:33  jsb]
[ ./kernel/norma/ipc_input.c ]
Use MACH_MSGH_BITS_COMPLEX_DATA instead of null msgid to determine
whether data follows kmsg.
[91/08/01  21:57:37  jsb]

Eliminated remaining old-style page list code.
Cleaned up and corrected clport_deliver_page.
[91/07/27  18:47:08  jsb]

Moved MACH_MSGH_BITS_COMPLEX_{PORTS,DATA} to mach/message.h.
[91/07/04  13:10:48  jsb]

Use vm_map_copy_t's instead of old style page_lists.
Still need to eliminate local conversion between formats.
[91/07/04  10:18:11  jsb]
[ ./kernel/norma/ipc_kserver.c ]
Replaced spldcm/splx with sploff/splon.
[91/07/28  20:52:22  jsb]

Removed obsolete includes and vm and kmsg munging operations.
[91/07/17  14:14:11  jsb]

Moved MACH_MSGH_BITS_COMPLEX_{PORTS,DATA} to mach/message.h.
[91/07/04  13:12:09  jsb]

Use vm_map_copy_t page_lists instead of old style page_lists.
[91/07/04  10:20:35  jsb]
[ ./kernel/norma/ipc_net.c ]
Fiddled splon/sploff definitions. Removed another printf.
[91/08/02  14:30:57  jsb]

Many many changes.
[91/08/01  22:59:24  jsb]

Small protocol bug fixes. Removed bogus kv_addr usage.
[91/07/27  18:56:52  jsb]

First checkin.
[91/07/24  22:55:43  jsb]
[ ./kernel/norma/ipc_net.h ]
First checkin.
[91/07/27  19:00:39  jsb]
[ ./kernel/norma/ipc_output.c ]
Merged into norma/ipc_net.c. At some point I will move all output
related functions from norma/ipc_net.c back into here.
[91/08/01  22:04:59  jsb]

Cleaned up and corrected handling of out-of-line data.
Eliminated remaining old-style page list code.
[91/07/27  18:51:30  jsb]

Moved MACH_MSGH_BITS_COMPLEX_{PORTS,DATA} to mach/message.h.
[91/07/04  13:11:39  jsb]

Confined complex_data_hint garbage to just this file.
[91/07/04  10:22:22  jsb]
[ ./kernel/norma/ipc_wait.c ]
Fixed include.
[91/07/17  14:06:39  jsb]
[ ./kernel/norma/ipc_xxx.c ]
Conditionalized printfs.
[91/08/01  22:55:17  jsb]

Eliminated dynamically allocated clport structures; this information
is now stored in ports directly. This simplifies issues of allocation
at interrupt time.

Added definitions for IP_CLPORT_{NODE,LID} appropriate for using the
low two bytes of an internet address as a node number.

Revised norma_special_port mechanism to better handle port death
and port replacement. Eliminated redundant special port calls.
Cleaned up associated startup code.
[91/07/25  19:09:16  jsb]
[ ./kernel/norma/xmm.c ]
Renamed xmm_init() to norma_vm_init().
[91/07/24  23:25:57  jsb]
[ ./kernel/norma/xmm_server.c ]
Changed mach_port_t to ipc_port_t whereever appropriate.
[91/07/17  14:07:08  jsb]
[ ./kernel/norma/xmm_svm.c ]
Added missing type cast.
[91/07/17  14:07:46  jsb]
[ ./kernel/vm/memory_object.c ]
For now, use memory_object_data_supply iff NORMA_IPC.
[91/07/04  13:14:50  jsb]
[ ./kernel/vm/vm_map.c ]
Removed vm_map_convert_from_page_list.
Temporarily make vm_map_copyin_page_list always steal pages.
[91/08/01  22:49:17  jsb]

NORMA_IPC: Added vm_map_convert_{to,from}_page_list functions.
These will be removed when all kernel interfaces
understand page_list copy objects.
[91/07/04  14:00:24  jsb]

Removed obsoleted NORMA_IPC functions:
	ipc_clport_copyin_object
	vm_map_copyout_page
	ipc_clport_copyin_pagelist
[91/07/04  13:20:09  jsb]
[ ./user/threads/cthreads.h ]
Removed the infamous line 122.
[91/08/01  22:40:24  jsb]
    
    
    
==========================================================================
   ***** MK Version MK61  (af) *****
    
    
New features:
--- --------

A new DEC machine enters the family: the DECstation 5000/120,125.
Brings in a new screen and some new graphic chips also.

The 386AT now understands SCSI, using the generic SCSI driver which
now supports the Adaptec 1540 board.  Plug in your SCSI toys and have
fun!

New autoconfig code for the 386.  I repeat: "NEW AUTOCONFIG CODE for THE 386".

New, much improved generic serial line driver.  Understands two chips 
currently: the dz7085 from DEC and the scc8530 from Zilog.

The SCSI driver understands and handles correctly PROCESSOR type devices.
More on this some other day.  We also handle fixed-size tapes (QIC-11).

The screen driver can be asked about the size of the phys screen.

Use the 4.4 BSD string functions.  Now the Berkeley people cannot joke
about ATT code in our kernels anymore, sorry Keith.

[PMAX]	  The interrupt system is now much more flexible, spls are vectored
so that each machine type can install its own, if needs to.  Old ones are
the default.

[PMAX]	  Support for extra SCSI boards, which can be plugged in any TC slot.

[PMAX]	  Boot now understands the REX prom interface from DEC


Bug fixes:
--- -----

Some.

Organizational changes:
-------------- -------

As mentioned by danner, now we are supposed to build for the Omron too.

Special notes:
------- -----

Testing was:

	vax	STD+VAX6bb (gcc)	booted on sf.mach
	sun	STD+SWS (gcc)		booted on rocky
	i386	STD+WS			booted on badenov
					(SCSI native also (*))
		STD+NORMA+iPSC
		STD+SQT+32
	88k	STD+ANY			booted (partially) on amalia
	mips	STD+ANY			booted on testarossa, miura, rvb

(*) The 386 does not know where it is booted from, Bob promised to look into.
    For now, stop it in get_boot_device and patch root_name by hand.

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
61
[ ./Directories/ALL ]
Added luna88k specific directories.
[91/07/11            danner]
[ ./include/Makefile ]
Luna88k support, partial i860 support, general restructings
[91/08/01            danner]
[ ./kernel/chips/bt431.c ]
Created, from Brooktree specs:
"Product Databook 1989"
"Bt431 Monolithic CMOS 64x64 Pixel Cursor Generator"
Brooktree Corp. San Diego, CA
LA59001 Rev. J
[91/07/25            af]
[ ./kernel/chips/bt431.h ]
Created, from Brooktree specs:
"Product Databook 1989"
"Bt431 Monolithic CMOS 64x64 Pixel Cursor Generator"
Brooktree Corp. San Diego, CA
LA59001 Rev. J
[91/07/25            af]
[ ./kernel/chips/bt455.c ]
Cleaned up a bit, avoid use of poorly documented add_clr register.
Catched various minor bloopers.
[91/08/22  11:02:18  af]

Created, from Brooktree specs:
"Graphics And Imaging Product Databook 1991"
"Bt454/Bt455 170 Mhz Monolithic CMOS 16 Color Palette RAMDAC"
Brooktree Corp. San Diego, CA, 3rd Ed.
[91/07/25            af]
[ ./kernel/chips/bt455.h ]
Cleaned up a bit, described spec sources more precisely.
[91/08/22  11:03:56  af]

Created, from Brooktree specs:
"Graphics And Imaging Product Databook 1991"
"Bt454/Bt455 170 Mhz Monolithic CMOS 16 Color Palette RAMDAC"
Brooktree Corp. San Diego, CA, 3rd Ed.
[91/07/25            af]
[ ./kernel/chips/bt459.c ]
Moved padding of regmap here, in implementation file.
[91/08/02  02:03:12  af]
[ ./kernel/chips/bt459.h ]
Padding is a machdep issue: moved into implementation file.
[91/08/02  02:03:49  af]
[ ./kernel/chips/bt478.c ]
Moved padding of regmap here.  Add a couple of clarifications.
[91/08/02  02:06:15  af]
[ ./kernel/chips/bt478.h ]
Moved padding of regmap to impl file.
[91/08/02  02:06:41  af]
[ ./kernel/chips/busses.c ]
Wildcarding on adaptor no. works now.
[ ./kernel/chips/busses.h ]
Mods to cope with the 386 PC/AT ISA bus.
[91/06/20            af]
[ ./kernel/chips/cfb_hdw.c ]
Works on 3mins too.  New calling seq, declare screen sizes.
[91/08/02  01:59:46  af]
[ ./kernel/chips/cfb_misc.c ]
CharRows is gone, pm_init_screen_params() is different.
[91/08/02  02:00:39  af]
[ ./kernel/chips/dc503.c ]
Moved padding of regmap here.  Rid of "struct pcc" hack, now
we understand a pm_softc, and compatibles.
[91/08/02  02:27:53  af]
[ ./kernel/chips/dc503.h ]
Moved padding issues down in impl file.
Struct pcc hack is gone.
[91/08/02  02:28:28  af]
[ ./kernel/chips/dz_7085.h ]
Moved padding down in impl file.
[91/08/02  02:14:58  af]
[ ./kernel/chips/dz_hdw.c ]
Spl for 3min, padding of regmap here, a lot of code migrated
elsewhere to become chip-indep, pseudo-dma is gone.
Did not think I changed so much, oops.
[91/08/02  02:31:34  af]
[ ./kernel/chips/fb_hdw.c ]
Created, from .. NO SPECS AT ALL.  A little experimentation
with ddb, and a lot of past experience did the magic.
I guess this screen driver really is portable.
BTW, the cursor is still mirrored, ahem.
[91/01/25            af]
[ ./kernel/chips/fb_misc.c ]
Got cursor mirrored right.
[91/08/22  11:05:12  af]

Created, from .. NO SPECS AT ALL.  A little experimentation
with ddb, and a lot of past experience did the magic.
I guess this screen driver really is portable.
BTW, the cursor is still mirrored, ahem.
[91/01/25            af]
[ ./kernel/chips/lance.c ]
Spls for 3min, which has yet another bogus DMA setup: now the
alignment for the rings can be different from the one for data.
What will be next ?
[91/08/02  02:24:15  af]
[ ./kernel/chips/lance.h ]
Fixed mis-typing of strides, mods to switch to cope with yet-another
DMA bogosity.
[91/08/02  01:54:00  af]
[ ./kernel/chips/lance_mapped.c ]
Bugfix: typos, spl for 3min.
[91/08/02  01:52:26  af]
[ ./kernel/chips/lk201.c ]
Spls for 3min.  More uniformity.  More flexible about where the serial 
line is.
[91/08/02  02:18:02  af]
[ ./kernel/chips/mc_clock.c ]
Fixed spl munging, for 3min.
[91/08/02  01:49:09  af]
[ ./kernel/chips/mouse.c ]
The hack for 3mins was screwing up everyone else.
[91/08/02            af]
Spl for 3min, more uniformity, temporary hack for bug
still at large on 3min, generic console linkage.
[91/08/02  02:33:05  af]
[ ./kernel/chips/pm_defs.h ]
Dropped predefines of frame sizes.
[91/08/02  02:16:00  af]
[ ./kernel/chips/pm_hdw.c ]
Declare screen sizes, new calling sequences for a couple funcs.
[91/08/02  01:58:48  af]
[ ./kernel/chips/pm_misc.c ]
Now we share this with yet another driver.  Mods to cope with
arbitrary framebuffer geometries.  Did not put pixel sizes in,
maybe should someday.  Code seems more understandable, too.
Threw in a couple optims, did not try to avoid copying non-visible
memory when scrolling, will do next time around.
[91/08/02  02:14:16  af]
[ ./kernel/chips/scc_8530.h ]
Created, from the Zilog specs:
"Z8530 SCC Serial Communications Controller, Product Specification"
in the "1983/84 Components Data Book" pp 409-429, September 1983
Zilog, Campbell, CA 95008
[91/06/21            af]
[ ./kernel/chips/scc_8530_hdw.c ]
Created, from the Zilog specs:
"Z8530 SCC Serial Communications Controller, Product Specification"
in the "1983/84 Components Data Book" pp 409-429, September 1983
Zilog, Campbell, CA 95008
[91/06/28            af]
[ ./kernel/chips/screen.c ]
Spls for 3min, added SCREEN_HARDWARE_INFO.
[91/08/02  02:04:46  af]
[ ./kernel/chips/screen.h ]
Added frame size related defs, and get_status call.
[91/08/02  02:05:23  af]
[ ./kernel/chips/screen_defs.h ]
Added frame size related defs.  Redefines for 3min.
Define here logical names for the keyboard&mouse
serial lines.  Specify completely here the kernel font.
[91/08/02  02:09:43  af]
[ ./kernel/chips/screen_switch.c ]
Added new hires, monochrome screen driver "fb", dressed as a color one.
[91/08/02  01:56:50  af]
[ ./kernel/chips/serial_console.c ]
Created, splitting out most code from dz_tty.c file.
[91/07/07            af]
[ ./kernel/chips/serial_defs.h ]
Created.
[91/07/07            af]
[ ./kernel/conf/MASTER.i386 ]
Added SCSI driver "aha".
[91/08/02  02:34:39  af]
[ ./kernel/conf/MASTER.luna88k ]
Lets build mach_kernel like everyone else.
[91/08/16            rvb]
Changed scsi support from sd to scsi.
[91/07/13            danner]
[ ./kernel/conf/MASTER.mips ]
Changes for kmin, including one more ASC scsi interface, and a new
driver: the SCC serial line one (substitutes the DZ)
[91/07/05            af]
[ ./kernel/conf/MASTER.vax ]
Generic console driver. Should eventually replace all the old cruft.
[91/08/02  02:35:27  af]
[ ./kernel/conf/Makefile.luna88k ]
Defuncted vsnprintf.c,  debug_msg.c in locore.
Removed -fvolatile-global, -fvolatile
[91/07/19            danner]
[ ./kernel/conf/files.i386 ]
Added SCSI driver files and new autoconf code.
[91/08/02  02:36:35  af]
[ ./kernel/conf/files.luna88k ]
	Added some missing scsi files.
	sd --> scsi

 Revision 2.2  91/07/09  23:14:57  danner
Added scsi/rz_labels.c
[91/07/08  22:55:54  danner]

Initial Checkin
[91/03/08            danner]
 
[ ./kernel/conf/files.mips ]
The SCC driver moved to its final destination.
[91/08/02  10:21:47  af]

New 3min files for "fb" screen, SCC serial lines, 3min (kmin*)
proper, new SCSI "Cpu" and "Host" devices, generic console.
[91/08/02  02:39:59  af]
[ ./kernel/conf/files.vax ]
Generic console driver, two new SCSI devices: "Cpu" and "Host".
Plus disklabel related code is separate.
[91/08/02  02:37:55  af]
[ ./kernel/ddb/db_command.c ]
Added optional funcall at ddb entry: similar to GDB's
"display"s in spirit.
[91/08/02  02:42:11  af]
[ ./kernel/device/chario.c ]
Spl definitions.
[91/08/02  02:44:21  af]
[ ./kernel/device/ds_routines.c ]
Spls definitions.
[91/08/02  02:44:45  af]
[ ./kernel/device/net_io.c ]
Missing include for Spls definitions.
[91/08/02  02:45:16  af]
[ ./kernel/device/subrs.c ]
Use BSD string functions now, which of course come with a
copyright.  Also, undef them in case some smarty..
[91/08/22            af]
[ ./kernel/i386/loose_ends.c ]
Added delay() function, for where too much optim hurts.
[91/08/02  02:47:21  af]
[ ./kernel/i386/trap.c ]
Revision 2.15.3.1  91/08/19  13:45:20  danner
Make the file safe for gcc 1.36.  There is a really bizarro
structure assignment of an array that starts at zero that
nukes us.
[91/08/07            rvb]
[ ./kernel/i386at/autoconf.c ]
Use new MI autoconf procedures. Added SCSI.
[91/08/02  02:52:15  af]
[ ./kernel/i386at/com.c ]
New MI autoconf.
[91/08/02  02:50:03  af]
[ ./kernel/i386at/conf.c ]
Added SCSI disks, tapes, and cpus.
[91/08/02  02:56:08  af]
[ ./kernel/i386at/fd.c ]
New MI autoconf.
[91/08/02  02:53:26  af]
[ ./kernel/i386at/grab_bob_label.c ]
Temporarily created, till we evaporate the religious issues.
[91/08/02            af]
[ ./kernel/i386at/hd.c ]
New MI autoconf.
[91/08/02  02:52:47  af]
[ ./kernel/i386at/if_3c501.c ]
New MI autoconf.
[91/08/02  02:54:56  af]
[ ./kernel/i386at/if_ns8390.c ]
New MI autoconf.
[91/08/02  02:55:17  af]
[ ./kernel/i386at/if_pc586.c ]
New MI autoconf.
[91/08/02  02:54:27  af]
[ ./kernel/i386at/if_wd8003.h ]
Removed embedded control character that made gcc unhappy.
[91/07/29            danner]
[ ./kernel/i386at/kd_mouse.c ]
New MI autoconf.
[91/08/02  02:49:38  af]
[ ./kernel/i386at/m765knl.c ]
New MI autoconf.
[91/08/02  02:53:56  af]
[ ./kernel/kern/sched_prim.c ]
Final form of do_priority_computation was missing a pair of parenthesis.
[91/07/19            danner]
[ ./kernel/kern/syscall_emulation.c ]
Cast tags for bcopy
[91/08/14            rvb]
[ ./kernel/luna88k/autoconf.c ]
pcb_zone_init -> pcb_module_init and now is called by MI code.
[91/08/14            rvb]
Modifed slave_machine_configure to call cpu_configuration_print.
[91/07/18            danner]
[ ./kernel/luna88k/clock.c ]
Changed snprintf to sprintf, upped buffer size.
[91/07/20  15:34:04  danner]
[ ./kernel/luna88k/cmmu.c ]
Changed cmmu_cpu_number to use a more meaningfull loop variable.
[91/08/08            danner]
Changes from jfriedl, including 2.5 compatibility
[91/08/06  11:49:54  danner]
Added cmmu_get_idr (mmu identification register) so we can print
 chip revision during boot.

Cmmu_init now turns on the global bit of each processor. This
 avoids coherency problems when the first processor goes virtual
 and the other processors are still physical.

Removed broken BATC usage code.
[91/07/20            danner]
[ ./kernel/luna88k/db_disasm.c ]
Changes from jfriedl, including 2.5 compatability
[91/08/06  11:49:18  danner]
[ ./kernel/luna88k/db_interface.c ]
Changes from jfriedl, including 2.5 compatability.

Added volatile declarations to compensate for dropping
 volatile-global flag from gcc.
[91/07/14            danner]
[ ./kernel/luna88k/db_machdep.h ]
Changes from jfriedl, including 2.5 compatability
[91/08/06  11:49:49  danner]
[ ./kernel/luna88k/db_sstep.c ]
Changes from jfriedl, including 2.5 compatability
[91/08/06  11:49:22  danner]
[ ./kernel/luna88k/db_trace.c ]
Conditionalized pid field on ifndef MACH_KERNEL. Modified stack
 trace command to recognize integers 0 - 3 as references to the
 exception frame of the specified cpu.
[91/08/08            danner]
Changes from jfriedl, including 2.5 compatability
[91/08/06  11:49:28  danner]
[ ./kernel/luna88k/exec.c ]
Clone get_symtab from vax copy.  IS sym_off correct?
[91/08/14            rvb]
Updated to reflect new thread_state structure.
[91/08/08            danner]
[ ./kernel/luna88k/exec.h ]
Taken from i386/exec.h.
[91/08/14            rvb]
[ ./kernel/luna88k/genassym.c ]
Updated to reflect new exception frame thread /
 luna88k_saved_state structure. Added sanity checking code to
 make sure the thread structure is an integral multiple of double
 words. 
[91/08/07            danner]
[ ./kernel/luna88k/locore/eh.c ]
Bug fixes.
[91/07/11            danner]
[ ./kernel/luna88k/locore/locore.c ]
New slave stack initialization.
[91/08/15            rvb]
Removed the unused scASM* and ocsum functions.
[91/08/06            danner]
Made save context switch to interupt stack.
[91/07/15            danner]
[ ./kernel/luna88k/locore/locore.h ]
We realy should not define NBPG here.
[91/08/16  19:43:26  rvb]
[ ./kernel/luna88k/locore/locore_asm_routines.c ]
Removed ffs, suword, fuword, careful_bcopy
[91/08/06            danner]
Added read processor identification register function.
[91/07/20  15:36:01  danner]
[ ./kernel/luna88k/locore/locore_c_routines.c ]
Removed everything except data access emulation and vector init.
 The rest of the functions are defunct in 3.0
[91/08/06            danner]
[ ./kernel/luna88k/luna_init.c ]
Changes from jfriedl, including 2.5 compatability
[91/08/06  11:49:31  danner]
[ ./kernel/luna88k/machdep.c ]
Change instack declaration type and add a cast for 
assignment into the interrupt_stack of instack.
[91/08/16  16:34:38  rvb]
Add get_slave_stack to do kmem_alloc for slave's stack.
[91/08/15            rvb]
Added cpu_configuration_print.
[91/07/18            danner]
[ ./kernel/luna88k/pcb.c ]
Added thread_set_syscall_return -- does nothing for now.
Renamed pcb_zone_init -> pcb_module_init.
[91/08/14            rvb]
Cast bcopy arguments to (char *) when not.
[91/08/14            rvb]
Updated to reflect new thread_state structure.
[91/08/08            danner]
[ ./kernel/luna88k/pmap.c ]
Taken from danner.
[ ./kernel/luna88k/pmap.h ]
Changes from jfriedl, including 2.5 compatability
[91/08/06  11:48:59  danner]
Volatilized
[91/07/19            danner]
[ ./kernel/luna88k/setroot.c ]
Updated to coincide slightly more with reality.
[91/07/13            danner]
[ ./kernel/luna88k/sys_machdep.c ]
read_symtab_from_file is now MI in boot_ufs/load.c
[91/08/14            rvb]
[ ./kernel/luna88k/thread.h ]
Added scratch1, pad fields.
[91/08/07            danner]
Reorganized luna88k_saved_state structure to match up nicely with
 the thread_status structure. Removed the pid field and moved the
 fpsr and fpcr registers to be right after the general user
 registers. Moved the vector field to follow the fpit field. Moved
      the ssbr register to follow the sfip.
[91/08/07            danner]
[ ./kernel/luna88k/trap.c ]
Replaced use of backtrace with db_stack_trace_cmd.
[91/08/06            danner]
Added missing argument to ddb_error_trap.
[91/07/14            danner]
[ ./kernel/mach/luna88k/thread_status.h ]
Typo correction.
[91/08/09  18:32:12  danner]
Completely reorganized. All the machine registers are now
 exportable. Broke the state up into two pieces - one contains
 the basic user registers + pc, and the other contains the rest
 of the machine state. Things are synchronized with the
 luna88k_saved_state structure in luna88k/thread.h so that block
 copies can be used. 
[91/08/07            danner]
[ ./kernel/mach/port.h ]
Added a set of parenthesis to MACH_PORT_TYPE to shut up gcc2.
[91/07/19            danner]
[ ./kernel/mips/PMAX/boot/Makefile ]
Now test program needs c_misc.o too.
[91/08/22  11:27:20  af]
[ ./kernel/mips/PMAX/boot/asm_misc.h ]
Rid of longjmp crap.  Make callbacks vectorable, as needed
by new interface on 3min.  Described 3min interface.
[91/08/22  11:20:22  af]
[ ./kernel/mips/PMAX/boot/asm_misc.s ]
Rid of longjmp crap. Added 3min callbacks.
[91/08/22  11:21:27  af]
[ ./kernel/mips/PMAX/boot/c_misc.c ]
Set up prom callback vector appropriately, added which_prom().
Now exec passes four arguments along.
[91/08/22  11:23:41  af]
[ ./kernel/mips/PMAX/boot/mkboot.c ]
Scsi include files have moved, plus we use BSD label defs
from disk_status.h
[91/06/20            af]
[ ./kernel/mips/PMAX/boot/primary_boot.c ]
Pass along all 4 arguments, needed on 3min.
[91/08/22  11:17:49  af]
[ ./kernel/mips/PMAX/boot/start.s ]
Rid of jumpbuffer, shrinked stack frame, call which_prom()
asap to set up callback vector, moved exit() elsewhere.
[91/08/22  11:25:55  af]
[ ./kernel/mips/PMAX/boot/test.c ]
Now take 4 args, and do not try to deref the third one.
[91/08/22  11:18:37  af]
[ ./kernel/mips/PMAX/kmin.c ]
Created, from the DEC specs:
"3MIN System Module Functional Specification"  Revision 1.7
Workstation Systems Engineering, Palo Alto, CA. Sept 14, 1990.
"KN02BA Daughter Card Functional Specification" Revision 1.0
Workstation Systems Engineering, Palo Alto, CA. Aug  14, 1990.
[91/06/21            af]
[ ./kernel/mips/PMAX/kmin.h ]
Documented new SCSI registers, which were missing in the 3min prototype.
[91/08/22  11:14:57  af]

Created, from the DEC specs:
"3MIN System Module Functional Specification"  Revision 1.7
Workstation Systems Engineering, Palo Alto, CA. Sept 14, 1990.
"KN02BA Daughter Card Functional Specification" Revision 1.0
Workstation Systems Engineering, Palo Alto, CA. Aug  14, 1990.
[91/06/21            af]
[ ./kernel/mips/PMAX/kmin_cpu.h ]
Ignore, as hinted by specs, the "SCSI data available" interrupt.
The point is there seems to be no obvious way to clear it.
[91/08/22  11:14:10  af]

Created, from the DEC specs:
"3MIN System Module Functional Specification"  Revision 1.7
Workstation Systems Engineering, Palo Alto, CA. Sept 14, 1990.
"KN02BA Daughter Card Functional Specification" Revision 1.0
Workstation Systems Engineering, Palo Alto, CA. Aug  14, 1990.
[91/06/21            af]
[ ./kernel/mips/PMAX/kmin_cpu.s ]
Created, from the DEC specs:
"3MIN System Module Functional Specification"  Revision 1.7
Workstation Systems Engineering, Palo Alto, CA. Sept 14, 1990.
"KN02BA Daughter Card Functional Specification" Revision 1.0
Workstation Systems Engineering, Palo Alto, CA. Aug  14, 1990.
[91/06/21            af]
[ ./kernel/mips/PMAX/kmin_dma.c ]
Actually got it to boot multiuser with on-board SCSI.
[91/08/22  11:11:55  af]

Created.
[91/08/02  03:39:00  af]
[ ./kernel/mips/PMAX/kn02_dma.c ]
Now end_xfer routine is called for writes too.
[91/08/22  11:12:51  af]

Created.
[91/08/02  03:39:32  af]
[ ./kernel/mips/PMAX/mips_box.c ]
Spl defines, SCC and ASIC drivers, a bunch more disks and tapes
so that we can play any number of additional SCSI interface boards.
New fb screen driver.
[91/08/02  03:36:23  af]
[ ./kernel/mips/PMAX/mips_box.h ]
Pass along interrupt frame pointer to intr routines:
on 3min we need to munge the SR on the fly.
[91/08/02  03:37:22  af]
[ ./kernel/mips/PMAX/model_dep.c ]
Added 3min support, spl dispatcher lives here too.
[91/08/02  03:41:00  af]
[ ./kernel/mips/PMAX/pmag_aa.h ]
Created, from the DEC specs:
"PMAG-AA TURBOchannel Monochrome Frame Buffer Functional Specification"
Workstation Systems Engineering, Palo Alto, CA. Aug 27, 1990.
[91/01/25            af]
[ ./kernel/mips/PMAX/tc.c ]
Bugfix from Michael Pagels (pagels@cs.arizona.edu): did
not properly skip unknown devices.
[91/08/02  12:48:21  af]

Added PMAG-AA, and ASIC and Z8530 pseudos.
Made number of slots dynamic, probe them from
high to low slot number (system devices take precedence).
The 'someday' for an arbitrary interrupt enable function has come.
[91/08/02  03:33:19  af]
[ ./kernel/mips/PMAX/tc.h ]
Defined max number of TC slots, arbitrary TC interrupt
enable function.
[91/08/02  03:34:38  af]
[ ./kernel/mips/autoconf.c ]
We understand 3mins.  Finding systype is a problem now.
[91/08/02  03:24:57  af]
[ ./kernel/mips/conf.c ]
Generic console driver, SCSI processor devices.
[91/08/02  03:07:13  af]
[ ./kernel/mips/db_disasm.c ]
We are supposed to print a newline before returning from db_disasm().
[91/08/02  16:25:54  af]
[ ./kernel/mips/db_interface.c ]
Use generic console calls.
[91/08/02  03:15:32  af]
[ ./kernel/mips/locore.s ]
Made clearing of buserrors variables, accomodates 3mins.
[91/08/02  03:19:50  af]
[ ./kernel/mips/machparam.h ]
Made spls indirect jumps, to allow more flexibility in redefining
them.  This is dictated by the ridicoulous interrupt dispatching
found on the DEC 3min, which mixes both different levels and an
interrupt mask on one level.
[91/06/24            af]
[ ./kernel/mips/mips_box.h ]
Defines for some new DEC boxes.
[91/08/02  03:06:24  af]
[ ./kernel/mips/mips_cpu.s ]
Renames of old spl functions, still used as "default" spls.
[91/08/02  03:05:32  af]
[ ./kernel/mips/mips_init.c ]
Some calls that lived in assembly live here now.
Identify proms real quick now, getenv depends on it.
More flexibility in finding the bitmap of valid pages.
Made contiguous page stealing a MI feature.
[91/08/02  03:23:48  af]
[ ./kernel/mips/mips_instruction.c ]
pcb_synch() no longer needed.
[91/08/02  03:28:18  af]
[ ./kernel/mips/mips_misc.c ]
Spl defs, define halt() function.
[91/08/02  03:18:57  af]
[ ./kernel/mips/mips_startup.c ]
Removed obsolete piece of wisdom.
[91/08/02  03:15:03  af]
[ ./kernel/mips/parse_args.c ]
Added rcline, and temporarily SCC .
[91/08/02  03:11:11  af]
[ ./kernel/mips/pcb.c ]
Missing include of Spl defs.
[91/08/02  03:04:04  af]
[ ./kernel/mips/pmap.c ]
phys_to_k0seg() is out, kvtophys() is in.
[91/08/02  03:13:06  af]
[ ./kernel/mips/prom_interface.h ]
Reduced the number of entry points to the ones we actually use.
[91/06/25            af]
[ ./kernel/mips/prom_interface.s ]
Reduced the number of entry points to the ones we actually use.
Added yet-another-prom-interface-from-DEC, for 3min.
[91/06/25            af]
[ ./kernel/mips/start.s ]
Moved any call to C that can be made from C in C code.
Save all 4 arguments for later inspection: new DEC
proms are more creative.
[91/08/02  03:17:56  af]
[ ./kernel/mips/swapgeneric.c ]
Better parsing of both old and new syntax, assumed
arguments are a bit more consistent.  Understands
unit numbers greater than 9 also.  Can tftp() boot,
but only if we have a local disk :-((
[91/08/02  03:27:33  af]
[ ./kernel/mips/trap.c ]
Spl defs, and fixed disguised splsoftclock().
[91/08/02  03:12:05  af]
[ ./kernel/scsi/adapters/README ]
Created.
[91/08/02            af]
[ ./kernel/scsi/adapters/scsi_33C93.h ]
Created, from the Amd specs:
"Am33C93A Enhanced SCSI-Bus Interface Controller"
Publication #11853 Rev.A Amendment/0 Issue Date: June 1989
5/16/1989, Advanced Micro Devices Inc.,  Sunnyvale, CA.
[91/08/01            af]
[ ./kernel/scsi/adapters/scsi_33C93_hdw.c ]
Created, from the Amd specs:
"Am33C93A Enhanced SCSI-Bus Interface Controller"
Publication #11853 Rev.A Amendment/0 Issue Date: June 1989
5/16/1989, Advanced Micro Devices Inc.,  Sunnyvale, CA.
[91/08/01            af]
[ ./kernel/scsi/adapters/scsi_5380.h ]
Moved padding of regmap in impl file.
[91/08/02  04:22:39  af]
[ ./kernel/scsi/adapters/scsi_5380_hdw.c ]
Moved padding of regmap here.  Do synch neg on inquiry too.
[91/08/02  04:23:37  af]
[ ./kernel/scsi/adapters/scsi_53C94.h ]
Moved padding down in impl file.
[91/08/02  04:14:53  af]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
Always call the end_xfer routine, might have to stop DMA engine.
In synch negotiation, actually send out the command we are
supposed to rather than blindly test_unit_ready.
[91/08/22  11:08:23  af]

Moved padding of regmap here.  Moved dma-like operations elsewhere,
now we have a new case in which a true DMA chip uses the 53C94.
Actually, on 3mins the two types of dma might/do coexist.
[91/08/02  04:17:22  af]
[ ./kernel/scsi/adapters/scsi_7061.h ]
Moved padding of regmap in impl file.
[91/08/02  04:18:05  af]
[ ./kernel/scsi/adapters/scsi_7061_hdw.c ]
Padding of regmap is done here.  Renames for uniformity.
Do the synch neg on enquiry too.  Disabled answering to
selection, we live on the same bus with other machines
now.
[91/08/02  04:20:22  af]
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
Reflected changes in MI code
[af]
Changed hardware header from sd.h to scsi.h
[91/07/13            danner]
[ ./kernel/scsi/adapters/scsi_aha15.h ]
Created, from the Adaptec manual:
"AHA-1540B/1542B Technical Reference Manual"
Adaptec Inc. Literature Department,
600001-031 Rev. C, 7/90, Milpitas, CA.
[91/06/14            af]
[ ./kernel/scsi/adapters/scsi_aha15_hdw.c ]
Created, from the Adaptec spec:
"AHA-1540B/1542B Technical Reference Manual"
Adaptec Inc. Literature Department,
600001-031 Rev. C, 7/90, Milpitas, CA.
[91/06/14            af]
[ ./kernel/scsi/adapters/scsi_dma.h ]
Created.
[91/08/02  04:14:25  af]
[ ./kernel/scsi/compat_30.h ]
Corrected defines.
[91/08/02  03:50:58  af]
[ ./kernel/scsi/mapped_scsi.c ]
Spl defs.
[91/08/02  03:45:16  af]
[ ./kernel/scsi/rz.c ]
Pass along the ior in open calls.
Removed luna88k specialization, as the device headers have been
 rationalized. 
[91/08/02  03:51:40  af]
[ ./kernel/scsi/rz_cpu.c ]
Created.
[91/08/02  03:52:11  af]
[ ./kernel/scsi/rz_disk.c ]
Spl defs.  Search for label. MultiP locks.
[91/08/02  03:53:45  af]
[ ./kernel/scsi/rz_disk_bbr.c ]
Fixed includes.
[91/08/02  03:45:46  af]
[ ./kernel/scsi/rz_host.c ]
Created.
[91/08/02  03:47:02  af]
[ ./kernel/scsi/rz_labels.c ]
Created, splitting out DEC-specific code from rz_disk.c and
adding some more.
[91/06/26            af]
[ ./kernel/scsi/rz_labels.h ]
More vendor's labels.
[91/08/02  03:50:34  af]
[ ./kernel/scsi/rz_tape.c ]
Flag tapes as exclusive open, Spl defs, now we
understand fixed-size tapes (QIC-11), multiP locks.
[91/08/02  03:56:41  af]
[ ./kernel/scsi/scsi.c ]
Spls defs, corrected scsi_master_alloc() to allocate
as expected, support for processor devices, 
made it possible to avoid sync neg at all (for rb's sake),
no start unit on processor devices, understand our
own descriptor.
[91/08/02  04:01:50  af]
[ ./kernel/scsi/scsi_alldevs.c ]
Revised scsi_inquiry to try selecting with ATN too,
a certain target insults us ("dumb initiator") if not.
[91/08/02  03:48:38  af]
[ ./kernel/scsi/scsi_cpu.c ]
Filled in with what was missing.  Works, too.
[91/08/02  03:46:32  af]
[ ./kernel/scsi/scsi_defs.h ]
Added processor_type infos, definition of an opaque type,
multiP locking.
[91/08/02  03:55:05  af]
[ ./kernel/scsi/scsi_disk.c ]
Bcopy casts.
[ ./kernel/scsi/scsi_tape.c ]
Support for fixed-size-tapes: careful about speed selections,
round sizes properly, use fixed bit.
[91/08/02  03:58:18  af]
[ ./kernel/src/mig/Makefile ]
Fine tuning: ... -if vs if
[91/08/14            rvb]
Fixed release to actually link each time.
[91/07/23            danner]
[ ./kernel/vax/conf.c ]
Generic console.
[91/08/02  04:30:46  af]
[ ./kernel/vax/ka3100.c ]
pcc is gone, reflected other changes in calling seq or
function names.
[91/08/02  04:31:48  af]
[ ./user/libmach/Makefile ]
Luna setjmp needs to go the the preprocessor. Added SETJMP variable to
accomplish this.
[91/07/20  15:42:18  danner]
[ ./user/libmach/luna88k/_setjmp.cs ]
Added _longjmp, optimized setjmp.
[91/07/20            danner]
Renamed from _setjmp.h. Completed
[91/07/11            danner]
[ ./user/libmach/luna88k/bzero.c ]
Created
[91/07/20            danner]
[ ./user/threads/Makefile ]
Added MACHINE_CFLAGS switch to support the -Wf,-XNk150 flag for
 mips string space. Apparently "danner/n3" is enough longer than
 "dbg" to exhaust string space.
[91/08/21            danner]
Added better cpp technology to deal with gcc limitations. 
      Currently only an issue on luna88k.
[91/07/26            danner]
Made use of -ES vs. -E machine dependent, as luna88k does not
 like -ES.
[91/07/19            danner]
[ ./user/threads/luna88k/csw.s ]
Comment leader fix
[91/07/19  20:03:34  danner]
Created by rwd
[91/07/19  18:58:17  danner]
[ ./user/threads/luna88k/cthread_inline.awk ]
Revision 2.1  91/07/11  17:24:50  danner
Created.
[ ./user/threads/luna88k/cthreads.h ]
Created by rwd
[91/07/19  18:45:07  danner]
[ ./user/threads/luna88k/lock.s ]
Comment leader fix
Created by rwd
[91/07/19  20:03:31  danner]
[ ./user/threads/luna88k/thread.c ]
Created.
[91/07/19  18:45:28  danner]
[ ./utils/mktree.sh ]
Fixed a comment.
[91/07/21            danner]
Missed one pmax/mips thingie.
[91/07/13            danner]

Fixed mistake where pmax_mach was a link to pmax instead of mips.
 This is the only machine were @sys_mach should not be a link to
 @sys. Sigh.
[91/07/11            danner]

Added i860 to machines. Changed directory warning to warn if the
 current directory is not 'latest' instead of 'kernel'.
[91/07/11            danner]
    
    
    
==========================================================================
   ***** MK Version MK62  (jsb) *****
    
    
Warning/disclaimer:
------------------

This is really about 4 1/2 merges, one each from jsb (me), dlb, rpd,
and intel, and some misc stuff from dbg and af. I don't remember how
I decided that this was a good thing to do.

New features:
--- --------

Summary:

===> From jsb:

Added support for remote task creation with inherited memory.
Remove task creation is accessible either via task_create_remote,
or task_create with task_server_node patched to some reasonable value.
The first option allows a norma-knowlegable program or server to create
a task on a particular node. The second option allows norma-naive
programs or servers (such as the unix server) to use remote task creation;
the task_server_node variable will be replaced with a policy module
that selects one of several nodes on which to create the new task.

The vm inheritance logic for remote task creation has some problems.
When a local task creates a remote task, memory is copied lazily.
Unfortunately, when that child creates a new task, that address space
copy is done eagerly. This will be fixed in a future merge.

Removed the hardwired table of <node number | ethernet addr | ip addr >
from the kernel, and replaced with client code for an arp-like protocol
which provides the same information. The server for this protocol will
be released to the USER area in a future merge.

Added preliminary support in network code for windows > 1 packet.
(The current code uses stop-and-wait.)

Added a.out ddb filename/line number support. (This support has existed for
a long time for the pmax.) Building with the 'lineno' options (e.g.,
STD+WS+lineno) will build a kernel with all the necessary symbol table
info. The xstrip program then removes all the unnecessary symbol table
info, leaving just global identifiers, file names, and line numbers.

The pmax now no longer by default builds with line number information;
if you want this information, you must use the lineno option.

Added 'A' flag to examine: just like 'a' (address), but prints addr
as a procedure type, thus printing file/line info if available.
Useful when called as 'x/Ai'.

Did a lot of integration of norma code with dlb, rpd, and intel changes.
I've punted on some of the conflicts, which will be fixed properly in
future merges. For example, the norma xmm code doesn't yet know about
data_supply.

Updated machine/conf.c for all machines to include devinfo fields
(as dlb described on mach3) for all devices. Right now they are almost
all set to nodev. If you want your machine to handle big big writes
without panicing, add devinfo routines for your devices. For reference,
here is dlb's hddevinfo for the i386 hd driver:

hddevinfo(dev, flavor, info)
dev_t   dev;
int     flavor;
char    *info;
{
        register int    result;

        result = D_SUCCESS;

        switch (flavor) {
        case D_INFO_BLOCK_SIZE:
                *((int *) info) = SECSIZE;
                break;
        default:
                result = D_INVALID_OPERATION;
        }

        return(result);
}

See, isn't that easy?

===> From dlb:

Update previous page list code.  Add continuation logic
to allow arbitrary sized vm regions to be handled by page list routines.
[These are not the same continuations that the scheduler uses!]

Enhance page stealing logic for page lists to steal wired pages; convert
default pager to take advantage of this (pages paged in by default pager
are now almost always stolen instead of copied).

Changed device_write to use page lists.  This replaces io_wire,
io_unwire, and kmem_fault_wire with kmem_io_map_{copyout,deallocate}.
Minor device driver changes are required to make device's block size
available to the device code.

Implement precious pages based on 2.5 version.  Still a few minor tweaks
left to do, but the code should be usable.  Add backwards compatibility
logic to protect old pagers from new interfaces.

[i386]  Add device driver logic to make block size available.

===> From rpd:

Messages dequeued from a port get stamped with a sequence number.
Newly created ports start with zero.  The sequence number is reset
to zero when a receive right moves between tasks.  The msgh_kind
field is renamed msgh_seqno.  There is a new type, mach_port_seqno_t.
This change is not backwards compatible, but in practice programs
didn't use msgh_kind (except for ipc_test), so old programs are happy.

The mach_port_status_t type (returned by mach_port_get_receive_status)
has a new field that reports the sequence number the port will use next.
This change is backwards compatible because I changed the msg-id
of mach_port_get_receive_status and left a compatibility call at the old id.
There is a new call, mach_port_set_seqno, which changes a port's
sequence number.

When a message is dequeued but not received (ie, MACH_RCV_INVALID_NOTIFY,
MACH_RCV_TOO_LARGE, MACH_RCV_HEADER_ERROR) then the message header
with all fields but the reply port (which is MACH_PORT_NULL) is received.
This extends the old MACH_RCV_HEADER_ERROR behavior to the other error codes.
Except for extremely picky programs like ipc_test, this is compatible.

I removed Camelot and TrapRoutine (some experimental code I did
a long time ago) support from Mig.  I removed support for the obsolete
forms of translation and destructor syntax.  I replaced the MsgKind keyword
with MsgSeqno.  A MsgSeqno argument passes to the server the
request message's sequence number.  I added a ServerDemux keyword
which can be used to specify the name of the server's demux function.
For example,
	subsystem foo 12345;
	#include <mach/std_types.defs>

	ServerDemux not_foo_server_but_something_else;

	simpleroutine asyncmsg(server: mach_port_t;
		       MsgSeqno seqno: mach_port_seqno_t);
I added a new return code, MIG_SERVER_DIED, which client stubs report
when the server dies without sending a reply.  (Before this situation
was reported as a generic MIG_REPLY_MISMATCH error.)

I added a call, default_pager_info, to the default_pager_object interface.
It returns information about the amount of backing store available.
(A forthcoming USER release will have a program which uses this feature.)

I upgraded the default pager to use the new sequence number feature.
Now it can service most requests from the kernel, even for a single object,
in parallel.  (Read requests will wait for previous write requests
on the same object.)

I changed how the default pager manages the paging file so that it
uses a wired array of disk block addresses instead of repeatedly re-reading
indirect blocks.  This is an improvement because
	1) The default pager services many/most requests twice as fast now.
	2) The wired array only takes a few pages.
	3) Because the pager doesn't have to read a page to write a page,
	the kernel won't run out of free pages when multiple write requests
	are being serviced in parallel.
	4) The wired array can potentially be grown on-the-fly, so one
	could add backing store dynamically.


===> From Intel/SSD (the iPSC folks):

[I860]	  Lots and lots and lots of fixes. This kernel almost boots
	  multiuser. (That is, Intel is now booting multiuser, and
	  this release has almost all of their changes.)

Bug fixes:
--- -----

===> From jsb:

Fixed code to handoff kmsgs from interrupt handler to spinning thread.

===> From dlb:

Make synchronous io wait (iowait/iodone) logic work on multiprocessors.

Handle dirty private pages correctly in vm_object_terminate().

===> From rpd:

I fixed mach_msg_interrupt to check for MACH_RCV_IN_PROGRESS.

I changed vm_map_copyout so that it follows the standard protocol
of only consuming its arguments when it returns KERN_SUCCESS.
This fixes the usage inside device_write that could result in
a map-copy object being freed twice.

I fixed exception_no_server to print a semi-informative message
before dropping into kdb, so it doesn't look like the kernel is at fault.

I fixed syscall_mach_port_insert_right and syscall_task_set_special_port
to handle non-valid port names correctly.

I changed vm_pageout_scan so that it copes when memory is very tight
and external pagers can't process write requests to clean dirty pages.
This basically resurrects the Mach 2.5 vm_pageout_reserved_external
and vm_pageout_reserved_internal technology, but done somewhat differently
to avoid some problems.  I added vm_page_free_count_minimum, which
tracks the lowest value of vm_page_free_count.  If you do a lot of
paging, I would be interested in hearing what kind of values you
see for vm_page_free_count_minimum.

I fixed vm_page_deactivate to handle absent/fictitious pages properly.

I increased the device_io_map size so that one can mkfs partitions
reliably.  (Previously a 256K write would fill device_io_map, leaving
no room for writes by eg the default pager.)

I fixed xprbootstrap to zero the xpr buffer.

I fixed read_symtab_from_file so that the pmax can boot a non-xstripped
Unix server without barfing on the large symbol table.

I fixed cthreads so that cthread_fork_prepare, cthread_fork_child,
and cthread_fork_parent work at least minimally.

===> From af:

[PMAX]	  Fixed bug in SCC 8530 code that hung the machine when restarting X11.

Special notes:
------- -----

===> From dlb:

NOTE: The dev_ops (dev_name_list) structure now has an additional entry
to make device-dependent information available to machine-independent code.
This entry should be nodev for devices that don't support it.  The kernel
will panic if a big write (>64k) is attempted to such a device; these
will be replaced by error returns in the near future.

Log messages:
--- --------
[ ./conf/version.edit ]
62
[ ./kernel/boot_ufs/def_pager_setup.c ]
Added struct file_direct and associated functions.
[91/08/19            rpd]
[ ./kernel/boot_ufs/default_pager.c ]
Added seqnos_memory_object_change_completed.
From dlb: use memory_object_data_supply for pagein when buffer is
going to be deallocated.
From me: don't use data_supply under NORMA_VM (will be fixed).
[91/08/26  14:30:07  jsb]

Changed to process requests in parallel when possible.

Don't bother keeping track of mscount.
[91/08/16            rpd]
Added default_pager_info.
[91/08/15            rpd]

Added sequence numbers to the memory object interface.
Changed to use no-senders notifications.
Changed to keep track of port rights and not use mach_port_destroy.
Added dummy supply-completed and data-return stubs.
[91/08/13            rpd]
[ ./kernel/boot_ufs/file_io.c ]
Added struct file_direct and associated functions.
[91/08/19            rpd]
[ ./kernel/boot_ufs/file_io.h ]
Added struct file_direct and associated functions.
[91/08/19            rpd]
[ ./kernel/boot_ufs/load.c ]
Fixed to check vm_allocate return codes, esp in read_symtab_from_file.
[91/08/26            rpd]
[ ./kernel/chips/scc_8530_hdw.c ]
Fixed scc_scan to actually check the tp->state each time,
we are not notified when the MI code brutally zeroes it
on close and so we cannot update our software CARrier.
[91/08/27  16:18:05  af]
[ ./kernel/chips/screen.c ]
Fixed screen_write to check vm_map_copyout's return code.
[91/08/03            rpd]
[ ./kernel/conf/MASTER ]
Added lineno build option.
[91/08/26  11:12:32  jsb]
[ ./kernel/conf/MASTER.i386 ]
Added support for lineno build option.
[91/08/26  11:11:55  jsb]
[ ./kernel/conf/MASTER.mips ]
Added support for lineno build option. This option is now required
to get filename and line number debugging info.
[91/08/26  11:25:33  jsb]
[ ./kernel/conf/MASTER.sun3 ]
Added support for lineno build option.
[91/08/27  18:04:54  jsb]
[ ./kernel/conf/MASTER.vax ]
Added support for lineno build option.
[91/08/27  18:05:04  jsb]
[ ./kernel/conf/Makefile.i860 ]
Bumped up data origin a little bit (0xf8080000 -> 0xf8090000).
[91/08/27  17:09:51  jsb]
[ ./kernel/conf/Makefile.template ]
Added support for lineno build option.
[91/08/26  11:26:52  jsb]

Added sequence numbers to the memory object interface.
Updated MACH_PORT_FUNCS.
[91/08/13            rpd]
Add new external memory management routines to libmig.
[91/07/03  13:58:50  dlb]
Removed rules pertaining to mach/norma_task.defs.
Added rules for building mach_user.o and mach_norma_user.o.
[91/08/15  13:24:48  jsb]
[ ./kernel/conf/files ]
Removed mach/norma_task_user.c.
Added mach_user.c and mach_norma_user.c.
Added norma/xmm_copy.c.
[91/08/15  13:00:43  jsb]
[ ./kernel/conf/files.i860 ]
Replaced cswitch.c with cswitch.s; removed ipsc/{node,dcmcom}.c.
[91/08/27  17:08:46  jsb]
[ ./kernel/ddb/db_aout.c ]
Added line number support, via X_db_line_at_pc.
[91/08/13  18:12:37  jsb]
[ ./kernel/ddb/db_examine.c ]
Added 'A' flag to examine: just like 'a' (address), but prints addr
as a procedure type, thus printing file/line info if available.
Useful when called as 'x/Ai'.
[91/08/13  18:14:55  jsb]
[ ./kernel/device/blkio.c ]
From rpd: documented what (*max_count)() does in block_io.
[91/08/22  15:30:18  jsb]

Unlimited size is for write only.
[91/08/12  17:44:31  dlb]

Support synchronous waits for writes with vm continuations.
Remove limit on size of operations.
[91/08/12  17:22:59  dlb]
[ ./kernel/device/chario.c ]
Fixed char_write to check vm_map_copyout's return code.
[91/08/03            rpd]
[ ./kernel/device/conf.h ]
Change block size entry to general device info entry.
[91/08/12  17:24:37  dlb]

Add block size entry.  Only needed for block_io devices.
[91/08/05  17:28:42  dlb]
[ ./kernel/device/ds_routines.c ]
From rpd: increased DEVICE_IO_MAP_SIZE; documented why
device_write_get cannot be used for in-band data.
[91/08/22  15:28:19  jsb]

In device_write_get, always set the wait parameter to something;
by default, it's FALSE.
[91/08/16  14:19:31  jsb]

Support synchronous wait by writers when vm continuations are present.
Optimize device_write_dealloc.  Fix MP bug in iowait/iodone.
Convert from bsize to dev_info entry in device op vector.
[91/08/12  17:27:15  dlb]

Page lists working reliably: delete old code.
[91/08/06  17:16:09  dlb]

Clean up and add continuation support for device_write page lists.
[91/08/05  17:30:38  dlb]

First version of support for vm page lists in device_write.
Still needs cleanup and continuation support.  Old code left
under #ifdef 0.  
[91/07/31  14:42:24  dlb]
[ ./kernel/device/ds_routines.h ]
Page list support: device_write_dealloc returns a boolean.
[91/08/05  17:32:28  dlb]
[ ./kernel/device/io_req.h ]
Removed semicolon after decl_simple_lock_data in io_req declaration.
[91/08/16  15:31:22  jsb]

Add lock and associated macros to io_req structure.
[91/08/12  17:28:46  dlb]

Add io_total for use by writes - io_count is for each driver
operation, io_total is for the entire device_write.
[91/08/05  17:34:49  dlb]

Add io_copy field to remember vm_map_copy_t that must be discarded
when a mapped (not inline) device_write completes.
[91/07/31  14:43:07  dlb]
[ ./kernel/device/net_io.c ]
Panic if network write attempted with continuation.
[91/08/12  17:29:53  dlb]
[ ./kernel/i386/db_trace.c ]
In stack traces, print file/line info if available.
[91/08/13  18:15:57  jsb]
[ ./kernel/i386at/conf.c ]
Fixed field-describing comment in dev_name_list definition.
[91/08/27  17:52:06  jsb]

Convert bsize entries to devinfo entries.  Add nodev entries for
[91/08/15  18:43:13  jsb]
[ ./kernel/i386at/hd.c ]
Replace hdbsize with hddevinfo.
[91/08/12  17:33:59  dlb]

Add block size routine.
[91/08/05  17:39:16  dlb]
[ ./kernel/i386at/m765knl.c ]
Replace fdbsize with fddevinfo.
[91/08/12  17:34:48  dlb]

Add block size routine.
[91/08/05  17:40:04  dlb]
[ ./kernel/i386ipsc/conf.c ]
Added entries for new dev_info field.
[91/08/27  17:54:02  jsb]
[ ./kernel/i386ipsc/dcm_input.c ]
Moved shortword count support here from norma/ipc_net.c.
[91/08/26  14:03:39  jsb]
[ ./kernel/i386ipsc/dcm_output.c ]
Moved shortword count support here from norma/ipc_net.c.
[91/08/26  14:04:28  jsb]
[ ./kernel/i860/_setjmp.s ]
From Intel SSD: new implementation.
[91/08/26  16:01:36  jsb]
[ ./kernel/i860/bcopy.s ]
From Intel SSD: added get_r1; changed sploff/splon.
[91/08/26  16:05:21  jsb]
[ ./kernel/i860/db_interface.c ]
Removed references to db_jmpbuf.
[91/08/27  11:03:20  jsb]

From Intel SSD: various changes.
[91/08/26  16:44:29  jsb]
[ ./kernel/i860/db_trace.c ]
From Intel SSD: use pcb->k_context (not context) in db_stack_trace_cmd.
[91/08/26  16:10:05  jsb]
[ ./kernel/i860/hardclock.c ]
Removed in_hardclock; added test of db_active.
[91/08/26  16:12:45  jsb]
[ ./kernel/i860/pcb.c ]
From Intel SSD: various fixes. Added pcb_get{cur,th}pcb for cswitch.s.
[91/08/26  17:01:02  jsb]
[ ./kernel/i860/setjmp.h ]
From Intel SSD: new definitions.
[91/08/26  16:16:46  jsb]
[ ./kernel/i860/start.s ]
From Intel SSDL: always come up single user; forcibly turn interrupts
off in thread_bootstrap.
[91/08/26  16:32:10  jsb]
[ ./kernel/i860/thread.h ]
From Intel SSD: changed pcb definition.
[91/08/26  16:38:06  jsb]
[ ./kernel/i860/trap.c ]
Missed a couple exception -> exc renames.
[91/08/27  17:02:26  jsb]

Removed unused user_page_fault_continue.
From Intel SSD: use RECOVERY conditional for recover code to be
enabled in the future; turn off trap_vm_debug by default;
added emul_vm_debug; added splon/sploff to trap() (on upon entry,
off before exit); added emulated_syscall().
[91/08/26  17:45:58  jsb]
[ ./kernel/i860/ttrap.s ]
Replaced astintr call with splsched, ast_taken calls.
Left a comment indicating that we should check asts again.
[91/08/27  11:02:32  jsb]

From Intel SSD: lots of fixes.
[91/08/26  15:55:25  jsb]
[ ./kernel/i860ipsc/autoconf.c ]
Eliminated call to ask_bootstrap_server.
Split dcm_init call into dcm_init_{send,recv}.
[91/08/26  15:40:29  jsb]
[ ./kernel/i860ipsc/conf.c ]
Added entries for new dev_info field.
[91/08/27  17:54:12  jsb]
[ ./kernel/i860ipsc/dcm_input.c ]
Updated for norma/ipc_net.c compatability.
Contains lots of debugging printfs.
[91/08/27  17:04:22  jsb]
[ ./kernel/i860ipsc/dcm_output.c ]
Updated for norma/ipc_net.c compatability.
Contains lots of debugging printfs.
Also contains dummy definitions for some new dbg routines.
[91/08/27  17:07:22  jsb]
[ ./kernel/i860ipsc/i860_init.c ]
From intel SSD: Fixed chip_state() and i860_interrupts_on().
[91/08/26  15:29:38  jsb]
[ ./kernel/i860ipsc/intr.c ]
From Intel SSD: fixed intr_poll() and otherint().
[91/08/26  15:33:05  jsb]
[ ./kernel/i860ipsc/led.c ]
Added spls where necessary.
[91/08/26  15:37:21  jsb]
[ ./kernel/i860ipsc/spl.c ]
From Intel SSD: overhauled spl implementation.
[91/08/26  15:34:58  jsb]
[ ./kernel/intel/pmap.c ]
From Intel SSD: add data cache flush in INVALIDATE_TLB to work around
some more subtle unknown bug in page table caching; allow user access
to various bits of I/O space?
[91/08/26  18:27:04  jsb]
[ ./kernel/intel/pmap.h ]
From Intel SSD: turn off caching for i860 for now.
[91/08/26  18:31:19  jsb]
[ ./kernel/ipc/ipc_kmsg.c ]
Changed msgh_kind to msgh_seqno.
[91/08/09            rpd]
Changed for new vm_map_copyout failure behavior.
[91/08/03            rpd]
Update page list discriminant logic to allow use of page list for
kernel objects that do not require page stealing (devices).
[91/07/31  15:00:55  dlb]

Add arg to vm_map_copyin_page_list.
[91/07/30  14:10:38  dlb]

Turn page lists on by default.
[91/07/03  14:01:00  dlb]
Renamed clport fields in struct ipc_port to ip_norma fields.
Added checks for sending receive rights remotely.
[91/08/15  08:22:20  jsb]
[ ./kernel/ipc/ipc_kmsg.h ]
Renamed IKM_SIZE_CLPORT to IKM_SIZE_NORMA.
[91/08/15  08:12:02  jsb]
[ ./kernel/ipc/ipc_mqueue.c ]
Added seqno argument to ipc_mqueue_receive.
Also added seqno processing to ipc_mqueue_send, ipc_mqueue_move.
[91/08/10            rpd]
Fixed norma_ipc_handoff technology.
Renamed clport things to norma_ipc things.
[91/08/15  08:23:17  jsb]
[ ./kernel/ipc/ipc_mqueue.h ]
Added seqno argument to ipc_mqueue_receive.
[91/08/10            rpd]
[ ./kernel/ipc/ipc_notify.c ]
Changed msgh_kind to msgh_seqno.
[91/08/09            rpd]
[ ./kernel/ipc/ipc_port.c ]
Added ip_seqno and ipc_port_set_seqno.
Changed ipc_port_init to initialize ip_seqno.
Changed ipc_port_clear_receiver to zero ip_seqno.
[91/08/09            rpd]
Renamed clport fields in struct ipc_port to ip_norma fields.
[91/08/15  08:20:08  jsb]
[ ./kernel/ipc/ipc_port.h ]
Added ip_seqno and ipc_port_set_seqno.
[91/08/09            rpd]
Renamed clport (now ip_norma) fields in struct ipc_port.
[91/08/14  19:31:55  jsb]
[ ./kernel/ipc/mach_msg.c ]
Changed MACH_RCV_TOO_LARGE and MACH_RCV_INVALID_NOTIFY to work
like MACH_RCV_HEADER_ERROR, using ipc_kmsg_copyout_dest.
[91/08/12            rpd]

Added seqno argument to ipc_mqueue_receive.
Updated mach_msg_trap fast path for seqno processing.
[91/08/10            rpd]
Fixed mach_msg_interrupt to check for MACH_RCV_IN_PROGRESS.
[91/08/03            rpd]
Renamed clport things to norma_ipc things.
[91/08/15  08:24:12  jsb]
[ ./kernel/ipc/mach_msg.h ]
Added mach_msg_interrupt.
[91/08/03            rpd]
[ ./kernel/ipc/mach_port.c ]
Added mach_port_set_seqno and updated mach_port_get_receive_status
for mps_seqno.  Added old_mach_port_get_receive_status.
[91/08/09            rpd]
Changed port_names for new vm_map_copyout failure behavior.
[91/08/03            rpd]
[ ./kernel/ipsc/usm.h ]
From Intel SSD: added some i860 UART register definitions.
[91/08/27  17:21:00  jsb]
[ ./kernel/kern/ast.c ]
Renamed AST_CLPORT to AST_NETIPC.
[91/08/14  21:39:25  jsb]
[ ./kernel/kern/ast.h ]
Renamed AST_CLPORT to AST_NETIPC.
[91/08/14  21:38:09  jsb]
[ ./kernel/kern/bootstrap.c ]
Changed msgh_kind to msgh_seqno.
[91/08/10            rpd]
[ ./kernel/kern/exception.c ]
Added seqno arguments to ipc_mqueue_receive
and exception_raise_continue_slow.
[91/08/10            rpd]

Changed msgh_kind to msgh_seqno.
[91/08/10            rpd]

Changed exception_no_server to print an informative message
before invoking kdb, so this doesn't look like a kernel bug.
[91/08/09            rpd]
[ ./kernel/kern/ipc_kobject.h ]
Add support for using page lists with devices.  Split the macro
that says whether to use page lists into a macro that says whether
to use them (vm_page_list) and a macro that says whether the pages
should be stolen (vm_page_steal).
[91/07/31  15:05:17  dlb]
[ ./kernel/kern/ipc_mig.c ]
Fixed syscall_mach_port_insert_right and syscall_task_set_special_port
to handle non-valid port names correctly.
[91/08/15            rpd]

Changed MACH_RCV_TOO_LARGE and MACH_RCV_INVALID_NOTIFY to work
like MACH_RCV_HEADER_ERROR, using ipc_kmsg_copyout_dest.
[91/08/12            rpd]

Added seqno argument to ipc_mqueue_receive.
[91/08/10            rpd]
Conditionalize mach_msg_rpc_from_kernel on NORMA_VM, not NORMA_TASK.
[91/08/14  18:34:30  jsb]
[ ./kernel/kern/startup.c ]
Start NORMA ipc and vm systems before user bootstrap.
[91/08/15  08:33:05  jsb]
[ ./kernel/kern/thread.c ]
Fixed thread_halt, mach_msg_interrupt interaction.
Added checks for thread_exception_return, thread_bootstrap_return.
[91/08/03            rpd]
[ ./kernel/kern/thread.h ]
Added ith_seqno.
[91/08/10            rpd]
[ ./kernel/kern/xpr.c ]
Fixed xprbootstrap to zero the allocate memory.
[91/08/18            rpd]
[ ./kernel/luna88k/conf.c ]
Added entries for new dev_info field.
[91/08/27  17:58:24  jsb]
[ ./kernel/mach/default_pager_object.defs ]
Added default_pager_info.
[91/08/15            rpd]
[ ./kernel/mach/mach.defs ]
Precious page support:  Add new version of memory_object_lock_request.
Add memory_object_{ready,change_attributes}.
[91/07/03  14:03:34  dlb]
Added KERNEL_USER definitions (for NORMA support).
[91/08/15  09:58:13  jsb]
[ ./kernel/mach/mach_norma.defs ]
Added KERNEL_USER definitions.
Removed norma_set_task_server.
Added task_create_remote, norma_copy_create.
[91/08/15  13:28:27  jsb]
[ ./kernel/mach/mach_port.defs ]
Added mach_port_set_seqno.  Moved mach_port_get_receive_status
to a new id, renaming the old call old_mach_port_get_receive_status.
[91/08/09            rpd]
[ ./kernel/mach/mach_types.defs ]
Increased the size of mach_port_status_t, for mps_seqno.
Added old_mach_port_status_t, for compatibility purposes.
[91/08/09            rpd]
Add memory_object_return_t for precious page support.
[91/07/03  14:04:25  dlb]
[ ./kernel/mach/memory_object.defs ]
Added conditionalized sequence number support.
[91/08/13            rpd]
Fixed memory_object_supply_completed and memory_object_data_return
to use mach_port_t as the C type name for port arguments.
[91/08/02            rpd]
Update types in new memory object routines.  Add
memory_object_change_completed.
[91/07/03  14:05:39  dlb]
[ ./kernel/mach/memory_object.h ]
Add defs for memory_object_return_t.
[91/07/03  14:06:26  dlb]
[ ./kernel/mach/memory_object_default.defs ]
Added conditionalized sequence number support.
[91/08/13            rpd]
[ ./kernel/mach/message.h ]
Replaced msgh_kind with msgh_seqno.
[91/08/09            rpd]
[ ./kernel/mach/mig_errors.h ]
Added MIG_SERVER_DIED.
[91/08/21            rpd]
[ ./kernel/mach/notify.defs ]
Added conditionalized sequence number support.
[91/08/13            rpd]
[ ./kernel/mach/port.h ]
Added mach_port_seqno_t.  Added mps_seqno to mach_port_status_t
and created old_mach_port_status_t for compatibility purposes.
[91/08/09            rpd]
[ ./kernel/mach/std_types.defs ]
Added mach_port_seqno_t.
[91/08/09            rpd]
[ ./kernel/mach_debug/vm_info.h ]
single_use --> use_old_pageout to match vm_object.h
[91/08/05  17:41:53  dlb]
[ ./kernel/mips/conf.c ]
Added entries for new dev_info field.
[91/08/27  17:59:55  jsb]
[ ./kernel/mips/db_mips_sym.c ]
Made message about preserving symtab uniform with other machines.
Added missing one in X_db_sym_init().
[91/08/27  16:42:03  af]
[ ./kernel/norma/ipc_ether.c ]
Generalized netipc_swap_device code.
[91/08/16  14:30:15  jsb]

Added fields to support nrp (node table resolution protocol),
allowing removal of hardwired table of node/ip/ether addresses.
[91/08/15  08:58:04  jsb]
[ ./kernel/norma/ipc_ether.h ]
Added fields to support nrp (node table resolution protocol).
[91/08/15  08:50:29  jsb]
[ ./kernel/norma/ipc_input.c ]
Mark received pages as dirty and not busy.
Initialize copy->cpy_cont and copy->cpy_cont_args.
[91/08/16  10:44:19  jsb]

Fixed reference to norma_ipc_kobject_send.
[91/08/15  08:42:23  jsb]

Renamed clport things to norma things.
[91/08/14  21:34:13  jsb]

Fixed norma_ipc_handoff code.
Added splon/sploff redefinition hack.
[91/08/14  19:11:07  jsb]
[ ./kernel/norma/ipc_kserver.c ]
As a hack to avoid printfs from i860ipsc/spl.c,
defined sploff/splon as splsched/splx.
[91/08/27  21:59:34  jsb]

Renamed clport things to norma things.
[91/08/15  09:11:36  jsb]
[ ./kernel/norma/ipc_net.c ]
Removed shortword count support (BTODEV, etc) since this can be handled
by each driver. Added a couple of hacks for i860 support.
[91/08/26  14:02:50  jsb]

Added changes in preparation for >1 window sizes.
Use array-based linked lists in place of full array search.
Renamed clport things to norma things.
[91/08/15  09:10:55  jsb]
[ ./kernel/norma/ipc_wait.c ]
Renamed ast_clport things to ast_netipc things.
[91/08/15  09:12:09  jsb]

Fixed, and added counters.
[91/08/14  19:22:35  jsb]
[ ./kernel/norma/ipc_xxx.c ]
Renamed clport things to norma things.
Eliminated NORMA_ETHER special case node/lid uid division.
[91/08/15  09:14:06  jsb]

Renamed ipc_clport_foo things to norma_ipc_foo.
Added host_port_at_node().
[91/08/14  19:21:16  jsb]
[ ./kernel/norma/kern_task.c ]
Turned off remaining printf.
[91/08/26  11:16:11  jsb]

Added support for remote task creation with inherited memory.
Remove task creation is accessible either via task_create_remote,
or task_create with task_server_node patched to some reasonable value.
[91/08/15  13:55:54  jsb]
[ ./kernel/norma/xmm_copy.c ]
In m_copy_data_request: removed dead code, and added missing
is_continuation parameter to vm_map_copyin_page_list.
[91/08/16  14:25:04  jsb]

First checkin.
[91/08/15  13:03:06  jsb]
[ ./kernel/norma/xmm_server.c ]
Added temporary definition for memory_object_change_completed.
[91/08/16  14:21:20  jsb]

Added comment to xmm_lookup about read-only pagers.
[91/08/15  10:12:12  jsb]
[ ./kernel/norma/xmm_server_rename.h ]
Added xxx_memory_object_lock_request, memory_object_data_supply,
memory_object_ready, and memory_object_change_attributes.
[91/08/16  14:32:26  jsb]
[ ./kernel/norma/xmm_user.c ]
Added definition for xxx_memory_object_lock_request, and temporary
stubs for data_supply, object_ready, and change_attributes.
[91/08/16  14:22:37  jsb]

Added check for internal memory objects to xmm_user_create.
[91/08/15  10:14:19  jsb]
[ ./kernel/norma/xmm_user_rename.h ]
Added supply_completed, data_return, change_completed.
[91/08/16  10:47:04  jsb]
[ ./kernel/scsi/adapters/scsi_33C93.h ]
Name prefix change, revised list of spec documents.
[91/08/27  17:11:47  af]
[ ./kernel/scsi/adapters/scsi_33C93_hdw.c ]
Added some more code, name prefix changed, new specs.
[91/08/27  17:12:59  af]
[ ./kernel/sqtconf/conf.c ]
Added entries for new dev_info field.
[91/08/27  17:56:16  jsb]
[ ./kernel/src/mig/global.c ]
Replaced ServerProcName with ServerDemux.
[91/08/13            rpd]

Removed Camelot and TrapRoutine support.
Changed MsgKind to MsgSeqno.
[91/08/12            rpd]
[ ./kernel/src/mig/global.h ]
Replaced ServerProcName with ServerDemux.
[91/08/13            rpd]

Removed Camelot and TrapRoutine support.
Changed MsgKind to MsgSeqno.
[91/08/12            rpd]
[ ./kernel/src/mig/header.c ]
Removed TrapRoutine support.
[91/08/12            rpd]
[ ./kernel/src/mig/lexxer.l ]
Added syServerDemux.
[91/08/13            rpd]

Removed syMsgKind, syCamelot, syCamelotRoutine, syTrapRoutine,
syTrapSimpleRoutine.  Added syMsgSeqno.
[91/08/11            rpd]
[ ./kernel/src/mig/mig.c ]
Removed TrapRoutine support.
[91/08/12            rpd]
[ ./kernel/src/mig/parser.y ]
Added ServerDemux.
[91/08/13            rpd]

Removed Camelot, TrapRoutine support.
Removed obsolete translation and destructor specs.
Replaced MsgKind with MsgSeqno.
[91/08/12            rpd]
[ ./kernel/src/mig/routine.c ]
Removed Camelot and TrapRoutine support.
Changed MsgKind to MsgSeqno.
[91/08/12            rpd]
[ ./kernel/src/mig/routine.h ]
Removed Camelot and TrapRoutine support.
Changed MsgKind to MsgSeqno.
[91/08/12            rpd]
[ ./kernel/src/mig/server.c ]
Replaced ServerProcName with ServerDemux.
[91/08/13            rpd]

Removed Camelot and TrapRoutine support.
Changed MsgKind to MsgSeqno.
[91/08/12            rpd]
[ ./kernel/src/mig/type.c ]
Removed itMsgKindType.
[91/08/12            rpd]
[ ./kernel/src/mig/type.h ]
Removed itMsgKindType.
[91/08/12            rpd]
[ ./kernel/src/mig/user.c ]
Added MIG_SERVER_DIED.
[91/08/21            rpd]
Removed Camelot and TrapRoutine support.
Changed MsgKind to MsgSeqno.
[91/08/12            rpd]
[ ./kernel/src/mig/write.h ]
Removed TrapRoutine support.
[91/08/12            rpd]
[ ./kernel/sun/conf.c ]
Added entries for new dev_info field.
[91/08/27  17:56:37  jsb]
[ ./kernel/vax/conf.c ]
Added entries for new dev_info field.
[91/08/27  17:57:06  jsb]
[ ./kernel/vm/memory_object.c ]
Continuation bug fix.
[91/08/05  17:42:57  dlb]

Add vm_map_copy continuation support to memory_object_data_supply.
[91/07/30  14:13:59  dlb]

Turn on page lists by default: gut and remove body of memory_object_
data_provided -- it's now a wrapper for memory_object_data_supply.
Precious page support:
    Extensive modifications to to memory_object_lock_{request,page}
    Implement old version wrapper xxx_memory_object_lock_request
    Maintain use_old_pageout field in vm objects.
    Add memory_object_ready, memory_object_change_attributes.
[91/07/03  14:11:35  dlb]
[ ./kernel/vm/vm_debug.c ]
single_use --> use_old_pageout in vm_object.
[91/08/05  17:44:32  dlb]
[ ./kernel/vm/vm_kern.c ]
Delete kmem_fault_wire, io_wire, io_unwire - Replaced by
kmem_io_{copyout,deallocate}.
[91/08/06  17:17:40  dlb]

Make kmem_io_map_deallocate return void.
[91/08/05  17:45:39  dlb]

New interfaces for kmem_io_map routines.
[91/08/02  17:07:40  dlb]

New and improved io wiring support based on vm page lists:
kmem_io_map_{copyout,deallocate}.  io_wire and io_unwire will
go away when the device logic fully supports this.
[91/07/31  15:12:02  dlb]
[ ./kernel/vm/vm_kern.h ]
Delete io_wire, io_unwire.
[91/08/06  17:18:36  dlb]

Add declarations for kmem_io_map_{copyout,deallocate}.
[91/08/05  17:46:55  dlb]
[ ./kernel/vm/vm_map.c ]
Changed vm_map_copyout to discard the copy object only upon success.
[91/08/03            rpd]
Initialize copy->cpy_cont and copy->cpy_cont args in
vm_map_convert_to_page_list and
vm_map_convert_to_page_list_from_object.
[91/08/16  10:34:53  jsb]

Optimize stealing wired pages case of vm_map_copyin_page_list.
[91/08/12  17:36:57  dlb]

Move vm_map_copy_steal pages in this file.  Improve comments,
and related cleanup.
[91/08/06  17:22:43  dlb]

Split page release logic for page lists into separate
routine, vm_map_copy_page_discard.  Minor continuation
bug fix.
[91/08/05  17:48:23  dlb]

Move logic that steals pages by making a new copy into a separate
routine since both vm_map_{copyin,copyout}_page_list may need it.
Also: Previous merge included logic to be a little more careful
about what gets copied when a map entry is duplicated.
[91/07/31  15:15:19  dlb]

Implement vm_map_copy continuation for page lists.  
Implement in transition map entries needed by the above.
[91/07/30  14:16:40  dlb]

New and improved version of vm_map_copyin_page_list:
    Clean up error handling (especially vm_fault_page returns).
    Avoid holding map locks across faults and page copies.
    Move page stealing code to separate loop to deal with
	pagein errors from vm_fault_page.
    Add support for stealing wired pages (allows page stealing on
	pagein from default pager).
[91/07/03  14:15:39  dlb]
Restored definition of vm_map_convert_from_page_list.
Added definition of vm_map_convert_to_page_list_from_object.
Added call to vm_map_convert_from_page_list to vm_map_copy_overwrite.
Added include of kern/assert.h.
[91/08/15  13:20:13  jsb]
[ ./kernel/vm/vm_map.h ]
Supplied missing argument to thread_block in vm_map_entry_wait.
[91/08/16  10:36:21  jsb]

Minor cleanups.
[91/08/06  17:26:24  dlb]

Discard pages before invoking or aborting a continuation.
[91/08/05  17:51:55  dlb]

Add declarations for in transition map entries and vm_map_copy
continuations.
[91/07/30  14:18:14  dlb]
[ ./kernel/vm/vm_object.c ]
Handle dirty private pages correctly in vm_object_terminate().
[91/07/30  14:18:54  dlb]

single_use --> use_old_pageout in object initialization template.
Support precious pages in vm_object_terminate().
[91/07/03  14:18:07  dlb]
[ ./kernel/vm/vm_object.h ]
single_use --> use_old_pageout in vm_object structure.
[91/07/03  14:18:59  dlb]
[ ./kernel/vm/vm_pageout.c ]
Fixed vm_pageout_scan to send pages to the default pager
when memory gets very tight.  This is the same idea as the old
vm_pageout_reserved_external and vm_pageout_reserved_internal,
but with a different implementation that forcibly double-pages.
[91/08/07            rpd]
Precious page support: return precious pages on pageout, use
memory_object_data_return instead of memory_object_data_write
when appropriate,
[91/07/03  14:20:57  dlb]
[ ./kernel/vm/vm_resident.c ]
Added vm_page_free_count_minimum.
Fixed divergence between vm_page_free and vm_page_replace.
Fixed vm_page_deactivate to handle absent/fictitious pages properly.
[91/08/07            rpd]
Replaced divergent, expanded vm_page_free code in vm_page_replace
with a call to vm_page_free itself.
[91/08/15  18:49:59  jsb]
[ ./kernel/vm/vm_user.c ]
Fixed vm_map to check memory_object with IP_VALID.
Changed vm_wire to use KERN_INVALID_{HOST,TASK,VALUE}
instead of a generic KERN_INVALID_ARGUMENT return code.
[91/07/12            rpd]
[ ./user/libmach/mach.h ]
Synced up with USER area mach.h by removing exc.h, mach_host.h,
memory_object_default.h, and memory_object_user.h.
[91/08/27  16:39:43  jsb]
[ ./user/threads/cprocs.c ]
Fixed the loop in cproc_fork_child that frees cprocs.
[91/08/23            rpd]
[ ./user/threads/cthread_internals.h ]
Fixed MACH_CALL to allow multi-line expressions.
[91/08/23            rpd]
[ ./user/threads/cthreads.c ]
Fixed mig_init initialization in cthread_fork_child.
[91/08/23            rpd]
[ ./kernel/device/dev_pager.c ]
For now, use older dev_pager code for NORMA_VM.
I'll fix this soon.
[91/08/28  11:24:45  jsb]
[ ./kernel/boot_ufs/default_pager.c ]
Fixed the default values of default_pager_internal_count and
default_pager_external_count.
[91/08/28            rpd]
[ ./user/threads/i386/cthreads.h ]
Safer definitions for spin_unlock and spin_try_lock from mib.
[ ./kernel/luna88k/locore/locore.c ]
As a hack to make things compile, added null definition
of thread_bootstrap_return.
[ ./kernel/i386/interrupt.s ]
Check for out-of-range interrupts.
[91/08/20            dbg]
[ ./kernel/i386/trap.c ]
Don't emulate IO instructions if in V86 mode.
[91/08/21            dbg]
[ ./kernel/i386/locore.s ]
Add tests for V86 mode in trace and GP fault checks.  Clear
direction flag at all kernel entry points.
[91/08/20            dbg]
[ ./kernel/mips/mips_init.c ]
New proms on 3max problem: getenv copies strings on the
stack sometimes.  Fixed default_get_memory_bitmap() accordingly.
[91/08/29            af]
[ ./kernel/boot_ufs/default_pager.c ]
A couple quick changes for NORMA_VM. Will be fixed later.
    
    
    
==========================================================================
   ***** MK Version MK63  (jsb) *****
    
    
New features:
--- --------

Finished merging Intel i860 support. Most of the new files are in
the mk/user tree, but there are some fixes to the mk/kernel tree.
The merged kernel now works well enough to come up single user
and run some commands.

Bug fixes:
--- -----

[PMAX]	  Picked up fix to booting problem from Sandro (actually,
	  from Rich's area).

Special notes:
------- -----

Built for i386 and pmax. Tested on ubik.mach and jsb.mach.
This includes UX28 server and emulator rebuilt using rebuilt
mk/release files.

Log messages:
--- --------

[ ./conf/version.edit ]
63
[ ./include/Makeconf ]
Added cross-compilation support via atsys variable.
[91/09/01  09:45:13  jsb]
[ ./include/Makefile ]
Replaced accidently deleted MACH_LUNA88K_INCLUDES definition.
Added missing '$' to MACH_I860_INCLUDES definition.
[91/09/04  11:08:51  jsb]

Added full i860 support.
[91/09/04  10:09:05  jsb]
[ ./kernel/boot_ufs/load.c ]
Fixed a printf in read_symtab_from_file (following failure of
get_symtab) by not printing unset variable ``result''.
[91/09/01  07:48:45  jsb]
[ ./kernel/i860/cswitch.s ]
First checkin.
[91/08/30  15:31:13  jsb]
[ ./kernel/i860/db_interface.c ]
Use jmp_buf db_recover instead of db_nofault. Updated kdb_trap.
[91/09/01  07:53:59  jsb]
[ ./kernel/i860/trap.c ]
Added astintr(), called from ttrap.s.
[91/09/04  08:48:43  jsb]
[ ./kernel/i860/ttrap.s ]
Revert to astintr, reimplemented elsewhere.
[91/09/04  07:31:56  jsb]
[ ./kernel/i860ipsc/dcm_input.c ]
Removed debugging printfs and made it work (sort of).
[91/09/04  09:08:06  jsb]
[ ./kernel/i860ipsc/dcm_output.c ]
Removed debugging printfs and made it work (sort of).
[91/09/04  09:08:42  jsb]
[ ./kernel/i860ipsc/usm.c ]
This is Intel's most recent usm.c, with my JUSTHACKIT code added
and enabled since things still act funny without it.
[91/09/04  08:39:09  jsb]
[ ./kernel/kern/sched_prim.c ]
Add a temporary hack to thread_dispatch for i860 support:
don't panic if thread->state is TH_WAIT.
[91/09/04  09:24:43  jsb]
[ ./kernel/norma/ipc_net.c ]
Removed i860 support hacks. Bumped up _netipc_timeout for ipsc to
work around not-yet-understood bug.
[91/09/04  09:45:22  jsb]
[ ./kernel/norma/ipc_wait.c ]
Use splhigh/splx instead of sploff/splon for now.
[91/09/04  09:46:45  jsb]
[ ./user/Makeconf ]
Added ATSYS variable which can be used to override use of @sys.
[91/09/04  10:11:15  jsb]
[ ./user/Makefile ]
Use $(atsys) in place of @sys.
[91/09/04  10:11:53  jsb]
[ ./user/libmach/Makefile ]
Use cc860 for i860.
[91/09/04  11:23:12  jsb]

From Intel SSD: added i860 cases.
[91/09/04  10:16:51  jsb]
[ ./user/libmach/i860/_setjmp.s ]
First checkin. Provided by Intel SSD.
[91/09/04  10:32:35  jsb]
[ ./user/libmach/i860/bcopy.s ]
First checkin. Provided by Intel SSD.
[91/09/04  10:32:49  jsb]
[ ./user/libmach/i860/bzero.s ]
First checkin. Provided by Intel SSD.
[91/09/04  10:33:01  jsb]
[ ./user/libmach/i860/crt0.c ]
First checkin. Provided by Intel SSD.
[91/09/04  10:36:20  jsb]

Created 12/12/90 dfc from Jim Hurley's code.
[91/09/04  10:33:22  jsb]
[ ./user/libmach/setjmp.h ]
From Intel SSD: added i860 support.
[91/09/04  10:14:32  jsb]
[ ./user/libmach/varargs.h ]
Added i860 support, provided by Intel SSD.
[91/09/04  10:34:52  jsb]
[ ./user/threads/Makefile ]
Use cc860 for i860.
[91/09/04  11:23:25  jsb]

From Intel SSD: Added I860_CPP for i860 support.
[91/09/02  08:57:36  jsb]
[ ./user/threads/i860/csw.s ]
First checkin. Contributed by Intel/SSD.
[91/09/02  08:54:36  jsb]
[ ./user/threads/i860/cthread_inline.awk ]
First checkin. Contributed by Intel/SSD.

i860/cthread_inline.awk
[91/09/02  08:55:28  jsb]
[ ./user/threads/i860/cthreads.h ]
First checkin. Derived from i386 sources by Intel/SSD.
[91/09/02  08:56:06  jsb]
[ ./user/threads/i860/lock.s ]
First checkin. Contributed by Intel/SSD.
[91/09/02  08:56:39  jsb]
[ ./user/threads/i860/thread.c ]
First checkin. Derived from i386 sources by Intel/SSD.
[91/09/02  08:42:47  jsb]
[ ./kernel/chips/lance.c ]
Don't let ethernet interrupts blow us away.
[91/09/04  11:35:00  jsb]
[ ./kernel/mips/autoconf.c ]
Don't let ethernet interrupts blow us away.
[91/09/04  11:36:17  jsb]
    
    
    
==========================================================================
   ***** MK Version MK64  (bohman) *****
    
    
New features:
--- --------

Added Macintosh II{,x,cx,ci,fx} and SE/30 support.  The IIsi has NOT been
tested, but it should work.  Should also work on future Macintoshes with
full 030's.  The kernel does not require an FPU to run.

The device pager now allocates vm_page structures on the fly from
memory_object_data_request().  This is so that large objects can be
mapped without running the system out of memory.

I fixed up the device_write inband code a bit.  A reply port is now not
required.  Also, device_write_get() for an inband request now copies
the data into an io_inband buffer.  This allows driver code to be less
complicated in handling inband requests.

I added strlen() to device/subrs.c (BSD version).

Bug fixes:
--- -----

I fixed ds_read_done() to not zfree() the io_inband buffer unless one
was actually allocated.

I made a few minor bug fixes in device/chario.c.

I changed launch_first_thread() to set active_stacks[] in addition to
setting active_threads[].  This means that load_context() is not required
to do this.

Organizational changes:
-------------- -------

None that I know of.

Special notes:
------- -----

This merge was done rather quickly, since I am leaving CMU very soon.  In
fact, no post merge testing has been done.  I expect that the Mach group
at CMU will test the non-mac systems soon.  Zon Williamson
(zon@andrew.cmu.edu) will be testing the mac system.  Contact him if you are
interested in learning how soon this will be done.

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
64
[ ./Directories/ALL ]
Added mac2.
[91/09/11  14:00:12  bohman]
[ ./Directories/mac2 ]
Created.
[91/09/11  14:02:19  bohman]
[ ./kernel/Makefile ]
mac2 support.
[91/09/11  14:06:43  bohman]
[ ./kernel/conf/MASTER ]
Added ufs_pager option and made it the default.  Not enabling it allows
a different default pager setup to be supplied.
[91/09/11  16:53:41  bohman]
[ ./kernel/conf/MASTER.mac2 ]
Created.
[91/09/11  16:56:07  bohman]
[ ./kernel/conf/MASTER.mac2.local ]
Created.
[91/09/11  16:57:20  bohman]
[ ./kernel/conf/Makefile.mac2 ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  16:58:31  bohman]
[ ./kernel/conf/Makefile.template ]
Added task_get_special_port to MACH_FUNCS.
[91/09/11  16:59:30  bohman]
[ ./kernel/conf/files ]
Added ufs_pager option.
Made boot_ufs/def_pager_setup.c optional on ufs_pager.
[91/09/11  17:01:20  bohman]
[ ./kernel/conf/files.mac2 ]
Created.
[91/09/11  17:02:41  bohman]
[ ./kernel/device/chario.c ]
Added missing clear of TS_TTSTOP in char_write().
TS_INIT belongs in t_state, not t_flags.
[91/09/11  17:04:18  bohman]
[ ./kernel/device/dev_pager.c ]
For device_map objects, don't setup the actual resident page mappings
at initialization time.  Instead, do it in response to actual requests
for the data.  I left in the old code for NORMA_VM.
[91/09/11  17:05:20  bohman]
[ ./kernel/device/ds_routines.c ]
Changed device_write_inband() to not require a reply port.
Fixed device_write_get() to allow inband calls.  In this case,
an io_inband buffer is allocated and the data is copied into it.
Fixed device_write_dealloc() to correctly deallocate io_inband
buffers.
Fixed ds_read_done() to free io_inband buffers only if one was
actually allocated.
[91/09/11  17:06:50  bohman]
[ ./kernel/device/subrs.c ]
Added strlen() (BSD version).
[91/09/11  17:07:25  bohman]
[ ./kernel/kern/bootstrap.c ]
Made bootstrap task call mac2 machine dependent code before running
'startup', which is loaded from the UX file system.  This needs to
be handled more generally in the future.
[91/09/11  17:07:59  bohman]
[ ./kernel/kern/startup.c ]
Changed launch_first_thread() to set active_stacks[] before
starting the first thread.
[91/09/11  17:08:23  bohman]
[ ./kernel/mac2/act.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:16:15  bohman]
[ ./kernel/mac2/act.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:18:07  bohman]
[ ./kernel/mac2/asm.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:20:09  bohman]
[ ./kernel/mac2/ast.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:21:19  bohman]
[ ./kernel/mac2/bitmap_inline.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:22:10  bohman]
[ ./kernel/mac2/call_frame.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:22:53  bohman]
[ ./kernel/mac2/clock.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:24:23  bohman]
[ ./kernel/mac2/clock.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:25:06  bohman]
[ ./kernel/mac2/conf.c ]
Created.
[91/09/11  14:26:30  bohman]
[ ./kernel/mac2/cpu.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:27:30  bohman]
[ ./kernel/mac2/cpu_inline.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:28:18  bohman]
[ ./kernel/mac2/emul_trap.s ]
Created.
[91/09/11  14:29:51  bohman]
[ ./kernel/mac2/endian.h ]
Created Mach 3.0 version from 2.5 version, deleting extraneous stuff.
[91/09/11  14:40:17  bohman]
[ ./kernel/mac2/exec.c ]
Created from vax version.
[91/09/11  14:41:46  bohman]
[ ./kernel/mac2/exec.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:43:04  bohman]
[ ./kernel/mac2/genassym.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:44:10  bohman]
[ ./kernel/mac2/ivect.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:44:57  bohman]
[ ./kernel/mac2/locore.s ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:45:54  bohman]
[ ./kernel/mac2/mac2_init.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:46:40  bohman]
[ ./kernel/mac2/mach_param.h ]
Created.
[91/09/11  14:47:35  bohman]
[ ./kernel/mac2/machdep.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:50:52  bohman]
[ ./kernel/mac2/machine_routines.h ]
Created.
[91/09/11  14:52:23  bohman]
[ ./kernel/mac2/machparam.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:53:31  bohman]
[ ./kernel/mac2/pager_support.c ]
Created.
[91/09/11  14:54:27  bohman]
[ ./kernel/mac2/pcb.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:55:26  bohman]
[ ./kernel/mac2/pmap.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:56:49  bohman]
[ ./kernel/mac2/pmap.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:57:46  bohman]
[ ./kernel/mac2/pmap_inline.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:58:28  bohman]
[ ./kernel/mac2/pmap_kmap.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:59:14  bohman]
[ ./kernel/mac2/pmmu_inline.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  14:59:50  bohman]
[ ./kernel/mac2/pmmu_log2phys.c ]
Created.
[91/09/11  15:01:14  bohman]
[ ./kernel/mac2/psl.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:01:51  bohman]
[ ./kernel/mac2/setroot.c ]
Created.
[91/09/11  15:02:41  bohman]
[ ./kernel/mac2/slots.c ]
Created.
[91/09/11  15:03:36  bohman]
[ ./kernel/mac2/slots.h ]
Created.
[91/09/11  15:04:27  bohman]
[ ./kernel/mac2/softint.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:05:07  bohman]
[ ./kernel/mac2/swapgeneric.c ]
Created.
[91/09/11  15:06:18  bohman]
[ ./kernel/mac2/thread.h ]
Created Mach 3.0 version from mac2/pcb.h of 2.5 version.
[91/09/11  15:21:01  bohman]
[ ./kernel/mac2/time_stamp.h ]
Created.
[91/09/11  15:09:56  bohman]
[ ./kernel/mac2/trap.c ]
Changed TRAP_BREAKPOINT in user_trap() to not
decrement pc to trap instruction.
Created MACH 3.0 version from 2.5 version.
[91/09/11  15:11:19  bohman]
[ ./kernel/mac2/trap.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:12:15  bohman]
[ ./kernel/mac2/virt.s ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:12:50  bohman]
[ ./kernel/mac2/vm_tuning.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:14:30  bohman]
[ ./kernel/mac2/xpr.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:16:00  bohman]
[ ./kernel/mac2dev/adb.c ]
Created.
[91/09/11  15:23:32  bohman]
[ ./kernel/mac2dev/adb.h ]
Created.
[91/09/11  15:24:40  bohman]
[ ./kernel/mac2dev/cons.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:25:22  bohman]
[ ./kernel/mac2dev/font.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:26:12  bohman]
[ ./kernel/mac2dev/font1.s ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:26:55  bohman]
[ ./kernel/mac2dev/font_521.b ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:33:24  bohman]
[ ./kernel/mac2dev/font_524.b ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:34:27  bohman]
[ ./kernel/mac2dev/mhd.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  15:35:03  bohman]
[ ./kernel/mac2dev/mscsi.c ]
Created.
[91/09/11  15:35:57  bohman]
[ ./kernel/mac2dev/mscsi.h ]
Created.
[91/09/11  16:00:42  bohman]
[ ./kernel/mac2dev/sdisk.c ]
Created.
[91/09/11  16:01:41  bohman]
[ ./kernel/mac2dev/sdisk.h ]
Created.
[91/09/11  16:02:51  bohman]
[ ./kernel/mac2dev/sony.c ]
Created.
[91/09/11  16:04:36  bohman]
[ ./kernel/mac2dev/sony_done.s ]
Created.
[91/09/11  16:05:27  bohman]
[ ./kernel/mac2dev/thread_io.c ]
Created.
[91/09/11  16:06:16  bohman]
[ ./kernel/mac2dev/thread_io_done.s ]
Created.
[91/09/11  16:07:27  bohman]
[ ./kernel/mac2dev/video.c ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  16:08:10  bohman]
[ ./kernel/mac2dev/video.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  16:09:38  bohman]
[ ./kernel/mac2extra/macobjects.c ]
Created.
[91/09/11  16:40:33  bohman]
[ ./kernel/mac2extra/macobjects_kern.c ]
Created.
[91/09/11  16:41:26  bohman]
[ ./kernel/mac2extra/macserver.defs ]
Created.
[91/09/11  16:43:47  bohman]
[ ./kernel/mac2if/if_en.c ]
Created.
[91/09/11  16:17:20  bohman]
[ ./kernel/mac2if/if_en.h ]
Created.
[91/09/11  16:18:08  bohman]
[ ./kernel/mac2if/if_enproto.s ]
Created.
[91/09/11  16:19:02  bohman]
[ ./kernel/mac2os/DeskBus.h ]
Created.
[91/09/11  16:25:31  bohman]
[ ./kernel/mac2os/Disks.h ]
Created.
[91/09/11  16:26:26  bohman]
[ ./kernel/mac2os/Errors.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  16:27:04  bohman]
[ ./kernel/mac2os/Ethernet.h ]
Created.
[91/09/11  16:28:05  bohman]
[ ./kernel/mac2os/Files.h ]
Created.
[91/09/11  16:28:58  bohman]
[ ./kernel/mac2os/Globals.h ]
Created.
[91/09/11  16:29:59  bohman]
[ ./kernel/mac2os/ROMDefs.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  16:30:36  bohman]
[ ./kernel/mac2os/Retrace.h ]
Created.
[91/09/11  16:31:35  bohman]
[ ./kernel/mac2os/SCSI.h ]
Created.
[91/09/11  16:32:34  bohman]
[ ./kernel/mac2os/Slots.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  16:33:48  bohman]
[ ./kernel/mac2os/Timer.h ]
Created.
[91/09/11  16:34:39  bohman]
[ ./kernel/mac2os/Traps.h ]
Created.
[91/09/11  16:35:56  bohman]
[ ./kernel/mac2os/Types.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  16:36:35  bohman]
[ ./kernel/mac2os/Video.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  16:37:14  bohman]
[ ./kernel/mac2os/os_interface.s ]
Created.
[91/09/11  16:38:07  bohman]
[ ./kernel/mach/mac2/boolean.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  17:11:38  bohman]
[ ./kernel/mach/mac2/exception.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  17:12:17  bohman]
[ ./kernel/mach/mac2/frame.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  17:12:52  bohman]
[ ./kernel/mach/mac2/kern_return.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  17:13:28  bohman]
[ ./kernel/mach/mac2/reg.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  17:14:09  bohman]
[ ./kernel/mach/mac2/syscall_sw.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  17:14:59  bohman]
[ ./kernel/mach/mac2/thread_status.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  17:15:42  bohman]
[ ./kernel/mach/mac2/vm_param.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  17:16:38  bohman]
[ ./kernel/mach/mac2/vm_types.h ]
Created Mach 3.0 version from 2.5 version.
[91/09/11  17:17:13  bohman]
[ ./kernel/src/config/config.y ]
Added mac2.
[91/09/11  17:21:32  bohman]
[ ./kernel/src/config/main.c ]
Added mac2.
[91/09/11  17:22:03  bohman]
[ ./kernel/src/mig/Makefile ]
Added mac2.
[91/09/11  17:22:34  bohman]
[ ./kernel/sys/varargs.h ]
Added mac2.
[91/09/11  17:22:52  bohman]
    
    
    
==========================================================================
   ***** MK Version MK65  (af) *****
    
    
New features:
--- --------

Debugger extensions and modifications from OSF.


Bug fixes:
--- -----

Many, see log.


******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
65
[ ./kernel/conf/files.i386 ]
From 2.5, switch over to fd.c vs *765*
[91/09/04  22:03:09  rvb]
[ ./kernel/i386/interrupt.s ]
From mg32: testing for spurious interrupts is bogus.
[91/09/23            rvb]
[ ./kernel/i386/locore.s ]
tenmicrosec() was all wrong has been expunged, since noone uses
it.
[91/09/04            rvb]
[ ./kernel/i386/loose_ends.c ]
Removed strlen(), which is now MI.
[91/10/05            af]
[ ./kernel/i386/pit.c ]
tenmicrosec() was all wrong has been expunged, since noone uses
it.
[91/09/04            rvb]
[ ./kernel/i386at/autoconf.c ]
Allow for second fd controller and fix hd entry.
[91/10/01  15:26:32  rvb]

Synchronize with 2.5 tables.
[91/09/04            rvb]
[ ./kernel/i386at/com.c ]
Add some improvements from 2.5 version.
[91/09/04  22:05:25  rvb]
[ ./kernel/i386at/disk.h ]
From 2.5:
 	p_flag & p_tag -> p_flag
[91/09/09            rvb]
[ ./kernel/i386at/fd.c ]
Still better
[91/10/07  16:29:57  rvb]

From mg32: Better probe for multiple controllers now possible.
[91/09/23            rvb]
New chips/busses.[ch] nomenclature.
[91/09/09  17:12:23  rvb]

Added a reset in open to prevent "no such device" errors
Added dlb's fddevinfo.
Reworked to make 2.5/3.0 compatible
[91/09/04  15:46:49  rvb]
[ ./kernel/i386at/fdreg.h ]
More mg32 changes
[91/10/07            rvb]
New chips/busses.[ch] nomenclature.
[91/09/09  17:11:55  rvb]

Synched again with 2.5.
[91/09/04            rvb]
[ ./kernel/i386at/hd.c ]
Now works with 2 disk drives, new probe/slave routines, misc cleanup
[91/08/07            mg32]

From 2.5:
		Rationalize p_flag
		Kill nuisance print out.
		Removed "hdioctl(): do not recognize ioctl ..." printf().
[91/08/07            rvb]
[ ./kernel/i386at/hdreg.h ]
Made port addresses dependent on base address, cleaned up hh struct
[91/08/07            mg32]
[ ./kernel/i386at/if_pc586.c ]
Add a lot of fixes/improvements from 2.5.
[91/09/04            rvb]
[ ./kernel/i386at/kd.c ]
Add support for ibm ps2 "keyboard" mouse.  Try to be general
about it to support other "keyboard mice", but we don't have
any.
[91/09/25            rvb]
Changes by mg32 from Mach2.5:
  	Neet bug.  Setting LED's yields TWO ack's.  And since we
  	only read one this screwed us up.
  	Bound's check the esc string
[91/09/04            rvb]
[ ./kernel/i386at/kd_mouse.c ]
Add support for ibm ps2 "keyboard" mouse.  Try to be general
about it to support other "keyboard mice", but we don't have
any.
[91/09/25            rvb]
Add support for MicroSoft 2 button Mouse from 2.5
[91/09/04            rvb]
[ ./kernel/i386at/kdasm.s ]
From 2.5: Always set "direction bit" before rep.
	([91/05/03            rvb])
[91/09/04            rvb]
[ ./MERGE_HISTORY ]
MK65 done.
[ ./kernel/chips/busses.c ]
Changed to never overwrite the *->address and *->phys_address
fields in either master or device descriptors.  This lets the
probe routine use them as it pleases, and modify them if
necessary.
Also, if the device does have a phys address insist that we match.
[91/09/03            af]
[ ./kernel/conf/MASTER.i386 ]
Revision 2.17.1.1  91/09/23  23:00:23  rvb
	Allow for 4 hd's and 4 fd's
Revision 2.17.2.1  91/10/05  13:01:18  jeffreyh
	Deleted "-x" option from LDFLAGS to keep static symbol information.
	[91/08/29            tak]
[ ./kernel/conf/Makefile.mips ]
The lineno option wasn't passed along appropriately.
Note that locore.s needs it if you want to be able to
trace into user space.
[91/10/05  10:12:35  af]
[ ./kernel/conf/files ]
Revision 2.24.1.1  91/10/05  13:01:45  jeffreyh
	Added ddb/{db_cond.c, db_macro.c, db_task_thread.c}.
	[91/08/29            tak]
[ ./kernel/ddb/db_access.c ]
 Revision 2.4.3.1  91/10/05  13:03:41  jeffreyh
 	Added db_{get,put}_task_value, and changed db_{get,put}_value
 	  to call them.  db_{get,put}_value are left for compatibility
 	  reason.
 	Added "task" parameter to specifiy target task space.
 	Added db_access_level to indicate implementation dependent
 	  access capability.
 	[91/08/29            tak]
[ ./kernel/ddb/db_access.h ]
 Revision 2.4.3.1  91/10/05  13:03:49  jeffreyh
 	Added declarations of db_{get,put}_task_value.
 	Added definitions of implementation dependent access capability.
 	Added default defines of space access check functions.
 	[91/08/29            tak]
[ ./kernel/ddb/db_aout.c ]
 Revision 2.8.1.1  91/10/05  13:04:00  jeffreyh
 	Supported address lookup with line number.
 	Changed X_db_line_at_pc to get file name without compiled
 	  with -g option.
 	Included "stab.h" for symbol type definitions.
 	[91/08/29            tak]
[ ./kernel/ddb/db_break.c ]
 Revision 2.9.2.1  91/10/05  13:04:32  jeffreyh
 	Supported thread-oriented break points.
 	[91/08/29            tak]
[ ./kernel/ddb/db_break.h ]
 Revision 2.5.3.1  91/10/05  13:05:04  jeffreyh
 	Added db_thread_breakpoint structure, and added task and threads
 	field to db_breakpoint structure.  Some status flags were also
 	added to keep track user space break point correctly.
 	[91/08/29            tak]
[ ./kernel/ddb/db_command.c ]
 Revision 2.15.1.1  91/10/05  13:05:19  jeffreyh
 	Added compound, macro, and conditional command support.
	Added "xf" and "xb" command to examine forward and backward.
 	Added last command execution with "!!".
 	Added "show task" command.
 	Added "ipc_port" command to print all IPC ports in a task.
 	Added dot address and default thread indicator in prompt.
 	Changed error messages to output more information.
 	Moved "skip_to_eol()" to db_lex.c.
 	[91/08/29            tak]
[ ./kernel/ddb/db_command.h ]
 Revision 2.5.2.1  91/10/05  13:05:30  jeffreyh
 	Added db_exec_conditional_cmd(), and db_option().
 	Deleted db_skip_to_eol().
 	[91/08/29            tak]
[ ./kernel/ddb/db_cond.c ]
 Revision 2.1.3.1  91/10/05  13:05:38  jeffreyh
 	Created to support conditional break point and command execution.
 	[91/08/29            tak]
[ ./kernel/ddb/db_examine.c ]
 Revision 2.6.1.1  91/10/05  13:05:49  jeffreyh
 	Supported non current task space data examination and search.
 	Added 'm' format and db_xcdump to print with hex and characters.
 	Added db_examine_{forward, backward}.
 	Changed db_print_cmd to support variable number of parameters
 	including string constant.
 	Included "db_access.h".
 	[91/08/29            tak]
[ ./kernel/ddb/db_expr.c ]
 Revision 2.4.3.1  91/10/05  13:06:04  jeffreyh
 	Added relational expression etc. to support condition expression.
 	Supported modifier after indirect expression to specify size,
 	  sign extention and non current task space indirection.
 	Changed error messages to print more information.
 	[91/08/29            tak]
[ ./kernel/ddb/db_input.c ]
 Revision 2.6.2.1  91/10/05  13:06:12  jeffreyh
 	Fixed incorrect db_lbuf_end setting.
 	[91/08/29            tak]
[ ./kernel/ddb/db_lex.c ]
 Revision 2.4.3.1  91/10/05  13:06:25  jeffreyh
 	Added relational operator tokens and string constant etc.
 	Added input switching functions for macro and conditional command.
 	Moved skip_to_eol() from db_command.c and added db_last_lp to print
 	  skipped input data as a warning message.
 	Added last input repetition support to db_read_line.
 	Changed db_lex() to always set db_tok_string for error message.
 	[91/08/29            tak]
[ ./kernel/ddb/db_lex.h ]
 Revision 2.4.3.1  91/10/05  13:06:34  jeffreyh
 	Added db_lex_context structure and some routine declarations
 	  for macro and conditinal command.
 	Added relational operator tokens etc. for condition expression.
 	Changed TOK_STRING_SIZE from 120 to 64, and defined
 	  DB_LEX_LINE_SIZE as 256 which was previously embedded
 	  in db_lex.c as 120.
 	[91/08/29            tak]
Revision 2.4.1 91/07/15  09:30:00  tak
	Added db_lex_context for macro support
	Added some lexical constants to support logical expression etc.
	[91/05/15  13:55:00  tak]
[ ./kernel/ddb/db_macro.c ]
 Revision 2.1.3.1  91/10/05  13:06:40  jeffreyh
 	Created for macro support.
 	[91/08/29            tak]
[ ./kernel/ddb/db_output.c ]
 Revision 2.5.2.1  91/10/05  13:06:46  jeffreyh
 	Added "more" like function.
 	[91/08/29            tak]
[ ./kernel/ddb/db_print.c ]
 Revision 2.9.1.1  91/10/05  13:06:54  jeffreyh
 	Supported "show registers" for non current thread.
 	Changed display format of thread and task information.
 	Changed "show thread" to print current thread information 
 	  if no thread is specified.
 	Added "show_one_task" for "show task" command.
 	Added IPC port print routines for "show ipc_port" command.
 	[91/08/29            tak]
[ ./kernel/ddb/db_run.c ]
 Revision 2.8.2.1  91/10/05  13:07:06  jeffreyh
 	Added task parameter for user space break point, and changed
 	 db_find_breakpoint_here to db_find_thread_breakpoint_here
 	 to support thread based break point.
 	Changed db_{set,clear}_single_step to db_{set,clear}_task_single
 	 _step to add task paramter and to maintain compatibility.
 	[91/08/29            tak]
[ ./kernel/ddb/db_sym.c ]
 Revision 2.9.2.1  91/10/05  13:07:27  jeffreyh
 	Changed symbol table name qualification syntax from "xxx:yyy"
 	  to "xxx::yyy" to allow "file:func:line" in "yyy" part.
	       "db_sym_parse_and_lookup" is also added for "yyy" part parsing.
 	Replaced db_search_symbol with db_search_task_symbol, and moved
 	  it to "db_sym.h" as a macro.
 	Added db_task_printsym, and changed db_printsym to call it.
 	Added include "db_task_thread.h".
 	Fixed infinite recursion of db_symbol_values.
 	[91/08/29            tak]
[ ./kernel/ddb/db_sym.h ]
 Revision 2.5.1.1  91/10/05  13:07:39  jeffreyh
 	Added macro definitions of db_find_task_sym_and_offset(),
 	  db_find_xtrn_task_sym_and_offset(), db_search_symbol().
 	[91/08/29            tak]
[ ./kernel/ddb/db_task_thread.c ]
 Revision 2.1.3.1  91/10/05  13:07:50  jeffreyh
 	Created for task/thread handling.
 	[91/08/29            tak]
[ ./kernel/ddb/db_task_thread.h ]
 Revision 2.1.3.1  91/10/05  13:08:07  jeffreyh
 	Created for task/thread handling.
 	[91/08/29            tak]
[ ./kernel/ddb/db_trap.c ]
 Revision 2.7.3.1  91/10/05  13:08:18  jeffreyh
 	Replaced db_trap function with db_task_trap, and changed
 	 db_trap to call db_task_trap with user_space parameter.
 	 db_trap exists only for backward compatibility.
 	Passed task parameter for user space break point support.
 	[91/08/29            tak]
[ ./kernel/ddb/db_variables.c ]
 Revision 2.4.3.1  91/10/05  13:08:27  jeffreyh
 	Added suffix handling and thread handling of variables.
	Added new variables: lines, task, thread, work and arg.
	Moved db_read_variable and db_write_variable to db_variables.h
 	  as macros, and added db_read_write_variable instead.
 	Changed some error messages.
 	[91/08/29            tak]
[ ./kernel/ddb/db_variables.h ]
 Revision 2.4.3.1  91/10/05  13:08:42  jeffreyh
 	Added suffix related field to db_variable structure.
 	Added macro definitions of db_{read,write}_variable.
 	[91/08/29            tak]
[ ./kernel/ddb/db_watch.c ]
 Revision 2.6.3.1  91/10/05  13:08:50  jeffreyh
 	Added user space watch point support including non current task.
 	Changed "map" field of db_watchpoint structure to "task"
 	  for a user to easily understand the target space.
 	[91/08/29            tak]
[ ./kernel/ddb/db_watch.h ]
 Revision 2.4.3.1  91/10/05  13:09:14  jeffreyh
 	Changed "map" field of db_watchpoint structure to "task",
 	and also changed paramters of function declarations.
 	[91/08/29            tak]
[ ./kernel/ddb/db_write_cmd.c ]
 Revision 2.5.3.1  91/10/05  13:09:25  jeffreyh
	Added user space write support including inactive task.
 	[91/08/29            tak]
[ ./kernel/ddb/stab.h ]
 Revision 2.1  91/10/05  13:02:42  jeffreyh
 Created.
[ ./kernel/device/ds_routines.c ]
Fixed device_write_get to check kmem_io_map_copyout return code.
Enabled wait_for_space in device_io_map.
[91/09/17            rpd]
[ ./kernel/i386/db_disasm.c ]
 Revision 2.4.3.1  91/10/05  13:09:57  jeffreyh
 	Supported disassemble of non current task by passing task parameter.
 	[91/08/29            tak]
[ ./kernel/i386/db_interface.c ]
 Revision 2.7.2.1  91/10/05  13:10:15  jeffreyh
 	Added user space access and check routines.
 	Added UNIX task information print routines.
 	Changed db_trap to db_task_trap.
 	[91/08/29            tak]
[ ./kernel/i386/db_machdep.h ]
 Revision 2.6.3.1  91/10/05  13:10:32  jeffreyh
 	Added access and task name macros.
 	[91/08/29            tak]
[ ./kernel/i386/db_trace.c ]
 Revision 2.8.2.1  91/10/05  13:10:45  jeffreyh
 	Supported stack trace and register access of non current thread.
 	Supported user register access.
 	Fixed incorrect next frame check.
 	[91/08/29            tak]
 Revision 2.8.1.1  91/09/29  13:08:09  rpd
 	Fixed stack tracing for threads without kernel stacks.  Yes, again.
 	[91/09/26            rpd]
[ ./kernel/i386/pcb.c ]
 Revision 2.11.2.1  91/10/05  13:11:06  jeffreyh
 	Set value of kenrel_stack field in stack_handoff().
 	[91/08/29            tak]
[ ./kernel/i386/trap.c ]
 Revision 2.17.1.1  91/10/05  13:11:17  jeffreyh
 	Checked kdb trap for user space T_DUBUG and T_INT3.
 	[91/08/29            tak]
[ ./kernel/i386at/if_ns8390.c ]
 Revision 2.12.1.1  91/09/03  17:28:50  af
 	Fixes from 2.5 (from rvb), made sure two WD boards work (with
 	help from jeffreyh).
[ ./kernel/i860/loose_ends.c ]
 Revision 2.3.1.1  91/09/22  14:56:13  rpd
 	Removed strlen.
 	[91/09/22            rpd]
[ ./kernel/ipc/ipc_entry.c ]
 Revision 2.6.2.1  91/09/16  10:15:30  rpd
 	Added <ipc/ipc_hash.h>.
 	[91/09/02            rpd]
[ ./kernel/ipc/ipc_kmsg.c ]
 Revision 2.16.2.2  91/10/05  15:58:10  rpd
 	Changed msgh_kind to msgh_seqno in ipc_msg_print.
 	[91/10/05            rpd]
 Revision 2.16.2.1  91/09/16  10:15:35  rpd
 	Removed unused variables.  Added <ipc/ipc_notify.h>.
 	[91/09/02            rpd]
[ ./kernel/ipc/ipc_object.h ]
 Revision 2.5.2.1  91/09/16  10:15:46  rpd
 	Added (unconditional) ipc_object_print declaration.
 	[91/09/02            rpd]
[ ./kernel/ipc/ipc_port.c ]
 Revision 2.10.2.1  91/09/16  10:15:49  rpd
 	Removed unused variable.
 	[91/09/16  09:42:52  rpd]
[ ./kernel/ipc/ipc_port.h ]
 Revision 2.9.2.1  91/09/16  10:15:53  rpd
 	Added (unconditional) ipc_port_print declaration.
 	[91/09/02            rpd]
[ ./kernel/ipc/ipc_pset.h ]
 Revision 2.5.2.1  91/09/16  10:15:55  rpd
 	Added (unconditional) ipc_pset_print declaration.
 	[91/09/02            rpd]
[ ./kernel/ipc/ipc_space.c ]
 Revision 2.7.2.1  91/09/16  10:15:57  rpd
 	Added <ipc/ipc_hash.h>.
 	[91/09/02            rpd]
[ ./kernel/ipc/ipc_splay.c ]
 Revision 2.4.2.1  91/09/16  10:16:00  rpd
 	Added MACH_PORT_SMALLEST, MACH_PORT_LARGEST definitions to reduce lint.
 	[91/09/02            rpd]
[ ./kernel/ipc/ipc_splay.h ]
 Revision 2.4.2.1  91/09/16  10:16:03  rpd
 	Fixed typo in ipc_splay_tree_insert declaration.
 	[91/09/02            rpd]
[ ./kernel/ipc/ipc_table.c ]
 Revision 2.5.2.1  91/09/16  10:16:06  rpd
 	Removed unused variables.
 	[91/09/02            rpd]
[ ./kernel/ipc/mach_msg.c ]
 Revision 2.13.2.1  91/09/16  10:16:09  rpd
 	Added <ipc/ipc_notify.h>.  Fixed type-mismatch in msg_rpc_trap.
 	[91/09/02            rpd]
[ ./kernel/ipc/mach_port.c ]
 Revision 2.5.2.1  91/09/16  10:16:19  rpd
 	Added <ipc/ipc_notify.h>.
 	[91/09/02            rpd]
[ ./kernel/kern/syscall_emulation.c ]
Everyone gets as many syscalls as mips, needed
on e.g. vax and sun for AFS support.
[91/10/07            af]
[ ./kernel/kern/xpr.c ]
Removed xpr_save.  Modified xpr_dump to make it useful
for dumping xpr buffers in user space tasks.
[91/09/20            rpd]

Turned on xprenable by default.  xprbootstrap now preserves
the original contents of the buffer if xprenable is off.
[91/09/18            rpd]
[ ./kernel/luna88k/db_trace.c ]
Added parens for initializers to db_regs[].
[91/10/07            af]
[ ./kernel/mach/message.h ]
 Revision 2.10.1.1  91/10/05  15:44:57  rpd
 	Added check for __STDC__ to get function prototypes.
 	Removed MACH_MSGH_KIND_NOTIFICATION compatibility definition.
[ ./kernel/mips/PMAX/kmin.c ]
 Revision 2.2.1.1  91/08/30  11:45:33  af
 	Moved REX's memory bitmap routine elsewhere, it is used
 	also by 3maxen with the new boot.
[ ./kernel/mips/PMAX/kn02_dma.c ]
 Revision 2.2.1.1  91/08/30  11:37:05  af
 	Made sure it works under 2.5.
[ ./kernel/mips/PMAX/model_dep.c ]
 Revision 2.8.1.1  91/08/30  11:43:55  af
 	Sigh, ds 5000 with new proms AND new boot need the REX
 	interface, all of it.
 	Moved REX's memory bitmap routine here from kmin file.
[ ./kernel/mips/db_disasm.c ]
 Revision 2.5.1.1  91/10/05  13:11:59  jeffreyh
 	Changed db_get_value and db_printsym to db_get_task_value and
 	  db_task_printsym, and passed task or thread parameter to
 	  some function calls.
 	[91/09/05            tak]
[ ./kernel/mips/db_interface.c ]
 Revision 2.12.1.1  91/10/05  13:12:12  jeffreyh
 	Added user space access and check routines.
 	Added UNIX tasak information print routines.
 	Changed db_trap to db_task_trap.
 	[91/09/05            tak]
[ ./kernel/mips/db_machdep.h ]
 Revision 2.6.1.1  91/10/05  13:12:27  jeffreyh
 	Added access and task name macros and screen size definitions.
 	[91/09/05            tak]
[ ./kernel/mips/db_mips_sym.c ]
 Revision 2.9.1.1  91/10/05  13:12:38  jeffreyh
	Supported address lookup with line number.
 	[91/09/05            tak]
[ ./kernel/mips/db_trace.c ]
Fixed db_trace_cproc.
[91/09/19            rpd]
[ ./kernel/mips/mips_instruction.c ]
 Revision 2.12.1.1  91/10/05  13:20:51  jeffreyh
 	Added a paramter to stack_modified to pass an argument to
 	  "getreg" function.
 	Added db_restore_regs to get saved register value.
	[91/09/05            tak]
[ ./kernel/mips/mips_misc.c ]
 Revision 2.10.1.1  91/10/05  13:21:33  jeffreyh
 	correct gets problem
[ ./kernel/mips/swapgeneric.c ]
 Revision 2.9.1.1  91/10/05  13:22:36  jeffreyh
 	correct gets problem
[ ./kernel/mips/trap.c ]
On breakpoint exceptions we were taking the instruction
from the wrong place.
[91/09/29            af]
[ ./kernel/scsi/adapters/scsi_7061_hdw.c ]
 Revision 2.13.1.1  91/09/22  14:56:46  rpd
 	Fix from Sandro for a race in sii_dosynch.
 	[91/09/18            rpd]
[ ./kernel/scsi/adapters/scsi_user_dma.c ]
Moved over from 2.5 tree, and made machine independent.
[ ./kernel/scsi/adapters/scsi_user_dma.h ]
Moved over from 2.5 tree, and made machine independent.
[ ./kernel/scsi/compat_30.h ]
 Revision 2.5.1.1  91/08/29  18:10:28  af
 	The 2.5 raw-I/O support code has moved, and became MI.
[ ./kernel/scsi/mapped_scsi.c ]
Changing the header files broke this module cuz padding, fixed now.
Made to work with the DEC driver first, and then with our driver
in user space.
[91/10/05  10:23:39  af]
[ ./kernel/scsi/mapped_scsi.h ]
Define maximum size of mapped region.  The fifo flags
for the ASC chip do not change with interrupt ack, the
command might.
[91/10/05  10:25:03  af]
[ ./kernel/scsi/rz.c ]
 Revision 2.10.1.1  91/09/01  17:17:17  af
 	Zero io_error before using the ior.
[ ./kernel/scsi/rz_disk.c ]
Do not tolerate a negative io_count (sanity).
[91/10/05  10:21:09  af]
[ ./kernel/scsi/rz_tape.c ]
 Revision 2.9.1.2  91/09/01  17:16:50  af
 	Zero io_error before using the ior.
 Revision 2.9.1.1  91/08/29  18:08:50  af
 	Fixed to compile again under 2.5.
[ ./kernel/sun3/db_trace.c ]
Added parens in initializers for db_regs.
[91/10/07            af]
[ ./kernel/sys/ioctl.h ]
 Revision 2.4.1.1  91/09/01  15:53:00  af
 	Upgraded to BSD 4.4.
 	[91/09/01            af]
[ ./kernel/vax/db_trace.c ]
Added parens to initializers for db_regs[].
[91/10/07            af]
[ ./kernel/vax/stubs.c ]
Removed that one real routine: strlen.
[91/10/07            af]
[ ./kernel/vm/memory_object.c ]
 Revision 2.24.1.2  91/10/06  14:46:38  rpd
 	Fixed assertion in memory_object_data_supply.
 	[91/10/06            rpd]
 Revision 2.24.1.1  91/10/05  14:35:49  rpd
 	Added vm_page_deactivate_hint.
 	[91/09/29            rpd]
[ ./kernel/vm/vm_map.c ]
 Revision 2.26.1.3  91/10/07  10:46:15  rpd
 	Fixed vm_map_copy_page_discard to lock before activating.
 	Fixed vm_map_copyout_page_list to clear just the busy bit (from dlb).
 	Fixed vm_map_copy_steal_pages to activate if necessary (from dlb).
	[91/10/07            rpd]
 Revision 2.26.1.2  91/10/06  14:46:51  rpd
	Fixed vm_map_copyout_page_list to clear busy and dirty bits.
 	[91/10/06            rpd]
 Revision 2.26.1.1  91/09/29  13:08:19  rpd
 	Picked up dlb fix for stealing wired pages in vm_map_copyin_page_list.
 	[91/09/27            rpd]
[ ./kernel/vm/vm_pageout.c ]
 Revision 2.19.1.1  91/10/05  14:36:04  rpd
 	Added vm_pageout_pause_count, vm_pageout_pause_max technology
 	so that vm_pageout_burst_wait can decrease as well as increase.
 	[91/10/04            rpd]
[ ./kernel/vm/vm_resident.c ]
 Revision 2.19.1.1  91/10/05  14:36:34  rpd
 	Added vm_page_deactivate_behind.
[ ./user/threads/vax/csw.s ]
 Revision 2.5.1.1  91/09/16  10:26:18  rpd
 	Removed inappropriate RCS keywords.
[ ./user/threads/vax/cthread_inline.awk ]
Revision 2.4.1.1  91/09/16  10:26:21  rpd
	Removed inappropriate RCS keywords.
[ ./user/threads/vax/lock.s ]
 Revision 2.4.1.1  91/09/16  10:26:24  rpd
 	Removed inappropriate RCS keywords.
[ ./user/threads/vax/thread.c ]
 Revision 2.7.1.1  91/09/16  10:26:26  rpd
 	Removed inappropriate RCS keywords.
    
    
    
==========================================================================
   ***** MK Version MK66  (rvb) *****
    
    
There were two main objectives for this merge:

	1. to fix problems for the i386 with MK65 mainly
	   for ether devices

	2. to merge up the latest iPSC and NORMA support from
	   jsb's "tar.3" to MK65.

Of course, there are a few other bug fixes and improvements.

This system was tested with UX29 on a
	5000/200
	Sun 3/60
	VaxStation 3100
	Lots of I386en

This system was tested by Jeffrey Heller on some I386en,
a few NORMA platforms and a Hypercube.

Thanks to Rich Draves and Jeffrey Heller for helping with the 
NORMA part of merge.


Special notes:
------- -----
On the i386, to make NORMA happy, we have unconditionally up
the kernel stack size to 4 pages.  I don't think this should
cause problems.


******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
66
[ ./kernel/chips/busses.c ]
Upgrade phys_address and address check
[91/10/30  15:36:00  rvb]
[ ./kernel/i386at/fd.c ]
Amazing how hard getting the probe to work for all machines is.
[91/10/16            rvb]
[ ./kernel/i386at/hd.c ]
Amazing how hard getting the probe to work for all machines is.
V_REMOUNT must clear gotvtoc[].
[91/10/16            rvb]
[ ./kernel/i386at/if_ns8390.c ]
Undo "strict" wrong change to probe()
[91/10/25            rvb]
[ ./kernel/i386at/if_pc586.c ]
Undo 2.16.1.1
[91/10/25            rvb]
Typo in transcribing the 2.5 changes missed ! before pc586read().
Funny thing is that we did have this fixed in a branch once.
[91/10/16            rvb]
[ ./kernel/i386at/kd.c ]
Get kd_kbd_magic from 2.5 version.
[91/10/17  23:08:19  rvb]

Use scroll lock vs insert to turn on "keyboard" mouse.
To make DOS happy.
[91/10/17            rvb]
[ ./kernel/mips/PMAX/kmin_dma.c ]
In kmin_dma_end_msgin(), brutally copy four bytes off the IOCTL
buffers, flushing is asynchronous and does not work well enough.
This seems to have put an end to the "bad SDP" printouts.
[91/11/01  10:53:32  af]
[ ./kernel/mips/PMAX/kn02_dma.c ]
Added kn02_dma_end_msgin() {null function}.
[91/10/30  13:44:31  af]
[ ./kernel/mips/mips_copyin.s ]
Anti-sneaker test was too strict in copyin/copyout, would
not let you touch the very last byte of the user's space.
[91/10/19  08:42:19  af]
[ ./kernel/mips/pcb.c ]
When allocating breakpoint structure zero the bp count,
this is now needed by prepare/did_sstep.
[91/10/13  17:19:49  af]
[ ./kernel/mips/trap.c ]
Use the ss_count field as a flag to prevent re-entering
prepare_sstep() after, e.g. an AST go tus on the way out
to user space.  Looong overdue bugfix.
[91/10/13  17:21:59  af]

On breakpoint exceptions we were taking the instruction
from the wrong place.
[91/09/29            af]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
To cope with kmin, call dma complete function at end of
msg-in phase (disconnect sequence).  Also check no leftover
bytes in fifo.
[91/10/30  13:41:44  af]
[ ./kernel/scsi/adapters/scsi_dma.h ]
Added end_msgin().
[91/10/30  13:42:14  af]
[ ./kernel/scsi/scsi_tape.c ]
Deal with fixed-size tapes more gracefully: fixed a bug in
read (incorrectly called the go routine with the number of
blocks rather than the number of bytes), in mode select
set the block size too.
We seem to be happy with DEC TZK10s now.
[91/10/30  13:39:34  af]
[ ./kernel/src/config/mkmakefile.c ]
Accept "...|$(FORCE_VOLATILE)" like clauses for all files.
Bug report and fix from idall@eleceng.adelaide.edu.au.
[91/10/28  11:42:05  af]
[ ./kernel/conf/files ]
Restored 2.24 changes.  Fixed the log.
[91/10/30            rpd]
[ ./kernel/ddb/db_break.c ]
Fixed db_delete_cmd so that just "d" works in user space.
[91/10/31            rpd]
Fixed db_delete_thread_breakpoint for zero task_thd.
[91/10/30            rpd]
[ ./kernel/ddb/db_print.c ]
Added OPTION_USER ("/u") to db_show_all_threads, db_show_one_thread,
db_show_one_task.  Without it, we display old-style information.
[91/10/31            rpd]
[ ./kernel/i386/db_trace.c ]
Removed redundant printing of the continuation.
Fixed the log.
[91/11/07            rpd]
[ ./kernel/i386/lock.h ]
Added simple_lock_pause.
[91/11/12            rpd]
[ ./kernel/i386/mp_desc.c ]
Added simple_lock_pause.
[91/11/12            rpd]
[ ./kernel/kern/bootstrap.c ]
Added task_insert_send_right.
Changed BOOTSTRAP_MAP_SIZE to 4 meg.
[91/11/12            rpd]
[ ./kernel/kern/lock.h ]
Added simple_lock_pause.
[91/11/12            rpd]
[ ./kernel/vm/vm_fault.c ]
Added simple_lock_pause.
[91/11/12            rpd]
[ ./kernel/vm/vm_object.c ]
Added simple_lock_pause.
[91/11/12            rpd]
[ ./kernel/norma/ipc_alias.c ]
Created.
[ ./kernel/norma/ipc_fields.h ]
Created.
[ ./kernel/norma/ipc_migrate.c ]
Created.
[ ./kernel/norma/ipc_node.h ]
Created.
[ ./kernel/norma/ipc_token.c ]
Created.
[ ./kernel/norma/ipc_transit.c ]
Created.
[ ./kernel/norma/ipc_xxx.c ]
Moved to norma/ipc_special.c.
[ ./kernel/norma/ipc_special.c ]
Moved from norma/ipc_xxx.c.
[ ./kernel/norma/ipc_input.c ]
Replaced norma_ipc_get_proxy with norma_ipc_receive_sright.
Added checks on type of received rights.
[91/09/19  13:51:21  jsb]
[ ./kernel/norma/ipc_net.c ]
Replaced norma_ipc_export call with norma_ipc_send_sright.
[91/09/19  13:46:39  jsb]
[ ./kernel/norma/kern_task.c ]
Use new child_node task field in place of task_server_node to decide
upon what node to create child task. Also add task_set_child_node().
[91/09/23  09:22:18  jsb]
[ ./kernel/norma/ipc_ether.c ]
Picked up mysterious norma changes.
[ ./kernel/norma/ipc_kserver.c ]
Picked up mysterious norma changes.
[ ./kernel/norma/xmm.c ]
Picked up mysterious norma changes.
[ ./kernel/norma/xmm_import.c ]
Picked up mysterious norma changes.
[ ./kernel/conf/files ]
Picked up mysterious norma changes.
[91/11/14            rpd]
[ ./kernel/device/ds_routines.c ]
Picked up mysterious norma changes.
[91/11/14            rpd]
[ ./kernel/ipc/ipc_kmsg.c ]
Picked up mysterious norma changes.
[91/11/14            rpd]
[ ./kernel/ipc/ipc_mqueue.c ]
Picked up mysterious norma changes.
[91/11/14            rpd]
[ ./kernel/ipc/ipc_port.c ]
Picked up mysterious norma changes.
[91/11/14            rpd]
[ ./kernel/ipc/ipc_port.h ]
Picked up mysterious norma changes.
[91/11/14            rpd]
[ ./kernel/kern/ipc_mig.c ]
Picked up mysterious norma changes.
[91/11/14            rpd]
[ ./kernel/mach/mach_norma.defs ]
Picked up mysterious norma changes.
[91/11/14            rpd]
[ ./kernel/vm/vm_map.c ]
Picked up mysterious norma changes.
[91/11/14            rpd]
[ ./kernel/ipc/mach_msg.c ]
Picked up mysterious norma changes.
[91/11/14            rpd]
[ ./kernel/vm/vm_map.c ]
Add ifdef's to always steal code. Not needed (or wanted) except
to workaround a norma ether bug. UGH!
[91/11/14            jeffreyh]

Add consume on success logic to vm_map_copyout_page_list.
[91/11/12            dlb]
[ ./kernel/kern/syscall_emulation.c ]
Rewrote task_set_emulation_vector for greater clarity.
Fixed bcopy bug in task_get_emulation_vector.
Simplified and removed debugging printf from task_set_emulation.
[91/09/24  14:15:28  jsb]
[ ./kernel/norma/xmm_copy.c ]
Use ipc_port_make_send in norma_copy_create for returned memory_object.
[91/09/23  09:09:25  jsb]
[ ./kernel/norma/xmm_export.c ]
Use ipc_port_copy_send in _proxy_init for import_master.
[91/09/23  09:14:28  jsb]
[ ./kernel/kern/task.h ]
NORMA_TASK: added child_node field, which determines where child tasks
are created for the given task. A value of -1 means local node.
[91/09/23  09:19:35  jsb]
[ ./kernel/kern/task.c ]
NORMA_TASK: initialize new child_node field in task upon creation.
[91/09/23  09:20:23  jsb]
[ ./kernel/i386ipsc/sd.c ]
Flush p_tag, and redo V_VALID computation like was done on
all the other i386 disks.
[ ./kernel/i386at/hd.c ]
For now, back out the hdprobe(), hdslave() probes and use
the old simple test and believe BIOS.
[ ./kernel/intel/pmap.c ]
Up morevm for NORMA.
    
    
    
==========================================================================
   ***** MK Version MK67  (jsb) *****
    
    
Lots of NORMA fixes, vm fixes, etc.
I'll tell you more tomorrow.

- Joe

Log messages:
--- --------

[ ./conf/version.edit ]
67
[ ./kernel/device/ds_routines.c ]
Merged in 2.25.1.1 from dlb.
[91/12/10  11:16:31  jsb]
[ ./kernel/ipc/ipc_init.c ]
Removed reference counting bug workaround.
[91/12/10  11:17:21  jsb]
[ ./kernel/ipc/ipc_kmsg.c ]
Added ipc_kmsg_copyout_to_network, as required by ipc_kserver.c.
Picked up vm_map_convert_to_page_list call changes from dlb.
Changed NORMA_VM conditional for ipc_kmsg_copyout_to_kernel
to NORMA_IPC.
[91/12/10  11:20:36  jsb]
[ ./kernel/norma/ipc_input.c ]
Added support for moving receive rights.
Use norma_ipc_ack_xxx upcalls (downcalls?) instead of return values
from norma_deliver_kmsg and _page.
Merged dlb check for continuation-needing copy objects in
norma_deliver_page.
Added (untested) support for multiple copy objects per message.
[91/12/10  11:26:32  jsb]
[ ./kernel/norma/ipc_kserver.c ]
Use ipc_kmsg_copyout_to_network instead of ipc_kmsg_copyin_from_kernel.
[91/12/10  11:27:15  jsb]
[ ./kernel/norma/ipc_migrate.c ]
Make sure a port has a uid before migrating its receive right.
Set ip_receiver_name and ip_destination for migrated right.
[91/12/10  11:28:53  jsb]
[ ./kernel/norma/ipc_net.c ]
Fixed protocol bug previously worked around with longer timeout.
Lowered timeout accordingly. Simplified netipc_set_seqid.
Added (untested) support for multiple copy objects per message.
Added norma_ipc_ack_xxx upcalls for quicker acknowledgements.
Added netipc_safe_vm_map_copy_discard to avoid calling vm routines
at interrupt level.
Added support for migrating receive rights.
[91/12/10  11:33:35  jsb]
[ ./kernel/norma/kern_task.c ]
Changed printfs to frets.
[91/12/10  11:34:35  jsb]
[ ./kernel/norma/xmm.c ]
Added better debugging in xmm_obj_deallocate.
[91/12/10  11:35:06  jsb]
[ ./kernel/norma/xmm_import.c ]
Added missing third parameter in call to proxy_terminate.
[91/12/10  12:48:52  jsb]
[ ./kernel/norma/xmm_invalid.c ]
Added better debugging support to xmm_invalid_complain.
[91/12/10  12:46:26  jsb]
[ ./kernel/norma/xmm_proxy.defs ]
Added missing third parameter to proxy_terminate.
It should in the future become a moving receive right.
[91/12/10  12:49:57  jsb]
[ ./kernel/vm/vm_map.c ]
5-Dec-91 David L. Black (dlb) at Open Software Foundation
Simplify page list continuation abort logic.
[91/12/10  12:56:06  jsb]
[ ./kernel/vm/vm_map.h ]
5-Dec-91 David L. Black (dlb) at Open Software Foundation
	Simplify page list continuation abort logic. Temporarily
increase size of page lists for NORMA_IPC until it supports
page list continuations.
[91/12/10  12:50:01  jsb]
[ ./kernel/vm/vm_object.c ]
Comment out noisy printf. (Avoiding dealloc ...)
[91/12/10  12:50:34  jsb]
[ ./kernel/vm/vm_user.c ]
Apply temporary NORMA_VM workaround to XMM problem.
This leaks objects if vm_map() fails.
[91/12/10  12:55:27  jsb]
[ ./kernel/conf/MASTER.i386 ]
Fixes from Intel
[91/12/10  15:51:24  jsb]
[ ./kernel/conf/MASTER.i860 ]
Fixes from Intel
[91/12/10  15:31:55  jsb]
[ ./kernel/conf/Makefile.i860 ]
Fixes from Intel
[91/12/10  15:31:59  jsb]
[ ./kernel/conf/Makefile.template ]
Fixes from Intel
[91/12/10  15:51:29  jsb]
[ ./kernel/conf/files.i386 ]
Fixes from Intel
[91/12/10  15:51:34  jsb]
[ ./kernel/conf/files.i860 ]
Fixes from Intel
[91/12/10  15:32:02  jsb]
[ ./kernel/i386ipsc/asm_startup.h ]
Fixes from Intel
[91/12/10  15:32:05  jsb]
[ ./kernel/i386ipsc/bia.h ]
Fixes from Intel
[91/12/10  15:32:07  jsb]
[ ./kernel/i386ipsc/conf.c ]
Fixes from Intel
[91/12/10  15:32:10  jsb]
[ ./kernel/i386ipsc/led.c ]
Fixes from Intel
[91/12/10  15:32:14  jsb]
[ ./kernel/i386ipsc/md.c ]
New files from Intel
[91/12/10  16:11:01  jsb]
[ ./kernel/i386ipsc/model_dep.c ]
Fixes from Intel
[91/12/10  15:32:17  jsb]
[ ./kernel/i386ipsc/sd.c ]
Fixes from Intel
[91/12/10  15:32:20  jsb]
[ ./kernel/i860/_setjmp.s ]
Fixes from Intel
[91/12/10  15:32:23  jsb]
[ ./kernel/i860/bcopy.s ]
Fixes from Intel
[91/12/10  15:32:26  jsb]
[ ./kernel/i860/bzero.s ]
New files from Intel
[91/12/10  16:11:07  jsb]
[ ./kernel/i860/coff.h ]
New files from Intel
[91/12/10  16:11:12  jsb]
[ ./kernel/i860/cswitch.s ]
Fixes from Intel
[91/12/10  15:32:30  jsb]
[ ./kernel/i860/ctrap.c ]
New files from Intel
[91/12/10  16:11:18  jsb]
[ ./kernel/i860/db_coff_sym.c ]
New files from Intel
[91/12/10  16:11:24  jsb]
[ ./kernel/i860/db_disasm.c ]
Fixes from Intel
[91/12/10  15:32:33  jsb]
[ ./kernel/i860/db_interface.c ]
Fixes from Intel
[91/12/10  15:32:36  jsb]
[ ./kernel/i860/db_machdep.h ]
Fixes from Intel
[91/12/10  15:32:39  jsb]
[ ./kernel/i860/db_trace.c ]
Fixes from Intel
[91/12/10  15:32:41  jsb]
[ ./kernel/i860/exec.c ]
Fixes from Intel
[91/12/10  15:32:45  jsb]
[ ./kernel/i860/exec.h ]
Fixes from Intel
[91/12/10  15:32:48  jsb]
[ ./kernel/i860/misc.s ]
New files from Intel
[91/12/10  16:11:30  jsb]
[ ./kernel/i860/mmu.s ]
New files from Intel
[91/12/10  16:11:36  jsb]
[ ./kernel/i860/pcb.c ]
Fixes from Intel
[91/12/10  15:32:50  jsb]
[ ./kernel/i860/psl.h ]
Fixes from Intel
[91/12/10  15:32:53  jsb]
[ ./kernel/i860/start.s ]
Fixes from Intel
[91/12/10  15:32:56  jsb]
[ ./kernel/i860/storclass.h ]
New files from Intel
[91/12/10  16:11:41  jsb]
[ ./kernel/i860/syms.h ]
New files from Intel
[91/12/10  16:11:47  jsb]
[ ./kernel/i860/thread.h ]
Fixes from Intel
[91/12/10  15:33:00  jsb]
[ ./kernel/i860/trap.c ]
Fixes from Intel
[91/12/10  15:33:03  jsb]
[ ./kernel/i860/trap.h ]
Fixes from Intel
[91/12/10  15:33:06  jsb]
[ ./kernel/i860/ttrap.s ]
Fixes from Intel
[91/12/10  15:33:10  jsb]
[ ./kernel/i860/va_list.h ]
New files from Intel
[91/12/10  16:11:53  jsb]
[ ./kernel/i860/varargs.h ]
New files from Intel
[91/12/10  16:12:01  jsb]
[ ./kernel/i860/varargs.pgi.h ]
New files from Intel
[91/12/10  16:12:10  jsb]
[ ./kernel/i860ipsc/autoconf.c ]
Fixes from Intel
[91/12/10  15:33:20  jsb]
[ ./kernel/i860ipsc/dcm_input.c ]
Fixes from Intel
[91/12/10  15:33:22  jsb]
[ ./kernel/i860ipsc/dcm_output.c ]
Fixes from Intel
[91/12/10  15:33:25  jsb]
[ ./kernel/i860ipsc/intr.c ]
Fixes from Intel
[91/12/10  15:33:29  jsb]
[ ./kernel/i860ipsc/led.c ]
Fixes from Intel
[91/12/10  15:33:32  jsb]
[ ./kernel/i860ipsc/model_dep.c ]
New files from Intel
[91/12/10  16:12:19  jsb]
[ ./kernel/i860ipsc/spl.c ]
Fixes from Intel
[91/12/10  15:33:34  jsb]
[ ./kernel/i860oki/boot/bootblok.c ]
New files from Intel
[91/12/10  16:12:26  jsb]
[ ./kernel/i860oki/boot/romcall.h ]
New files from Intel
[91/12/10  16:12:34  jsb]
[ ./kernel/i860oki/model_dep.c ]
New files from Intel
[91/12/10  16:12:40  jsb]
[ ./kernel/intel/pmap.c ]
Fixes from Intel
[91/12/10  15:51:38  jsb]
[ ./kernel/intel/pmap.h ]
Fixes from Intel
[91/12/10  15:51:47  jsb]
[ ./kernel/ipsc/bootenv.c ]
New files from Intel
[91/12/10  16:12:46  jsb]
[ ./kernel/ipsc/dev_forward_name.c ]
Fixes from Intel
[91/12/10  15:33:38  jsb]
[ ./kernel/ipsc/startup.c ]
New files from Intel
[91/12/10  16:12:51  jsb]
[ ./kernel/ipsc/usm.c ]
Fixes from Intel
[91/12/10  15:33:41  jsb]
[ ./kernel/kern/bootstrap.c ]
Fixes from Intel
[91/12/10  15:51:50  jsb]
[ ./kernel/kern/debug.c ]
Fixes from Intel
[91/12/10  15:51:54  jsb]
[ ./kernel/mach/i860/vm_param.h ]
Fixes from Intel
[91/12/10  15:33:46  jsb]
[ ./kernel/mach/machine.h ]
Fixes from Intel
[91/12/10  15:51:57  jsb]
[ ./kernel/sys/varargs.h ]
Fixes from Intel
[91/12/10  15:52:01  jsb]
[ ./user/libmach/Makefile ]
Fixes from Intel
[91/12/10  15:51:19  jsb]
[ ./user/libmach/i860/crt0.c ]
Fixes from Intel
[91/12/10  15:31:47  jsb]
[ ./user/libmach/i860/pre_crt0.s ]
New files from Intel
[91/12/10  16:10:50  jsb]
[ ./user/libmach/mach_syscalls.c ]
Fixes from Intel
[91/12/10  15:51:22  jsb]
[ ./user/threads/Makefile ]
New files from Intel
[91/12/10  16:19:40  jsb]
[ ./user/threads/i860/csw.s ]
Fixes from Intel
[91/12/10  15:31:50  jsb]
[ ./user/threads/i860/thread.c ]
Fixes from Intel
[91/12/10  15:31:53  jsb]
[ ./kernel/mach/i860/thread_status.h ]
Another fix from Intel.
[91/12/11  08:40:08  jsb]
[ ./kernel/kern/task.c ]
Fixed assert_wait/thread_wakeup rendezvous in task_assign.
[91/11/26            rpd]
[ ./kernel/man/mach_msg.man ]
Updated for MK62 (sequence numbers).
[91/11/26  11:01:07  rpd]
[ ./kernel/man/mach_port_allocate.man ]
Updated for MK62 (sequence numbers).
[91/11/26  11:01:28  rpd]

Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:09  rpd]
[ ./kernel/man/mach_port_allocate_name.man ]
Updated for MK62 (sequence numbers).
[91/11/26  11:01:31  rpd]

Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:13  rpd]
[ ./kernel/man/mach_port_deallocate.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:16  rpd]
[ ./kernel/man/mach_port_destroy.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:18  rpd]
[ ./kernel/man/mach_port_extract_right.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:22  rpd]
[ ./kernel/man/mach_port_get_receive_status.man ]
Updated for MK62 (sequence numbers).
[91/11/26  11:01:25  rpd]

Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:24  rpd]
[ ./kernel/man/mach_port_get_refs.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:27  rpd]
[ ./kernel/man/mach_port_get_set_status.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:30  rpd]
[ ./kernel/man/mach_port_insert_right.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:33  rpd]
[ ./kernel/man/mach_port_mod_refs.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:40  rpd]
[ ./kernel/man/mach_port_move_member.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:44  rpd]
[ ./kernel/man/mach_port_names.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:47  rpd]
[ ./kernel/man/mach_port_rename.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:50  rpd]
[ ./kernel/man/mach_port_request_notification.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:53  rpd]
[ ./kernel/man/mach_port_set_mscount.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:57  rpd]
[ ./kernel/man/mach_port_set_qlimit.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:55:59  rpd]
[ ./kernel/man/mach_port_set_seqno.man ]
Created.
[91/11/25            rpd]
[ ./kernel/man/mach_port_type.man ]
Changed <mach/mach.h> to <mach.h>.
[91/11/25  10:56:03  rpd]
[ ./kernel/man/thread_wire.man ]
Created.
[91/11/25            rpd]
[ ./kernel/man/vm_wire.man ]
Created.
[91/11/25            rpd]
[ ./kernel/vm/vm_map.c ]
Fixed vm_map_copyout_page_list a la vm_object_coalesce.
Fixed vm_map_copy_overwrite to check for misalignment.
Fixed some log infelicities.
[91/12/09            rpd]
[ ./kernel/vm/vm_object.c ]
Changed vm_object_coalesce to also check for paging references.
This fixes a problem with page-list map-copy objects.
[91/12/03            rpd]
[ ./kernel/vm/vm_pageout.c ]
Added vm_pageout_active, vm_pageout_inactive,
and other measurement counters.  Fixed the log.
[91/11/24            rpd]
[ ./kernel/vm/vm_user.c ]
Fixed vm_write and vm_copy to check for a null map.
Fixed vm_write and vm_copy to not check for misalignment.
Fixed vm_copy to discard the copy if the overwrite fails.
[91/12/09            rpd]
[ ./kernel/i386ipsc/cnp/if_cnp.c ]
Fix from Intel.
[91/12/11  08:48:27  jsb]
[ ./kernel/i860/cswitch.c ]
Defuncted.
[ ./kernel/i860/init.c ]
Defuncted.
[ ./kernel/i860ipsc/i860_init.c ]
Defuncted.
[ ./kernel/i860ipsc/usm.c ]
Defuncted.
[ ./conf/Makefile.template ]
Added rules for norma/norma_internal.defs.
[ ./conf/files ]
Added ./mach/norma_internal_{server,user}.c.
[ ./kernel/kern/exception.c ]
Added NORMA_IPC support.
[ ./kernel/kern/ipc_kobject.c ]
Added support for norma/norma_internal.defs.
[ ./kernel/kern/syscall_emulation.c ]
Increased eml_max_emulate_count for OSF/1+ server support.
[ ./kernel/mach/mach_norma.defs ]
Moved non-exported interfaces to norma/norma_internal.defs.
Changed name of task_create_remote to norma_task_create.
Added comments.
[ ./kernel/mach/norma_special_ports.h ]
Moved MAX_SPECIAL_ID here from ipc/ipc_node.h.
[ ./kernel/vm/vm_map.c ]
Removed NORMA_ETHER always_steal hack.
[ ./kernel/ipc/ipc_kmsg.c ]
Use norma_ipc_copyin_page_list when sending to remote port.
[ ./kernel/norma/kern_task.c ]
Changed name of task_create_remote to norma_task_create.
Added check for local case in norma_task_create.
[ ./kernel/norma/ipc_input.c ]
Fixed check for end of last copy object in norma_deliver_page.
Moved norma_ipc_ack_xxx calls to safer places.
[ ./kernel/norma/ipc_net.c ]
Multiple copy objects per message now works.
Added wakeup and counts to netipc_safe_vm_map_copy_discard.
[ ./kernel/norma/ipc_output.c ]
Added norma_ipc_copyin_page_list and norma_ipc_thread_return.
These will be replaced with more efficient versions.
[ ./kernel/norma/ipc_migrate.c ]
Changed debugging printf routines.
[ ./kernel/norma/ipc_node.h ]
Moved MAX_SPECIAL_ID to mach/norma_special_ports.h.
[ ./kernel/norma/ipc_transit.c ]
Changed printfs to debugging printfs.
[ ./kernel/norma/norma_internal.defs ]
First checkin. Split off from mach/mach_norma.defs.
[ ./kernel/man/vm_copy.man ]
Moved alignment restrictions to a BUGS section.
Removed the non-overlapping restriction.
[91/12/11            rpd]
[ ./kernel/man/vm_write.man ]
Moved alignment restrictions to a BUGS section.
[91/12/11            rpd]
[ ./include/Makeconf ]
Changed OBJECTDIR to reflect new structure
[91/12/09            mrt]
[ ./kernel/Makeconf ]
Changed OBJECTDIR to reflect new structure
[91/12/09            mrt]
[ ./kernel/src/mig/Makefile ]
Changed to reflect new directory structure.
[91/12/12            mrt]
[ ./user/Makeconf ]
Changed OBJECTDIR and MKREL to reflect new structure
[91/12/09            mrt]
[ ./user/Makefile ]
Changed LIBBASE and OBJBASE to reflect new structure
[91/12/09            mrt]
[ ./user/libmach/Makefile ]
Added rules for mach/mach_norma.defs.
[ ./conf/files ]
Added kern/eventcount.c
[91/11/08  12:10:33  af]
[ ./kernel/chips/lance_mapped.c ]
Use eventcounters.
[91/12/12  17:43:08  af]
[ ./kernel/kern/eventcount.c ]
Created.
[91/11/01            af]
[ ./kernel/kern/eventcount.h ]
Created.
[91/11/01            af]
[ ./kernel/kern/syscall_sw.c ]
Added evc_wait().
[91/12/12  17:42:00  af]
[ ./kernel/kern/thread.c ]
Removed thread_resume_from_kernel.
[91/12/12  17:40:12  af]
[ ./kernel/mach/syscall_sw.h ]
Added evc_wait.
[91/11/02  17:44:54  af]
[ ./kernel/mips/PMAX/kmin_dma.c ]
Fixed to flush the FIFO after sending the command
out and before sending more data from a different place.
This should not have been necessary, but it is.
Also fixed read case to manually pick up all remaining
bytes in the SCR regs, just causing it to flush was both
incorrect and unreliable.
[91/12/12  17:49:00  af]

In kmin_dma_end_msgin(), brutally copy four bytes off the IOCTL
buffers, flushing is asynchronous and does not work well enough.
This seems to have put an end to the "bad SDP" printouts.
[91/11/01  10:53:32  af]
[ ./kernel/scsi/mapped_scsi.c ]
Use eventcounters.
[91/11/08  12:11:44  af]
[ ./Directories/i386 ]
new: kernel/{chips,scsi{,/adapters}} (for real this time)
[ ./kernel/i860ipsc/dcm_input.c ]
Fix from andyp at Intel: flush cache after receiving page.
[ ./kernel/kern/exception.c ]
Removed ipc_fields.h hack.
[ ./kernel/ipc/ipc_kmsg.c ]
Removed ipc_fields.h hack.
Made ipc_kmsg_clean_{body,partial} aware of remote ports.
They don't yet clean up remote ports, but at least they
no longer pass port uids to ipc_object_destroy.
[ ./kernel/ipc/ipc_kmsg.h ]
NORMA_IPC: added ikm_copy to struct kmsg.
[ ./kernel/ipc/ipc_mqueue.c ]
Removed ipc_fields.h hack.
[ ./kernel/ipc/ipc_port.c ]
Removed ipc_fields.h hack.
[ ./kernel/ipc/ipc_port.h ]
NORMA_IPC: replaced dummy port struct fields with real names.
[ ./kernel/ipc/mach_msg.c ]
Removed ipc_fields.h hack.
[ ./kernel/kern/eventcount.c ]
Replaced gimmeabreak calls with panics.
[ ./kernel/norma/ipc_alias.c ]
Removed ipc_fields.h hack.
[ ./kernel/norma/ipc_ether.c ]
Picked up bootconfig code from sjs@osf.org.
[ ./kernel/norma/ipc_ether.h ]
Picked up bootconfig code from sjs@osf.org.
[ ./kernel/norma/ipc_fields.h ]
This is now documentation instead of a hack.
[ ./kernel/norma/ipc_input.c ]
Removed private assert definition.
[ ./kernel/norma/ipc_kserver.c ]
Removed ipc_fields.h hack.
[ ./kernel/norma/ipc_migrate.c ]
Removed ipc_fields.h hack.
[ ./kernel/norma/ipc_special.c ]
Removed ipc_fields.h hack.
[ ./kernel/norma/ipc_token.c ]
Removed ipc_fields.h hack.
[ ./kernel/norma/ipc_transit.c ]
Removed ipc_fields.h hack.
[ ./kernel/norma/ipc_wait.c ]
Removed private assert definition.
    
    
    
==========================================================================
   ***** MK Version MK68  (dbg) *****
    
    
New features:
--- --------

The default pager is now out of the kernel.  Building the kernel involves
two more steps:

1) Building the 'bootstrap' program.  The bootstrap program is all of
   the code that used to be in kernel/boot_ufs: the default pager, and
   the loader for '/mach_servers/startup'.

2) Gluing the kernel and bootstrap images together into the 'mach.boot'
   file.  The 'makeboot' program does this.

The kernel Makefile does this automatically.  However, building the
bootstrap image uses 'libmach_sa' and 'libthreads' which depend on
the include directory and MiG... so MiG must be built first.

The image to run is now 'mach.boot', NOT 'mach_kernel'.  It is still
built in the kernel build directory.

The makeboot program can be run at any time to build a mach.boot file
from a kernel and a bootstrap image.  The syntax is:

makeboot -o <mach.boot file> <kernel> <bootstrap>


The resulting mach.boot image looks to the boot program like a standard
executable file (a.out or COFF).  All of the code, data, and symbols for
both the kernel and the bootstrap program are made to look like one text
segment.

At startup, the kernel symbols and bootstrap program are sitting in
the kernel's BSS section, preceded with a structure describing how
long each section is; this structure is in <mach/boot_info.h>.  The
kernel must move these out of the BSS before it can proceed.  In addition,
it must move the bootstrap image to a page-aligned address, so that it
can be mapped directly into the first user task's address space.

The machine-independent code to implement this is in kern/bootstrap.c,
routine move_bootstrap().  It can be used if the first few megabytes
(probably 2) of physical memory are mapped to contiguous virtual memory
starting at the kernel load location (i.e., the kernel is loaded
at physical address 0, which is mapped to VM_MIN_KERNEL_ADDRESS).
If this is NOT true, machine-dependent code must be written to
do the same thing (see the VAX and i386).

The 'ask' (-a, b/1) switch to the boot procedure now will cause the
kernel (actually, the bootstrap program) to ask for the name of
the /mach_servers directory.  You can use this to select a completely
new server directory: startup, emulator, paging_file, mach_init, and all.
<CR> defaults to the standard /dev/<root_device>/mach_servers directory.


New MiG Features
--- --- --------

The Mig features outlined in my proposal of late October have been
implemented.  They are:

1) New code for variable length OUT arrays that may be in-line or
   out-of-line.  The new protocol for using such an interface is:

   . allocate a buffer to hold the returned array.
   . Set a pointer variable to point to it
   . Set the count to the number of items that the buffer
     can hold
   . Call the routine

   . Use the NEW values of the pointer and count to access
     the returned data.

     When done with the data:
   . if the pointer does not still point to the buffer,
     call vm_deallocate() to deallocate the array that was returned.

   OR:

     item	buffer[MAX];
     
     item	*ptr;
     unsigned int *count;

     ptr = &buffer[0];
     count = MAX;
     
     (void) user_stub_call(..., &ptr, &count, ...)

     for (i = 0; i < count; i++)
	printf("returned item%d\n", ptr[i]);

     if (ptr != buffer)
	(void) vm_deallocate(mach_task_self(),
			     (vm_offset_t) ptr,
			     count * sizeof(item));


2) A new keyword, 'CountInOut', to specify that the count argument
   for a variable-length inline OUT parameter is in-out.  This allows
   the maximum array length specified by the user to be passed to
   the server procedure.  The call will now return only as many items
   as the user supplies for the size of the returned array; it will
   not overflow it (or return MIG_ARRAY_TOO_LARGE).

3) Each server dispatch procedure (<subsystem>_server) now has an associated
   function (<subsystem>_server_routine) that returns a pointer to the
   unpacking stub for the request message, or 0 if the message is not
   handled by this subsystem.  This allows a server that handles multiple
   MiG interfaces (such as the kernel) to quickly find the stub to call;
   it avoids initializing the header of the reply message each time the
   request message is tested against a new subsystem.  libmach_sa.a contains
   a new routine, mig_reply_setup, to initialize the reply message header.

Kernel Interface Changes
------ --------- -------

All kernel routines (mach.defs, mach_host.defs, device.defs) that pass
variable-length inline arrays have been changed to use the new 'CountInOut'
feature (for OUT parameters) and to remove the 'IsLong' tags.  The old
interfaces have been temporarily retained as 'xxx_' or 'yyy_' versions,
so that old messages will still work.  Callers should be relinked with
the new user stubs from libmach_sa ASAP to use the new messages; the
calling sequences are unchanged.

task_get_emulation_vector and task_set_emulation_vector now pass the
emulation vector OUT-OF-LINE.  In addition, they accept an arbitrary
range of system call numbers.  It will no longer be necessary to keep
enlarging the system call tables.  This is not a compatibile change,
but it is likely that nothing but the NORMA remote task creation code
currently uses these calls.  Machine-dependent changes to the system
call trampoline code (simple) are required.

The network packet filter has been extended with a few new operands:

    NETF_PUSHHDR+n	Pushes (short) word <n> of the header
    			onto the stack.
    NETF_PUSHIND	Pops the top word from the stack, then pushes
			the packet (short) word indexed by that value
			onto the stack.
    NETF_PUSHHDRIND	Same, but accesses the header
    NETF_PUSHSTK+n	Pushes (long) word <n> of the stack onto the stack.
			The stack top is (long) word 0.


Cthreads now exports cthread_stack_size.  It can be initialized at compile-time
to set the size of the stacks allocated by the CThreads package.

[VAX]	A vax kernel can be built with '-pvax' to remove VAX3100 support.

[I386]	The floating-point emulator (from Intel) is now in the kernel.
	The kernel automatically detects the presence of the FPU, and
	will use the emulator if there is no FPU.  The emulator is
	configured by default into the STD+WS configuration.

[I386]	There is a new set of interfaces to allow threads access to
	the IO ports.  A device can have an associated set of IO ports,
	defined by the device driver.  They are 'mapped' into a thread,
	much the same way that a memory object is mapped into a task's
	address space.

	The calls are:
		i386_io_port_add(thread_t thread,
				device_t device)

		Adds the device's IO ports to those accessible by
		the thread.

		i386_io_port_remove(
				thread_t thread,
				device_t device)

		Removes the device's IO ports from those accessible by
		the thread.

		i386_io_port_list(
				thread_t thread,
				device_t **list,	/* OUT array */
				unsigned int *count)	/* OUT */

		Returns an array (out-of-line) containing the devices
		whose IO ports are accessible by the thread.

	Only a few devices are supported in this release:

	'kd0' or 'vga' accesses the ports for the VGA display:
		3b0..3df

	'iopl' accesses a large set of ports (currently used by the
		DOS emulator):
		42, 43, 61 (speaker)
		70, 71	   (configuration CMOS)
		201	   game port
		the VGA ports
		220..22f   (sound blaster)
		378..37a   (printer)

	It is intended that 'iopl' allow access to any port that is
	not in use by another device.  This will require building
	the port table during autoconfiguration (or when a device is
	opened).

	To avoid the need to rebuild the U*X server, the existing
	behavior of 'iopl' is still supported.  If a task has send
	rights to the 'iopl' device port, then any thread that
	tries to access the 'iopl' device's ports will have them
	mapped into its IO map, as if 'i386_io_port_add' was
	called.

	(There is an ugly hack for DOS emulator compatibility -
	'iopl' allows IN instructions on any port, if the thread
	is not in V86 mode.  The DOS emulator should be fixed.)

	The ISA_PORT_MAP thread state flavor does nothing, but
	still returns KERN_SUCCESS (for compatibility).

[I386]	Support for i286/i386 segmentation has been added.  Each thread
	can optionally have its own LDT.  There are calls to get and set
	LDT entries.  An additional thread state flavor has been added
	to set the segment registers along with the general registers.

	The calls are:
		i386_set_ldt(
				thread_t thread,
				int	first_selector,
				struct descriptor *desc_list,
				unsigned int count)

		Adds the LDT entries starting with <first_selector>
		to the LDT for the thread.  Creates an LDT if the thread
		does not have one.

		i386_get_ldt(
				thread_t thread,
				int	first_selector,
				int	selector_count,
				struct descriptor **desc_list,/* IN/OUT array */
				unsigned int *count)	      /* IN/OUT */

		Returns the LDT entries starting with <first_selector>,
		for <selector_count> items.  The list is returned using
		the new variable-length array protocol.


	Allowable LDT entries are:
	Code segments: all kinds, protection level = 3 (user).
		16-bit or 32-bit segments are allowed.
	Data segments: all kinds, protection level = 3 (user).
		16-bit or 32-bit stack segments are allowed.

	i386 (32-bit) call gate, protection level = 3 (user).
	i286 (16-bit) call gate, protection level = 3 (user).

	An i386 call gate with protection level = 0 is also allowed.
	This is a call gate to the standard Mach/U*X system call trap.
	(XXX - this should probably be changed to a PL=3 gate, but
	 to segment 8 in the GDT).


	WARNING: the segmentation support has NOT been tested.


Bug fixes:
--- -----

The default pager and bootstrap loader have been fixed to free the
extra memory allocated for each open file.

The kernel debugger prints 'loading symbols for <foo>' only if the
load succeeds.  Host_load_symbol_table no longer ties the vm_map_copy zone
in knots if it can't load the symbol table.

I fixed an erroneous boundary condition check in vm_map_copyout and
vm_map_copyout_page_list.  The 'end' of an entry is the last address +1,
and therefore can be <= the start of the next entry.  The old code
checked for '<', and therefore could not add a new entry that exactly
fit between two existing entries.  I copied the test from vm_map_enter(),
where it was done correctly.

Sandro changed the event counter to use a small integer ID for the
event counter instead of a kernel address.

Joe added some NORMA fixes:
	fixed merge error in nd_reply
	made large kmsgs work without leaking
	added check for null parent task in task_create.

[SUN3]	I fixed the inline code for spin_lock_try (in <sun3/cthreads.h>)
	to avoid the bad operand-match constraint.  I added 'volatile'
	to the definition of spin_lock_t to keep the lock's value from
	being cached in registers.

[VAX]	I fixed the inline code for spin_lock_try (in <VAX/cthreads.h>)
	to avoid the bad operand-match constraint.  I added 'volatile'
	to the definition of spin_lock_t to keep the lock's value from
	being cached in registers.

[PMAX]	The cache tests now preserve all callee-saved registers
	(they had dropped s0).

	Pmap_extract now correctly handles virtual addresses in the
	K0 or K1 range.

	SCSI disks now support the devinfo call (to handle the new
	fsck and other large I/Os).

	Sandro made some fixes to the dma on the KMIN.
	The kdbputmem routine now correctly handles little-ender machines.

	Multiple SCSI drives now work with a 53C94 chip.

[I386]	Kernel stack size has been reduced back to 4K.

	Floating-point exceptions on AT bus machines (that vector
	floating-point errors to INT 0x13) no longer crash the kernel.

	The com device no longer stops I/O when the carrier drops.
	Several modems drop the carrier when the phone line is hung up,
	but the modem can still talk to the CPU.

	I fixed the inline code for spin_lock_try (in <i386/cthreads.h>)
	to avoid the bad operand-match constraint.  I added 'volatile'
	to the definition of spin_lock_t to keep the lock's value from
	being cached in registers.

	SCSI disks now support the devinfo call (to handle the new
	fsck and other large I/Os).  Some small bugs were fixed for
	the AHA15 disk driver.

[LUNA]	SCSI disks now support the devinfo call (to handle the new
	fsck and other large I/Os).

Organizational changes:
-------------- -------

The default pager and bootstrap loader have moved from
./kernel/boot_ufs
to
./bootstrap.

<mach_user_internal.h> (and related files) are no longer built for
the kernel.

The MiG user stubs in user/libmach are now built (for the most part)
as separate files.  Linking against libmach_sa will only include the
MiG stubs that are needed rather than the entire mach_user.o.

New routines mig_allocate(), mig_deallocate(), and mig_reply_setup()
have been added to libmach_sa.

I removed 'THREAD_SHOULD_TERMINATE' from kern/sched_prim.h.  It had
been removed a long time ago. but re-appeared.

device/subr_rmap.c and device/map.h have been removed from the
device directory.  This should remove the last partiallly-contaminated
code from any machine-independent directory.

I removed the *765* files from the i386at directory - they were
the old floppy driver.  They have been replaced (a while ago) with
fd.c and fdreg.h.


[SUN3]	device/subr_rmap.c was moved to sundev/subr_rmap.c.
	device/map.h was moved to sundev/subr_rmap.h.

[VAX]	device/subr_rmap.c was copied to vaxuba/subr_rmap.c.
	device/map.h was moved to vaxuba/subr_rmap.h.

[I386]	Definitions for user-visible floating point registers have
	been moved to mach/i386/fp_reg.h.


Special notes:
------- -----

Tested on:
	VAX		STD+VAX6bb:	nova.fac
	SUN3		STD+SWS:	rocky.mach
	MIPS		STD+ANY		testarossa, rpd
	i386		STD+WS		several
			STD+SQT		boris

Broken on i386iPSC: I don't know how the ramdisk is set up,
		but it appears to conflict with the code that
		moves the bootstrap image.

Broken on i860iPSC, luna88k, MacII.

Machine-dependent changes needed:

startup code must evict the bootstrap image and the kernel symbols
from BSS (see kern/bootstrap.c::move_bootstrap() )

machine/pcb.c needs two new routines to talk to the bootstrap startup
code: set_user_regs() and user_stack_low().

The system call trap code must be changed to take the lower bound
for emulated system call traps from the current emulation vector
table; it is no longer a constant.


******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
68
[ ./kernel/mips/db_interface.c ]
kdb_init and read_mips_symtab take no parameters.
Enter ddb whether or not RB_KDB is set.
[91/10/30            dbg]
[ ./bootstrap/Makeconf ]
Created.
[91/04/24            dbg]
[ ./bootstrap/Makefile ]
Add our own memory allocator to reduce space requirements.
[91/10/01            dbg]

Build sequence-number versions of memory_object interface files.
[91/09/04            dbg]

Build memory_object_server.h instead of memory_object_user.h.
[91/08/02            dbg]

Created.
[91/04/24            dbg]
[ ./bootstrap/assert.h ]
Modify for out-of-kernel use.
[91/09/05            dbg]
[ ./bootstrap/boot_printf.c ]
Moved outside of kernel to bootstrap.
[91/08/02            dbg]
[ ./bootstrap/bootstrap.c ]
Close server directory after it has been found.  Add server
directory name to command line passed to startup program.
[91/09/25            dbg]

Set stack size to 8 K bytes.
[91/08/28            dbg]

Ask for mach_servers directory if -a switch supplied.
[91/08/09            dbg]

Rewrite to run out of kernel.
Initialize default pager (to get default pager port) before
running first user task.
[91/04/24            dbg]
[ ./bootstrap/def_pager_setup.c ]
Use server_dir_name instead of root_name.
[91/09/04            dbg]

Convert to run outside of kernel.
Return whether there is a paging partition.
[91/09/04            dbg]
[ ./bootstrap/default_pager.c ]
Simplify locking.
[91/10/02            dbg]

Convert to run outside of kernel.
[91/09/04            dbg]
[ ./bootstrap/defs.h ]
Add type names.  Add block-size definitions (should be
in device/disk_status.h).
[91/08/02            dbg]
[ ./bootstrap/dir.h ]
Moved out of kernel.
[91/12/23  16:21:36  dbg]
[ ./bootstrap/disk_inode.h ]
Moved out of kernel.
[91/12/23  17:59:11  dbg]
[ ./bootstrap/file_io.c ]
Make file_direct self-contained: add the few fields needed from
the superblock.
[91/10/17            dbg]

Deallocate unused superblocks when switching file systems.  Add
file_close routine to free space taken by file metadata.
[91/09/25            dbg]

Move outside of kernel.
Unmodify open_file to put arrays back on stack.
[91/09/04            dbg]
[ ./bootstrap/file_io.h ]
Make file_direct self-contained: add the few fields needed from
the superblock.
[91/10/17            dbg]

Add close_file to free storage.
[91/09/25            dbg]

Move outside of kernel.
[91/09/04            dbg]
[ ./bootstrap/fs.h ]
Moved out of kernel.
[91/12/23  17:59:30  dbg]
[ ./bootstrap/i386/exec.c ]
Moved outside of kernel.
[91/09/04            dbg]
[ ./bootstrap/i386/exec.h ]
Moved out of kernel.
[91/12/23  16:22:25  dbg]
[ ./bootstrap/kalloc.c ]
Rewrote for default pager use.
[91/10/01            dbg]
[ ./bootstrap/load.c ]
Close startup file after loading it.
[91/09/25            dbg]

Move outside of kernel.
[91/09/04            dbg]
[ ./bootstrap/loader_info.h ]
Moved from boot_ufs.  Removed format; added fields for symbol
table.
[91/04/24            dbg]
[ ./bootstrap/mips/coff.h ]
Moved out of kernel.
[91/12/23  16:23:08  dbg]
[ ./bootstrap/mips/exec.c ]
Moved outside of kernel.
[91/09/04            dbg]
[ ./bootstrap/mips/syms.h ]
Moved out of kernel.
[91/12/23  16:23:38  dbg]
[ ./bootstrap/queue.h ]
Strip down for default pager use.
[91/10/02            dbg]
[ ./bootstrap/strfcns.c ]
Created.
[91/08/09            dbg]
[ ./bootstrap/sun3/exec.c ]
Moved outside of kernel.
[91/09/04            dbg]
[ ./bootstrap/sun3/exec.h ]
Moved out of kernel.
[91/12/23  16:24:18  dbg]
[ ./bootstrap/vax/exec.c ]
Moved outside of kernel.
[91/09/04            dbg]
[ ./bootstrap/vax/exec.h ]
Moved out of kernel.
[91/12/23  18:00:10  dbg]
[ ./bootstrap/wiring.c ]
Don't wire memory unless for current task.
[91/10/17            dbg]

Created.
[91/04/29            dbg]
[ ./bootstrap/wiring.h ]
Created.
[91/04/29            dbg]
[ ./include/Makefile ]
Added mach/boot_info.h, mach/i386/fp_reg.h,
mach/i386/mach_i386.defs, mach/i386/mach_i386_types.h.
Changed to new copyright.
[91/12/18            dbg]
[ ./kernel/Makefile ]
Add rules to build mach.boot from kernel and bootstrap.
Add rules to build makeboot.
[91/12/18            dbg]
[ ./kernel/conf/MASTER.i386 ]
Remove MAKEBOOT rules for Sequent.  Makeboot is now used for all
machines.

Add floating-point emulation support.  Add to WS configuration
(AT bus) only.
[91/12/18            dbg]
[ ./kernel/conf/MASTER.vax ]
Configure for VAX3100 only on 'pvax' tag, so we can build a
system without VaxStation 3100 support.
[91/11/01            dbg]
[ ./kernel/conf/Makefile.i386 ]
Remove makeboot rules - makeboot is now used for all
machines.
[91/08/02            dbg]
[ ./kernel/conf/Makefile.template ]
Move bootstrap out of kernel.  Remove all 'mach_user_internal'
files except for memory_object_data_provided,
memory_object_data_unavailable, memory_object_data_error,
memory_object_set_attributes (used by device pager).  Build
these as "kernel_user" interfaces.
[91/12/18            dbg]
[ ./kernel/conf/files ]
Move bootstrap code outside of kernel proper.
[91/12/18            dbg]
[ ./kernel/conf/files.i386 ]
18-Decl-91  David Golub (dbg) at Carnegie-Mellon University
Add FPE option and fpe_linkage.c.
Add user_ldt.c.  Remove io_map_interface.c.
Kick bootstrap code out to user space: remove i386/exec.c.
[91/12/23  16:25:42  dbg]
[ ./kernel/conf/files.mips ]
Move bootstrap code to user space - remove exec.c.
[91/09/04            dbg]
[ ./kernel/conf/files.sun3 ]
Kick bootstrap code out to user space; remove sun/exec.c.
Move device/subr_rmap.c to sundev/subr_rmap.c.
[91/12/18            dbg]
[ ./kernel/conf/files.vax ]
Kick bootstrap code out to user space: remove vax/exec.c.
Move device/subr_rmap.c to vaxuba/subr_rmap.c, and make
it conditional on uba.
[91/12/18            dbg]
[ ./kernel/ddb/db_aout.c ]
Don't print 'preserving symbols' if loading symbol table fails.
[91/11/29            dbg]

Use kern_sym_start, kern_sym_size to locate kernel symbol table.
Rename routine to ddb_init.
[91/10/30            dbg]
[ ./kernel/ddb/db_ext_symtab.c ]
Don't deallocate symbol-table twice if error in loading symbol
table.
[91/11/29            dbg]
[ ./kernel/device/dev_pager.c ]
Define device_pager_server_routine for new kernel stub calling
sequence.
[91/11/25            dbg]

Call MiG stubs for memory_object functions, instead of the
internal functions directly, so that the device pager will work
remotely.
[91/10/30            dbg]
[ ./kernel/device/device.defs ]
Add 'CountInOut' tag to routines returning variable-length
inline arrays.  Remove 'IsLong' tag from routines passing or
returning variable-length arrays.  Old routines left under
'xxx_' names.  REMOVE THESE SOON!
[91/11/26            dbg]
[ ./kernel/device/io_req.h ]
Rename io_lock to io_req_lock to avoid conflict with io_lock
macro for ipc_objects.
[91/10/21            dbg]
[ ./kernel/device/net_io.c ]
Add: NETF_PUSHHDR, NETF_PUSHSTK, NETF_PUSHIND, NETF_PUSHHDRIND.
[91/12/23            dbg]
[ ./kernel/device/net_status.h ]
Add: NETF_PUSHHDR, NETF_PUSHSTK, NETF_PUSHIND, NETF_PUSHHDRIND.
[91/12/23            dbg]
[ ./kernel/i386/ast.h ]
Add AST_I386_FP to handle delayed floating-point exceptions.
[91/10/29            dbg]
[ ./kernel/i386/cswitch.s ]
Floating-point state is now saved by caller.
[91/10/20            dbg]
[ ./kernel/i386/db_disasm.c ]
Add a switch to disassemble 16-bit code.
Fix spelling of 'lods' opcodes.
[91/10/30            dbg]
[ ./kernel/i386/db_interface.c ]
Always enter debugger - ignore RB_KDB.
[91/10/30            dbg]
[ ./kernel/i386/fpe.b ]
Created.  Sources are Intel proprietary.
[91/12/23  16:31:25  dbg]
[ ./kernel/i386/fpe_linkage.c ]
Changed trap gate for interrupt 7 to PL_Kernel.  The privilege level
affects INT $7 instructions, not coprocessor-not-present traps.
[91/12/19            dbg]

Created.
[91/10/19            dbg]
[ ./kernel/i386/fpu.c ]
Move floating-point state manipulation from i386/pcb.c to this
file.  Add support for floating-point emulator.  Restore
FPU shuffling between threads if single CPU.  Add locking
to PCB to avoid losing fp_save structures.
[91/10/20            dbg]
[ ./kernel/i386/fpu.h ]
Created.
[91/12/23  16:32:15  dbg]
[ ./kernel/i386/gdt.c ]
Add entries for user LDT, floating-point register
access from emulator, and floating-point emulator code.
[91/10/18            dbg]
[ ./kernel/i386/genassym.c ]
Add DISP_MIN.
[91/10/31            dbg]
[ ./kernel/i386/idt.s ]
Segment-not-present fault may occur during kernel exit sequence.
[91/10/29            dbg]
[ ./kernel/i386/io_emulate.c ]
Move AT-bus IO port emulation to i386at/iopl.c.
[92/01/02            dbg]

Rewrite to map IO ports into 'faulting' thread.
Move actual instruction decoding to trap.c.
Emulate certain IO ports for AT bus machines.
[91/11/09            dbg]
[ ./kernel/i386/io_emulate.h ]
Created.
[91/12/06            dbg]
[ ./kernel/i386/io_port.h ]
Created.
[91/11/07            dbg]
[ ./kernel/i386/iopb.c ]
Fix locking.  Move all interface routines here.
[91/11/07            dbg]
[ ./kernel/i386/locore.s ]
Generalize retryable faults.  Add inst_fetch to fetch
instruction when segments are in use.
[91/12/06            dbg]

Remove fixed lower bound for emulated system call table.
[91/10/31            dbg]

Segment-not-present may also occur during kernel exit sequence.
Call i386_ast_taken to handle delayed floating-point exceptions.
[91/10/29            dbg]
[ ./kernel/i386/machine_routines.h ]
Define MACHINE_SERVER_ROUTINE.
[91/11/25            dbg]
[ ./kernel/i386/pcb.c ]
Disable thread_set_state of ISA_PORT_MAP, but have it still
return KERN_SUCCESS (for DOS emulator compatibility).
[91/12/06            dbg]

Add user ldt management.  Move floating-point state
manipulation to i386/fpu.{c,h}.

Add user_stack_low and set_user_regs for passing control to
bootstrap in user space.
[91/10/30            dbg]
[ ./kernel/i386/proc_reg.h ]
Add macros to get and set various privileged registers.
[91/10/20            dbg]
[ ./kernel/i386/seg.h ]
Add USER_LDT and USER_FPREGS.  Add defines for selector bits.
[91/08/20            dbg]
[ ./kernel/i386/start.s ]
Move symbol table and bootstrap image out of BSS.
[91/08/02            dbg]
[ ./kernel/i386/thread.h ]
Add lock to PCB to govern separate state fields (e.g.
floating-point status, io_tss, user_ldt).
[91/11/01            dbg]

Add user_ldt pointer to machine_state.
[91/08/20            dbg]
[ ./kernel/i386/trap.c ]
Build retry table for certain successful faults.
Enable IO instruction emulation in V86 mode.
[91/12/01            dbg]

Add i386_astintr to handle delayed floating-point exceptions.
[91/10/29            dbg]

Check for use of user FP register segment if floating-point
emulator present.  Pass i386 trap number as exception code
for all i386 exceptions.  Route i386 exceptions through
emulator fixup routine if exception taken within emulator.

Eliminate warning on 'ifdef'.  Remove offending type
declarations.
[91/10/19            dbg]
[ ./kernel/i386/user_ldt.c ]
Created.
[91/08/20            dbg]
[ ./kernel/i386/user_ldt.h ]
Created.
[91/08/20            dbg]
[ ./kernel/i386at/asm_startup.h ]
Symbols are no longer read separately by boot loader.
[91/08/02            dbg]
[ ./kernel/i386at/com.c ]
Don't drop software CARR_ON if carrier drops - modem drops
carrier but still can talk to machine.
[91/10/30            dbg]
[ ./kernel/i386at/iopl.c ]
Add 'forbidden' list.  For DOS compatibility, allow any port not
on this list.
[92/01/02            dbg]

Add ports 70 and 71 for DOS programs (XXX).
[91/12/18            dbg]

Use io_port sets.
[91/11/09            dbg]
[ ./kernel/i386at/kd.c ]
Fix io_port mapping setup.
[91/12/18            dbg]
[ ./kernel/i386at/model_dep.c ]
Fixed so that mem_size can be patched to limit physical memory
use.
[91/09/29            dbg]

Rename kdb_init to ddb_init.  Remove esym.
[91/09/11            dbg]
[ ./kernel/i386ipsc/asm_startup.h ]
Symbols are no longer read separately by boot loader.
[91/12/18            dbg]
[ ./kernel/i386ipsc/model_dep.c ]
Rename kdb_init to ddb_init.
Use '-d' switch (RB_KDB) for initial debugger breakpoint.
[91/12/18            dbg]
[ ./kernel/ipc/ipc_mqueue.c ]
Removed THREAD_SHOULD_TERMINATE.
[91/12/19            dbg]
[ ./kernel/ipc/mach_msg.c ]
Add quick dispatch to Mach Kernel messages.
[91/12/18            dbg]
[ ./kernel/kern/bootstrap.c ]
Move bootstrap code out to user space.
Mac2 and iPSC-dependent code must be moved there also.
[91/12/18            dbg]
[ ./kernel/kern/compat_xxx_defs.h ]
Created.  If this has more than one log entry, something
is wrong.
[91/11/26            dbg]
[ ./kernel/kern/ipc_kobject.c ]
Call <subsystem>_routine_name to find IPC stub to execute.
Build reply message header by hand. (XXX)
Simplify cleanup of request message when reply is success.
[91/12/18            dbg]
[ ./kernel/kern/sched_prim.h ]
Removed THREAD_SHOULD_TERMINATE (again).
[91/12/19            dbg]
[ ./kernel/kern/syscall_emulation.c ]
Change new versions of calls to pass dispatch table out-of-line.
Old calls (xxx_*) use inline data.
[92/01/03            dbg]

Don't round up allocated vector size.
[92/01/02            dbg]

Remove fixed lower and upper bounds on emulated system call
table.  Now everyone can get as much as the MiG interface will
allow.
[91/12/18            dbg]
[ ./kernel/kern/syscall_emulation.h ]
Remove fixed lower bound.  Fix type declaration for
eml_routine_t.  Remove syscall_val structure.
[91/10/31            dbg]
[ ./kernel/kern/thread.c ]
Make thread_wire really reserve a kernel stack.
[91/12/18            dbg]
[ ./kernel/mach/boot_info.h ]
Created.
[91/09/06            dbg]
[ ./kernel/mach/i386/fp_reg.h ]
Move this file to mach/i386.  Add FP_NO..FP_387 codes for
floating-point processor status.  Error bits in control
register are masks, not enables.
[91/10/19            dbg]
[ ./kernel/mach/i386/mach_i386.defs ]
Renamed io_map to io_port_add.  Added io_port_remove,
io_port_list, set_ldt, get_ldt.
[91/08/20            dbg]
[ ./kernel/mach/i386/mach_i386_types.h ]
Created.
[91/08/20            dbg]
[ ./kernel/mach/i386/thread_status.h ]
Add REGS_SEGS flavor to get and set the segment registers.
Move fp_reg.h to mach/i386.
[91/10/18            dbg]
[ ./kernel/mach/i386/vm_param.h ]
Drop back to 1-page kernel stacks, since emulation_vector calls
now pass data out-of-line.
[92/01/03            dbg]
[ ./kernel/mach/mach.defs ]
Changed (new) task_get_emulation_vector,
task_set_emulation_vector to pass data out-of-line.  Old
routines still pass data in-line, for compatibility.
[92/01/03            dbg]

Add 'CountInOut' tag to routines returning variable-length
inline arrays.  Remove 'IsLong' tag from routines passing or
returning variable-length arrays.  Old routines left under
'xxx_' names.  REMOVE THESE SOON!

I used the message IDs from the Mach 1.5 thread calls (before
the real thread support went in) - they haven't been used since
1988.
[91/11/26            dbg]
[ ./kernel/mach/mach_host.defs ]
Add 'CountInOut' tag to routines returning variable-length
inline arrays.  Remove 'IsLong' tag from routines passing or
returning variable-length arrays.  Old routines left under
'xxx_' names.  REMOVE THESE SOON!
[91/11/26            dbg]
[ ./kernel/mach/mig_errors.h ]
Add mig_routine_t.
[91/11/11            dbg]
[ ./kernel/mips/db_mips_sym.c ]
Symbol table is now always moved to 'end', NOT preceded by
filehdr.
[91/10/30            dbg]
[ ./kernel/mips/genassym.c ]
Remove fixed lower bound on emulated system call number.
[91/11/01            dbg]
[ ./kernel/mips/locore.s ]
Remove fixed lower bound on emulated system call number.
[91/11/01            dbg]
[ ./kernel/mips/mips_cache.s ]
Reload saved s0 in mipscache_tests.
[91/09/16            dbg]
[ ./kernel/mips/mips_init.c ]
Move symbol table and bootstrap image out of BSS at startup.
[91/09/04            dbg]
[ ./kernel/mips/parse_args.c ]
Remove startup_name.
[91/09/13            dbg]
[ ./kernel/mips/pcb.c ]
Add user_stack_low and set_user_regs for passing control to
bootstrap in user space.
[91/11/26            dbg]
[ ./kernel/mips/pmap.c ]
Made pmap_extract handle kernel virtual addresses in K0 or K1
space.
[91/09/19            dbg]
[ ./kernel/sqt/asm_startup.h ]
Symbols are always packed into kernel image by boot program -
remove Sequent-specific loader code.
[91/08/30            dbg]
[ ./kernel/sqt/model_dep.c ]
Rename kdb_init to ddb_init.  Remove esym.
Allocate interrupt stacks before initial debugger breakpoint.
[91/09/11            dbg]
[ ./kernel/sqt/stubs.c ]
Add iopl_device.
[91/11/26            dbg]
[ ./kernel/src/makeboot/Makefile ]
Fixed copyright.  Split out machine-dependent code to separate
files.
[91/09/12            dbg]
[ ./kernel/src/makeboot/build_boot.c ]
Remove '-sequent' switch.  Recognize Sequent from
real-to-protected bootstrap text following a.out header.
[91/08/30            dbg]

Added code to glue the kernel and the boot file together, for
all machines.
[91/05/29            dbg]
[ ./kernel/src/makeboot/i386/exec.c ]
Created.
[91/09/12            dbg]
[ ./kernel/src/makeboot/mips/coff.h ]
Added (from kernel sources).
[91/12/23  16:39:07  dbg]
[ ./kernel/src/makeboot/mips/exec.c ]
Created.
[91/09/12            dbg]
[ ./kernel/src/makeboot/mips/syms.h ]
Added (from kernel sources).
[91/12/23  16:39:38  dbg]
[ ./kernel/src/makeboot/sun3/exec.c ]
Created.
[91/09/12            dbg]
[ ./kernel/src/makeboot/vax/exec.c ]
Created.
[91/09/12            dbg]
[ ./kernel/src/mig/lexxer.l ]
Add 'CountInOut' flag.
[91/11/11            dbg]
[ ./kernel/src/mig/routine.c ]
Indefinite OUT arrays are passed by pointer, not by address.

Set argByReferenceUser and argByReferenceServer fields.
[91/09/04            dbg]
[ ./kernel/src/mig/routine.h ]
Add byReferenceUser and byReferenceServer to each argument, so
they can be individually set.  Add akbPointer.
[91/09/04            dbg]
[ ./kernel/src/mig/server.c ]
Generate <subsystem>_server_routine to return unpacking function
pointer.
[91/11/11            dbg]

For inline variable-length arrays that are Out parameters, allow
passing the user's count argument to the server as an InOut
parameter.
[91/11/11            dbg]

Redo handling of OUT arrays that are passed in-line or
out-of-line.  Treat more like out-of-line arrays:
user allocates buffer and pointer
fills in pointer with buffer address
passes pointer to stub
stub copies data to *pointer, or changes pointer
User can always use *pointer.

Change argByReferenceUser to a field in argument_t.
[91/09/04            dbg]
[ ./kernel/src/mig/type.h ]
Add flCountInOut.
[91/11/11            dbg]
[ ./kernel/src/mig/user.c ]
Redo handling of OUT arrays that are passed in-line or
out-of-line.  Treat more like out-of-line arrays:
user allocates buffer and pointer
fills in pointer with buffer address
passes pointer to stub
stub copies data to *pointer, or changes pointer
User can always use *pointer.

Change argByReferenceUser to a field in argument_t.
[91/09/04            dbg]
[ ./kernel/src/mig/utils.c ]
Change argByReferenceUser and argByReferenceServer to fields in
argument_t.
[91/08/29            dbg]
[ ./kernel/sun3/db_interface.c ]
Ignore RB_KDB - always enter DDB.
[91/11/06            dbg]
[ ./kernel/sun3/genassym.c ]
Remove fixed lower bound on emulated system call number.
[91/11/01            dbg]
[ ./kernel/sun3/locore.s ]
Remove fixed lower bound on emulated system call number.
[91/11/01            dbg]

Symbol table and bootstrap image are at end of kernel, sitting
in BSS.  Account for moved bootstrap image (starting at next
page boundary after kernel symbols) in re-mapping physical
memory to virtual memory.  Move symbols and bootstrap and zero
BSS in sun_init.
[91/08/21            dbg]
[ ./kernel/sun3/model_dep.c ]
Don't use 'RB_KDB' - always trap to debugger.
[91/11/06            dbg]

Rename kdb_init to ddb_init.
[91/09/11            dbg]
[ ./kernel/sun3/pcb.c ]
Add user_stack_low and set_user_regs for passing control to
bootstrap in user space.
[91/08/12            dbg]
[ ./kernel/sun3/sun_init.c ]
Move symbol table and bootstrap image out of BSS.  Clear BSS
afterwards.
[91/08/21            dbg]
[ ./kernel/sundev/mb.c ]
Move device/map.h to sundev/subr_rmap.h.
[91/12/19            dbg]
[ ./kernel/sundev/subr_rmap.c ]
Fix bug in rminit: clear the entire rmap.
[91/10/25            dbg]
[ ./kernel/sundev/subr_rmap.h ]
Moved here from device directory.  It's not license-free.
[91/12/23  16:42:08  dbg]
[ ./kernel/sunif/if_ie.c ]
Move device/map.h to sundev/subr_rmap.h.
[91/12/19            dbg]
[ ./kernel/vax/autoconf.c ]
Remove include of device/map.h.
[91/12/19            dbg]
[ ./kernel/vax/db_interface.c ]
Ignore RB_KDB - always enter DDB.
[91/09/12            dbg]
[ ./kernel/vax/db_trace.c ]
Fix trace's test for kernel stack - use state & TH_SWAPPED.
[91/11/01            dbg]
[ ./kernel/vax/genassym.c ]
Remove fixed lower bound on emulated system calls.
[91/11/01            dbg]
[ ./kernel/vax/ka6200.c ]
Add ka6200_start.
[91/10/25            dbg]
[ ./kernel/vax/locore.s ]
Remove fixed lower bound on emulated system call number.
[91/11/01            dbg]
[ ./kernel/vax/model_dep.c ]
Rename kdb_init to ddb_init.  Remove esym.
RB_KDB is unused.
[91/09/11            dbg]
[ ./kernel/vax/pcb.c ]
Add user_stack_low and set_user_regs for passing control to
bootstrap in user space.
[91/08/02            dbg]
[ ./kernel/vax/vax_init.s ]
Move symbol table and bootstrap image out of BSS.
[91/08/02            dbg]
[ ./kernel/vaxuba/subr_rmap.c ]
Fix bug in rminit: clear the entire rmap.
[91/10/25            dbg]
[ ./kernel/vaxuba/subr_rmap.h ]
Moved here from device directory.  It's not license-free.
[91/12/23  16:43:42  dbg]
[ ./kernel/vaxuba/uba.c ]
Remove include of device/map.h.
[91/12/19            dbg]
[ ./kernel/vaxuba/ubavar.h ]
Move device/map.h to vaxuba/subr_rmap.h.
[91/12/19            dbg]
[ ./kernel/vm/vm_map.c ]
Fix erroneous boundary condition in search for free space in
vm_map_copyout(), vm_map_copyout_page_list().  The 'end' of the
entry is the last used address + 1, and therefore can be <= the
start of the next entry.  See vm_map_enter(), where it was done
correctly.
[91/12/23            dbg]

Add vm_map_copy_copy.  It is needed by kernel interface
routines that may still return errors after copying a
copy-object into kernel address space.
[91/12/18            dbg]
[ ./user/libmach/Makefile ]
Add mig_reply_setup.
[91/12/23            dbg]

Add mig_allocate, mig_deallocate.

Reorganize makefile and sources to build MiG-generated interface
routines as individual .o files.

Add mach_i386 interface.
[91/12/18            dbg]
[ ./user/libmach/mig_allocate.c ]
Created.
[91/09/21            dbg]
[ ./user/libmach/mig_deallocate.c ]
Created.
[91/09/21            dbg]
[ ./user/libmach/mig_reply_setup.c ]
Created.
[91/12/23            dbg]
[ ./user/libmach/ms_mach_port_allocate.c ]
Split into individual files so that user can substitute for any
one routine (e.g. vm_allocate).
[91/09/05            dbg]
[ ./user/libmach/ms_mach_port_allocate_name.c ]
Split into individual files so that user can substitute for any
one routine (e.g. vm_allocate).
[91/09/05            dbg]
[ ./user/libmach/ms_mach_port_deallocate.c ]
Split into individual files so that user can substitute for any
one routine (e.g. vm_allocate).
[91/09/05            dbg]
[ ./user/libmach/ms_mach_port_insert_right.c ]
Split into individual files so that user can substitute for any
one routine (e.g. vm_allocate).
[91/09/05            dbg]
[ ./user/libmach/ms_task_create.c ]
Split into individual files so that user can substitute for any
one routine (e.g. vm_allocate).
[91/09/05            dbg]
[ ./user/libmach/ms_task_set_special_port.c ]
Split into individual files so that user can substitute for any
one routine (e.g. vm_allocate).
[91/09/05            dbg]
[ ./user/libmach/ms_task_suspend.c ]
Split into individual files so that user can substitute for any
one routine (e.g. vm_allocate).
[91/09/05            dbg]
[ ./user/libmach/ms_task_terminate.c ]
Split into individual files so that user can substitute for any
one routine (e.g. vm_allocate).
[91/09/05            dbg]
[ ./user/libmach/ms_vm_allocate.c ]
Split into individual files so that user can substitute for any
one routine (e.g. vm_allocate).
[91/09/05            dbg]
[ ./user/libmach/ms_vm_deallocate.c ]
Split into individual files so that user can substitute for any
one routine (e.g. vm_allocate).
[91/09/05            dbg]
[ ./user/libmach/ms_vm_map.c ]
Split into individual files so that user can substitute for any
one routine (e.g. vm_allocate).
[91/09/05            dbg]
[ ./user/threads/i386/cthreads.h ]
Add volatile to spin_lock_t.  Change spin_unlock and
spin_try_lock definitions back to memory operands, but rely on
volatile attribute to keep from using value in memory.
[91/09/04            dbg]
[ ./user/threads/stack.c ]
Export cthread_stack_size, and use it if non-zero instead of
probing the stack.  Fix error in deallocating unused initial
stack (STACK_GROWTH_UP case).
[91/08/28            dbg]
[ ./user/threads/sun3/cthreads.h ]
Add volatile to spin_lock_t.  Remove operand-match
constraint from ASM statement in spin_lock_try - rely on
volatile attribute.
[91/09/04            dbg]
[ ./user/threads/vax/cthreads.h ]
Add volatile to spin_lock_t.  Remove operand-match
constraint from ASM statement in spin_lock_try - rely on
volatile attribute.
[91/09/04            dbg]
[ ./kernel/chips/lance_mapped.c ]
No need to destroy/init the eventcounter all the time.
[91/12/27            af]

Since we are actually using this, made user-safe.
[91/12/27            af]
[ ./kernel/i386at/conf.c ]
Added devinfo routine to scsi to accomodate MI change
that screwed up extra large writes.
[91/12/26  11:06:54  af]
[ ./kernel/kern/eventcount.c ]
Made user-safe with a small translation table.
This all will be refined at a later time.
[91/12/27            af]
[ ./kernel/kern/eventcount.h ]
Added id field to make user-safe.  Since we have not
decided what the user-interface will look like (and
we are using it nonetheless) do not define anything.
[91/12/27            af]
[ ./kernel/kern/syscall_sw.c ]
Use continuations always in evc_wait.
[91/12/27            af]
[ ./kernel/luna88k/conf.c ]
Added devinfo routine to scsi to accomodate MI change
that screwed up extra large writes.
[91/12/26  11:10:01  af]
[ ./kernel/mips/PMAX/kmin_dma.c ]
Zero dma_ptr at end of xfers, else disconnects get confused.
On disconnect, fix case where (a) it happened before we got
a chance to start the dma operations going and (b) we restart
dma on following reconnect [cuz dma_offset==1 hack].
[91/12/26  11:05:33  af]
[ ./kernel/mips/conf.c ]
Added devinfo routine to scsi to accomodate MI change
that screwed up extra large writes.
[91/12/26  11:01:14  af]
[ ./kernel/mips/db_interface.c ]
Fix (from <Steve.Ackerman@zindigi.msg.uvm.edu>) the kdbputmem
routine for little endian machines.
[91/12/26  10:59:59  af]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
Removed playing with FIFO in asc_reconnect(), see comment within.
This makes the case of multiple drives work again.
[91/12/26  11:14:02  af]
[ ./kernel/scsi/adapters/scsi_aha15.h ]
Made various chars unsigned, else we screwup in outbs.
[Found by bernadat@gr.osf.org]
[ ./kernel/scsi/adapters/scsi_aha15_hdw.c ]
Made various chars unsigned, else we screwup in outbs.
[Found by bernadat@gr.osf.org]
[ ./kernel/scsi/mapped_scsi.c ]
No need to destroy/init the eventcounter all the time.
[91/12/27            af]

Since we are actually using this, make user-safe.
[91/12/27            af]
[ ./kernel/scsi/rz.c ]
Added rz_devinfo().
[91/12/26  11:10:59  af]
[ ./kernel/mach/mach_types.defs ]
Changed emulation_vector_t to pass data out-of-line.  Renamed
old type to xxx_emulation_vector_t for compatibility.
Removed vm_page_data_t.
[92/01/03            dbg]
[ ./kernel/vax/pmap.c ]
Fixed pmap_enter so that unwiring a mapping doesn't unwire the
pte page if it has more wired mappings.
[91/12/30            dbg]
[ ./kernel/norma/ipc_ether.c ]
Fixed merge error in nd_reply.
[92/01/01            jsb]
[ ./kernel/norma/ipc_input.c ]
Made large kmsgs work correctly (without leaking).
[92/01/01            jsb]
[ ./kernel/norma/kern_task.c ]
Changed norma_task_create to use new out-of-line interfaces
for task_{get,set}_emulation_vector.
[92/01/03            dbg]

Check for null parent task in task_create.
[92/01/01            jsb]
[ ./kernel/i386/io_map_interface.c ]
Defunct.
[ ./kernel/i386at/c765.c ]
Defunct.
[ ./kernel/i386at/m765.h ]
Defunct.
[ ./kernel/i386at/m765drv.c ]
Defunct.
[ ./kernel/i386at/m765knl.c ]
Defunct.
[ ./kernel/i386at/pc586bcopy.s ]
Defunct.
[ ./kernel/device/map.h ]
Defunct.
[ ./kernel/device/subr_rmap.c ]
Defunct.
    
    
    
==========================================================================
   ***** MK Version MK69  (rpd) *****
    
    
New features:
--- --------

I changed the exported header files so that the default value
for MACH_IPC_COMPAT is 0.  This means you don't need
	-DMACH_IPC_COMPAT=0
in your Makefiles.  It also means that if you *want* the old
IPC definitions, you need to add
	-DMACH_IPC_COMPAT=1
to your Makefiles.  The support in the kernel for old IPC
is not changed.

I changed the kernel so that all VM objects are created with name ports.

I changed the default_pager_object interface.  It is now the default_pager
interface and lives in bootstrap/mach/default_pager.defs.
I added a couple calls (default_pager_objects, default_pager_object_pages)
for extracting information about VM objects managed by the default pager.
I changed the default_pager_info call to also return the VM page-size
used by the default pager.  (I did not change default_pager_object_create.)

I changed the mach_debug interface.  I removed the vm_mapped_pages_info
call.  I changed the mach_vm_region_info call; now it just returns
the object at the top of the object chain.  I added mach_vm_object_info
and mach_vm_object_pages for getting information about a VM object,
given its name port.  I changed all the calls that return variable-sized
info to return it using "indefinite" (in-line or out-of-line, depending
on size) arrays.

Taken together, the additions to the default_pager and mach_debug
interfaces allow an appropriately privileged task to extract information
about all of the VM maps in the system, the object chains, objects managed
by the default pager, and pages in these objects.  You can find out
which pages are resident, which are paged-out, etc.


Bug fixes:
--- -----

I fixed several locking/assertion bugs in vm_fault_copy.

I fixed out-of-line ports so that tasks in the kernel address
space can use them.  Of course, now that the default pager
isn't in the kernel address space this is a moot fix.

I fixed mach_vm_region_info so that it handles share/sub maps properly.

I fixed the "CountInOut" feature in mig.  This feature, used with
variabled-sized out arrays, passes the client's array size through
to the server.  The old implementation passed the client-specified
size through unchanged even if it was bigger than the buffer in
the server's reply message.  A client could crash a server by
supplying a large value.

I fixed the "indefinite" array feature in mig.  The client-side
code for out arrays was incorrect in the case that in-line data
is received but it doesn't fit in the client's buffer.

I fixed the code generation for "indefinite" arrays so that
the deallocate bit ("Dealloc" and "Dealloc[]") works properly.

I fixed the mig cover-script's dependency generation.
It doesn't generate dependencies with /dev/null now.
It does generate dependencies for all generated files,
and adds a dependency on migcom.  If you are using -i,
then to get proper dependencies you should also use -user:
	USER_SRCS = foo_routine1.c foo_routine2.c ...

	foo.h ${USER_SRCS} fooServer.c : foo.defs
		mig -MD -i ./ -user '$${USER_SRCS}' foo.defs

I fixed several dead-name bugs in bootstrap.

[PMAX]	  I picked up Sandro's cursor-color fix and his root-name fix
for tftp.

[I386]	  I picked up Bob's com3 fix.

[I386]	  I picked up Bob's bad-block-mapping fix for the hd driver.

[I386]	  I fixed the get-status/set-status calls for the hd and fd drivers
so that they return D_INVALID_OPERATION for unsupported flavors.

[SUN3]	  I cleaned up the mach/sun3/reg.h, sun3/reg.h mess.

In libmach/libmach_sa:

I fixed mach_msg_server so that if the reply port is a send right
instead of a send-once right, the reply message is sent using MACH_SEND_TIMEOUT
in case a bogus/malicious user isn't receiving reply messages.

I fixed mach_msg so that it doesn't pass the MACH_SEND_INTERRUPT and
MACH_RCV_INTERRUPT bits to the kernel, so that they don't keep you off
the kernel's fast IPC paths.

I fixed mach_msg_destroy so that for MACH_MSG_TYPE_MAKE_SEND and
MACH_MSG_TYPE_MAKE_SEND_ONCE it creates and destroys a send/send-once right.
This is important to servers sending reply messages that use these types.
If mach_msg_server can't send the reply message, because the client died, then
mach_msg_destroy needs to create the same situation as if the reply message
had been sent and then destroyed.  For example, this way the server's
make-send count for the port doesn't get confused.


Organizational changes:
-------------- -------

The MK collection uses the new Makefile organization.
In the mk/kernel directory, you can build individual .o files now.
For example,
	make thread.o
will do the right thing.

I fixed the Directories/* files.

I removed support for the inline program.

I removed swap/root/dump/arg device support from the config program
and made corresponding simplifications to Makefile.template.
machine/swapgeneric.c is no longer special.

The user/libmach directory now builds libmach.a and libmach_sa.a.
It builds and installs crt0.o, which is no longer in a library.

Special notes:
------- -----

I tested the following configurations:
	mips		STD+ANY on rpd
	i386		STD+WS	on waldo, STD+SQT on boris
	vax		STD+16+fixpri+VAX6bb+BI+de on r2d2
	sun3		STD+SWS on rocky
    
    
    
==========================================================================
   ***** MK Version MK70  (elf) *****
    
    
New features:
--- --------

A vastly improved default pager, compliments of Alessandro Forin. This
pager can use both paging files and raw devices (disk partitions) for
backing store. In addition, paging files/devices can be dynamically
added and deleted to running systems. The swapon program in the USER
collection (availible in USER14) can be used to accompilish this. See
the man page there for more details.

By default, the default pager symbol table is no longer preserved. Patch
the load_bootstrap_symbols variable to preserve it.

Ddb has more emacs editting features, including command history.
Ctrl-P (previous command), Ctrl-N (next command), and 
Crtl-U (delete line) now work.

Changed from David Black (dlb@osf.org) to eliminate sharing maps. 

Rconsole support for the 5000/120 (elf,af).

[I386,PMAX]	"F" flag will now be displayed for threads that have a valid
FPU context in show threads in ddb.

[LUNA88K]	First update in over a year. Code is now substantially
working, if not complete. Currently it will boot, autoconfigure and die
somewhere in the default pager. Ddb can now single step in user space.
Stack tracing code substantially improved. The code now uses stack handoff.

Bug fixes:
--- -----

	Several and various. See the log.
 
[I386]	 Floating point fixes from Finland and OSF. Some problems still exist.
	Run paranoia and enquire at your own risk.



Organizational changes:
-------------- -------

A set of directories motorola, motorola/m88k, and motorola/m88100 were
created to hold sources which are dependent on the corresponding name 
but not particular to the luna. This change has been made in anticipation
of support for motorola MVME 188 and MVME 187 boards, in addition to future
motorola m88110 based products. It is left for someone truly ambitious to
create motorola/68k, motorola/68k/{68030,68040,68050}....

Special notes:
------- -----

On the sun3, vax, and i386, one now needs to set 
GCC_EXEC_PREFIX to /afs/cs/project/mach/mach3/latest/release/lib/gcc-
when compiling. This only used to be true for the sun3 and vax. All
three are now compiling with gcc 1.37.1 (and cmu cpp). 

On the luna, the kernel is now compiled with gcc 2.0 (and cmu modified
gcc-cpp). The savearg (which allows optimized compilation and recovery
of arguments passed in registers) requires patches to the compiler.
Contact danner@cs.cmu.edu for info.

For reasons of comptability with the mips roms, the "-a" boot flag has
been changed to "-q". If "-q" is specified, the kernel will query for
a directory in which to find the startup task and emulator.

Rpd reworked the makefiles and config.


Known Problems
--------------

Possible reference leak in the vm code. Seen one system deadlock where it
appeared that there was a gratuitous page reference on a vm_object.

[I386] Floating point on the i386 as mentioned above.



Build and Boot History
----------------------

[I386]	Built STD+WS, STD+SQT. Booted (with UX32:STDAFS+WS,
UX32:STDAFS+WS+cfs) on Bialetti (486) and Doright (386). Untested on
Boris (Sequent) as all the disks are scrambled.  Uptimes of over 1 day
have been observed. 

[VAX]	Built STD+VAX6bb. Booted on dbg (Microvax). Failed to boot on
R2D2 (Vax 8250). 

[SUN3]  Built STD+SWS. Booted on Rocky (sun 3/60).

[MIPS]  Built STD+ANY. Booted on 5000/120 (mc8, disco), a 3100 (unknown),
and 5000/200 (testarossa). Uptimes of over a day have been observed.

[LUNA88K] Built STD+ANY+HW_FOOTPRINT+assert+savearg+lineno. Booted
on halfmoon, crashed in default pager.

Ipc Test Compliance and Timing
------------------------------

All testable architectures passed the user collection (USER14) ipc_test.
Wall clock time is reported for three consective runs of

time ipc_test& > /dev/null

with UX32:STDAFS+WS.

[VAX]   dbg: 94, 95, 94 seconds
[MIPS]  disco: 7, 7, 7 seconds
[I386]  doright: 18, 18, 18 seconds
[SUN3]  rocky: 39, 39, 39 seconds

Default pager sizes
-------------------

Wired resident set of the default pager, as reported by ms -dp. All
configurations are with a single paging file on an unstressed system. 

[VAX]   dbg: 196K
[MIPS]  disco: 256K
[I386]  doright: 232K
[SUN3]  rocky: 208K



******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
70
[ ./kernel/luna88k/cmmu.c ]
Removed.
[ ./kernel/luna88k/cpu.h ]
Removed.
[ ./kernel/luna88k/pcb.c ]
Removed.
[ ./kernel/luna88k/psl.h ]
Removed.
[ ./kernel/luna88k/reg.h ]
Removed.
[ ./kernel/luna88k/trap.h ]
Removed.
[ ./Directories/ALL ]
Added motorola directories.
[92/01/22            danner]
[ ./Directories/luna88k ]
Added motolora directories.
[92/01/22            danner]
[ ./bootstrap/Makefile ]
Added pickup of libgcc.a for luna.
[92/01/22  18:16:32  danner]
[ ./bootstrap/luna88k/exec.c ]
Moved out of kernel.
[92/01/17            danner]
[ ./bootstrap/luna88k/exec.h ]
Moved out of kernel.
[92/01/17            danner]
[ ./include/Makefile ]
Added export of motorola/m88k/m88100/thread_status.h
[92/01/22  18:18:25  danner]
[ ./kernel/conf/MASTER ]
Corrected pseudo-device cpus for luna. There was a space instead of a tab,
and config cares.
[92/01/22  18:40:16  danner]
[ ./kernel/conf/MASTER.luna88k ]
Added assembler rules.
[92/02/02            danner]
 
Added saveargs option to support argument recovery.
Added -moptimize-arg-area in non save args case.
[92/01/22            danner]

Updated with LIBS, <lineno> support.
[92/01/19            danner]
[ ./kernel/conf/Makefile.luna88k ]
lineno support.
General cleanup.
[92/01/19            danner]
[ ./kernel/conf/files.luna88k ]
Made cmmu.c luna-independent.
[92/02/06            danner]

Added continuation, exception return.
[92/02/02            danner]
[ ./kernel/ddb/../luna88k/db_sstep.c ]
Updated next_instr_address to take a task argument.
[92/02/14            danner]
Changed type of frame.
[92/01/22  18:50:47  danner]
[ ./kernel/kern/bootstrap.c ]
Added global load_fault_in_text to force the faulting in of the
 bootstrap task text. Useful for debugging.
[92/02/14            danner]
[ ./kernel/kern/debug.c ]
Merged up.
[92/01/22  18:44:39  danner]
[ ./kernel/kern/timer.c ]
Merged up.
[92/01/22  18:45:01  danner]
[ ./kernel/luna88k/asm.h ]
Typo correction (from Torbjorn Granlund <tege@sics.se>).
[92/02/06            danner]

moved RTE definition here
[92/02/02            danner]
[ ./kernel/luna88k/autoconf.c ]
Include updates.
[92/01/20            danner]
[ ./kernel/luna88k/clock.c ]
Since sprintf disappeared, just special case it.
[92/01/19            danner]
[ ./kernel/luna88k/cpu_number.h ]
Updated copyirght, changed to include motorola/m88k/cpu_number.h
[92/01/22  18:49:05  danner]
[ ./kernel/luna88k/db_disasm.c ]
Updated to handle task arguments.
[92/02/14            danner]
Merged up.
[92/01/22  18:49:51  danner]
[ ./kernel/luna88k/db_interface.c ]
Upgraded to db_task_trap.
[92/02/14            danner]

New functions to support updated ddb.
[92/02/12            danner]

Made db_read_bytes, db_write_bytes multi address space capable.
[92/02/10            danner]
Decreased maximum wait by factor of 8.
[92/02/02            danner]
Include changes.
[92/01/20            danner]
[ ./kernel/luna88k/db_machdep.h ]
Changed BKPT_INST, ENTRY_ASM to be trap 144, which is excutable
 from user space.
[92/02/13            danner]

Several new macros to support new ddb.
[92/02/12            danner]
Updated include of trap.h
[92/01/30            danner]
Moved redefinitions of _longjmp and _setjmp under 2.5
 conditionals.
[92/01/19            danner]
[ ./kernel/luna88k/db_trace.c ]
Additional bug fixes.
[92/01/27            danner]

Modified exception frame identifing code to take advantage of the
 duplicate frame pointer generated in locore. Had sign backwards
      in store double test in argument recovery code.
[92/01/23            danner]
Added code to recover arguments that are saved on the stack.
[92/01/22            danner]
[ ./kernel/luna88k/exec.c ]
Merged up.
[92/01/22  18:51:51  danner]
[ ./kernel/luna88k/exvec.h ]
Created.
[92/01/22            danner]
[ ./kernel/luna88k/genassym.c ]
Added DISP_MIN to correspond to disp_min field added in the
 emulation vector definition introducted in MK68.
[92/01/17            danner]
[ ./kernel/luna88k/locore/eh.c ]
Removed mach syscall handler. Removed user_{entry,trace,break}
 traps. Renumbered entry,trace, and break traps.
[92/02/13            danner]

Under mach_kdb conditionals dump the pointer to the exception
 twice so the debugger can recognize it.
[92/01/23            danner]
Updated to deal with variable emulation vector base (minimum)
 introduced in MK68.
[92/01/17            danner]
[ ./kernel/luna88k/locore/exception_vectors.h ]
Moved entry, trace, break (kdb traps) to vectors 130-132. Removed
 user_{entry,trace,break) traps. Changed trap 129 to call
 syscall_handler instead of mach_syscall_handler.
[92/02/13            danner]
Merged up.
[92/01/22  18:47:26  danner]
[ ./kernel/luna88k/locore/locore.c ]
br should have been br.n. Pointed out by Dan Malek of HRI.
[92/02/10            danner]

Removed release_other_cpus. Moved call_rom_abort. Removed
      thread_bootstrap_return.
[92/01/30            danner]

Updated includes.
[92/01/30            danner]
Removed esym calculation.
[92/01/19            danner]

Removed esym definition, as it is obsoleted by the
 move_bootstrap.
[92/01/19            danner]
[ ./kernel/luna88k/locore/locore.h ]
Removed the stack frame allocation in the CALL macro.
[92/01/27            danner]
[ ./kernel/luna88k/locore/locore_asm_routines.c ]
Fixed bugs in enable/disable interrupt routines.
[92/02/01            danner]

moved call_rom_abort here.
[92/01/30            danner]

Updated includes.
[92/01/30            danner]
setjmp -> _setjmp
longjmp -> _longjmp.
[92/01/19            danner]

Added simple_lock_pause. Added lockpause counters to go with it.
 Made lockinit, lockuse, and lockpause reside in the data
 segment. Changed there definitions to depend on NCPUS, instead
 of implicitly assuming 4.
[92/01/19            danner]

Add memcpy definition for gcc 2.
[92/01/19            danner]
[ ./kernel/luna88k/locore/locore_c_routines.c ]
Updated includes.
[92/01/30            danner]
[ ./kernel/luna88k/luna_fp.c ]
Changed include of trap.h.
[92/01/30            danner]
Removed include of luna88k/m88k.h
[92/01/20            danner]
[ ./kernel/luna88k/luna_init.c ]
Fixed type of end, conditionalized db_pallete configuration on
 diptest.
[92/02/11            danner]
Changed types of edata and end to char. Without this, only 1/4
 of the bss gets zeroed.
[92/01/28            danner]

Made first_addr and last_addr initialized so they will not be in
 the BSS. They are refered to before move bootstrap
[92/01/28            danner]
luna88k/cpu.h -> luna88k/cpu_number.h
[92/01/21            danner]

Removed include of luna88k/m88k.h
[92/01/20            danner]

Adapted to use move_bootstrap.
[92/01/19            danner]
[ ./kernel/luna88k/machdep.c ]
Longjmp_int_enable in load_context should have THREAD_NULL as its
 second argument in the stack handoff world.
[92/02/02            danner]
Changed include of trap.h
[92/01/30            danner]
luna88k/cpu.h -> luna88k/cpu_number.h
[92/01/21            danner]

Updated includes.
[92/01/20            danner]
[ ./kernel/luna88k/machine_thread.c ]
Delete stack_{attach,detach}, thread_exception_return,
 thread_syscall_return.
[92/02/11            danner]
[ ./kernel/luna88k/pmap.c ]
Moved all the M88K_* defines in here. 
Updated includes.
Merged up.
[92/01/22  18:53:13  danner]
[ ./kernel/luna88k/pmap.h ]
Added CACHE_INHIBIT definition, removed the M88K_* defines.
Removed segmap definition. 
Merged up.

Commented out broken assert 
[92/01/12            danner]
[ ./kernel/luna88k/scb.h ]
Updated copyright, removed lots of junk.
[92/01/22            danner]
[ ./kernel/luna88k/softint.c ]
luna88k/cpu.h -> luna88k/cpu_number.h
[92/01/21            danner]
[ ./kernel/luna88k/thread.h ]
Merged up, modified includes.
[92/01/22  18:55:53  danner]
[ ./kernel/luna88k/trap.c ]
Added code for ddb traps from userspace.
[92/02/18            danner]
Updated include of trap.h
[92/01/30            danner]
updated includes.
[92/01/20            danner]
[ ./kernel/luna88kdev/cons.c ]
Merged up.
[92/01/22  19:07:32  danner]
[ ./kernel/luna88kdev/kbmain.c ]
Made include of sys/types.h unconditional
[92/01/21            danner]
[ ./kernel/luna88kdev/msmain.c ]
Made include of sys/types.h unconditional.
[92/01/21            danner]
[ ./kernel/luna88kdev/uart.c ]
Includes fixup.
[92/01/20            danner]
[ ./kernel/mach/luna88k/thread_status.h ]
Include m88100 thread status definitions.
[92/01/20            danner]
[ ./kernel/motorola/m88k/cpu_number.h ]
Created.
[92/01/21            danner]
[ ./kernel/motorola/m88k/cpus.h ]
Created.
[92/01/22  19:04:05  danner]
[ ./kernel/motorola/m88k/endian.c ]
Created.
[92/01/20            danner]
[ ./kernel/motorola/m88k/m88100/cmmu.c ]
Updated includes.
[92/02/18  16:37:40  danner]

Created for luna machine depedent source.
[92/02/06            danner]
[ ./kernel/motorola/m88k/m88100/continuation.s ]
Created. 
[92/02/01            danner]
[ ./kernel/motorola/m88k/m88100/exception_return.s ]
Created. 
[92/02/01            danner]
[ ./kernel/motorola/m88k/m88100/exvec.h ]
Created. 
[92/01/22  19:01:26  danner]
[ ./kernel/motorola/m88k/m88100/lotrap.s ]
Created. 
[92/02/01            danner]
[ ./kernel/motorola/m88k/m88100/m88100.h ]
[92/01/22  19:01:48  danner]
[ ./kernel/motorola/m88k/m88100/m882xx.h ]
Created. 
[92/01/22  19:02:13  danner]
[ ./kernel/motorola/m88k/m88100/pcb.c ]
Added include of mach_kdb.h
[92/02/06            danner]

Added calls to actually set up the cmmu in switch_context and
 stack handoff.
[92/02/06            danner]

Added stack_attach,stack_detach, stack_handoff, switch_context.
[92/02/01            danner]
Removed thread_start (MI under continuation model).
[92/01/30            danner]
Added set_user_regs, user_stack_low to support out of kernel
 bootstrap task.
[92/01/20            danner]
[ ./kernel/motorola/m88k/m88100/pcb.h ]
Disabled KEEP_STACKS.
[92/01/30            danner]
Created.
[92/01/20            danner]
[ ./kernel/motorola/m88k/m88100/psl.h ]
Moved from luna88k
[92/01/20            danner]
[ ./kernel/motorola/m88k/m88100/thread_status.h ]
created.
[92/01/20            danner]
[ ./kernel/motorola/m88k/trap.h ]
Liberated.
[92/01/30            danner]
[ ./kernel/src/makeboot/luna88k/exec.c ]
Correctly handle symbol offset table size in 407 case.
413 support.
[92/01/21            danner]

Created.
[92/01/17            danner]
[ ./user/libmach/luna88k/_setjmp.cs ]
Comment format changed.
[92/02/18  16:39:09  danner]
[ ./user/libmach/luna88k/bcopy.c ]
Removed misconcieved dependence of memcpy.
[92/01/17            danner]
[ ./user/libmach/luna88k/bzero.c ]
Changed.
	
[92/02/18  16:39:56  danner]
[ ./user/libmach/luna88k/crt0.ss ]
Corrected bug in getting argv in start.
[92/01/29            danner]

Corrected serious typo.
[92/01/20            danner]
[ ./user/libmach/luna88k/gcc.c ]
Created.
[92/01/17            danner]
[ ./user/threads/luna88k/thread.c ]
Updated to reflect thread structure.
[92/02/18  16:41:00  danner]
[ ./kernel/Makefile ]
Luna default should STD+ANY+HW_FOOTPRINT; set to be
that +lineno+savearg+assert as we are currently just building
 debugging kernels.
[92/02/18            danner]
[ ./include/Makefile ]
Fixed type in a level 3 rule.
[92/02/18            danner]
[ ./user/libmach/luna88k/fork.ss ]
Created
[92/02/19            danner]
[ ./user/libmach/Makefile ]
Added SA_LUNA88K_OBJS. Updated Copyright.
[92/02/19            danner]
[ ./kernel/kern/debug.c ]
Added cpu number print, locking to print in Assert for
 multiprocessor case.
[92/01/12            danner]
[ ./bootstrap/luna88k/exec.c ]
Moved out of kernel.
[92/01/17            danner]
[ ./bootstrap/luna88k/exec.h ]
Moved out of kernel.
[92/01/17            danner]
[ ./kernel/conf/MASTER ]
Corrected pseudo-device cpus for luna. 
There was a space instead of a tab,
and config cares.
[92/01/22  18:40:16  danner]
[ ./kernel/conf/files.luna88k ]
Added motorola directory files.
[92/01/22  18:42:09  danner]
[ ./kernel/conf/files.luna88k ]
Added motorola directory files.
[92/01/22  18:42:09  danner]

Made cmmu.c luna-independent.
[92/02/06            danner]

Added continuation, exception return.
[92/02/02            danner]
[ ./kernel/kern/timer.c ]
Add include of <kern/assert.h>. Under MACH_ASSERT conditionals,
 make the loop in timer_grab fail assertion fail if it loops more
 than 10000 times.
[92/01/15            danner]
Added version to timer grab that can be called by the kernel debugger.
Will work even if the time is not normalized.
[91/09/19  13:47:32  danner]
[ ./kernel/luna88k/db_disasm.c ]
Added the control register names to the crtlregs table.
[91/09/18            danner]
[ ./kernel/luna88k/db_trace.c ]
Additional bug fixes.
[92/01/27            danner]

Modified exception frame identifing code to take advantage of the
 duplicate frame pointer generated in locore. Had sign backwards
      in store double test in argument recovery code.
[92/01/23            danner]
Added code to recover arguments that are saved on the stack.
[92/01/22            danner]
Db_stack_trace_cmd now happily walks over multiple exception
 frames on a stack. It will also attempt to find the user
 exception frame, which no longer resides on the stack.
[91/09/05            danner]
[ ./kernel/luna88k/exec.c ]
Add support for data segment rounding.
[91/09/07            danner]
[ ./kernel/luna88k/machdep.c ]
Longjmp_int_enable in load_context should have THREAD_NULL as its
 second argument in the stack handoff world.
[92/02/02            danner]
Changed include of trap.h
[92/01/30            danner]
luna88k/cpu.h -> luna88k/cpu_number.h
[92/01/21            danner]
Updated includes.
[92/01/20            danner]
Fix problem related to the wrong value in the softcall cause register.
[91/09/19  13:49:10  danner]
[ ./kernel/luna88k/pmap.c ]
Moved all the M88K_* defines in here. 
Updated includes.
Merged up.
[92/01/22  18:53:13  danner]
XPR's for shootdown debugging.
[91/09/19  13:50:15  danner]
[ ./kernel/luna88k/thread.h ]
Made all fields unsigned - got bitten in the debugger.
[91/08/27            danner]
[ ./kernel/luna88k/trap.c ]
Added code for ddb traps from userspace.
[92/02/18            danner]
Updated include of trap.h
[92/01/30            danner]
updated includes.
[92/01/20            danner]
Removed T_ASTFLT case from trap, as ast_taken() is called
 directly from assembly in 3.0 instead.
[91/11/03            danner]
Support for user level ddb traps. 
[91/09/19  13:51:09  danner]
[ ./kernel/luna88k/locore/eh.c ]
Removed mach syscall handler. Removed user_{entry,trace,break}
 traps. Renumbered entry,trace, and break traps.
[92/02/13            danner]

Under mach_kdb conditionals dump the pointer to the exception
 twice so the debugger can recognize it.
[92/01/23            danner]
Updated to deal with variable emulation vector base (minimum)
 introduced in MK68.
[92/01/17            danner]
Modifed ast call from syscall native return to go to splhigh,
 turn interrrupts on, then call ast (instead of just disabling
 interrupts). 
[91/11/07            danner]

Updated to use the 3.0 ast technology, ast_taken instead of
 calling trap(T_ASTFLT)
[91/11/03            danner]
Corrected return from exception handler to work in the case of
 user mode return (preservation of the stack pointer).

     Corrected stack pickup from user mode.
[91/09/05            danner]
[ ./kernel/luna88k/locore/exception_vectors.h ]
Moved entry, trace, break (kdb traps) to vectors 130-132. Removed
 user_{entry,trace,break) traps. Changed trap 129 to call
 syscall_handler instead of mach_syscall_handler.
[92/02/13            danner]
Merged up.
[92/01/22  18:47:26  danner]
Added user_kdb_{break,trace,entry} traps.
[91/09/15            danner]
[ ./kernel/luna88k/locore/locore.c ]
br should have been br.n. Pointed out by Dan Malek of HRI.
[92/02/10            danner]

Removed release_other_cpus. Moved call_rom_abort. Removed
      thread_bootstrap_return.
[92/01/30            danner]

Updated includes.
[92/01/30            danner]
Removed esym calculation.
[92/01/19            danner]

Removed esym definition, as it is obsoleted by the
 move_bootstrap.
[92/01/19            danner]
The interrupt_stack for the master processor was not getting set;
 it needs to be set to _intstack once the master knows its cpu
 number.

Fixed problem with master processor interrupt stack.
[91/11/04            danner]
Changed thread_bootstrap to return to
 return_from_exception_handler instead of check_ast. 
      No longer sets need_ast[cpu#] = 1.
[91/09/05            danner]
[ ./kernel/luna88kdev/cons.c ]
Added hack to allow a keyboard character to cause a debugger
 entry. Set the integer ddb_trap_char to the ascii code of the
 character. This character will never make it past the debugger.
[91/09/17            danner]
[ ./kernel/luna88kdev/uart.c ]
Includes fixup.
[92/01/20            danner]
Added ddb trap via the funky two over from the BS key (right next
 to the DEL) key.
[91/09/17            danner]
[ ./kernel/mach/luna88k/thread_status.h ]
Include m88100 thread status definitions.
[92/01/20            danner]
[ ./user/threads/luna88k/thread.c ]
Updated to reflect thread structure.
[92/02/18  16:41:00  danner]
Updated setregs to reflect new thread structure.
[91/09/19  16:58:25  danner]

Updated for new thread structure.
[91/08/25  16:39:33  danner]
[ ./user/libmach/luna88k/bzero.c ]
Fixed subtract length twice bug.
[91/09/20            danner]
Changes.
[91/09/19  13:51:51  danner]
[ ./user/libmach/luna88k/_setjmp.cs ]
Comment format changed.
[92/02/18  16:39:09  danner]
An unbalanced comment was eating most of _setjmp.
[91/11/03            danner]
[ ./Makefile-common ]
make LIBCS evaluate to libcmucs.a instead of libcs.a. Ditto with
 DEPCS
[92/02/19            danner]

Updated .cs.o and .ss.o rules to create an intermediate xXx.c
 file to run through cpp; some cpp's (namely gcc derived cpp's)
 will not process files with random suffixes.
[92/02/19            danner]
[ ./bootstrap/boot_printf.c ]
Removed.
[ ./bootstrap/mips/syms.h ]
Removed.
[ ./bootstrap/mips/coff.h ]
Removed.
[ ./bootstrap/sun3/exec.h ]
Removed.
[ ./bootstrap/vax/exec.h ]
Removed.
[ ./bootstrap/i386/exec.h ]
Removed.
[ ./kernel/src/makeboot/mips/syms.h ]
Removed.
[ ./kernel/src/makeboot/mips/coff.h ]
Removed.
[ ./Makefile ]
Added Makefile-subdirs and Makefile-mkdirs.
[92/02/10            rpd]
[ ./Makefile-common ]
Added LIBREADLINE, DEPREADLINE, EXIT_RULE.
[92/02/16            rpd]

Moved recursive make stuff to Makefile-subdirs.
Moved mkodirs, mkidirs, mkrdirs rules to Makefile-mkdirs.
Moved mkilinks, mkrlinks rules to Makefile-mklinks.
Moved xstrip definitions to Makefile-xstrip.
Turned off debugging symbols on the pmax.
[92/02/10            rpd]
[ ./bootstrap/Makefile ]
Replaced *.internal stuff with Makefile-version.
Moved printf to libmach_sa.
[92/02/10            rpd]
[ ./bootstrap/bootstrap.c ]
Changed gets to safe_gets.
Added printf_init, panic_init calls.
[92/02/11            rpd]
[ ./bootstrap/def_pager_setup.c ]
Changed gets to safe_gets.
[92/02/11            rpd]
[ ./include/Makefile ]
Changed source location of */exec.h files, from bootstrap to kernel.
Added {mac2,i860,luna88k}/exec.h.
[92/02/19            rpd]
Added Makefile-mkdirs and Makefile-mklinks.
Added sys/varargs.h.
[92/02/10            rpd]
[ ./kernel/Makefile ]
Changed to use Makefile-common, Makefile-xstrip, Makefile-subdirs,
Makefile-version, and Makefile-config.
[92/02/16            rpd]
[ ./kernel/conf/MASTER ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/MASTER.i386 ]
Simplified, condensed history.
[92/02/13            rpd]
[ ./kernel/conf/MASTER.i860 ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/MASTER.luna88k ]
Simplified, condensed history.
[92/02/17            rpd]

Condensed history:
Added saveargs option to support argument recovery.
Added -moptimize-arg-area in non save args case.
[ ./kernel/conf/MASTER.mac2 ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/MASTER.mips ]
Simplified, condensed history.
[92/02/19  11:29:04  rpd]
[ ./kernel/conf/MASTER.sun3 ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/MASTER.vax ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/Makefile.i386 ]
Simplified, condensed history.
[92/02/13            rpd]
[ ./kernel/conf/Makefile.i860 ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/Makefile.luna88k ]
Simplified, condensed history.
[92/02/17            rpd]

Condensed history:
[ ./kernel/conf/Makefile.mac2 ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/Makefile.mips ]
Simplified, condensed history.
[92/02/13            rpd]
[ ./kernel/conf/Makefile.sun3 ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/Makefile.template ]
Simplified - no more *_RULE_[1234] stuff.
Condensed history.
[92/02/12            rpd]
[ ./kernel/conf/Makefile.vax ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/files ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/files.i386 ]
Simplified, condensed history.
[92/02/13            rpd]
[ ./kernel/conf/files.i860 ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/files.luna88k ]
Simplified, condensed history.

Condensed history:
[92/02/19  11:30:54  rpd]
[ ./kernel/conf/files.mac2 ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/files.sun3 ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/conf/files.vax ]
Simplified, condensed history.
[92/02/17            rpd]
[ ./kernel/ddb/db_input.c ]
Added delete_line (Ctrl-U).
[92/02/17            kivinen]

Added command line history. Ctrl-P = previous, Ctrl-N = next. If
DB_HISTORY_SIZE is 0 then command history is disabled.
[92/02/17            kivinen]
[ ./kernel/ddb/db_print.c ]
Added db_thread_fp_used, to avoid machine-dependent conditionals.
[92/02/19            rpd]

Added 'F' flag to db_thread_stat showing if the thread has a valid
FPU context. Tested on i386 and pmax.
[92/02/17            kivinen]
[ ./kernel/i386/asm.h ]
Changed #if __STDC__ to #ifdef __STDC__
[92/01/16            jvh]
[ ./kernel/i386/db_machdep.h ]
Added db_thread_fp_used.
[92/02/19            rpd]
[ ./kernel/i386/fpu.c ]
Make sure the current thread's floating instruction has completed
before freeing its fpu context and before context switching the FPU.

Remember which thread the FPU AST was meant for and delay sending
exception if a context switch has occurred between the interrupt and
the AST handling. This can happen if an fpu interrupt arrives after 
FPU ASTs have been checked for but before thread_block.

Mark pending exception for thread in fp_valid (= 2) in fpexterrflt or
fp_intr if the thread that caused the exception is not running and
send the exception when the thread next runs. (I'm not really sure 
this is necessary).

Check fp_thread for THREAD_NULL in fp_free and fp_intr before
accessing its PCB.

Don't save FPU context in fpexterrflt. It is already saved in 
fp_intr. 
[92/02/01            jvh]
[ ./kernel/i386/fpu.h ]
Added fwait()
[92/01/19            jvh]
[ ./kernel/i386at/autoconf.c ]
Made take_dev_irq() print device name instead of XYZ in case of
failure.
[92/01/20            kivinen]

Added more possible configurations for ns8390driver to be able to
use two wd cards simultaneously.
[92/01/20            kivinen]
[ ./kernel/i386at/com.c ]
Made comprobe more selective. Try to recognize chip.
[92/01/20            kivinen]
[ ./kernel/i386at/if_ns8390.c ]
Made wd driver work with 16 bit cards. Better recognize different
cards. Print card name when probing. Tested on wd8003, wd8013EP,
wd8003EP.
Add IFWD_ prefix to defines.
[92/01/20            kivinen]
[ ./kernel/i386at/if_wd8003.h ]
Made names consistent with wd example driver. Add those missing.
Add IFWD_ prefix to defines.
[92/01/20            kivinen]
[ ./kernel/mach/machine.h ]
Added more Sparc subtypes.
[92/02/19            rpd]
[ ./kernel/mips/PMAX/kmin_cpu.s ]
Changed #-style comments, for ANSI cpp.
[92/02/19  13:11:34  rpd]
[ ./kernel/mips/context.s ]
Changed #-style comments, for ANSI cpp.
[92/02/19  13:10:55  rpd]
[ ./kernel/mips/db_machdep.h ]
Added db_thread_fp_used.
[92/02/19            rpd]
[ ./kernel/mips/locore.s ]
Changed #-style comments, for ANSI cpp.
[92/02/19  13:11:00  rpd]
[ ./kernel/mips/mips_cache.s ]
Changed #-style comments, for ANSI cpp.
[92/02/19  13:11:12  rpd]
[ ./kernel/mips/mips_copyin.s ]
Changed #-style comments, for ANSI cpp.
[92/02/19  13:11:16  rpd]
[ ./kernel/mips/mips_cpu.s ]
Changed #-style comments, for ANSI cpp.
[92/02/19  13:11:19  rpd]
[ ./kernel/mips/prom_interface.s ]
Changed #-style comments, for ANSI cpp.
[92/02/19  13:11:25  rpd]
[ ./kernel/mips/start.s ]
Changed #-style comments, for ANSI cpp.
[92/02/19  13:11:27  rpd]
[ ./kernel/mips/syms.h ]
Fixed copyright.
Removed RCS Header line.
[92/02/19            rpd]
[ ./kernel/mips/tlb.s ]
Changed #-style comments, for ANSI cpp.
[92/02/19  13:11:31  rpd]
[ ./kernel/src/config/mkmakefile.c ]
Vastly simplified do_rules.
It is machine-independent now.
[92/02/12            rpd]
[ ./kernel/sun3/cswtch.s ]
Removed insque, remque.
[92/02/17            rpd]
[ ./kernel/vm/vm_map.c ]
Picked up dlb fix for vm_map_copyin_page_list,
for when vm_fault_page returns memory-error.
[92/02/14            rpd]
[ ./kernel/vm/vm_object.c ]
Fixed vm_object_collapse to unlock the object before calling
ipc_port_dealloc_kernel (which might allocate memory).
[92/02/16            rpd]

Picked up dlb fix for vm_object_copy_slowly,
for when vm_fault_page is interrupted.
[92/02/14            rpd]
[ ./user/libmach/Makefile ]
Added mach_error_string.o, htg_vm_map.o, panic.o,
doprnt.o, printf.o, sprintf.o, get_privileged_ports.o.
[92/02/11            rpd]
[ ./user/libmach/i386/SYS.h ]
Add __STDC__ conditonal.
[92/02/07            jvh]
[ ./user/libmach/i386/fork.cs ]
Fixes for compilation with ANSI cpp.
[92/02/19            jvh]
[ ./user/libmach/mach_error.c ]
Moved mach_error_string and mach_error_type to mach_error_string.c.
[92/02/11            rpd]
[ ./user/libmach/printf.c ]
Created.
[92/02/11            rpd]
[ ./user/libmach/slot_name.c ]
Synced with mach/machine.h 2.14.
[92/02/19            rpd]
[ ./user/libmach/strings.h ]
Change strlen return type from int to unsigned long to keep gcc2
silent.
[92/02/19            jvh]
[ ./kernel/vm/vm_map.c ]
Picked up dlb fix for vm_map_copyin_page_list,
to make the continuation args correctly.
[92/02/19            rpd]
[ ./user/libmach/i386/memcpy.s ]
Created.
[ ./kernel/kern/ipc_mig.c ]
Added syscall_thread_depress_abort.
[92/01/20            rwd]
[ ./kernel/kern/sched_prim.c ]
Added argument to compute_priority.  We dont always want to do
a reschedule right away.
[92/01/19            rwd]
[ ./kernel/kern/syscall_subr.c ]
Change calls to compute_priority.
[92/01/19            rwd]
Changed thread_depress_priority to not schedule a timeout when
time is 0.
[92/01/10            rwd]
[ ./kernel/kern/syscall_sw.c ]
Added syscall_thread_depress_abort.
[92/01/20            rwd]
[ ./kernel/kern/thread.c ]
Change calls to compute_priority.
[92/01/19            rwd]
[ ./kernel/mach/mach_host.defs ]
Reenable thread_depress_abort.
[92/01/20            rwd]
[ ./kernel/mach/syscall_sw.h ]
Removed STANDALONE conditionals.
[92/02/19            elf]

Added syscall_thread_depress_abort.
[92/01/20            rwd]
[ ./kernel/man/thread_switch.man ]
thread_restore_priority does not exist.
[92/01/20            rwd]
Fixed to reflect change in timeout parameter being zero
[92/01/10            rwd]
[ ./user/libmach/Makefile ]
Added thread_depress_abort.
Added i386/memcpy.s.
[92/02/19            elf]
[ ./user/libmach/i386/bcopy.c ]
Remove memcpy from here.
[92/02/14            rwd]
[ ./user/libmach/ms_thread_depress_abort.c ]
Created.
[92/01/20            rwd]
[ ./kernel/conf/MASTER.i386 ]
Add lpr and par devices.  (taken from 2.5)
[92/02/13            rvb]
[ ./kernel/i386/db_interface.c ]
MD debugger support.
[92/02/07            rvb]
[ ./kernel/i386/locore.s ]
Add some MD debugger support.
[92/02/07            rvb]
[ ./kernel/i386/setroot.c ]
Make atleast a half hearted attempt to use the info provide by
the bootstrap to choose the boot device.
[92/02/07            rvb]
[ ./kernel/i386at/autoconf.c ]
Re-order device probes -- disks first.
[92/02/18            rvb]
[ ./kernel/i386at/conf.c ]
Add lpr and par devices.  (taken from 2.5)
[92/02/13            rvb]
[ ./kernel/i386at/grab_bob_label.c ]
On 25-Jan, did not consider NO ACTIVE mach parition.
[92/01/31            rvb]

Add "BIOS" support -- always boot mach partition NOT active one.
[92/01/25            rvb]
[ ./kernel/i386at/hd.c ]
On 25-Jan, did not consider NO ACTIVE mach parition.
Add "BIOS" support -- always boot mach partition NOT active one.
[92/01/31            rvb]
[ ./kernel/i386at/if_par.c ]
	On output side, skip ether header -- they are not put on the wire.
And some cleanup
[92/02/19            rvb]
Add lpr and par devices.  (taken from 2.5)
BEING DEBUGGED -- not operational
[92/02/13            rvb]
[ ./kernel/i386at/if_par.h ]
Add lpr and par devices.  (taken from 2.5)
[92/02/13            rvb]
[ ./kernel/i386at/kd.c ]
Fix up exit from the debugger, iff you had once started X but are
not currently in X.  The console used to be reinitialized to
"graphics" mode.
[92/02/07            rvb]

On the T2200, an interrupt gets posted against the keyboard,
while you are sucking out the mouse "ack" data in polled mode.
So you see an interrupt and the old kdintr() would wait for
data to arrive.
Fix keyboard mouse to automatically toggle up a down mouse button
if you push a different button down.  Also change acceleration 
along diagonal keys to 2 x.
[92/01/30            rvb]
[ ./kernel/i386at/kd_mouse.c ]
On ps2_mouse_close, wait a bit and then drain console.  For
T2200 and sometime the IBM axion bus extender, data will show
up after a while (a 0) w/o interrupt and your kbd would hang.
[92/01/30            rvb]

Allow for only "keyboard mouse".  Does not use serial line.
[92/01/25            rvb]
[ ./kernel/i386at/lpr.c ]
Add lpr and par devices.  (taken from 2.5)
NOT DEBUGGED
[92/02/13            rvb]
[ ./kernel/i386at/lprreg.h ]
Add lpr and par devices.  (taken from 2.5)
[92/02/13            rvb]
[ ./user/libmach/i386/fork.cs ]
Cloned from the tahoe vax/fork.s; added call to mach_init
on child.
[92/02/19            rvb]
[ ./kernel/i386at/if_par.c ]
On output side, skip ether header -- they are not put on the wire.
And some cleanup
[92/02/19            rvb]
Add lpr and par devices.  (taken from 2.5)
BEING DEBUGGED -- not operational
[92/02/13            rvb]
[ ./bootstrap/bootstrap.c ]
Changed '-a' switch into '-q'.
[92/02/10  17:53:27  af]
[ ./bootstrap/default_pager.c ]
Two mods: changed bitmap ops to work one int at a time rather
than one byte at a time.  This helps under load, e.g. when the
paging file is large and busy. Second mod to use port-to-pointer
casting in lookups, rather than hash+list searching.  This not
only helps under load (I see >600 objects on my pmax) but also
increases parallelism a little.
Shrunk the code size by one page in the process.
[92/02/14  01:44:23  af]
[ ./kernel/chips/cfb_hdw.c ]
Reflected changes in tc_enable_interrupt().
[92/02/10  17:13:38  af]
[ ./kernel/chips/dz_hdw.c ]
Typo.
[92/02/10  17:10:52  af]
[ ./kernel/chips/fb_hdw.c ]
Reflected changes in tc_enable_interrupt().
[92/02/10  17:13:09  af]
[ ./kernel/chips/lk201.c ]
Added keycodes for lk401.
[92/01/31            af]
[ ./kernel/chips/lk201.h ]
Added some defs for lk401 keyboard.
[92/01/31            af]
[ ./kernel/chips/mc_clock.c ]
Wait for uip before stopping the chip, too.
[92/01/22            af]
[ ./kernel/chips/mouse.c ]
Removed kmin hack.
[92/02/10  17:16:53  af]
[ ./kernel/chips/scc_8530.h ]
Revised, based on Intel documentation for the 82530:
"Microcommunications Handbook", Vol 1-2, 1990.
[92/01/22            af]
[ ./kernel/chips/scc_8530_hdw.c ]
Uhmm, lotsa changes.  Basically, got channel B working
and made it possible to use it as rconsole line.
Missing modem bitsies only.
A joint Terri&Sandro feature presentation.
[92/02/10  17:03:08  af]
[ ./kernel/chips/screen.c ]
Turn on screen if output.
[92/02/10  17:06:15  af]
[ ./kernel/chips/serial_console.c ]
Bury rconsole-finding code down in machdep land.
[92/02/10  17:09:35  af]
[ ./kernel/ddb/db_break.c ]
Removed one of the many user-unfriendlinesses.
[92/02/10  17:48:25  af]
[ ./kernel/kern/bootstrap.c ]
Change -a switch into -q switch.
Do not load the default-pager's symtable by default,
it gets in the way of debugging UX.
[92/02/10  17:50:23  af]
[ ./kernel/mips/PMAX/tc.c ]
Additions for Maxine.  ANSI-C mods.  Define more slots.
[92/02/10  17:44:58  af]
[ ./kernel/mips/PMAX/tc.h ]
Separated notion of physical and logical TC slots.
Added ANSI C function prototypes.
[92/01/17            af]
[ ./kernel/mips/autoconf.c ]
Added Maxine.
[92/02/10  17:40:34  af]
[ ./kernel/mips/db_interface.c ]
Byteorder fix to read_bytes(), from Steve.Ackerman.
Removed ignorant mod that played with the restart address.
If you do not know what they do, pls leave things as they are.
[92/01/29            af]
[ ./kernel/mips/db_machdep.h ]
Fixed bogus address check macro.
[92/02/10  17:30:20  af]
[ ./kernel/mips/mips_box.h ]
Added Maxine.
[92/02/10  17:39:28  af]
[ ./kernel/mips/parse_args.c ]
Changed default init switches to go multiuser.
Removed SCC.
[92/01/30            af]
[ ./kernel/mips/swapgeneric.c ]
Forward 'askme' switch on to MI layer.
[92/02/10  17:20:59  af]
[ ./bootstrap/luna88k/exec.h ]
Defunct.
[ ./Makefile-common ]
Added {LIB,DEP}CMUCS definitions.
[92/02/20            danner]

Added ${TARGET_MACHINE}_LIBS definition here. Comments about
 assembly rules.
[92/02/20            danner]
[ ./bootstrap/Makefile ]
Moved LUNA88K_LIBS definition to Makefile-common.
[92/02/20            danner]
[ ./kernel/src/config/Makefile ]
Changed LIBCS and DEPCS to LIBCMUCS and DEPCMUCS.
[92/02/20            elf]
[ ./kernel/vm/vm_resident.c ]
Added changes to pmap_startup() to leave the free physical
pages in ascending address order.
[92/02/20            elf]
[ ./Makefile-config ]
Created from kernel/Makefile.
[92/02/16            rpd]
[ ./Makefile-mkdirs ]
Created from Makefile-common.
[92/02/10            rpd]
[ ./Makefile-mklinks ]
Created from Makefile-common.
[92/02/10            rpd]
[ ./Makefile-subdirs ]
Changed the RECURSE_TEMPLATE rule to not ignore the return code
 of the recursive make. This required wrapping the wh invocation
 in a shell and feeding its output to wc.
[92/02/20            danner]

Changed RECURSE_TEMPLATE to print informative messages.
[92/02/16            rpd]

Created from Makefile-common.
[92/02/10            rpd]
[ ./Makefile-xstrip ]
Created from Makefile-common.
[92/02/10            rpd]
[ ./bootstrap/bootstrap.c ]
Fixed misleading comment.
[92/02/19  17:33:43  af]

Changed '-a' switch into '-q'.
[92/02/10  17:53:27  af]
[ ./bootstrap/def_pager_setup.c ]
Added add_paging_file and remove_paging_file.  Not sure this
was the best place, but here is where the previous code resided.
[92/02/19  17:32:56  af]
[ ./bootstrap/default_pager.c ]
Many changes. Now supports adding/removing paging files, it does
not immediately panic if a paging file fills up but relocates the
object elsewhere, it uses the precious attribute in data_supply
to reduce paging space usage (under USE_PRECIOUS conditional,
enabled).
[92/02/19  17:29:54  af]

Two mods: changed bitmap ops to work one int at a time rather
than one byte at a time.  This helps under load, e.g. when the
paging file is large and busy. Second mod to use port-to-pointer
casting in lookups, rather than hash+list searching.  This not
only helps under load (I see >600 objects on my pmax) but also
increases parallelism a little.
Shrunk the code size by one page in the process.
[92/02/14  01:44:23  af]
[ ./bootstrap/file_io.c ]
Added remove_file_direct().  Commented out some unused code.
[92/02/19  17:31:01  af]
[ ./bootstrap/file_io.h ]
Added defs for remove_file_direct(), exported.
[92/02/19  17:31:35  af]
[ ./bootstrap/mach/default_pager.defs ]
Added default_pager_paging_file().
[92/02/19  17:35:25  af]
[ ./bootstrap/mach/default_pager_types.defs ]
Added filename types.
[92/02/19  17:34:54  af]
[ ./bootstrap/mach/default_pager_types.h ]
Added filename types.
[92/02/19  17:34:33  af]
[ ./user/libmach/Makefile ]
Added default_pager_paging_file.
[92/02/19  17:37:12  af]
[ ./Makefile-common ]
.s, .cs rule dependency generation fixup.
[92/02/20            danner]
[ ./user/libmach/get_privileged_ports.c ]
Created.
[92/02/12            rpd]
[ ./user/libmach/sprintf.c ]
Created.
[92/02/11            rpd]
[ ./user/libmach/doprnt.c ]
Moved from bootstrap to libmach.
[92/02/11            rpd]
[ ./user/libmach/panic.c ]
Created from bootstrap's version.
[92/02/11            rpd]
[ ./user/libmach/mach_error_string.c ]
Created from mach_error.c.
[92/02/11            rpd]
[ ./kernel/ddb/db_print.c ]
Fixed typo.
[92/02/20            elf]
[ ./bootstrap/default_pager.c ]
Added renaming of request and name ports (from af).
[92/02/21            danner]
[ ./user/libmach/luna88k/crt0.ss ]
ixed envp computation bug (pointed out by davide@cs.cmu.edu).
[92/02/22            elf]
[ ./kernel/mach/message.h ]
Condensed history, update copyright.
[92/02/23            danner]

Added MACH_MSGH_BITS_MIGRATED (NORMA_IPC internal).
[91/12/25  16:42:44  jsb]
[ ./kernel/mips/PMAX/kn02.c ]
Updated copyright, added include that af forgot.
[92/02/23            danner]
[ ./kernel/mips/PMAX/kmin.c ]
Copyright update, removed af mouse debug code.
[92/02/23            danner]
[ ./kernel/mips/PMAX/model_dep.c ]
Copyright update. Added dec_check_rcline
[92/02/23            danner]
[ ./kernel/src/config/mkmakefile.c ]
Changed the rules for .s files to invoke ${ASCPP} instead of ${CPP}
 
[92/02/23            elf]
[ ./kernel/i386/user_ldt.c ]
Eliminate keep_wired argument from vm_map_copyin().
[92/02/23            danner]
[ ./Makefile-config ]
Changed default configuration for the luna.
[92/02/23            danner]
[ ./user/libmach/sbrk.c ]
Added luna88k goop.
[92/02/20            danner]
[ ./kernel/device/ds_routines.c ]
Change panic message to match previous change.
[92/02/21  10:11:55  dlb]

Use page lists for device reads going to default pager.
[92/02/20  15:16:19  dlb]

Temporary change to return data read from devices as a page
list instead of an entry list.  The keep_wired logic has
to be updated to convert the default pager to this mechanism
when making this change permanent.
[92/02/19  17:36:50  dlb]
[ ./kernel/device/dev_pager.c ]
Eliminate keep_wired argument from vm_map_copyin().
[92/02/23            danner]
[ ./kernel/kern/zalloc.c ]
Eliminate keep_wired argument from vm_map_copyin().
[92/02/21  10:13:57  dlb]
[ ./kernel/kern/syscall_emulation.c ]
Eliminate keep_wired argument from vm_map_copyin()
[92/02/23            danner]
[ ./kernel/vm/memory_object.c ]
Bug fix to avoid duplicate vm_map_copy_t deallocate in
error case of memory_object_data_supply.
[92/02/19  17:38:17  dlb]
[ ./kernel/vm/vm_fault.c ]
Check for both copy and shadow objects due to asymmetric
copy on write for temporary objects.
[92/02/19  14:13:33  dlb]

No more sharing maps.  Eliminated single_use argument
from vm_map_lookup() calls.
[92/01/07  11:03:34  dlb]
[ ./kernel/vm/vm_kern.c ]
kmem_io_map_deallocate() now calls pmap_remove() -- VM
code optimization makes this necessary.  Optimized
out kmem_alloc_pageable() call from kmem_io_map_copyout().
[92/01/07  16:37:38  dlb]
[ ./kernel/vm/vm_map.h ]
Change unused wiring_allowed field to wiring_required
in vm_map data structure.
[92/02/20  15:19:12  dlb]

Add is_shared bit to map entry to detect sharing.
[92/02/19  14:26:45  dlb]

Remove all sharing map structure elements.
Make vm_map_verify_done() a macro.
[92/01/07  11:14:16  dlb]
[ ./kernel/vm/vm_object.c ]
Remove dest_wired logic from vm_object_copy_slowly.
[92/02/21  10:16:35  dlb]

Maintain shadowed field in objects for use by new
VM_INHERIT_SHARE code (vm_map_fork).  Restore old
interface to vm_object_pmap_protect.
[92/02/19  14:28:12  dlb]

Use use_shared_copy instead of new copy strategy for
temporary objects.
[92/01/07  11:15:53  dlb]

Add asynchronous copy-on-write logic for temporary objects.
[92/01/06  16:24:59  dlb]
[ ./kernel/vm/vm_object.h ]
Add shadowed bit to vm_object structure.
[92/02/19  14:28:59  dlb]

Add use_shared_copy bit to vm_object.  Remove
new temporary object copy strategies.
[92/01/07  11:16:53  dlb]

Add definitions for temporary object copy strategies.
[92/01/06  16:26:07  dlb]
[ ./kernel/vm/vm_user.c ]
Eliminate keep_wired argument from vm_map_copyin().
[92/02/21  10:16:59  dlb]
[ ./kernel/vm/vm_map.c ]
Remove all keep_wired logic.  wiring_required logic in
vm_map_copyin_page_list is the replacement.
[92/02/21  10:15:26  dlb]

Change wiring_allowed to wiring_required.  Pay attention to
it in vm_map_copyout_page list.  This is only for the default
pager -- to make it fully general, vm_map_copyout has to
be modified as well - see XXX comment at bottom of routine.
[92/02/20  15:18:13  dlb]

Use object->shadowed and object->use_shared copy to
detect sharing instead of the reference count.
[92/02/19  17:39:10  dlb]

Use is_shared field in map entries to detect sharing.
Some minor bug fixes to the code that eliminates
sharing maps.
[92/02/19  14:25:30  dlb]

Use object->use_shared_copy instead of new copy strategy.
Removed all sharing map logic.  Rewrote comments to reflect this.
vm_map_verify_done is now a macro in vm_map.h as a result.

First cut (commented out) at vm_map_copy_overwrite optimization
to insert entries from copy into target, still needs work.

Removed (bogus) single_use argument from vm_map_lookup().

Pick up dbg bug fix to vm_map_copyout{,page_list} to allow
insertion of new region between two old ones that fit exactly.
[92/01/07  11:11:52  dlb]

Replace share map logic in vm_map_fork with asynchronous
copy-on-write.  Check for null object in vm_map_entry_delete.
[92/01/06  16:22:17  dlb]
[ ./kernel/vm/vm_debug.c ]
Eliminate keep_wired argument from vm_map_copyin().
[92/02/21  10:14:21  dlb]

No more sharing maps.
[92/01/07  11:02:46  dlb]
[ ./kernel/ipc/ipc_kmsg.c ]
Eliminate keep_wired argument from vm_map_copyin().
[92/02/21  10:12:26  dlb]
[ ./kernel/ipc/mach_debug.c ]
Eliminate keep_wired argument from vm_map_copyin().
[92/02/21  10:13:00  dlb]
[ ./kernel/ipc/mach_port.c ]
Eliminate keep_wired argument from vm_map_copyin().
[92/02/21  10:13:34  dlb]
[ ./bootstrap/def_pager_setup.c ]
Moved printouts elsewhere.
[92/02/23  13:17:52  af]

Reflected change in open_file_direct, to page on unstructured
devices.
[92/02/22  18:54:38  af]

Added add_paging_file and remove_paging_file.  Not sure this
was the best place, but here is where the previous code resided.
[92/02/19  17:32:56  af]
[ ./bootstrap/default_pager.c ]
Improved handling of big objects, fixed a deadlock in
object relocation, improved printouts.
Now only crash if out of memory, otherwise use the old
code that just marked the object as in-error.
[92/02/23  13:25:49  af]

As per jsb instructions, removed all NORMA conditionals.
Rename port names to odd values, a trivial heuristic that
makes name conflicts even more unlikely.
[92/02/22            af]

Refined the port name conflict problem.  Instead of renaming
ports that we send to, just set aside the memory that we cannot
use.  When objects get deleted put back the memory in the system.
[92/02/21            af]
[ ./bootstrap/file_io.c ]
Removed debugging printf.
[92/02/23  13:16:45  af]

Added variation of file_direct to page on raw devices.
[92/02/22  18:53:04  af]

Added remove_file_direct().  Commented out some unused code.
[92/02/19  17:31:01  af]
[ ./bootstrap/file_io.h ]
Added macros for raw (unstructured) devices.
[92/02/22  18:53:33  af]

Added defs for remove_file_direct(), exported.
[92/02/19  17:31:35  af]
[ ./kernel/device/device_types.h ]
Added mandatory DEV_GET_SIZE getstatus operation.
Must be implemented by all devices.
[92/02/22  19:59:27  af]
[ ./kernel/i386at/fd.c ]
Added (mandatory) DEV_GET_SIZE flavor of get_status.
[92/02/22            af]
[ ./kernel/i386at/grab_bob_label.c ]
Dropped first scsi_softc argument.
[92/02/22  19:58:21  af]
[ ./kernel/i386at/hd.c ]
Added (mandatory) DEV_GET_SIZE flavor of get_status.
[92/02/22            af]
[ ./kernel/i386ipsc/conf.c ]
Added getstat routine to md driver.
[92/02/22  19:56:40  af]
[ ./kernel/i386ipsc/md.c ]
Added md_get_status().
[92/02/22  19:56:15  af]
[ ./kernel/mac2dev/sdisk.c ]
Added DEV_GET_SIZE to get status routine.
[92/02/22  19:55:31  af]
[ ./kernel/scsi/adapters/README ]
Documented the changes in the MI<->HBA interface functions.
Basically, the first scsi_softc argument is gone.
[92/02/22  19:38:09  af]
[ ./kernel/scsi/adapters/scsi_33C93_hdw.c ]
Reflected changes in interface functions: probe_target,
go and restart-callup routines do not take a scsi_softc
descriptor any more.
[92/02/22  19:34:07  af]
[ ./kernel/scsi/adapters/scsi_5380_hdw.c ]
Reflected changes in interface functions: probe_target,
go and restart-callup routines do not take a scsi_softc
descriptor any more.
[92/02/22  19:34:35  af]
[ ./kernel/scsi/adapters/scsi_53C700_hdw.c ]
Created, from the NCR specs:
"NCR 53C700 SCSI I/O Processor Data Manual, Rev 2.5"
NCR Microelectronics Division, Colorado Spring, 2/90
[91/08/27            af]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
Reflected changes in interface functions: probe_target,
go and restart-callup routines do not take a scsi_softc
descriptor any more.
[92/02/22  19:35:12  af]
[ ./kernel/scsi/adapters/scsi_7061_hdw.c ]
Reflected changes in interface functions: probe_target,
go and restart-callup routines do not take a scsi_softc
descriptor any more.
[92/02/22  19:35:41  af]
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
Reflected changes in interface functions: probe_target,
go and restart-callup routines do not take a scsi_softc
descriptor any more.
[92/02/22  19:36:06  af]
[ ./kernel/scsi/adapters/scsi_aha15_hdw.c ]
Reflected changes in interface functions: probe_target,
go and restart-callup routines do not take a scsi_softc
descriptor any more.
[92/02/22  19:36:38  af]
[ ./kernel/scsi/rz.c ]
Changed the interface of a number of functions not to
require the scsi_softc pointer any longer.  It was
mostly unused, now it can be found via tgt->masterno.
[92/02/22  19:31:18  af]
[ ./kernel/scsi/rz_cpu.c ]
Changed the interface of a number of functions not to
require the scsi_softc pointer any longer.  It was
mostly unused, now it can be found via tgt->masterno.
[92/02/22  19:30:48  af]
[ ./kernel/scsi/rz_disk.c ]
Changed the interface of a number of functions not to
require the scsi_softc pointer any longer.  It was
mostly unused, now it can be found via tgt->masterno.
Added DEV_GET_SIZE flavor for get status.
Disabled PERF code.
[92/02/22  19:06:12  af]
[ ./kernel/scsi/rz_disk_bbr.c ]
Changed the interface of a number of functions not to
require the scsi_softc pointer any longer.  It was
mostly unused, now it can be found via tgt->masterno.
[92/02/22  19:30:35  af]
[ ./kernel/scsi/rz_host.c ]
Changed the interface of a number of functions not to
require the scsi_softc pointer any longer.  It was
mostly unused, now it can be found via tgt->masterno.
[92/02/22  19:30:24  af]
[ ./kernel/scsi/rz_labels.c ]
Actually, scan for all possible (bogus) label formats.
This makes it possible to cross-mount disks even if
they do not have the standard BSD label.
[92/02/22            af]
[ ./kernel/scsi/rz_labels.h ]
The vendor-label-searching function is now fixed.
[92/02/22  19:03:13  af]
[ ./kernel/scsi/rz_tape.c ]
Changed the interface of a number of functions not to
require the scsi_softc pointer any longer.  It was
mostly unused, now it can be found via tgt->masterno.
[92/02/22  19:30:10  af]
[ ./kernel/scsi/scsi.c ]
Changed the interface of a number of functions not to
require the scsi_softc pointer any longer.  It was
mostly unused, now it can be found via tgt->masterno.
[92/02/22  19:30:58  af]
[ ./kernel/scsi/scsi_alldevs.c ]
Changed the interface of a number of functions not to
require the scsi_softc pointer any longer.  It was
mostly unused, now it can be found via tgt->masterno.
[92/02/22  19:29:59  af]
[ ./kernel/scsi/scsi_cpu.c ]
Changed the interface of a number of functions not to
require the scsi_softc pointer any longer.  It was
mostly unused, now it can be found via tgt->masterno.
[92/02/22  19:29:47  af]
[ ./kernel/scsi/scsi_defs.h ]
Changed unused field into masterno in target descriptor.
[92/02/22  19:31:54  af]
[ ./kernel/scsi/scsi_disk.c ]
Changed the interface of a number of functions not to
require the scsi_softc pointer any longer.  It was
mostly unused, now it can be found via tgt->masterno.
[92/02/22  19:29:26  af]
[ ./kernel/scsi/scsi_tape.c ]
Changed the interface of a number of functions not to
require the scsi_softc pointer any longer.  It was
mostly unused, now it can be found via tgt->masterno.
[92/02/22  19:29:10  af]
[ ./kernel/sqtconf/conf.c ]
Added getstat routine for sd and zd drivers.
[92/02/22  19:54:46  af]
[ ./kernel/sqtsec/sd.c ]
Added sdgetstat().
[92/02/22  19:53:28  af]
[ ./kernel/sqtzdc/zd.c ]
Added zdgetstat().
[92/02/22  19:52:59  af]
[ ./kernel/sun/conf.c ]
Added getstat routines for xy and sd drivers.
[92/02/22  19:54:08  af]
[ ./kernel/sundev/sd.c ]
Added sdgetstat().
[92/02/22  18:58:26  af]
[ ./kernel/sundev/xy.c ]
Added xygetstat().
[92/02/22  18:57:50  af]
[ ./kernel/vax/conf.c ]
Added/modified the get_status routines for a number of disks.
[92/02/22  19:01:10  af]
[ ./kernel/vaxmba/hp.c ]
Added hpgetstat(), commented out hpioctl.
[92/02/22  18:59:41  af]
[ ./kernel/vaxuba/rk.c ]
Added rkgetstat().
[92/02/22  18:56:06  af]
[ ./kernel/vaxuba/uda_umd.c ]
Added udgetstat().
[92/02/22  18:56:39  af]
[ ./bootstrap/def_pager_setup.c ]
Removed in kernel history, corrected copyright, condensed out of 
kernel history.
[92/02/23            elf]
[ ./bootstrap/default_pager.c ]
Copyright updated, corrected history.
[92/02/23            elf]
[ ./kernel/sqtzdc/zd.c ]
Removed gratuitous reference to undefined variable in zdgetstat.
[92/02/24            elf]
[ ./bootstrap/default_pager.c ]
Accept creation of objects bigger than any one partition, in
anticipation of the code that will page across partitions.
Since we are at it, also proceed with no paging partitions:
rely on killing unlucky objects on pageouts.
[92/02/25            af]
[ ./kernel/conf/files.luna88k ]
dded motorola directories, updated copyright
[92/02/25            elf]
[ ./kernel/conf/Makefile.template ]
Defined ASCPP and initialized it to ${CPP}
[92/02/23            elf]

Moved definition of MKDIRS to where it can be overriden by the
 machine dependent makefile fragment.
[92/02/21            elf]
[ ./kernel/conf/MASTER.luna88k ]
Added savarg option.
[92/02/25            danner]
[ ./kernel/conf/Makefile.luna88k ]
Adapted for new format. Added ascpp rules to replace old S_RULE stuff.
[92/02/25            danner]
[ ./kernel/luna88k/ascpp.sh ]
Created.
[92/02/23            danner]
[ ./kernel/vm/vm_debug.c ]
Added line to mach_vm_region_info to reflect sharing.
Note: vm_region_info needs to be updated. 
[92/02/24            elf]
[ ./kernel/vaxuba/uda_umd.c ]
Include device/param.h for DEV_BSIZE
[92/02/25            elf]
[ ./kernel/i386at/lpr.c ]
Added protection against spurious interrupts.
[92/02/24            danner]
[ ./kernel/chips/mouse.c ]
Delay modifications from af.
[92/02/24            danner]
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
Corrected typo.
[92/02/24            danner]
[ ./kernel/device/net_status.h ]
Add support for ux, NET_DSTADDR, to say whether it is ok
to establish a point to point for this interface.
[92/02/21            rvb]
[ ./kernel/i386at/if_par.c ]
Do NET_DSTADDR correctly.
[92/02/21            rvb]
On output side, skip ether header -- they are not put on the wire.
And some cleanup
[92/02/19            rvb]
Add lpr and par devices.  (taken from 2.5)
BEING DEBUGGED -- not operational
[92/02/13            rvb]
[ ./kernel/mach/i386/fp_reg.h ]
Installed from i386 directory.
[92/02/26            danner]
[ ./kernel/i386/fp_reg.h ]
obsoleted by mach/i386/fp_reg.h
[ ./kernel/i386at/atbus.h ]
Removed (request by rvb)
[ ./kernel/mach/i386/fp_reg.h ]
Added stupid alaises to make i386/fpu.c compile. RVB will fix.
 
[92/02/26            elf]
[ ./kernel/i386/fpu.c ]
Fpinit fixes from dlb.
[92/02/26            danner]
[ ./kernel/kern/bootstrap.c ]
Added protect in copy_bootstrap against zero size bss. 
[92/02/26            danner]
    
    
    
==========================================================================
   ***** MK Version MK71  (rpd) *****
    
    
New features:
--- --------

[PMAX]	  MAXine support, from af.


Bug fixes:
--- -----

Some VM fixes for the new-in-MK70 VM code, from dlb.

Minor norma fixes, from jsb.

Minor default-pager fixes, from af.

The default value of "debug_user_with_kdb" is FALSE now.

The assembly-language rules in Makefile-common do the straightforward
thing again (no more xXx stuff).

I changed the threads library to use thread_switch with a 10ms timeout
instead of swtch_pri.  This should prevent some jerky UX performance.

[I386]	  FP emulation fix, for a bug that caused "Segment Not Present" traps.

[SUN3]    The vm_offset_t and vm_size_t types are "unsigned int" now,
like on all other machines.

[MIPS]    Fixed the bus-reset bug, from af.

[MIPS]    Fixed the hang-after-boot-because-init-dies bug.

[LUNA88K] Assorted fixes, from danner.


Organizational changes:
-------------- -------

I redid the Makefiles in mk/include.  The main improvements are
  1) New files only have to be added in one place.
  2) It decides to install machine-dependent files based on the presence
  of a machine-type (eg, i386, mips) subdirectory, using RECURSE_TEMPLATE.

I removed obsolete machine/exec.[hc] files in the kernel.
I moved the machine/exec.h files to bootstrap.

Special notes:
------- -----

If the default pager or startup tasks take an exception, a thread in
the default pager will catch the exception and panic.  The faulting
thread will be waiting with "exception_raise_continue".  At this point,
you can "w debug_user_with_kdb 1" and "c" to get to ddb in the faulting
context.


[ ./conf/version.edit ]
71
[ ./user/libmach/i386/asm.h ]
Removed.
[ ./Directories/ALL ]
Added machine-dependent directories in ./include.
Purged history.
[92/02/29            rpd]
[ ./Directories/i386 ]
Added ./include/i386.
Purged history.
[92/02/29            rpd]
[ ./Directories/i860 ]
Added ./include/i860.
Purged history.
[92/02/29            rpd]
[ ./Directories/luna88k ]
Added ./include/luna88k.
Purged history.
[92/02/29            rpd]
[ ./Directories/mac2 ]
Added ./include/mac2.
Purged history.
[92/02/29            rpd]
[ ./Directories/mips ]
Added ./include/mips.
Purged history.
[92/02/29            rpd]
[ ./Directories/sqt ]
Added ./include/i386.
Purged history.
[92/02/29            rpd]
[ ./Directories/sun3 ]
Added ./include/sun3.
Purged history.
[92/02/29            rpd]
[ ./Directories/vax ]
Added ./include/vax.
Purged history.
[92/02/29            rpd]
[ ./kernel/conf/Makefile.template ]
Restored explicit vers.c/vers.o rules.
[92/02/27            rpd]
[ ./kernel/conf/files ]
Removed vers.c.
[92/02/27            rpd]
[ ./kernel/i386/asm.h ]
Added ENTRY2.
[92/02/28            rpd]
[ ./kernel/mach/sun3/vm_types.h ]
Changed vm_offset_t and vm_size_t to unsigned int.
[92/02/28            rpd]
[ ./kernel/luna88k/ascpp.sh ]
Removed.
[ ./bootstrap/file_io.c ]
Fixed device_get_status argument types.
[92/02/29            rpd]
[ ./kernel/conf/Makefile.i386 ]
Removed extraneous MAKE_MACH.
[92/02/29            rpd]
[ ./kernel/conf/Makefile.luna88k ]
Removed ascpp rules.
[92/02/29            rpd]
[ ./kernel/i386at/hd.c ]
Cleaned up syntactically incorrect ifdefs.
[92/02/29            rpd]
[ ./kernel/i386at/if_par.c ]
Cleaned up syntactically incorrect ifdefs.
[92/02/29            rpd]
[ ./user/libmach/mips/crt0.ss ]
	Removed .verstamp, .file, .loc directives.
[92/02/29            rpd]
[ ./user/libmach/mips/fork.cs ]
Removed sccsid.
[92/02/29            rpd]
[ ./user/threads/cthread_internals.h ]
Removed exit declaration.  It conflicted with the real thing.
[92/02/29            rpd]
[ ./kernel/i386/exec.c ]
Removed.
[ ./kernel/mips/exec.c ]
Removed.
[ ./kernel/sun/exec.c ]
Removed.
[ ./kernel/vax/exec.c ]
Removed.
[ ./kernel/luna88k/exec.c ]
Removed.
[ ./kernel/i386/exec.h ]
Removed.
[ ./kernel/luna88k/exec.h ]
Removed.
[ ./kernel/sun/exec.h ]
Removed.
[ ./kernel/vax/exec.h ]
Removed.
[ ./bootstrap/i386/exec.c ]
Changed a_info to a_magic.
[92/03/01            rpd]
[ ./bootstrap/luna88k/exec.c ]
Removed struct exechdr, moved related definitions to exec.h.
[92/03/01            rpd]
[ ./kernel/ipc/ipc_kmsg.c ]
Picked up page-list/norma code for ipc_kmsg_copyin_compat, from jsb.
[92/03/01            rpd]
[ ./kernel/vm/vm_map.c ]
Fixed must_wire code in vm_map_copyout_page_list.
Fixed vm_map_fork/VM_MAP_INHERIT_SHARE.  From dlb.
[92/03/01            rpd]
[ ./kernel/vm/vm_object.c ]
Fixed vm_object_copy_temporary to only set shadowed
if symmetric copy-on-write is used.  From dlb.
[92/03/01            rpd]
[ ./kernel/chips/cfb_misc.c ]
When first positioning the cursor use the max_row info.
[92/03/02  01:51:07  af]
[ ./kernel/chips/dtop.h ]
Created from DEC specs:
"DESKTOPinterconnect Description and Protocol Specification"
Version 0.9, Jun 17 1991
"Open Desktop Bus, Locator Device Protocol Specification"
Version 0.4, Dec 13 1990
"Open Desktop Bus, Keyboard Device Protocol Specification"
Version 0.7, Jan 9 1991
[92/01/19            af]
[ ./kernel/chips/dtop_handlers.c ]
Created from DEC specs:
"DESKTOPinterconnect Description and Protocol Specification"
Version 0.9, Jun 17 1991
"Open Desktop Bus, Locator Device Protocol Specification"
Version 0.4, Dec 13 1990
"Open Desktop Bus, Keyboard Device Protocol Specification"
Version 0.7, Jan 9 1991
[92/01/19            af]
[ ./kernel/chips/dtop_hdw.c ]
Created, from DEC specs.
[92/01/19            af]
[ ./kernel/chips/fb_misc.c ]
When first positioning the cursor use the max_row info.
[92/03/02  01:50:43  af]
[ ./kernel/chips/fdc_82077.h ]
Created from the Intel specs:
"Microcommunications Handbook", Vol 1-2, 1990.
[92/01/19            af]
[ ./kernel/chips/fdc_82077_hdw.c ]
Created, initial rough cut at init and probe only.
[92/01/19            af]
[ ./kernel/chips/ims332.c ]
Created stub copy to make things compile.
[92/03/02            af]
[ ./kernel/chips/ims332.h ]
Created stub to make things compile.
[92/03/02            af]
[ ./kernel/chips/isdn_79c30_hdw.c ]
Created stub.
[92/01/19            af]
[ ./kernel/chips/pm_misc.c ]
When first positioning the cursor use the max_row info.
[92/03/02  01:54:40  af]
[ ./kernel/chips/screen_switch.c ]
Added MAXine framebuffer.
[92/03/02  02:03:13  af]
[ ./kernel/chips/xcfb_hdw.c ]
Created.
[92/03/02            af]
[ ./kernel/chips/xcfb_misc.c ]
Created, largely incomplete pending info on cursor chip.
[92/03/02  01:53:40  af]
[ ./kernel/conf/MASTER.mips ]
Added MAXine configuration option and devices.  A bit of polish.
[92/03/02  02:10:56  af]
[ ./kernel/conf/files.mips ]
Added MAXine support code.
[92/03/02  02:09:01  af]
[ ./kernel/mips/PMAX/asic.h ]
Created, from the DEC specs:
"IO Controller ASIC Functional Specifications"
Workstation Systems Engineering, Palo Alto, CA. Feb 1, 1991.
[92/01/17            af]
[ ./kernel/mips/PMAX/kmin.c ]
Made some code common with MAXine.
[92/03/02  02:32:51  af]
[ ./kernel/mips/PMAX/kmin.h ]
Split out the ASIC defns into separate file, which is
in common with MAXine.  Added some nitwits defines.
[92/03/02  02:28:27  af]
[ ./kernel/mips/PMAX/kmin_cpu.s ]
Changed kmin_encode_sr_im() to make it more robust.
[92/03/02  02:26:41  af]
[ ./kernel/mips/PMAX/kmin_dma.c ]
Added support for MAXine.
Fixed "bus reset" bug, which was due to the interaction
of the chained fifos and prefetching in case the target
disconnected right away on a write command.
Also reduced to a minimum the spurious interrupts at
the end of a transfer.
[92/03/02  02:17:05  af]
[ ./kernel/mips/PMAX/kn02.c ]
The interface of the interrupt enable function has changed.
[92/03/02  02:21:38  af]
[ ./kernel/mips/PMAX/kn02ba.c ]
Created, from kmin code.
[92/03/02            af]
[ ./kernel/mips/PMAX/maxine.c ]
Created, from the DEC specs:
"MAXine System Module Functional Specification"  Revision 1.2
Workstation Systems Engineering, Palo Alto, CA. July 15, 1991.
"IO Controller ASIC Functional Specifications"
Workstation Systems Engineering, Palo Alto, CA. Feb 1, 1991.
[92/01/17            af]
[ ./kernel/mips/PMAX/maxine.h ]
Created, from the DEC specs:
"MAXine System Module Functional Specification"  Revision 1.2
Workstation Systems Engineering, Palo Alto, CA. July 15, 1991.
[92/01/17            af]
[ ./kernel/mips/PMAX/maxine_cpu.h ]
Created, from DEC specs.
[92/01/30            af]
[ ./kernel/mips/PMAX/maxine_cpu.s ]
Created, from DEC specs.
[92/01/30            af]
[ ./kernel/mips/PMAX/mips_box.c ]
Added MAXine's drivers.
[92/03/02  02:20:00  af]
[ ./kernel/mips/PMAX/model_dep.c ]
Support for MAXine.
[92/03/02  02:17:50  af]
[ ./kernel/mips/conf.c ]
Added MAXine's floppy.
[92/03/02  02:12:41  af]
[ ./kernel/kern/exception.c ]
Changed debug_user_with_kdb to FALSE.
[92/03/02            rpd]
[ ./kernel/vm/vm_map.c ]
Another wiring fix for vm_map_copyout_page_list.  From dlb.
[92/03/02            rpd]
[ ./kernel/mips/mips_mem_ops.c ]
Removed strlen.  It duplicated one in device/subrs.c. (!!!)
[92/03/02            rpd]
[ ./user/libmach/get_privileged_ports.c ]
Fixed includes.
[92/03/02            rpd]
[ ./bootstrap/default_pager.c ]
Changed to catch exception messages and handle bootstrap requests.
Added partition_init.
[92/03/02            rpd]
[ ./bootstrap/bootstrap.c ]
Added default_pager_bootstrap_port and default_pager_exception_port.
Added partition_init.
Removed bootstrap request handling.
[92/03/02            rpd]
[ ./bootstrap/mach/bootstrap.defs ]
Created.
[92/03/02            rpd]
[ ./bootstrap/bootstrap.c ]
Added default_pager_bootstrap_port and default_pager_exception_port.
Added partition_init.
Removed bootstrap request handling.
[92/03/03            rpd]
[ ./bootstrap/default_pager.c ]
Changed to catch exception messages and handle bootstrap requests.
Added partition_init.
[92/03/03            rpd]
[ ./kernel/mips/PMAX/model_dep.c ]
Support for MAXine.
[92/03/02  02:17:50  af]
[ ./bootstrap/default_pager.c ]
Changed to catch exception messages and handle bootstrap requests.
Added partition_init.
[92/03/03            rpd]
[ ./kernel/mips/thread.h ]
Removed pcb_synch, thread_start declarations.
Added syscall_emulation_sync, pcb_collect declarations.
[92/03/03            rpd]
[ ./kernel/mips/pcb.c ]
Added syscall_emulation_sync.
[92/03/03            rpd]
[ ./kernel/kern/syscall_emulation.c ]
Added syscall_emulation_sync.
[92/03/03            rpd]
[ ./kernel/motorola/m88k/m88100/pcb.h ]
Added dummy definition of syscall_emulation_sync.
[92/03/03            rpd]
[ ./kernel/i386/thread.h ]
Added dummy definition of syscall_emulation_sync.
[92/03/03            rpd]
[ ./kernel/i860/thread.h ]
Added dummy definition of syscall_emulation_sync.
[92/03/03            rpd]
[ ./kernel/mac2/thread.h ]
Added dummy definition of syscall_emulation_sync.
[92/03/03            rpd]
[ ./kernel/sun3/thread.h ]
Added dummy definition of syscall_emulation_sync.
[92/03/03            rpd]
[ ./kernel/vax/thread.h ]
Added dummy definition of syscall_emulation_sync.
[92/03/03            rpd]
[ ./kernel/luna88k/db_interface.c ]
Fixed TASK_NULL handling bug in db_task_va_to_phys.
[92/03/02            danner]
[ ./kernel/luna88k/db_trace.c ]
Now traces user space. Made much less verbose.
[92/03/02            danner]
[ ./kernel/luna88k/locore/eh.c ]
Fixes to the syscall_handler. It turns out none of the control
 registers except SR0-SR3 are read/write; the rest are
 read and clear. So using DMT0 as a scratch register is out.
[92/03/02            danner]
[ ./kernel/luna88k/luna_init.c ]
Fixed irritating palette initialization code.
[92/03/02            danner]
[ ./kernel/luna88k/setroot.c ]
sd6c -> sd6a
[92/03/02            danner]
[ ./kernel/luna88k/trap.c ]
conditionalized gimmeabreak in trap path.
[92/03/02            danner]
[ ./kernel/motorola/m88k/m88100/continuation.s ]
Save continuation argument as old_thread->swap_func in
 Switch_context.
[92/03/02            danner]

Added missing stcr in interrupt disabling code.
[92/03/02            danner]
[ ./kernel/i386at/rtc.c ]
Well, writetodc() is broken for after leapday on leapyears,
till Jan 1 the next year.
[92/03/03            rvb]
[ ./kernel/kern/syscall_emulation.c ]
Use vector_size instead of size_used in vm_map_copyin.
[92/03/04  14:54:49  jsb]
[ ./kernel/vm/vm_object.c ]
Fixed the most blatant errors in vm_object_copy_call.
[92/03/04  17:52:30  jsb]
[ ./kernel/chips/ims332.c ]
Got real specs ( thanks Jukki!! ):
"IMS G332 colour video controller"
1990 Databook, pp 139-163, Inmos Ltd.
[92/03/03            af]
[ ./kernel/chips/ims332.h ]
Got real specs ( thanks Jukki!! ):
"IMS G332 colour video controller"
1990 Databook, pp 139-163, Inmos Ltd.
[92/03/03            af]
[ ./kernel/chips/screen.c ]
Restore cursor 1-off-max, not to any predefined constant.
[92/03/04            af]
[ ./kernel/chips/xcfb_hdw.c ]
Cursor/VDAC chip works now.
[92/03/04            af]
[ ./kernel/chips/xcfb_misc.c ]
Got cursor to work.
[92/03/04            af]
[ ./kernel/mips/PMAX/maxine.c ]
Clear vertical retrace interrupt bit here.
[92/03/04            af]
[ ./kernel/mips/PMAX/model_dep.c ]
On maxine, do not make I/O space uncached; speeds up the screen
about 30% under X11.
[92/03/04            af]
[ ./kernel/mips/PMAX/pmag_xine.h ]
Created, from the DEC specs:
"MAXine System Module Functional Specification Rev 1.2"
Workstation Systems Engineering, Palo Alto, CA. July 15, 1991.
[92/03/04            af]
[ ./kernel/mips/pmap.c ]
Made non-cachability of I/O memory non-mandatory.
Do not account for I/O memory pages in the resident_count.
Removed some old cruft.
[92/03/04            af]
[ ./kernel/i386/fpe_linkage.c ]
Fixed disable_fpe to clear fs & gs.
[92/03/05            rpd]
[ ./bootstrap/default_pager.c ]
Changed PAGEMAP_ENTRIES from 128 to 64.  From af.
[92/03/05            rpd]
[ ./kernel/chips/dtop.h ]
Define how many buttons and coordinates we can take.
[92/03/05            af]
[ ./kernel/chips/dtop_handlers.c ]
Changed locators handler to always pass relative coords
to screen_motion_event.
[92/03/05            af]
[ ./kernel/chips/mouse.c ]
Moved scale & thresholding code up in screen.c
This rids of all but one use of the user_info_t.
[92/03/05            af]
[ ./kernel/chips/screen.c ]
Moved here code that used to be in mouse.c for scaling
and thresholding of motion events.
[92/03/05            af]
[ ./kernel/conf/files ]
Fixed ./mach/memory_object_*.c for norma.
[92/03/05            rpd]
[ ./kernel/conf/Makefile.template ]
Corrected the dependencies for device/dev_forward.c
and mach/mach_norma_user.c.
Added a rule for mach/mach_user.c.
[92/03/04            rpd]
[ ./kernel/ipc/ipc_kmsg.c ]
Undid norma changes that were inadvertently picked up in 2.24.
[92/03/05            rpd]
[ ./kernel/device/ds_routines.c ]
Undid norma changes that were inadvertently picked up in 2.27.
[92/03/05            rpd]
[ ./Makefile ]
Changed to use double-colon rules.
[92/02/28            rpd]
[ ./Makefile-common ]
Changed top-level targets to use double-colon rules.
Restored sane .s and .cs rules.
[92/02/28            rpd]
[ ./Makefile-mkdirs ]
Changed to use double-colon rules for top-level targets.
[92/02/28            rpd]
[ ./Makefile-mklinks ]
Changed to use double-colon rules.
[92/02/28            rpd]
[ ./Makefile-subdirs ]
Fixed RECURSE_TEMPLATE.
Added TARGET_MACHINE to MVARIABLES.
[92/02/28            rpd]
[ ./bootstrap/Makefile ]
Changed to use double-colon rules for top-level targets.
[92/02/28            rpd]
[ ./include/Makefile ]
Added mach/bootstrap.defs, mach/bootstrap.h.
[92/03/02            rpd]

Changed for new Makefile-include organization.
[92/02/28            rpd]
[ ./kernel/Makefile ]
Fixed to remove the kernel binary after configuring.
Changed to use double-colon rules for top-level targets.
[92/02/27            rpd]
[ ./kernel/src/config/Makefile ]
Changed to use double-colon rules for top-level targets.
[92/02/28            rpd]
[ ./kernel/src/doconf/Makefile ]
Changed to use double-colon rules for top-level targets.
[92/02/28            rpd]
[ ./kernel/src/makeboot/Makefile ]
Changed to use double-colon rules for top-level targets.
[92/02/28            rpd]
[ ./kernel/src/mig/Makefile ]
Changed to use double-colon rules for top-level targets.
[92/02/28            rpd]
[ ./user/libmach/Makefile ]
Added bootstrap functions.
[92/03/02            rpd]

Changed to use double-colon rules for top-level targets.
[92/02/28            rpd]
[ ./user/threads/Makefile ]
Changed to use double-colon rules for top-level targets.
[92/02/28            rpd]
[ ./include/mips/Makefile ]
Created.
[92/02/28            rpd]
[ ./include/Makefile-include ]
Created.
[92/02/28            rpd]
[ ./include/mips/Makefile ]
Created.
[92/02/28            rpd]
[ ./include/Makefile-include ]
Created.
[92/02/28            rpd]
[ ./include/i386/Makefile ]
Created.
[92/02/28            rpd]
[ ./include/i860/Makefile ]
Created.
[92/02/28            rpd]
[ ./include/Makefile-machine ]
Created.
[92/02/28            rpd]
[ ./include/Makefile-midevice ]
Created.
[92/02/28            rpd]
[ ./include/sun3/Makefile ]
Created.
[92/02/28            rpd]
[ ./include/vax/Makefile ]
Created.
[92/02/28            rpd]
[ ./include/mac2/Makefile ]
Created.
[92/02/28            rpd]
[ ./include/luna88k/Makefile ]
Created.
[92/02/28            rpd]
[ ./bootstrap/vax/exec.h ]
Moved from kernel to bootstrap.
Removed sun conditionals.
[92/03/01            rpd]
[ ./bootstrap/sun3/exec.h ]
Moved from kernel to bootstrap.
Removed sun conditionals.
[92/03/01            rpd]
[ ./bootstrap/i386/exec.h ]
Moved from kernel to bootstrap.
Removed sun conditionals.
Changed a_info to a_magic.
[92/03/01            rpd]
[ ./bootstrap/luna88k/exec.h ]
Moved from kernel to bootstrap.
Removed sun definitions, added luna definitions.
[92/03/01            rpd]
[ ./kernel/conf/files ]
Added vm/vm_external.c.
[92/03/06  13:16:00  jsb]
[ ./kernel/i386at/autoconf.c ]
Removed 0x3bc entry for lprdriver until someone can come up
with a better fix.
[92/03/06  13:16:43  jsb]
[ ./kernel/norma/xmm_user.c ]
Added working stub for memory_object_data_supply.
[92/03/06  13:17:44  jsb]
[ ./bootstrap/default_pager.c ]
Fixed pager_dealloc_page calls in pager_dealloc (from af).
Removed chatty printfs.
[92/03/06            rpd]
[ ./user/threads/cthread_internals.h ]
Added yield, defined using thread_switch.
[92/03/06            rpd]
[ ./user/threads/cprocs.c ]
Replaced swtch_pri with yield.
[92/03/06            rpd]
[ ./user/threads/sync.c ]
Replaced swtch_pri with yield.
[92/03/06            rpd]
    
    
    
==========================================================================
   ***** MK Version MK72  (jsb) *****
    
    
Bug fixes and new features:
--- ----- --- --- --------

Many many NORMA bug fixes, merged in from the NORMA_MK branch.
Moving receive rights and no-senders notifications now work.
The distributed vm system is much more stable. etc.

Old memory_object_terminate/memory_object_init race eliminated.

Added support for ipc notifications on kernel objects. This includes
a no-senders handler in the device server (which doesn't yet do anything).

Enabled MACH_PAGEMAP by default (STD now contains pm).

Picked up VM_PROT_NO_CHANGE functionality for memory_object_lock_request
from dlb@osf. This allows a pager to flush or clean without changing
protection.

Tested:
------

STD+WS					on horta (i486) (UX28)
STD+SWS					on rocky (sun3) (UX33)
STD+WS+assert+lineno+NORMA+norma_ether	on horta and ubik (i486) (UX28-muarea)
STD+ANY					on jsb (pmax) (UX33)

Log messages:
--- --------

[ ./conf/version.edit ]
72
[ ./kernel/kern/thread.c ]
Remove continuation from AST_TERMINATE case of thread_halt_self 
so that "zombie walks" is reachable.
[92/02/25            dlb]
[ ./kernel/conf/MASTER ]
Added pm (MACH_PAGEMAP) to STD.
[92/03/10  14:58:32  jsb]
[ ./kernel/conf/files ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:56:28  jsb]
[ ./kernel/ddb/db_command.c ]
Added show pset, show all vuids.
[92/02/20  10:52:22  jsb]
NORMA_VM: added show xmm_obj, show xmm_reply.
[92/01/21  18:13:32  jsb]

NORMA_IPC: added show all uids, proxies, principals.
[92/01/16  21:25:38  jsb]

Added show copy, show packet, show pcs.
[92/01/13  10:13:50  jsb]
[ ./kernel/device/dev_pager.c ]
Eliminated all NORMA_VM conditionals except for one in data_request.
[92/03/10  10:27:59  jsb]

Added missing memory_object_* stubs.
[92/03/10  08:41:12  jsb]
[ ./kernel/device/ds_routines.c ]
Check protection argument to device_map.
[David L. Black 92/02/22  17:03:11  dlb@osf.org]
Merged in norma branch changes as of NORMA_MK7:
Added ds_notify and ds_no_senders routines in preparation for using
no-senders notifications to close unreferenced devices.
Use remote_device() instead of norma_get_special_port().
[ ./kernel/device/net_io.c ]
Changed parameters to netipc_net_packet.
[92/03/09  12:57:30  jsb]
[ ./kernel/i386/db_trace.c ]
Changed db_numargs to use patchable variable db_numargs_default
when it needs to guess the number of arguments, instead of just
using the embedded constant '5'.
[92/03/10  14:21:55  jsb]
[ ./kernel/ipc/ipc_kmsg.c ]
Merged in norma branch changes as of NORMA_MK7:
Moved ipc_kmsg_copyout_to_network to norma/ipc_output.c.
Moved ipc_kmsg_uncopyout_to_network to norma/ipc_clean.c.
[92/02/21  10:34:46  jsb]
We no longer convert to network format directly from user format;
this greatly reduces the number of NORMA_IPC conditionals here.
Added code to detect and recover from vm_map_convert_to_page_list
failure. Streamlined and fixed ipc_kmsg_copyout_to_network.
[92/02/21  09:01:52  jsb]
[ ./kernel/ipc/ipc_kmsg.h ]
Added ikm_source_node to support norma_ipc_receive_rright.
[91/12/28  08:38:53  jsb]
[ ./kernel/ipc/ipc_mqueue.c ]
Merged in norma branch changes as of NORMA_MK7:
Picked up hack from dlb@osf.org to call norma_ipc_finish_receiving
before ipc_kmsg_destroy. The real fix is to use uncopyout_to_network.
[92/01/17  14:35:03  jsb]
Removed spurious arguments to norma_ipc_send.
Options and timeout will be handled here, not by norma_ipc_send.
[91/12/26  19:51:59  jsb]
[ ./kernel/ipc/ipc_notify.c ]
Merged in norma branch changes as of NORMA_MK7:
Added norma_ipc_notify_no_senders hook in ipc_notify_no_senders,
using ip_nsproxy* macros.
[92/03/09  13:24:06  jsb]
[ ./kernel/ipc/ipc_object.c ]
Made ipc_object_print look nicer.
[92/03/09  13:21:38  jsb]
[ ./kernel/ipc/ipc_port.c ]
Merged in norma branch changes as of NORMA_MK7:
Removed token-related fields. Added fields for receive-right migration
and xmm support. Updated ipc_port_{init,print} accordingly.
[92/03/09  13:20:23  jsb]
[ ./kernel/ipc/ipc_port.h ]
Merged in norma branch changes as of NORMA_MK7:
Removed token-related fields. Added fields for receive-right migration
and xmm support. Added ip_nsproxy* macros for no-senders support.
[92/03/09  13:14:35  jsb]
[ ./kernel/ipc/ipc_space.c ]
NORMA_IPC: declare ipc_space_remote.
[91/12/24  14:00:40  jsb]
[ ./kernel/kern/exception.c ]
Don't convert exception kmsg to network format.
[92/02/21  09:02:59  jsb]
[ ./kernel/kern/ipc_kobject.c ]
Add IKOT_PAGER_TERMINATING case to ipc_kobject_destroy.
[92/02/25            dlb]
Added ipc_kobject_notify for kernel-requested notifications.
Added code to correctly release send-once kobject destinations.
[92/01/21  18:20:19  jsb]
[ ./kernel/kern/ipc_kobject.h ]
Added IKOT_XMM_{OBJECT,KERNEL,REPLY} and IKOT_PAGER_TERMINATING.
[92/03/07  08:25:33  jsb]
[ ./kernel/kern/ipc_mig.c ]
Corrected log.
[91/12/24  14:42:53  jsb]
[ ./kernel/kern/mach_clock.c ]
Removed NORMA_IPC code.
[92/01/17  11:38:55  jsb]
[ ./kernel/kern/mach_param.h ]
19-Feb-92 David L. Black (dlb) at Open Software Foundation
Double object slop in PORT_MAX; allow for extra (non-task)
ipc spaces (e.g. ipc_space_remote) in SPACE_MAX
[92/03/07  08:51:33  jsb]
[ ./kernel/kern/machine.c ]
From durriya@ri.osf.org: added host_get_boot_info.
[92/01/08  16:38:55  jsb]
[ ./kernel/mach/host_info.h ]
From durriya@ri.osf.org: defined kernel_boot_info_t.
[92/03/07  08:16:27  jsb]
[ ./kernel/mach/mach_host.defs ]
From durriya@ri.osf.org: added host_get_boot_info.
[92/01/08  15:01:12  jsb]
[ ./kernel/mach/mach_types.defs ]
NORMA_VM: use xmm_kobj_lookup to convert memory_object_control ports.
From durriya@ri.osf.org: defined kernel_boot_info_t.
[92/03/07  08:30:08  jsb]
[ ./kernel/mach/mach_types.h ]
NORMA_VM: define mach_xmm_obj_t and xmm_kobj_lookup().
[92/02/10  08:47:29  jsb]
[ ./kernel/mach/memory_object.h ]
Added MEMORY_OBJECT_COPY_TEMPORARY.
[92/02/11  07:56:35  jsb]
[ ./kernel/mach/norma_special_ports.h ]
Define MAX_SPECIAL_KERNEL_ID.
[92/01/04  18:16:44  jsb]
[ ./kernel/mach/vm_inherit.h ]
Removed VM_INHERIT_DONATE_COPY.
[92/03/07  08:37:13  jsb]
[ ./kernel/mach/vm_prot.h ]
Add no change protection value for memory_object_lock_request.
[David L. Black 92/02/22  17:03:43  dlb@osf.org]
[ ./kernel/norma/ipc_alias.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:48:35  jsb]
[ ./kernel/norma/ipc_clean.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:48:39  jsb]
[ ./kernel/norma/ipc_ether.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:48:43  jsb]
[ ./kernel/norma/ipc_fields.h ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:49:05  jsb]
[ ./kernel/norma/ipc_input.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:49:08  jsb]
[ ./kernel/norma/ipc_kserver.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:49:17  jsb]
[ ./kernel/norma/ipc_list.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:49:22  jsb]
[ ./kernel/norma/ipc_migrate.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:49:26  jsb]
[ ./kernel/norma/ipc_net.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:49:32  jsb]
[ ./kernel/norma/ipc_net.h ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:49:55  jsb]
[ ./kernel/norma/ipc_netvec.h ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:50:03  jsb]
[ ./kernel/norma/ipc_node.h ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:50:06  jsb]
[ ./kernel/norma/ipc_output.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:50:12  jsb]
[ ./kernel/norma/ipc_special.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:50:20  jsb]
[ ./kernel/norma/ipc_token.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:50:24  jsb]
[ ./kernel/norma/ipc_transit.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:50:27  jsb]
[ ./kernel/norma/ipc_unreliable.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:50:36  jsb]
[ ./kernel/norma/ipc_wait.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:50:44  jsb]
[ ./kernel/norma/ipc_wire.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:50:47  jsb]
[ ./kernel/norma/kern_task.c ]
Check for null parent task in task_create.
[92/03/10  13:46:21  jsb]

Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:50:50  jsb]
[ ./kernel/norma/norma_internal.defs ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:52:25  jsb]
[ ./kernel/norma/xmm.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:50:54  jsb]
[ ./kernel/norma/xmm_buffer.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:00  jsb]
[ ./kernel/norma/xmm_copy.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:05  jsb]
[ ./kernel/norma/xmm_debug.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:08  jsb]
[ ./kernel/norma/xmm_export.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:14  jsb]
[ ./kernel/norma/xmm_import.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:19  jsb]
[ ./kernel/norma/xmm_interpose.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:23  jsb]
[ ./kernel/norma/xmm_invalid.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:26  jsb]
[ ./kernel/norma/xmm_invoke.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:30  jsb]
[ ./kernel/norma/xmm_obj.h ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:33  jsb]
[ ./kernel/norma/xmm_object.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:37  jsb]
[ ./kernel/norma/xmm_proxy.defs ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:52:28  jsb]
[ ./kernel/norma/xmm_server.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:42  jsb]
[ ./kernel/norma/xmm_server_rename.h ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:47  jsb]
[ ./kernel/norma/xmm_shadow.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:50  jsb]
[ ./kernel/norma/xmm_split.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:54  jsb]
[ ./kernel/norma/xmm_svm.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:51:57  jsb]
[ ./kernel/vm/memory_object.c ]
Add MEMORY_OBJECT_COPY_TEMPORARY case to
memory_object_set_attributes_common.
[92/03/06  16:57:38  jsb]

NORMA_VM: don't define cover and backwards compatibility routines.
[92/03/06  16:54:53  jsb]

[David L. Black 92/02/22  17:05:17  dlb@osf.org]
Implement no change of page lock functionality in
memory_object_lock_request.
[ ./kernel/vm/vm_object.c ]
Fix to NORMA_VM pager_name merge.
[92/03/10  13:45:01  jsb]

Merged in NORMA_VM strategy for pager_name ports.
Should one day reconcile the jsb and rpd schemes.
[92/03/10  08:17:32  jsb]

Added new NORMA_VM changes.
[92/03/06  16:35:19  jsb]

(Naively) handle temporary objects in vm_object_copy_strategically.
This now happens because of new MEMORY_OBJECT_COPY_TEMPORARY option.
[92/03/06  16:22:17  jsb]

Use IKOT_PAGER_TERMINATING to solve terminate/init race.
Includes fixes from David Black.
[92/03/06  16:15:41  jsb]

Changes for object->pager_request now being a pager_request_t.
[92/03/06  15:20:07  jsb]

Removed old NORMA_VM stuff.
[92/03/06  14:37:19  jsb]
[ ./kernel/vm/vm_object.h ]
Added declaration of pager_request_t, which is an xmm_obj_t in NORMA_VM
systems, ipc_port_t otherwise. Used to declare pager_request field.
[92/03/06  14:47:27  jsb]
[ ./kernel/vm/vm_user.c ]
Removed NORMA_VM workaround.
[92/02/11  17:42:41  jsb]
Add checks for protection and inheritance arguments.
[92/02/22  17:07:18  dlb@osf.org]
[ ./kernel/norma/xmm_user.c ]
Merged in norma branch changes as of NORMA_MK7.
[92/03/09  12:53:39  jsb]
    
    
    
==========================================================================
   ***** MK Version MK73  (rpd) *****
    
    
New features:
--- --------

Added cross-compilation support to the Makefiles, from jvh,
although I made various changes that hopefully didn't break anything.
Details to follow.

Added MIG_DESTROY_REQUEST error code in mach_msg_server.
If your server function returns this code, then mach_msg_server
will just destroy the request message and not send a reply message.

Removed pmap_remove_attributes from the pmap interface.

[PMAX]    Verbose SCSI error messages, from af.

[PMAX]    Mappable free-running counter device for maxine, from af.

[I386]    Added i386at boot loader program source.

[PMAX]    (Preliminary) Driver for Fore's ATM card, from rvb.


Bug fixes:
--- -----

Updated to latest OSF ddb man page.

Fixed conversion from IPC timeout (milliseconds) to ticks to round UP.
This affects thread_switch and mach_msg timeout arguments.
This fixes a C-threads bug: it was using a timeout of 10ms, which previously
rounded down to zero ticks, which thread_switch would interpret as infinity.

Fixed vm_map_copyout_page_list to make the pages dirty, from dlb.

Fixed per-thread ASTs, so that they don't mistakenly propogate across
context-switches, from dbg.  This should fix the i386 bug that sometimes
threads would get FP exceptions that they didn't deserve.

Fixed ip_msgcount overflow problem.  Yes, it is possible to get more than 2^16
messages queued to a port.

Fixed ipc_port_dealloc_special bug that could cause an assertion failure
when using thread_abort during exception handling.

Fixed thread_handoff to check for stack-privilege violations.
They are possible now that the default pager is out of the kernel.

Fixed thread_halt_self to use a continuation for termination.

Updated mach_error_string with error codes for the device/file-io interfaces.

device_write/OOL memory fix from dlb, for big writes to eg tape devices.

Fixed Directories/ALL luna88K typo.

Removed various machine-dependents versions of gets in favor
of the machine-independent version, which I renamed safe_gets.

Fixed the config program so that if a file is listed in both conf/files
and conf/files.<machine>, the latter entry wins.

Fixed vm_object_pager_wakeup to use ip_active, from dlb.

Fixed i386/mips disk label code, from rvb.  This involved an incompatible
change to device/disk_status.h, so old disk-label-munging programs
need to be recompiled.  (This doesn't affect anything in the UX and USER
collections.)

[PMAX]	  Changed the exceptions that get reported for ADEL/ADES exceptions,
so that an exception handler can unambiguously tell if the exception was
ADEL/ADES to TLBL/TLBS.

[PMAX]	  Fixed vm_machine_attributes (cacheability control) so that
multiple ranges in an address space can be non-cached.

[PMAX]	  Fixed mips configuration files to compile vm/vm_fault.c with
-Olimit, so that vm_fault_page gets optimized.

[PMAX]    Fix for slow scsi boards on maxine and kmin.

[PMAX]    Cursor fixes from af.

[PMAX]    Fixed makeboot to handle kernels with non-contiguous text & data.

[LUNA88K] Many fixes from danner.

[LUNA88K] Removed funny/wrong capitalization code in config's generation
of option/device header files.

[I386]	  Fixed get_root_device to use gets correctly.

[I386]	  Fixed pmap bug that prevented physical page 0 from being (un)mapped.
From rvb.

[I386]	  Some i386 device configuration fixes from rvb.

[I386]	  Some ANSI preprocessor fixes from jvh.

[VAX]	  Fixed ddb support so that the current user address space
can be accessed for breakpoints.


[ ./conf/version.edit ]
73
[ ./kernel/kern/syscall_emulation.h ]
Removed EML_OFFSET.
[92/03/20            rpd]
[ ./kernel/luna88k/pmap.h ]
Removed pmap_remove_attributes.
[92/03/25            rpd]
[ ./kernel/mach/error.h ]
Added err_bootstrap for bootstrap errors.
[92/03/09            rpd]
[ ./kernel/mach/mig_errors.h ]
Added MIG_DESTROY_REQUEST.
[92/03/09            rpd]
[ ./kernel/mips/pmap.h ]
Added a pmap_range structure.
[92/03/25            rpd]
[ ./kernel/sun3/pmap.h ]
Removed pmap_remove_attributes.
[92/03/25            rpd]
[ ./kernel/vax/pmap.h ]
Removed pmap_remove_attributes.
[92/03/25            rpd]
[ ./kernel/vm/vm_map.h ]
Add extend_cont continuation invocation macro to invoke
continuation without affecting current copy.  Declare
vm_map_copy_discard_cont.
[92/03/20  14:15:53  dlb]
[ ./user/libmach/errorlib.h ]
Added KERN_DEVICE_MOD for device errors.
[92/03/09            rpd]
[ ./kernel/luna88k/locore/vsnprintf.c ]
Removed.
[ ./bootstrap/luna88k/exec.c ]
Initial stack alignment should be doubleword (8 byte).
[92/03/20            danner]
[ ./kernel/ddb/db_run.c ]
Added missing newline print in n/p command.
[92/03/20            danner]
[ ./kernel/kern/task.c ]
Initialize kernel_task to TASK_NULL to support ddb use before the
 bss is zeroed. Remove duplicate include of machine/machparam.h.
Update copyright.
[92/03/21            danner]
[ ./kernel/luna88k/db_disasm.c ]
Modified to use db_task_printsym.
[92/03/22            danner]
[ ./kernel/luna88k/db_interface.c ]
upgraded luna_db_where to use db_find_xtrn_task_sym_and_offset.
[92/03/21            danner]
Replaced fixed length wait with db_wait variable.
[92/03/16  17:18:45  danner]
[ ./kernel/luna88k/db_machdep.h ]
Made suitable for inclusion in assembly files.
[92/03/03            danner]
[ ./kernel/luna88k/db_trace.c ]
Added t/t, t/tu functionality.
[92/03/24            danner]
Switch use of TASK_NULL to kernel_task in stack trace code.
[92/03/20            danner]

Changed last usages of db_printsym to db_task_printsym.
[92/03/20            danner]
[ ./kernel/luna88k/locore/eh.c ]
Added save of shadow XIP in syscall_native under MACH_KDB
 conditionals to support cleaner stack traces.
[92/03/18            danner]
[ ./kernel/luna88k/locore/locore.h ]
Readded call frame allocation in call.
[92/03/19            danner]
[ ./kernel/luna88k/locore/locore_asm_routines.c ]
Cleaned up log.
[92/03/21  12:02:38  danner]

Added simple lock debugging code
[92/03/16  17:20:02  danner]
[ ./kernel/luna88k/machdep.c ]
spl0 now enables interrupts. 
Removed splcounters
[92/03/16  17:30:15  danner]
[ ./kernel/luna88k/pcb.h ]
Changed include. Removed pcb_terminate macro.
[92/03/03            danner]
[ ./kernel/luna88k/trap.c ]
Drop thread argument to exception.
[92/03/24            danner]
Was treating user breakpoint instructions like entry breakpoints,
 causing user space single stepping to act like noops.
[92/03/19            danner]
Removed syscall, mach_syscall and other 2.5 cruft.
[92/03/03            danner]
[ ./kernel/luna88kdev/uart.c ]
Added a missing ttyinput call.
[92/03/16  17:22:02  danner]
[ ./kernel/motorola/m88k/m88100/exception_return.s ]
Corrections to the ast handling code.
[92/03/20            danner]
Corrected typo in ast_taken register reload code.
[92/03/03            danner]
[ ./kernel/motorola/m88k/m88100/pcb.c ]
Implemented thread_set_syscall_return.
[92/03/24            danner]
Added pcb_terminate
[92/03/03            danner]

Made pcb zone collectable, added alignment assert.
[92/03/03            danner]
[ ./user/libmach/luna88k/bcopy.c ]
Corrected, optimized nocpy.
[92/03/21            danner]
[ ./user/libmach/luna88k/bzero.c ]
Fixed most serious typo.
[92/03/15            danner]
[ ./user/libmach/luna88k/crt0.ss ]
Leave some more space on the top of stack; compiler convention
 has debugged code save arguments (8 words) above the callers sp.
[92/03/20            danner]
[ ./user/libmach/luna88k/gcc.c ]
Added memcpy
[92/03/16  17:23:41  danner]
[ ./user/threads/luna88k/csw.s ]
[92/03/21  12:04:28  danner]
[ ./user/threads/luna88k/thread.c ]
Moved broken  cthread_sp to csw.s where it can be written
 correctly in godfearing assembler.
[92/03/20            danner]
[ ./kernel/luna88k/setroot.c ]
Switched back to sd6c.
[92/03/16  17:21:07  danner]
[ ./kernel/conf/files.mips ]
Added vm/vm_fault.c, with -Olimit so that vm_fault_page is optimized.
[92/03/27            rpd]
[ ./kernel/chips/fb_misc.c ]
Put spl protections around setstatus playing with cursor
and vdac.
[92/03/11  16:04:49  af]
[ ./kernel/chips/frc.c ]
Created, based on maxine's counter.
[92/03/10            af]
[ ./kernel/chips/pm_misc.c ]
Put spl protection around the user (setstatus) playing
with the cursor and vdac.  Never was reported as an
observed problem, but...
[92/03/11  16:02:59  af]
[ ./kernel/chips/screen.c ]
Fixed scaling and thresholding for negative deltas of
the cursor, broken in previous merge.
[92/03/11  16:06:27  af]
[ ./kernel/conf/MASTER.mips ]
Added mappable timer.
[92/03/11  02:39:05  af]
[ ./kernel/conf/files.mips ]
Added mappable timer device.
[92/03/11  02:38:35  af]
[ ./kernel/mips/PMAX/maxine.c ]
Added mappable timer device.
[92/03/11  02:36:54  af]
[ ./kernel/mips/PMAX/maxine.h ]
Defined pseudo slot for mappable timer.
[92/03/11  02:37:41  af]
[ ./kernel/mips/PMAX/mips_box.c ]
Added maxine's mappable timer.
[92/03/11  02:36:18  af]
[ ./kernel/mips/PMAX/model_dep.c ]
On maxine and kmin, set speed of any possible scsi option board
down to 12.5 Mhz. Quadruple sigh.
[92/04/01  14:58:54  af]
[ ./kernel/mips/PMAX/tc.c ]
Added maxine's mappable timer.
[92/03/11  02:35:18  af]
[ ./kernel/mips/conf.c ]
Added mapped timer device
[92/03/11  02:34:30  af]
[ ./kernel/scsi/adapters/scsi_53C94.h ]
Made some defines parameterized on the clock speed.
[92/04/01  14:52:26  af]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
Made it capable of handling clock speeds other than 25Mhz (needed on
the option boards DEC sells for kmin and maxine).
Added first cut at target mode functionality. Works, sortof.
Turned off LOGing and made it more precise in places.
Fixed a couple races in the synch negotiation.
When a target goes offline reset the sync parameters.
[92/04/01  14:57:33  af]
[ ./Directories/ALL ]
Fixed ./bootstrap/luna88k typo.
[92/03/08            rpd]
[ ./kernel/ddb/db_print.c ]
Changed db_print_thread so that both display formats
show the floating-point-used status of the thread.
[92/03/16            rpd]
[ ./kernel/device/ds_routines.c ]
Calculate minimum transfer size in device_write_get and
pass it to kmem_io_map_copyout.  This makes large block
sizes work with tapes.

Increase DEVICE_IO_MAP_SIZE to 2 megs
[92/03/03  13:53:25  jeffreyh]
[ ./kernel/i386/idt.s ]
Changed $0 to $(0) for ANSI cpp.
[92/03/25            jvh]
[ ./kernel/i386/setroot.c ]
Renamed gets to safe_gets.
Fixed get_root_device.
[92/03/31            rpd]
[ ./kernel/i386/start.s ]
Changed comments to standard C syntax.
[92/03/18            jvh]
[ ./kernel/i386ipsc/autoconf.c ]
Renamed gets to safe_gets.
[92/03/31            rpd]
[ ./kernel/i860ipsc/autoconf.c ]
Renamed gets to safe_gets.
[92/03/31            rpd]
[ ./kernel/intel/pmap.c ]
Removed pmap_remove_attributes.
[92/03/25            rpd]
[ ./kernel/kern/bootstrap.c ]
Fixed ovbcopy_ints to handle zero size.
[92/03/13            rpd]
[ ./kernel/kern/ipc_sched.c ]
Fixed thread_handoff to check for stack-privilege violations.
The old assertion isn't true with out-of-kernel default-pager.
[92/03/24            rpd]
[ ./kernel/kern/printf.c ]
Renamed gets to safe_gets.
[92/03/31            rpd]
[ ./kernel/kern/thread.c ]
Restored continuation in AST_TERMINATE case of thread_halt_self.
[92/03/22            rpd]
[ ./kernel/mac2/pmap.c ]
Removed pmap_remove_attributes.
[92/03/25            rpd]
[ ./kernel/mips/mips_misc.c ]
Removed mips_gets.
[92/03/31            rpd]
[ ./kernel/mips/pmap.c ]
Redid pmap_attributes and associated functions,
to fix bugs with multiple ranges in a single pmap.
[92/03/25            rpd]
[ ./kernel/mips/softfp.s ]
Ifdef'd out mips_bcopy, mips_bzero.
Fixed the log.
[92/03/14            rpd]
[ ./kernel/mips/swapgeneric.c ]
Replaced mips_gets with machine-independent safe_gets.
[92/03/31            rpd]
[ ./kernel/mips/trap.c ]
Changed trap to make all ADEL/ADES exceptions use
EXC_BAD_INSTRUCTION/EXC_MIPS_RESADDR.
[92/03/24            rpd]
[ ./kernel/src/config/mkmakefile.c ]
Changed read_files so that when files are duplicated,
the later definition overrides the earlier one.
[92/03/27            rpd]
[ ./kernel/src/makeboot/i386/exec.c ]
Include i386/exec.h instead of a.out.h to be 
consistent with bootstrap.
[92/03/18            jvh]
[ ./kernel/src/makeboot/mips/exec.c ]
Fixed to handle kernels with non-contiguous text and data.
[92/03/13            rpd]
[ ./kernel/src/mig/mig.sh ]
Added option -cc arg
It informs mig that it should use the C compiler driver to
call the preprocessor. The argument gives the name of the 
driver and the flags that make it preprocess.
[92/03/18            jvh]
[ ./kernel/sun3/setroot.c ]
Changed to use machine-independent safe_gets.
[92/03/31            rpd]
[ ./kernel/vax/setroot.c ]
Changed to use machine-independent safe_gets.
[92/03/31            rpd]
[ ./kernel/vm/vm_kern.c ]
Change kmem_io_map_copyout to handle multiple page lists.
Don't call pmap_change_wiring from kmem_io_map_deallocate.
[92/03/20  14:13:50  dlb]
[ ./kernel/vm/vm_map.c ]
Removed pmap_remove_attributes.
[92/03/25            rpd]
Always need vm_map_copy_discard_cont (not just NORMA_IPC).
Add continuation recognition optimization to vm_map_copy_discard
to avoid tail recursion when vm_map_copy_discard_cont is used.
[92/03/20  14:14:00  dlb]

Move inheritance arg check out of vm_map_inherit.
Its callers must do this.
[92/02/25  16:59:30  dlb]
[ ./kernel/vm/vm_object.c ]
Fixed vm_object_pager_wakeup to use ip_active.  From dlb.
[92/03/22            rpd]
[ ./user/libmach/err_bootstrap.sub ]
Created.
[92/03/09            rpd]
[ ./user/libmach/err_kern.sub ]
Added err_codes_device.
[92/03/09            rpd]
[ ./user/libmach/err_mach_ipc.sub ]
Added MIG_DESTROY_REQUEST.
[92/03/09            rpd]
[ ./user/libmach/error_codes.c ]
Added err_bootstrap.
[92/03/09            rpd]
[ ./user/libmach/mach_error_string.c ]
Updated do_compat for kernel device errors,
bootstrap file-system errors.
[92/03/09            rpd]
[ ./user/libmach/mach_msg_server.c ]
Added MIG_DESTROY_REQUEST.
[92/03/09            rpd]
[ ./kernel/chips/ecc.c ]
Created
[92/03/23            rvb]
[ ./kernel/chips/eccreg.h ]
Created
[92/03/23            rvb]
[ ./kernel/conf/MASTER.mips ]
Support for FORE INC. ATM Card == ecc
[92/03/30  22:43:47  rvb]
[ ./kernel/conf/files.mips ]
Add FORE ATM support.
[92/03/23            rvb]
[ ./kernel/device/disk_status.h ]
We add one more partition so that we can point to the "whole"
disk.  It is at slot MAXPARTITIONS.
[92/04/01            rvb]
[ ./kernel/i386at/autoconf.c ]
Use port 0x250, 0x350 for irq 5 bnc, thick respectively.
[92/04/02            rvb]
Tossing (0x3bc) below is the WRONG thing to do!!
[92/03/10            rvb]
[ ./kernel/i386at/grab_bob_label.c ]
Reviewed with and blessed (?) by af.
[92/04/01            rvb]
Merged bernadat's change to mainline.  Made conditional
on i386 vs AT386.
[92/03/16            rvb]
Add AT specific setstatus/getstatus flavors
to support vtoc, diskutil, verify ...
[92/03/04            bernadat]
[ ./kernel/i386at/if_ns8390.c ]
	Use port 0x250, 0x350 for irq 5 bnc, thick respectively.
[92/04/02            rvb]
[ ./kernel/i386at/iopl.c ]
Change mapping of mmap function to map 0x0, 0xa0000..0xfffff
directly.
[92/03/16            rvb]
[ ./kernel/i386at/lpr.c ]
Allow for stupid with more than one lpr as unit 0.
[92/03/10  10:22:40  rvb]
[ ./kernel/mips/PMAX/mips_box.c ]
To support the FORE ATM TurboChannel board.
[92/03/23            rvb]
[ ./kernel/mips/PMAX/tc.c ]
Support for FORE INC. ATM Board (ecc) board.
[92/03/30            rvb]
[ ./kernel/mips/conf.c ]
Add FORE ATM support.
[92/03/23            rvb]
[ ./kernel/scsi/rz.h ]
Fabricate extra partition info to deal with the
first alternate partition range and "PARITITON_ABSOLUTE".
[92/04/01            rvb]
[ ./kernel/scsi/rz_disk.c ]
With af, fixed berkeley label processing not to trash tgt->ior.
	Use PARTITION_ABSOLUTE to read absolute sectors from the 
disk, by reading/writing on the absolute partition.
[92/04/01            rvb]
Merged bernadat's change to mainline.  Made conditional
on i386 vs AT386.
[92/03/16            rvb]
Call machine dependant set_status/get_status
if flavor is not a known one.
[92/03/04            bernadat]
[ ./kernel/scsi/rz_labels.c ]
Let "grab_bob_label" return failure so we take the default.
[92/04/01            rvb]
[ ./kernel/i386at/if_ns8390.c ]
Use port 0x250, 0x350 for irq 5 bnc, thick respectively.
[92/04/02            rvb]
[ ./kernel/scsi/rz_disk.c ]
With af, fixed berkeley label processing not to trash tgt->ior.
Use PARTITION_ABSOLUTE to read absolute sectors from the 
disk, by reading/writing on the absolute partition.
[92/04/01            rvb]
Merged bernadat's change to mainline.  Made conditional
on i386 vs AT386.
[92/03/16            rvb]
Call machine dependant set_status/get_status
if flavor is not a known one.
[92/03/04            bernadat]
[ ./kernel/mips/pmap.c ]
Redid pmap_attributes and associated functions,
to fix bugs with multiple ranges in a single pmap.
[92/03/25            rpd]
[ ./kernel/i386at/boot/Makefile ]
Fabricated for 3.0
[92/03/30            mg32]
[ ./kernel/i386at/boot/README ]
From 2.5
[92/03/30            mg32]
[ ./kernel/i386at/boot/asm.s ]
Fix Intel Copyright as per B. Davies authorization.
[92/04/03            rvb]
From 2.5 boot: pruned inb(), outb(), and pzero().
[92/03/30            rvb]
[ ./kernel/i386at/boot/bios.s ]
Fix Intel Copyright as per B. Davies authorization.
[92/04/03            rvb]
From 2.5 version
[92/03/30            mg32]
[ ./kernel/i386at/boot/boot.c ]
Change date in banner.
[92/04/03  16:51:14  rvb]

Fix Intel Copyright as per B. Davies authorization.
[92/04/03            rvb]
From 2.5 version.
[92/03/30            mg32]
[ ./kernel/i386at/boot/boot.h ]
Fabricated from 3.0 bootstrap.  But too many things are global.
[92/03/30            mg32]
[ ./kernel/i386at/boot/boot2.s ]
From 2.5
[92/03/30            rvb]
[ ./kernel/i386at/boot/disk.c ]
Fabricated from 3.0 bootstrap and 2.5 boot disk.c:
with support for scsi
[92/03/30            mg32]
[ ./kernel/i386at/boot/io.c ]
Fixed for IBM L40's A20 initialization.
[92/03/30            rvb]

Created.
[92/03/30            mg32]
[ ./kernel/i386at/boot/rmaouthdr ]
From 2.5 boot
[92/03/30            mg32]
[ ./kernel/i386at/boot/start.s ]
Fix Intel Copyright as per B. Davies authorization.
[92/04/03            rvb]
Need to zero dh on hd path; at least for an adaptec card.
[92/01/14            rvb]

From 2.5 boot:
Flush digit printing.
Fuse floppy and hd boot by using Int 21 to tell
boot type (slightly dubious since Int 21 is DOS
not BIOS)
[92/03/30            mg32]
[ ./kernel/i386at/boot/sys.c ]
Fabricated from 3.0 bootstrap and scratch.
[92/03/30            mg32]
[ ./kernel/i386at/boot/table.c ]
Fix Intel Copyright as per B. Davies authorization.
[92/04/03            rvb]
Taken from 2.5 bootstrap.
[92/03/30            rvb]
[ ./kernel/i386at/boot/Makeconf ]
Created, as an empty file.
[ ./kernel/i386at/boot/boot.sed ]
From 2.5
[ ./kernel/i386/start.s ]
Changed #-style comments to /-style, for ANSI preprocessors.
[ ./kernel/kern/ipc_sched.c ]
Fixed thread_will_wait_with_timeout with convert_ipc_timeout_to_ticks,
so that rounding happens properly.
[92/04/04            rpd]
[ ./kernel/kern/ipc_sched.h ]
Added convert_ipc_timeout_to_ticks.
[92/04/04            rpd]
[ ./kernel/kern/syscall_subr.c ]
Fixed thread_switch argument types.
Fixed thread_depress_priority with convert_ipc_timeout_to_ticks,
so that rounding happens properly.
[92/04/04            rpd]
[ ./Directories/ALL ]
Added ./kernel/i386at/boot.
[92/04/04            rpd]
[ ./Directories/i386 ]
Added ./kernel/i386at/boot.
[92/04/04            rpd]
[ ./kernel/kern/syscall_subr.c ]
Fixed thread_switch argument types.
Fixed thread_depress_priority with convert_ipc_timeout_to_ticks,
so that rounding happens properly.
[92/04/04            rpd]
[ ./kernel/conf/Makefile.i386 ]
Removed definition for CC. It is instead defined in Makefile-compilers.
[92/03/17            jvh]
[ ./kernel/conf/Makefile.luna88k ]
Removed some definitions which come from Makefile-compilers now.
[92/03/27            rpd]
[ ./kernel/conf/Makefile.sun3 ]
Removed some definitions which come from Makefile-compilers now.
[92/03/27            rpd]
[ ./kernel/conf/Makefile.template ]
Added ${VOLATILE} to genassym.c processing.
[92/03/27            rpd]
Changed to use Makefile-common (for some definitions).
New cross-compilation support.
[92/03/18            jvh]
[ ./kernel/conf/Makefile.vax ]
Modified for cross-compilation technology.
[92/03/27            rpd]
[ ./kernel/vm/vm_map.c ]
Fixed vm_map_copyout_page_list to mark the pages dirty.  From dlb.
[92/04/05            rpd]
[ ./kernel/i386/interrupt.s ]
Converted from #-style to /-style comments, for ANSI preprocessors.
[92/04/05            rpd]
[ ./kernel/i386/locore.s ]
Converted from #-style to /-style comments, for ANSI preprocessors.
[92/04/05            rpd]
[ ./kernel/i386/ast.h ]
Added MACHINE_AST_PER_THREAD.  From dbg.
[92/04/05            rpd]
[ ./kernel/kern/ast.h ]
Fixed ast_context bug, with AST_PER_THREAD.  From dbg.
[92/04/05            rpd]
[ ./kernel/ipc/ipc_port.c ]
Fixed ipc_port_dealloc_special for ipc_space_reply.
Fixed ipc_port_set_seqno with ipc_port_lock_mqueue.
[92/04/05            rpd]
[ ./kernel/ipc/ipc_port.h ]
Fixed ip_msgcount overflow problem by changing it
and ip_qlimit to be mach_port_msgcount_t.
Added ipc_port_lock_mqueue.
[92/04/06            rpd]
[ ./kernel/intel/pmap.c ]
Its time to let us map page 0.
[92/04/03            rvb]
[ ./kernel/scsi/rz_cpu.c ]
On bad errors, be loquacious and decode all sense data.
Do not retry IO_INTERNAL operations, cuz we donno what it is.
[92/04/06            af]
[ ./kernel/scsi/rz_disk.c ]
On bad errors, be loquacious and decode all sense data.
Do not retry IO_INTERNAL operations, cuz we donno what it is.
[92/04/06            af]
[ ./kernel/scsi/rz_tape.c ]
Use scsi_print_sense_data where applicable.
[92/04/06            af]
[ ./kernel/scsi/scsi_alldevs.c ]
Added scsi_print_sense_data, and the big string table that goes
with it. Sigh.
[92/04/06            af]
[ ./kernel/man/ddb.man ]
Changes from OSF.
[92/01/17  14:19:22  jsb]
Changes for OSF debugger modifications.
[91/12/12            tak]
[ ./kernel/i386at/fd.c ]
Fixed fdprobe to loop longer.  From rvb.
[92/04/08            rpd]
[ ./kernel/vax/db_machdep.h ]
Added DB_ACCESS_LEVEL.
[92/04/08            rpd]
[ ./kernel/vax/db_interface.c ]
Added task argument to db_read_bytes and db_write_bytes.
[92/04/08            rpd]
[ ./Makeconf ]
Cross compilation support.
Added Makeconf-site.
[92/03/19            jvh]
[ ./Makefile ]
Fixed to do crt0.o early.
[92/04/01            rpd]

Added cross-compilation support.
[92/03/19            jvh]
[ ./Makefile-common ]
Added LIBENV, DEPENV.
[92/03/28            jvh]

Cross-compilation support.
[92/03/19            jvh]
[ ./Makefile-mkdirs ]
Added mkhidirs and mkhrdirs.
[92/03/23            rpd]
[ ./Makefile-mklinks ]
Changed to link directly to the proper directory,
instead of indirecting through an @sys link.
[92/03/23            rpd]

Remove machine link before making it.
[92/03/19            jvh]
[ ./Makefile-subdirs ]
Cross-compilation support.
[92/03/19            jvh]
[ ./bootstrap/Makefile ]
Changed to use LDLIBS.
[92/03/24            rpd]
[ ./include/Makefile ]
Added ns532 to ARCHS.
[92/03/26            jvh]
[ ./kernel/Makefile ]
Fixed vers.config creation for DG Unix.
[92/04/05            rpd]
[ ./kernel/src/config/Makefile ]
Added cross-compilation support.
[92/03/18            jvh]
[ ./kernel/src/doconf/Makefile ]
Added cross-compilation support.
[92/03/18            jvh]
[ ./kernel/src/makeboot/Makefile ]
Added cross-compilation support.
[92/03/18            jvh]
[ ./kernel/src/mig/Makefile ]
Removed obsolete sun3 and mac2 compiler options.
[92/03/23            rpd]

Added cross-compilation support.
[92/03/18            jvh]
[ ./user/libmach/Makefile ]
Fixed to remove tmp directory before creating it.
[92/03/18            jvh]
[ ./kernel/src/config/mkheaders.c ]
Removed gratuitous luna88k differences.
[92/04/09            rpd]
[ ./kernel/conf/files.luna88k ]
Removed some nonexistent files, to prevent pseudo-device header
configuration files from being generated.
[92/04/09            rpd]
    
    
    
==========================================================================
   ***** MK Version MK74  (danner) *****
    
    
New features:
--- --------

Default pager can now page an individual object across paging files (af).

Support for scsi cpu. (af)

Enhancements to ddb. Changed x/u to examine current user space, with
x/U examining in unsigned decimal. b/u, b/Tu will not insert breakpoints
in the kernel. Support for overlapping user and kernel address spaces.
(danner). w/u works, as does w/tu. Man page needs updated.

[LUNA88K]  Now boots UX multiuser single processor. Ethernet support.
Missing: devices, multiprocessor support. Optimization compilation now
possible. See luna notes below.

[PMAX] Added mappable timer for maxine (af). 

[PMAX] Preliminary support for Fore Systems ATM card (device type ecc)
(af,jcb,rvb).

[PMAX] Support for the Turbochannel timer card from NSC (jcb).

[PMAX] Serial line support on 3min, maxine. (af) 

Bug fixes:
--- -----

AST bug allowed two threads doing rapid handoff to block any other 
thread from running. Fix from Israel. (dbg)

[PMAX]	Various device fixes for the decstations. 

[LUNA88K] Many, many many.

Organizational changes:
-------------- -------

Loading of the bootstrap symbol table is now controlled by a config
option. Add bootstrap_symbols to have the kernel save the bootstrap
symbols.

Special notes:
------- -----

[LUNA88K] Now usable single processor. Running 2.5 ps or 2.5 /etc/swapon
may cause the system to crash. Contact danner for more information.

Build Log
---------

[I860] Not built, under advice of jsb.

[LUNA88K] 
	STD+ANY+HW_FOOTPRINT+lineno. 
		Built and booted (uniprocessor) on halfmoon. 

	STD+ANY+HW_FOOTPRINT+NORMA+norma ether.
		Built. Failed to boot.

[PMAX] 
	STD+ANY
		Built on disco. Booted on disco (3min), countach (maxine).
	STD+ANY+NORMA+norma_ether
		Built on disco. Booted on mc7 (3min). With UX35, fixes
		the kerberos problem. Norma functionality untested.

[I386]
	STD+WS
		Built and booted on doright (386).
	STD+WS+NORMA+norma_ether
		Built

[VAX]
	STD+VAX6bb
		Built on natasha. Booted on dbg (microvax).

[SUN3]
	STD+SWS
		Built and booted on rocky. May be problems
		with the kernel debugger.

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
74
[ ./include/Makefile-midevice ]
Added scsi/scsi_endian.h
[92/05/04            danner]
[ ./Makefile-common ]
Add LUNA88K_CDEBUGFLAGS 
[92/05/03            danner]
[ ./Makefile-config ]
Drop savearg and assert from default luna configuration.
[92/05/03            danner]
[ ./kernel/chips/lance.c ]
Type arguments of xcopy and xzero.
[92/05/03            danner]
Luna88k support. Added comments about byte order issues. 
 Time to port: 2 days.
[92/04/24            danner]
[ ./kernel/chips/lance.h ]
Added endianness support.
[92/04/21            danner]
[ ./kernel/conf/MASTER.luna88k ]
Added BOOTSTRAP_SYMBOLS option.
[92/05/03            danner]

Added lance (ln).
[92/04/21            danner]
[ ./kernel/conf/files ]
Added bootstrap_symbols option. When set, the bootstrap task
 symbols are preserved by the kernel debugger. Used in
 kern/bootstrap.c 
[92/05/03            danner]
[ ./kernel/conf/files.luna88k ]
Added lance support.
[92/04/21            danner]
[ ./kernel/ddb/db_break.c ]
Fixed b/tu to b/Tu work if the specified address is valid in the
 target address space but not the current user space. Explicit
 user space breakpoints (b/u, b/Tu, etc) will no longer get
 inserted into the kernel if the specified address is invalid. 
[92/04/18            danner]
[ ./kernel/ddb/db_examine.c ]
x/u now examines current user space. x/t still examines user
space of the the specified thread. x/tu is redundant. 
To examine an value as unsigned decimal, use x/U. 
[92/04/18            danner]
[ ./kernel/ddb/db_print.c ]
Converted some db_printsyms to db_task_printsyms.
[92/04/10            danner]
[ ./kernel/ddb/db_write_cmd.c ]
Reorganized. w/u now works, instead of just w/tu. 
[92/04/18            danner]
[ ./kernel/kern/ast.h ]
Changed AST_PER_THREAD definition (from dbg).
[92/05/03            danner]
[ ./kernel/kern/bootstrap.c ]
Set load_bootstrap_symbols from bootstrap_symbols option file. 
[92/05/03            danner]
[ ./kernel/luna88k/autoconf.c ]
Lance support. 
[92/05/03  16:45:17  danner]
[ ./kernel/luna88k/conf.c ]
Added ethernet.
[92/04/21            danner]
[ ./kernel/luna88k/db_interface.c ]
Corrections to db_task_va_to_phys
[92/05/03  16:42:38  danner]

Fixed typo into dm{a,t,d}2 printing.
[92/04/12            danner]
[ ./kernel/luna88k/db_machdep.h ]
Set DB_ACCESS_LEVEL to DB_ACCESS_ANY.
[92/04/18            danner]
[ ./kernel/luna88k/db_trace.c ]
Added 'f' flag to the stack trace command. When f is specifed
 (t/f), the stack pointer of each call frame is printed. 
[92/04/27            danner]
Support for tracing code without symbols. More AI in the
 kernel....
[92/04/13            danner]
Simplify (and correct) the address space selection code for
recursive stack trace calls.
[92/04/10            danner]
[ ./kernel/luna88k/locore/eh.c ]
Remove check_frame calls, clean up error handler.
[92/05/03            danner]
Remove debug code.
[92/04/26            danner]

Add save of r14, r15 to handoff_native_syscall.
[92/04/17            danner]
Remove debugging cruft.
[92/04/12            danner]
Debugging version, for posterity.
[92/04/12            danner]
Changed the emulation return to set the SNIP and SFIP to be the
 first two instructions of the emulation routine. 
[92/04/08            danner]
[ ./kernel/luna88k/locore/locore_asm_routines.c ]
Increased timeout on simple lock debugging.
[92/04/18            danner]
[ ./kernel/luna88k/luna_init.c ]
Correct version declaration.
[92/04/13  10:04:08  danner]

Print version.
[92/04/10  20:15:12  danner]
[ ./kernel/luna88k/machdep.c ]
Add phystokv for norma.
[92/05/03            danner]
Load_context now sets active_threads, active_stacks.
[92/04/30            danner]
[ ./kernel/luna88k/trap.c ]
More cleanup.
[92/05/03            danner]
debug
[92/04/09  19:04:41  danner]
[ ./kernel/luna88kdev/cons.c ]
Added SPLX protection in cnputc. Possibly gratuitous.
[92/05/03            danner]
[ ./kernel/luna88kdev/uart.c ]
Added initialization of t_stop field (from jfriedl). 
Updated copyright.
[92/04/30            danner]
[ ./kernel/mach/luna88k/syscall_sw.h ]
Unixoid traps (htg_syscall, task_by_pid) need different syscall stubs than 
mach kernel traps....
[92/04/14  14:02:06  danner]
[ ./kernel/mach/luna88k/thread_status.h ]
Added define of LUNA88K_EXC_STATE_COUNT
[92/04/30  13:43:23  danner]
[ ./kernel/motorola/m88k/endian.c ]
Add ntohl, ntohs, htons to support norma ether.
[92/05/03            danner]
[ ./kernel/motorola/m88k/m88100/continuation.s ]
Support for gcc 2.x's moptimize-arg-area switch. Simplify
 Switch_context.
[92/05/03            danner]
Performed instruction reordering in Switch_context suggested by
jfriedl.
[92/04/26            danner]
[92/04/12  16:24:48  danner]
[ ./kernel/motorola/m88k/m88100/exception_return.s ]
Remove debugging cruft. Leave argument save area in call to
 ast_taken.
[92/05/03            danner]
Remove debugging cruft.
[92/04/12            danner]
[92/04/12  16:25:32  danner]
[ ./kernel/motorola/m88k/m88100/pcb.c ]
Support for gcc 2.x's moptimize-arg-area switch.
[92/05/02            danner]

Add updating of active_stacks, current_thread and active_threads
 to switch_context. Add additional arguments to Switch_context
 call to simplify its implementation.

Add asserts to stack_handoff and switch_context.
[92/04/30            danner]
Added support for m88100_exc_state flavor in thread_getstatus
 (from jfriedl).
[92/04/30            danner]
Updated thread_getstatus to return all three program counters.
Thread_setstatus can now set both the snip and sfip.
[92/04/12            danner]
[ ./kernel/motorola/m88k/m88100/thread_status.h ]
Added missing M88100_EXC_STATE_COUNT (from jfriedl).
[92/04/30            danner]
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
Moved gimmeabreak out of disk write path....
[92/04/18            danner]
[ ./kernel/src/config/mkheaders.c ]
Increase length of string buffers.
[92/05/03            danner]
[ ./kernel/src/config/mkioconf.c ]
Increase string buffer lengths.
[92/05/03            danner]
[ ./user/libmach/Makefile ]
The unixoid trap cs files now have a define UNIXOID_TRAP 1 in
 them. This is for systems that need to generate different
 syscall stubs for unixoid and pure mach syscalls.
[92/04/14            danner]
[ ./user/libmach/luna88k/bcopy.c ]
Fixed nocpy() for cases when not 4-byte aligned and len < 4.
[92/04/19  16:33:44  jfriedl]
[ ./user/libmach/luna88k/fork.ss ]
Can't store return address in jump delay slot...
[92/04/13            danner]
Make constants hex.
[92/04/13            danner]
[ ./user/threads/luna88k/cthreads.h ]
Added inline cthread_sp()
[92/04/29            danner]
[ ./user/threads/luna88k/thread.c ]
Updated Copyright.
Set valid bit in sfip.
[92/04/12            danner]
[ ./kernel/ddb/db_sym.c ]
Rewrote db_search_task_symbol to deal more reasonably 
 with overlapping user and kernel address ranges.
[92/03/23  15:03:21  danner]
Complete rewrite of db_search_task_symbol logic to deal
 gracefully with the case of overlapping user and kernel address
 space.
[92/03/21            danner]
Upped MAXNOSYMTABS from 3 to 5. Now there is space for kernel,
 bootstrap, server, and emulator symbols - plus one for future
 expansion.
[92/03/21            danner]
[ ./kernel/luna88k/trap.c ]
Add continuations for user page faults.
[92/05/04            danner]
[ ./bootstrap/default_pager.c ]
For merge purposes, backed-out the unstable stuff.
[92/05/04  11:12:01  af]

Now we can page an object across partitions.
Initial rough ideas about automatically extending
paging space.
[92/03/11  02:23:58  af]
[ ./kernel/chips/bt455.c ]
Only use the 4 most significant bits in the Colormap, or
cursor color when setting the registers.
[92/04/10            moore]
[ ./kernel/chips/dtop_handlers.c ]
Fixed to not call autorepeat when invoked from debugger.
It might be too early (e.g. boothowto=0xc) for timeout().
[92/05/04            af]
[ ./kernel/chips/dtop_hdw.c ]
Fixed interrupt routine & spls.
Since t_addr is now used to check for presence of
a given line, make sure it is non-zero.
[92/05/04            af]
[ ./kernel/chips/dz_hdw.c ]
Adapted to new cons_simple_tint() interface.
Also, optimized to invoke the start routine less often.
[92/04/14  12:41:44  af]
[ ./kernel/chips/ims332.c ]
Unconditionally do the reset at init time.
Fixed blooper in loading cursor colors.
[92/04/14  11:53:29  af]
[ ./kernel/chips/scc_8530_hdw.c ]
Fixed how the interrupt routine plays with priorities.
Ask for buffering on all lines.
[92/05/04  11:15:43  af]

Fixed for more than just rconsole-ing.  Two bugs: the chip
needs one char out to generate the xmit-empty (so it really
is a xmit-done) interrupt, and the t_addr game was not played
properly.
Tested both on maxine and the two serial lines kmin has.
[92/04/14  11:47:26  af]
[ ./kernel/chips/serial_console.c ]
Check for existance of a line at open time.  When
using the same chip we might or not have the same
number of lines.
[92/05/04  11:23:52  af]

Changed cons_simple_tint() interface to take an extra all_sent
argument, which controls the unsetting of the BUSY flag.
This way we do not call the start routine too often.
Also, optimized frequent case where a set-status is done but
does not really change anything at all: it is *not* ok to
go off reset a chip if you do not have to, esp if modems.
[92/04/14  11:51:17  af]
[ ./kernel/chips/xcfb_hdw.c ]
Fixed setting of reset address (vdac_regs, not planemask!).
[92/04/14  11:54:42  af]
[ ./kernel/conf/MASTER.mips ]
From jcb
[92/05/04  11:42:57  af]
[ ./kernel/device/chario.c ]
Added (optional) delayed wakeup of receiver until
a minimum of chars present, or timeout.
[92/05/04  11:29:43  af]
[ ./kernel/device/cirbuf.c ]
Initialize c_hog.
[92/05/04            af]
[ ./kernel/device/cirbuf.h ]
Added c_hog.
[92/05/04  11:31:37  af]
[ ./kernel/device/tty.h ]
Made TTYHOG dinamically adjustable.
New flags for delayed char receive.
[92/05/04  11:30:59  af]
[ ./kernel/mips/PMAX/kn02_dma.c ]
Use aligned copies wherever possible.
[92/04/14  12:11:54  af]
[ ./kernel/mips/PMAX/kn02ba.c ]
Fix from Charles_Silvers@CS.CMU.EDU: copyin_gap32 was not
copying properly the last two bytes at the end of the loop.
[92/05/01            af]
[ ./kernel/mips/PMAX/maxine.c ]
Make dtop interruptible from serial lines.
[92/05/04  11:35:40  af]

Changes to make the serial line work for real.
[92/04/14  12:11:08  af]

Added mappable timer device.
[92/03/11  02:36:54  af]
[ ./kernel/mips/PMAX/maxine_cpu.h ]
Made dtop interruptible from serial lines.
[92/05/04  11:36:44  af]
[ ./kernel/mips/PMAX/maxine_cpu.s ]
Made dtop interruptible from serial lines.
[92/05/04  11:36:12  af]
[ ./kernel/mips/PMAX/mips_box.c ]
Added scsi-cpu links to other processors.
[92/04/14  12:10:07  af]

Added maxine's mappable timer.
[92/03/11  02:36:18  af]
[ ./kernel/mips/PMAX/model_dep.c ]
From jcb.
[92/05/04  11:38:27  af]
[ ./kernel/mips/PMAX/tc.c ]
From jcb.
[92/05/04  11:37:51  af]
[ ./kernel/mips/parse_args.c ]
Added setting of scsi-ids to use on the various busses.
[92/04/14  12:08:11  af]
[ ./kernel/mips/pmap.c ]
From jcb
[92/05/04            af]
[ ./kernel/scsi/scsi.c ]
Reduced reset delay; knows about not probing itself;
do not clear synch params on reset.
[92/05/04  17:17:45  af]
[ ./kernel/ddb/db_sym.c ]
Bulletproof db_search_in_task_symbol against symbol tables that return
success and huge offsets for address outside of their domain.

[ ./kernel/chips/frc.c ]
Added frc_set_address(), to customize it.
Makes NSC's boards happy (any TC box).
[92/04/13            jcb]
[ ./kernel/ddb/db_sym.c ]
typo correction
[ ./kernel/mips/db_mips_sym.c ]
X_db_symbol_names now uses db_last_symtab. 
[92/05/05            danner]

========================================================================
   ***** MK Version MK75  (jfriedl) *****

New features:
--- --------

Cleaned up many files (ones used in the luna88k build) to quiet gcc
warnings.  Also added ANSI prototypes under '#ifdef WANT_PROTOTYPES'.
Gcc version 2.x can compile in -traditional but still grok prototypes.
(jfriedl)

Modified mk makefile to pick up CONFIG (kernel configuration to build)
from the environment [from env. var. 'MKCONFIG'], if there.
(Mike Kupfer <kupfer@sprite.Berkeley.EDU>)

[PMAX]
New features: Support for 2D/3D board on DECStations, as per boards
already listed in the tc.c file. (af)

[PMAX]
Clear screen upon boot to reduce scrolling (and hence speed boot) (af).

Bug fixes:
--- -----

[PMAX]	mips/pmap.c merge botch (af)

[I386]  Fix the disabling of fifos (wrt mice)
	("Jordan K. Hubbard" <jkh@meepmeep.pcs.com>)

[SUN3]  Fixed some assembler syntax in locore.s to make gas happy.
	(Ian Dall <idall@eleceng.adelaide.edu.au>)

[SUN3]	Add restore of stack pointer before return to VECINTR()
	in asm_linkage.h.
	(Tim.Raymond@UVM.EDU)

Organizational changes:
-------------- -------

Directory kernel/chips/dec_lic created to hold DEC copyrighted
device drivers (af).

Build Log
----- ---
[I860] Not built.

[LUNA88K]
	STD+ANY+HW_FOOTPRINT+lineno
		Built and booted uniprocessor on amalia, hiroshima.

[I386]
	STD+WS
		Built and booted on doright.

	STD+SQT
	STD+WS+NORMA+norma_ether
	STD+WS+TEST
		Built. Untested.

[PMAX]
	STD+ANY
		Built. Booted on disco (5000/120)
	STD+ANY+TEST
		Built. Untested.

[SUN3]
	STD+SWS
		Built on rocky. Untested.

[VAX]
	STD+VAX6bb
		Built. Booted on dbg (u-vax).
	STD+16+fixpri+VAX6bb+BI+de
		Built. Untested.

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
75
[ ./kernel/luna88k/machdep.c ]
Cleaned up and de-linted.
Removed subyte() and fubyte() to luna88kdev/kbmain.c
Appended 'U' to constants that would otherwise be signed.
Made non-returning fcns volatile under gcc.
Brought contents of scb.h here; removed scb.h.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/chips/busses.c ]
Added prototypes.
[92/05/20            jfriedl]
Cleanup to quiet gcc warnings.
[92/05/16            jfriedl]
[ ./kernel/chips/lance.c ]
'#define dev_t unsigned' under MACH_KERNEL. It's heinous, but dev_t
is a short, and that'll have promotion problems between ANSI/std. 
Added prototypes.
[92/05/18            jfriedl]
Cleanup to quiet gcc warnings.
[92/05/16            jfriedl]
[ ./kernel/chips/lance.h ]
Removed comment start from within comment.
[92/05/16            jfriedl]
[ ./kernel/conf/Makefile.luna88k ]
Added hooks for using warnings, prototypes.
[92/05/21  15:34:45  jfriedl]
[ ./kernel/conf/files.luna88k ]
Removed references to
	luna88k/mem.c
	luna88k/ufs_machdep.c
	luna88k/vm_machdep.c
[92/05/18            jfriedl]
[ ./kernel/ddb/db_access.c ]
Made db_extend unsigned and made constants unsigned as well.
This make it the same in STDC and traditional. Also shuts up lint.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ddb/db_aout.c ]
     Added init for func_diff and line_diff in X_db_search_by_addr().
Also added proper decloration for that function.
Add prototypes.
[92/05/16            jfriedl]
[ ./kernel/ddb/db_break.c ]
     Removed unused variable from db_delete_cmd().
Added decloration for arg 'count' of db_add_thread_breakpoint().
Added prototypes.
[92/05/18            jfriedl]
[ ./kernel/ddb/db_command.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ddb/db_cond.c ]
Added prototypes.
Changed errant call of db_error in db_cond_cmd() to db_printf/db_error.
[92/05/20            jfriedl]
[ ./kernel/ddb/db_examine.c ]
Added void type to functions that needed it.
Added init to 'size' in db_search_cmd(). Removed unused variables.
Other cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ddb/db_expr.c ]
Removed unused variable from db_unary().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ddb/db_ext_symtab.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ddb/db_input.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ddb/db_lex.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/18            jfriedl]
[ ./kernel/ddb/db_macro.c ]
Removed unused variable from db_exec_macro().
Added include of <ddb/db_command.h>.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ddb/db_output.c ]
Added void type to functions that needed it.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ddb/db_output.h ]
Cleanup to quiet gcc warnings.
[92/05/18            jfriedl]
[ ./kernel/ddb/db_print.c ]
Removed unused variable from db_show_regs().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ddb/db_run.c ]
Removed unused variable 'bkpt' from db_clear_task_single_step().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ddb/db_sym.c ]
Cleanup to quiet gcc warnings.
	Changed CHAR arg of db_eqname to UNSIGNED.
Made arg types proper for db_line_at_pc().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ddb/db_task_thread.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ddb/db_trap.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ddb/db_variables.c ]
Added void to db_read_write_variable().
Removed unused variable 'func' from db_set_cmd().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ddb/db_watch.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ddb/db_write_cmd.c ]
Removed unused variable 'p' from db_write_cmd().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/device/blkio.c ]
Cleanup to quiet gcc warnings.
Function args to block_io are void.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/device/chario.c ]
Added void to fcns that still needed it.
Made CHAR args to ttyinput() and ttyoutput() UNSIGNED.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/device/cirbuf.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/device/dev_lookup.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/device/dev_name.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/device/dev_pager.c ]
Added void to fcns that still needed it.
Removed unsused variable 'result' from device_pager_setup()
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/device/device_init.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/device/disk_status.h ]
Appended 'U' to long constant.
[92/05/21  15:40:18  jfriedl]
[ ./kernel/device/ds_routines.c ]
Added prototypes.
Cleanup to quiet gcc warnings.
[92/05/20            jfriedl]
[ ./kernel/device/io_req.h ]
Changed cast of kfree's first arg in io_req_free() to
vm_offset_t from char* to mach reality (and shush gcc warnings).
[92/05/16            jfriedl]
[ ./kernel/device/net_io.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/device/subrs.c ]
Cleanup to quiet gcc warnings. Replaced strlen with a faster one.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ipc/ipc_entry.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ipc/ipc_entry.h ]
Appended 'U' to long constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/ipc/ipc_hash.c ]
Added prototypes.
Moved MACH_IPC_DEBUG includes above with the rest of the include.
[92/05/20            jfriedl]
[ ./kernel/ipc/ipc_init.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ipc/ipc_kmsg.c ]
Added void to fcns that needed it.  Renamed one of the two local
variables 'object' to 'obj' in ipc_kmsg_clean_partial to keep clean.
Added return after error in ipc_msg_print().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ipc/ipc_marequest.c ]
Added prototypes.
Moved IPC_DEBUG includes above prototypes.
[92/05/20            jfriedl]
[ ./kernel/ipc/ipc_mqueue.c ]
Made correct for when assert is off.
Also some cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ipc/ipc_notify.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ipc/ipc_object.c ]
Fixed for when assert() is a nop and to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ipc/ipc_object.h ]
Appended 'U' to long constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/ipc/ipc_port.c ]
Added a few things to shut up gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ipc/ipc_pset.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ipc/ipc_right.c ]
Added a few things to shut up gcc warnings.
Also make correct case when assert is off.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ipc/ipc_space.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ipc/ipc_splay.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ipc/ipc_table.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ipc/ipc_thread.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/ipc/mach_debug.c ]
Added some things to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ipc/mach_msg.c ]
Added some things to quite gcc warnings.
Also made correct for when assert is off.
Renamed vars 'timeout' to 'time_out' so as not to conflit with global.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/ipc/mach_port.c ]
Added some things to quite gcc warnings.
Also made correct for when assert is off.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/assert.h ]
Made Assert() volatile under gcc.
[92/05/16            jfriedl]
[ ./kernel/kern/ast.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/kern/ast.h ]
Put calls to aston/astoff in {} for safety.
[92/05/16            jfriedl]
[ ./kernel/kern/bootstrap.c ]
Removed unused variable 'port' from bootstrap_create().
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/debug.c ]
Added void type to functions that needed it.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/eventcount.c ]
Added void type to functions that needed it.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/exception.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/kern/host.c ]
Removed unused variable 'size_used' from host_processor_sets.
Added prototypes, changes to quiet gcc warnings.
[92/05/16            jfriedl]
[ ./kernel/kern/ipc_host.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/kern/ipc_kobject.c ]
Made correct for when assert is off.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/ipc_mig.c ]
Removed unsed var 'addr' from syscall_vm_deallocate.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/ipc_sched.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/kern/ipc_tt.c ]
Removed unsed var 'kr' from mach_ports_lookup().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/kalloc.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/kern/lock.c ]
Added void to functions that yet needed it.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/mach_clock.c ]
Added void to fcns that yet needed it.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/mach_factor.c ]
Added void to to compute_mach_factor().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/machine.c ]
Made non-returning fcns volatile under gcc. Added void to fcns
that still needed it.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/printf.c ]
Cleanup to quiet gcc warnings.
Changed PUTC arg of _doprnt, etc. to be VOID (which it is)
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/priority.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/kern/processor.c ]
Added void to funtions that still needed it.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/queue.c ]
Added prototypes.
Added void to fcns that still needed it.
[92/05/20            jfriedl]
[ ./kernel/kern/queue.h ]
     Removed coment starter from within comments to shut up gcc warnings.
[92/05/16            jfriedl]
[ ./kernel/kern/sched_prim.c ]
Added void to fcns that yet needed it.
Added init to 'restart_needed' in do_thread_scan().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/startup.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/kern/syscall_emulation.c ]
Added init to 'new_start' and 'new_end' to quite gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/syscall_emulation.h ]
     Removed coment starter from within comments to shut up gcc warnings.
[92/05/16            jfriedl]
[ ./kernel/kern/syscall_subr.c ]
Removed unused var 'result' in swtch_pri().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/syscall_sw.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/kern/task.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/kern/thread.c ]
Appended 'U' to constants that would otherwise be signed.
Changed name of one of the two local 'thread' variables in
processor_set_stack_usage() to 'tmp_thread' for cleanness.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/thread_swap.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/kern/time_stamp.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/timer.c ]
Made fcns void that needed it.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/kern/timer.h ]
Appended 'U' to constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/kern/xpr.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/kern/xpr.h ]
Added 'extern void xpr()', etc.
[92/05/16            jfriedl]
[ ./kernel/kern/zalloc.c ]
Added stuff to quiet some gcc warnings.
Added prototypes.
Moved MACH_DEBUG stuff above prototypes.
[92/05/16            jfriedl]
[ ./kernel/luna88k/autoconf.c ]
     Cleaned up and de-linted.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/luna88k/board.h ]
Appended 'U' to constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/luna88k/clock.c ]
     Cleaned up and de-linted.
Added prototypes.
Fixed call to gmtime() in resettodr() to pass the _address_.
[92/05/16            jfriedl]
[ ./kernel/luna88k/clock.h ]
moved dmsize[] to clock.c
[92/05/21  15:59:24  jfriedl]
[ ./kernel/luna88k/db_disasm.c ]
Appended 'U' to constants that would otherwise be signed.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/luna88k/db_interface.c ]
Cleaned up and de-linted.
Made CHAR args to db_putc() and luna_db_set_palette() UNSIGNED.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/luna88k/db_machdep.h ]
Appended 'U' to constants with high bit on.
[92/05/16            jfriedl]
[ ./kernel/luna88k/db_sstep.c ]
Appended 'U' to constants that would otherwise be signed.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/luna88k/db_trace.c ]
Added prototypes, other cleanup.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/luna88k/genassym.c ]
     Cleaned up and de-linted.
[92/05/16            jfriedl]
[ ./kernel/luna88k/jtermio.h ]
Cleaned up to quiet gcc warnings.
[92/05/21  16:03:45  jfriedl]
[ ./kernel/luna88k/locore/debug_msg.c ]
REMOVED
[92/05/21  16:05:57  jfriedl]
[ ./kernel/luna88k/locore/eh.c ]
Added _badwordaddr(addr) which is same as _badaddr(addr, 4).
[92/05/16            jfriedl]
[ ./kernel/luna88k/locore/locore.c ]
Added raw_putstr and raw_putchar.
[92/05/21  16:08:15  jfriedl]
[ ./kernel/luna88k/locore/locore.h ]
Appended 'U' to constants with high bit on.
[92/05/21  16:08:42  jfriedl]
[ ./kernel/luna88k/locore/locore_asm_routines.c ]
cleanup.
[92/05/21  16:09:11  jfriedl]
[ ./kernel/luna88k/locore/locore_c_routines.c ]
     Added a light-weight vsnprintf for debugging purposes.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/luna88k/luna_fp.c ]
removed some debugging code
[92/05/21  16:09:58  jfriedl]
[ ./kernel/luna88k/luna_init.c ]
     Cleaned up and de-linted.
Added prototypes.
Removed include of <jkdb.h>.
[92/05/16            jfriedl]
[ ./kernel/luna88k/mach_param.h ]
Some cleanup.
[92/05/21  16:10:42  jfriedl]
[ ./kernel/luna88k/machine_thread.c ]
Added prototypes.
[92/05/18            jfriedl]
[ ./kernel/luna88k/mem.c ]
some cleanup.
[92/05/21  16:11:33  jfriedl]
[ ./kernel/luna88k/pmap.c ]
Some cleanup for gcc warnings.
Appended 'U' to constants that would otherwise be signed.
	Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/luna88k/pmap.h ]
Made batc entries in struct pmap unions to allow access to them
as unsigned entities.
[92/05/18            jfriedl]
[ ./kernel/luna88k/pte.h ]
Appended 'U' to constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/luna88k/scb.h ]
gone.
[92/05/21  16:13:36  jfriedl]
[ ./kernel/luna88k/setroot.c ]
Added void decl, prototypes.
[92/05/16            jfriedl]
[ ./kernel/luna88k/softint.c ]
Added void type to fcns that needed. Some cleanup for gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/luna88k/sys_machdep.c ]
Added prototypes.
[92/05/18            jfriedl]
[ ./kernel/luna88k/trap.c ]
Added prototypes.
[92/05/18            jfriedl]
[ ./kernel/luna88k/ufs_machdep.c ]
gone
[92/05/21  16:15:18  jfriedl]
[ ./kernel/luna88k/vm_machdep.c ]
gone
[92/05/21  16:15:53  jfriedl]
[ ./kernel/luna88k/vmparam.h ]
Appended 'U' to constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/luna88kdev/compat_25.h ]
Appended 'U' to constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/luna88kdev/cons.c ]
Cleanup to quiet gcc warnings.
Made CHAR and DEV_T args to be UNSIGNED (ANSI/std problems).
Added prototypes.
[92/05/18            jfriedl]
[ ./kernel/luna88kdev/kbmain.c ]
     Changes to quite gcc warnings.
Changed UNSIGNED CHAR args to fcns to UNSIGNED.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/luna88kdev/msmain.c ]
Cleanup to quiet gcc warnings.
Changed CHAR and DEV_T args of fcns to UNSIGNED (ANSI/std problems)
Added prototypes.
[92/05/18            jfriedl]
[ ./kernel/luna88kdev/uart.c ]
Cleanup to quiet gcc warnings.
Changed UNSIGNED CHAR and DEV_T args to UNSIGNED (ANSI/std problems)
Removed unused flag argument from utclose.
Added prototypes.
[92/05/18            jfriedl]
Appended 'U' to constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/mach/luna88k/vm_param.h ]
Changed VM_MIN_KERNEL_ADDRESS to be just "0" (took off cast).
[92/05/18            jfriedl]
[ ./kernel/mach/memory_object.h ]
     Removed coment starter from within comments to shut up gcc warnings.
[92/05/16            jfriedl]
[ ./kernel/mach/message.h ]
Appended 'U' to constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/mach/port.h ]
Appended 'U' to constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/motorola/m88k/m88100/cmmu.c ]
Cleanup to quiet gcc warnings.
Have cmmu_get_idr() and cmmu_get() actually return a value.
Add prototypes.
[92/05/18            jfriedl]
[ ./kernel/motorola/m88k/m88100/pcb.c ]
Appended 'U' to constants that would otherwise be signed.
Fixed bug in setting count for flavor == M88100_EXC_STATE.
Removed unused variable 'stack' from stack_handoff().
	Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/motorola/m88k/m88100/psl.h ]
Appended 'U' to constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
Lots of cleanup to quiet gcc warnings.	Added prototypes.
Added init of 'len' and 'msgs' in spc_disconnect().
Some fcn calls had too many args.. commented out with / ** ** /.
Changed CHAR args of spc_select_target() and SPC_ACK() to UNSIGNED
to avoid ANSI/trad promotion problems.
[92/05/16            jfriedl]
[ ./kernel/scsi/rz.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/scsi/rz_cpu.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/scsi/rz_disk.c ]
Fixed return-value types (most now void).
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/scsi/rz_disk_bbr.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/18            jfriedl]
[ ./kernel/scsi/rz_labels.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/scsi/rz_tape.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/18            jfriedl]
[ ./kernel/scsi/scsi.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/scsi/scsi_alldevs.c ]
Cleanup to quiet gcc warnings.
Changed UNSIGNED CHAR args to scsi_print_add_sense_keys() to UNSIGNED.
Added prototypes.
[92/05/18            jfriedl]
[ ./kernel/scsi/scsi_cpu.c ]
Added prototypes.
Cleanup to quiet gcc warnings.
[92/05/20            jfriedl]
[ ./kernel/scsi/scsi_defs.h ]
Appended 'U' to constants that would otherwise be signed.
wakeup() is void.
	Other changes to quiet gcc warnings.
[92/05/16            jfriedl]
[ ./kernel/scsi/scsi_disk.c ]
Added prototypes.
Cleanup to quiet gcc warnings. Remove unused local variables.
[92/05/20            jfriedl]
[ ./kernel/scsi/scsi_printer.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/scsi/scsi_rom.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/scsi/scsi_tape.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/scsi/scsi_worm.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/sys/ioctl.h ]
Appended 'U' to constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/sys/reboot.h ]
Appended 'U' to constants that would otherwise be signed.
[92/05/16            jfriedl]
[ ./kernel/vm/memory_object.c ]
Added stuff to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/vm/vm_debug.c ]
Added stuff to quiet gcc warnings.
Also removed unused var 'kr' in mach_vm_region_info().
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/vm/vm_external.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/vm/vm_fault.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/vm/vm_init.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/vm/vm_kern.c ]
Added types for functions that didn't have them explicitly.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/vm/vm_map.h ]
Added cast to call of assert_wait in vm_map_entry_wait.
[92/05/16            jfriedl]
[ ./kernel/vm/vm_object.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/vm/vm_pageout.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
[ ./kernel/vm/vm_resident.c ]
Cleanup to quiet gcc warnings.
Added prototypes.
Moved MACH_DEBUG includes above prototypes.
[92/05/16            jfriedl]
[ ./kernel/vm/vm_user.c ]
Added prototypes.
[92/05/20            jfriedl]
[ ./kernel/luna88k/locore/locore.c ]
took out 'cpu=1' at start of slave.
[ ./kernel/i386at/com.c ]
Moved disable of FIFO in comprobe().
From Jordan K. Hubbard <jkh@meepmeep.pcs.com>
[ ./kernel/sun3/locore.s ]
From Ian Dall (idall@eleceng.adelaide.edu.au).
Changed syntax near mach_call_call to be acceptable to gas as well.
    "jsr a3@(4)@"  -->  "jsr a3@(4)@(0)"
[ ./kernel/sun3/asm_linkage.h ]
From Tim.Raymond@UVM.EDU
Added 'addqw #4,sp' before return in VECINTR [x2].
[ ./kernel/luna88k/ufs_machdep.c ]
REMOVED
[ ./kernel/luna88k/vm_machdep.c ]
REMOVED
[ ./kernel/luna88k/scb.h ]
REMOVED
[ ./kernel/mips/PMAX/gq_hdw.c ]
REMOVED
[ ./kernel/mips/PMAX/ga_hdw.c ]
REMOVED
[ ./kernel/mips/PMAX/gx_misc.c ]
REMOVED
[ ./Directories/ALL ]
Added ./kernel/chips/dec_lic.
[92/05/22            af]
[ ./Directories/mips ]
Added ./kernel/chips/dec_lic.
[92/05/22            af]
[ ./kernel/chips/bt455.c ]
Some fields in user_info_t got renamed.
[92/05/13  20:41:18  af]
[ ./kernel/chips/bt459.c ]
Made loading the cursor bitmap a bit faster.
[92/05/21  18:53:06  af]

A careful re-reading of the specs revealed that we
better poke th ereset *after* setting cmd-0, to
allow for the pipeline to settle properly.
Even if the prom already had it right.
[92/05/20  22:46:09  af]

Init function now takes an extra argument, to specify
what mux factor to use. On 2D/3D it is 5:1.
[92/05/13  20:45:06  af]
[ ./kernel/chips/cfb_hdw.c ]
Now all screens clearup at boot.
[92/05/21            af]
[ ./kernel/chips/cfb_misc.c ]
Avoid spls and use SCREEN_BEING_UPDATED instead.
[92/05/21  18:52:22  af]

bt459_init() changed its looks.
[92/05/13  20:42:50  af]
[ ./kernel/chips/dec_lic/ga_hdw.c ]
Made it work for real. Added some Ultrix code.
Moved in a copyright-infected directory.
[92/05/20            af]
[ ./kernel/chips/dec_lic/ga_misc.c ]
Disable interrupts on exit.
[92/05/20  22:53:19  af]

Created, with some Ultrix code.
[92/05/09            af]
[ ./kernel/chips/dec_lic/gq_hdw.c ]
Made it work for real, added some Ultrix code.
Moved in copyright-infected directory.
[92/05/16            af]
[ ./kernel/chips/dec_lic/gq_misc.c ]
Made it work for real.
[92/05/20  22:54:37  af]

Created, with some Ultrix code.
[92/05/09            af]
[ ./kernel/chips/dec_lic/gx_defs.h ]
Added a bunch of fields and defs for 3d board.
Fixed text foreground color to use colormap entry
no. 1, so that we can coexist with X11 running.
[92/05/20  23:01:02  af]

Created, with some Ultrix code.
[92/05/09            af]
[ ./kernel/chips/dec_lic/gx_misc.c ]
Took away spl protection around (very expensive) loading
of cursor bitmap. The bt459 does it fine-grain, and with
retry so it really was not necessary. Maxine was not happy.
Avoid spls and use SCREEN_BEING_UPDATED instead.
[92/05/21            af]
Added open routine, reverse video, fixed line insertion,
added callups to terminal emulator on scrolls (took a
while to figure this one out), added third return value
to SCREEN_GET_OFFSETS to tell if 3d board, spl protection
where needed, spruced up.
[92/05/20  22:59:00  af]

Created, with some Ultrix code.
[92/05/13            af]
[ ./kernel/chips/dec_lic/stamp.h ]
Spin longer, and less intensely.
[92/05/20  23:01:58  af]

Moved and adapted to 3.0 sources from 2.5 tree.
[92/05/10            af]
[ ./kernel/chips/dtop_handlers.c ]
Got autorepeat to work under X11: just generate two events
(up+down) instead of the single metronome one that would
not really work.
[92/05/20  22:43:35  af]
[ ./kernel/chips/dtop_hdw.c ]
Poll every 16usecs, as per specs.
[92/05/20  22:41:35  af]
[ ./kernel/chips/fb_hdw.c ]
Crear up the screen at boot time.
[92/05/13  20:43:29  af]
[ ./kernel/chips/fb_misc.c ]
Avoid spls and use SCREEN_BEING_UPDATED instead.
[92/05/21  18:51:46  af]
[ ./kernel/chips/ims332.c ]
Some fields in user_info_t got renamed.
[92/05/13  20:40:39  af]
[ ./kernel/chips/pm_hdw.c ]
Now all screens clearup at boot.
[92/05/21            af]
[ ./kernel/chips/pm_misc.c ]
Avoid spls and use SCREEN_BEING_UPDATED instead.
[92/05/21  18:55:06  af]

Cleaned out an empty function.
[92/05/13  20:42:12  af]
[ ./kernel/chips/screen.c ]
Avoid playing with the cursor when it's not the case.
[92/05/21  18:49:58  af]
[ ./kernel/chips/screen.h ]
Added SCREEN_BEING_UPDATED flag value.
[92/05/21  18:50:43  af]

Weird devices, weird fixes.
[92/05/20  22:47:05  af]

Various renames to make 2D/3D drivers work.
[92/05/13  20:46:35  af]
[ ./kernel/chips/xcfb_hdw.c ]
Now all screens clearup at boot.
[92/05/21            af]
[ ./kernel/chips/xcfb_misc.c ]
Avoid spls and use SCREEN_BEING_UPDATED instead.
[92/05/21  18:52:03  af]
[ ./kernel/conf/files.mips ]
Relocated files for 2D/3D driver, which now works.
[92/05/13  20:38:51  af]
[ ./kernel/mips/PMAX/maxine.c ]
Use Ultrix' name for the builtin screen.
[92/05/13  20:55:48  af]
[ ./kernel/mips/PMAX/mips_box.c ]
Typos on slaves 27.  Now Mark is happy.
[92/05/13            af]
[ ./kernel/mips/PMAX/pmag_ca.h ]
Created, from Ultrix 4.2 code.
[92/05/08            af]
[ ./kernel/mips/PMAX/pmag_da.h ]
Corrected some offsets. The bt459 one was actually right,
but we offset it by two bytes so that we get to read
off byte 0 as expected by existing cursor code.
[92/05/20  22:39:37  af]

Created, from Ultrix 4.2 code.
[92/05/08            af]
[ ./kernel/mips/PMAX/tc.c ]
Use Ultrix' name for Maxine's screen.
[92/05/13  20:55:02  af]
[ ./kernel/mips/pmap.c ]
Weird devices, weird fixes.
[92/05/19            af]
bmerge got confused and did not pick up jcb's fix to
the blooper in pmap_destroy_ranges().
[92/05/07            af]
[ ./kernel/mips/pmap.h ]
Weird devices, weird fixes.
[92/05/19            af]
[ ./kernel/scsi/rz_disk_bbr.c ]
Blooper, unterminated comment took away some (working, I swear)
code.  Found by Jeff Friedl.
[92/05/17            af]
[ ./Makefile-config ]
	From Mike Kupfer <kupfer@sprite.Berkeley.EDU>
Get the CONFIG from the environment, if possible.
[ ./kernel/conf/Makefile.luna88k ]
	Added hooks for using warnings, prototypes.
[ ./kernel/kern/ast.h ]
	Put calls to aston/astoff in {} for safety.
[ ./kernel/sundev/xy.c ]
Changes from Tim.Raymond@UVM.EDU: Didn't have macros howmany and MIN.
[ ./kernel/sunif/if_ie.c ]
Cleanup in iegetmem() for an apparently very old cpp.
[ ./user/threads/Makefile ]
From Mike Kupfer <kupfer@sprite.Berkeley.EDU>:
Enable CTHREAD_DATA for the kernel bootstrap program.
[ ./user/threads/cthreads.h ]
From Mike Kupfer <kupfer@sprite.Berkeley.EDU>:
Add declaration for cthread_wire().
Merge in Jonathan Chew's changes for thread-local data.
Use MACRO_BEGIN and MACRO_END.
[ ./user/threads/cthread_data.c ]
Snarfed from multi-server sources at CMU.
No stdio (for use with single-server).
[ ./kernel/vm/vm_map.c ]
Removed unused variables. Some cleanup to quiet gcc warnings.
Added prototypes.
[92/05/16            jfriedl]
    
    
    
==========================================================================
   ***** MK Version MK76  (rvb) *****
    
    
New features:
--- --------

I am basically syncing up i386 changes that I have had in my MK74 branch
for a while and felt a need to bring them to the mainline.

The system sucessfully compiled on a vax, sun, pmax, and i386.  It was only
tested on the latter two because those saw real changes.

[GENERAL]
	Bug fix for mapping character devices at nonzero offsets.

[PMAX]
	I installed the marginal support for the FORE ATM.

[I386]
   16Meg
	I have hacked "./kernel/i386at/model_dep.c" to not "see" more
	than 16Meg of memory because machines now are pretty likely to
	have more than 16Meg of memory and our dma devices will screw up.
	The two devices we supply that do dma are the floppy and the
	adaptec 1542b.  Until the dma gets rewritten, this is a cautious
	choice.  If you are sure you will never hit these devices, you can
	undo the change.
	
   IO PORTS
	Remove io_port from list before freeing it.   [jvh]

   SCSI DISK
	AHA 1542B fix bad interaction between scsi dma and floppy dma.
	Fix kernel printout and GETPARMS to return what the controller
	would report the disk geometry as.
	Fix to allow more than one scsi disk to probe succesfully.

    ESDI DISK
	handle multiple ESDI DISKS and ESDI + SCSI.

    ETHER
	3c503 - print ether type
	pc586 - we don't see wd8003Elite's memory and thing that
		there is a pc586.

    X11R5
	microsoft mouse - don't emulate 3rd button in kernel.

    LPR
	better probe.


******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
76
[ ./kernel/chips/ecc.c ]
Minimal support for mapping ecc fifo's.
[92/05/12  17:09:58  rvb]
[ ./kernel/chips/eccreg.h ]
Minimal support for mapping ecc fifo's.
[92/05/12  17:10:10  rvb]
[ ./kernel/device/dev_pager.c ]
Dropped offset field from dev_pager structure.
Not clear what it was there for, and the only
time it got a non-zero value we got screwed.
[92/06/01  14:24:19  af]
[ ./kernel/i386/iopb.c ]
Remove io_port from list before freeing it.
[92/06/29            jvh]
[ ./kernel/i386at/fd.c ]
There is a problem with ADAPTEC boards, where scsi disk dma will
lock out the floppy dma.  An expedient fix seems to be to drop
the DMA size for the floppy, in the retry code when/if this happens.
[92/07/08            rvb]
[ ./kernel/i386at/grab_bob_label.c ]
No need to print out the relation between capacity and stated geometry.
Also adjust GETPARMS answer's to the adaptec's view of reality.
[92/06/18            rvb]
tgt->unit_no is not set up correctly now; should use masterno instead
[92/05/22  17:31:10  rvb]
[ ./kernel/i386at/hd.c ]
Transcription error missed a line.
[92/06/23  11:16:20  rvb]

Setcontroller should be called synchronously with hd_start().  So
that the controller is idle.
[92/06/20            rvb]

Defer setcontroller(unit) to getvtoc();  So we only setcontroller()
what we open, not what we probe.  ESDI+SCSI messes up the device
count.
[92/06/18            rvb]
[ ./kernel/i386at/if_ns8390.c ]
Say whether EtherLink II is thick or thin.
[92/06/18            rvb]
[ ./kernel/i386at/if_pc586.c ]
Check for pc586 signature, rather than just for writable memory.
[92/05/18            rvb]
[ ./kernel/i386at/kd_mouse.c ]
Fix microsoft 2 button mouse emulation to ignore two buttons down
simultaneously and let X11R5 handle it.
[92/07/06            rvb]
[ ./kernel/i386at/lpr.c ]
More robust probe.  On some hardware, inb's
return 0x00 vs 0xff.
[92/06/18            rvb]
[ ./kernel/i386at/model_dep.c ]
GROSS temporary (?) hack to limit memory to 16Meg to not freak
out ISA machines doing dma.
[92/06/18            rvb]
    
    
    
==========================================================================
   ***** MK Version MK77  (cmaeda) *****
    
    
New features:
--- --------

Restartable Atomic Sequence support from Brian.

[PMAX]	  fast_tas: Use RAS technology to get a really fast test-n-set.

Special notes:
------- -----

Built and tested as follows:

[PMAX]
	STD+WS		built
			booted with ux37 on mc8 (ds5000/120)
			booted with ux37 on exxon-valdez (ds2100)
	STD+WS+fast_tas	built, booted with ux37 on mc8 and exxon-valdez
	STD+WS+TEST	built

[I386]
	STD+WS		built, booted with ux37 on bialetti
	STD+WS+TEST	built
	STD+SQT		built
	STD+WS+NORMA+norma_ether
			built, failed to boot on bialetti

[SUN3]
	STD+SWS		built, booted with ux37 on rocky

[VAX]
	STD+VAX6bb	built, booted with ux37 on dbg
	STD+16+fixpri+VAX6bb+BI+de
			built

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
77
[ ./bootstrap/default_pager.c ]
Added private version of set_ras_address for fast_tas support.
[92/05/11  14:31:52  cmaeda]
[ ./kernel/conf/MASTER ]
Added fast_tas option.
[92/05/11  14:32:25  cmaeda]
[ ./kernel/kern/sched_prim.c ]
Fast tas support: Check if current thread is in ras during thread_block.
[92/05/11  14:34:42  cmaeda]
[ ./kernel/kern/task.c ]
Added fast tas support:
	Added task_set_ras_pc.
	Inherit ras addresses when forking.
[92/05/11  14:36:17  cmaeda]
[ ./kernel/kern/task.h ]
Added fast tas addresses to task structure.
[92/05/11  14:36:52  cmaeda]
[ ./kernel/mach/mach.defs ]
Added definition for task_set_ras_pc.
Uses message number recycled from old task_get_io_port.
[92/05/11  14:37:53  cmaeda]
[ ./kernel/mach/syscall_sw.h ]
Added set_ras_address (a unixoid trap).
[92/05/11  14:38:24  cmaeda]
[ ./kernel/mips/trap.c ]
Turn off fast tas debugging messages.
[92/05/11  14:50:19  cmaeda]

Added recover_ras function.  Resets the pc of a thread
inside an ras to the beginning of the ras.
[92/05/11  14:39:46  cmaeda]
[ ./user/libmach/Makefile ]
Added set_ras_address to list of unixoid traps.
Added task_set_ras_pc to list of kernel traps.
[92/05/11  14:40:31  cmaeda]
[ ./user/threads/cthreads.c ]
In cthread_init, do machine dependent initialization if it's defined.
[92/05/11  14:41:08  cmaeda]
[ ./user/threads/mips/cthreads.h ]
Added mips-dependent init function.
[92/05/11  14:41:31  cmaeda]
[ ./user/threads/mips/lock.s ]
New implementation using ras technology.
[92/05/11  14:42:59  cmaeda]
[ ./user/threads/mips/thread.c ]
New initialization code for mutexes:
First try using an ras, then fall back on kernel-emulated tas.
[92/05/11  14:44:24  cmaeda]
[ ./kernel/conf/files ]
Added fast_tas option.

    
    
    
==========================================================================
   ***** MK Version MK78  (jfriedl) *****
    
    
New features:
--- --------

Added man page for task_set_ras_pc system call. [bershad]

bootstrap now prints the emulator and startup filenames [cmaeda]

Support (in machine "independent" files) for ns532 port. Machine dependent
files can be ftp'd from Helsinki Univ. of Tech.

[PMAX] fast_tas now part of default configuration [cmaeda]

[SEQUENT] Add "zd_devinfo" routine [jms]

[LUNA88K] lots of stuff (port in progress) [jfriedl]

Bug fixes:
--- -----

Removed silly prototypes

[i386] fixed i386/fpu.c to make critical variables volatile. 

[i386] Fixed bug in wd80xxget_board_id, that made the machine hang on
       reboot when using wd8013EP boards.  [kivinen]

[LUNA88K] lots of stuff (port in progress) [jfriedl]

Organizational changes:
-------------- -------

LUNA88K / M88K reorganization in progress.

Special notes:
------- -----

Built:
	i386_mach/special/mach.boot.MK78.STD+SQT*
	i386_mach/special/mach.boot.MK78.STD+WS*
	i386_mach/special/mach.boot.MK78.STD+WS+NORMA+norma_ether*
	i386_mach/special/mach.boot.MK78.STD+WS+TEST*

	m88k_mach/special/mach.boot.MK78.STD+LUNA+lineno+savearg*

	pmax_mach/special/mach.boot.MK78.STD+ANY*
	pmax_mach/special/mach.boot.MK78.STD+ANY+TEST*

	sun3_mach/special/mach.boot.MK78.STD+SWS*

	vax_mach/special/mach.boot.MK78.STD+16+fixpri+VAX6bb+BI+de*
	vax_mach/special/mach.boot.MK78.STD+VAX6bb*

Booted (successfully, even!)
	i386_mach/special/mach.boot.MK78.STD+WS*
	pmax_mach/special/mach.boot.MK78.STD+ANY*
	sun3_mach/special/mach.boot.MK78.STD+SWS*

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
78
[ ./kernel/conf/MASTER.mips ]
Added fast_tas to default mips configuration.
[92/08/01            cmaeda]
[ ./bootstrap/load.c ]
Hacked boot_load_program and read_emulator_symbols to print
the location of unix and emulator symbols.  This is to make
sure startup loads the emulator text from the same place as
the emulator symbol table.
[92/08/02            cmaeda]
[ ./kernel/i386at/if_ns8390.c ]
Fixed bug in wd80xxget_board_id, that made the machine hang on
reboot when using wd8013EP boards.
[92/07/13            kivinen]

[ ./kernel/mach/machine.h ]
[ ./kernel/src/config/config.h ]
[ ./kernel/src/config/config.y ]
[ ./kernel/src/config/main.c ]
[ ./kernel/src/config/mkmakefile.c ]
[ ./user/libmach/setjmp.h ]
Added pc532 support.

[92/05/15            jvh]
[ ./kernel/man/task_set_ras_pc.2 ]
Created by Brian Bershad
[92/08/03  13:52:42  mrt]
[ ./Makeconf ]
Support for luna88k->m88k change (some from danner).
[92/07/24            jfriedl]
[ ./Makefile-config ]
Support for luna88k->m88k change (some from danner).
Added pc532 support [Johannes Helander (jvh@cs.hut.fi)]
[92/07/24            jfriedl]
[ ./bootstrap/m88k/exec.c ]
Created from luna version. [danner]
[ ./bootstrap/m88k/exec.h ]
created from luna88k version  [danner]
cleaned up ROUND_SEG() [sugahara@omron.co.jp]
[ ./include/Makefile ]
Added m88k to ARCHS [danner]
[ ./include/luna88k/Makefile ]
Removed m88k references. Added lcd.h
[92/07/24            jfriedl]
[ ./include/m88k/Makefile ]
removed luna88k references.
[92/07/24            jfriedl]
[ ./kernel/conf/MASTER.luna88k ]
defunct
[92/07/24            jfriedl]
[ ./kernel/conf/MASTER.luna88k.local ]
defunct
[92/07/24            jfriedl]
[ ./kernel/conf/MASTER.m88k ]
 Added OMRON, RAW_PRINTF options.
 Revision 2.1.1.1  92/05/27  15:13:54  danner
[ ./kernel/conf/MASTER.m88k.local ]
added
[ ./kernel/conf/Makefile.m88k ]
added
[ ./kernel/conf/files.luna88k ]
Cleaned up. Added new files.
[92/08/03  14:44:01  jfriedl]
[ ./kernel/conf/files.m88k ]
	added [danner]
added.

[ ./kernel/kern/debug.c ]
Added pc532 support [Johannes Helander (jvh@cs.hut.fi)]
[92/08/02            jfriedl]

[ ./kernel/luna88k/clock.c ]
Fixed the clock/calendar code [inui@omron.co.jp]
Fixed CPU speed code [jfriedl]
[ ./kernel/luna88k/conf.c ]
Added support for /dev/ttya and /dev/kbd.
Added LCD support (from Nagaoka). Cleaned up.
[92/07/24            jfriedl]
[ ./kernel/luna88k/db_disasm.c ]
Include update. [danner]
[ ./kernel/luna88k/db_sstep.c ]
Header file updates. [danner]
[ ./kernel/luna88k/db_trace.c ]
Header file updates. [danner]
[ ./kernel/luna88k/eh.s ]
_pre_trap --> trap (now handled in trap.c)
[92/07/30            jfriedl]

Moved and renmaed from locore/eh.c.
[92/07/24            jfriedl]
[ ./kernel/luna88k/exec.h ]
Created luna copy [danner]
[ ./kernel/luna88k/lcd.h ]
created.
[92/07/24            jfriedl]
[ ./kernel/luna88k/locore.s ]
Moved and renamed from locore/locore.c
[92/07/24            jfriedl]
[ ./kernel/luna88k/locore/asm_utils.h ]
defunct
[92/07/24            jfriedl]
[ ./kernel/luna88k/locore/debug_msg.c ]
defunct
[92/07/24            jfriedl]
[ ./kernel/luna88k/locore/eh.c ]
defunct
[92/07/24            jfriedl]
[ ./kernel/luna88k/locore/exception_vectors.h ]
defunct
[92/07/24            jfriedl]
[ ./kernel/luna88k/locore/locore.c ]
defunct
[92/07/24            jfriedl]
[ ./kernel/luna88k/locore/locore.h ]
defunct
[92/07/24            jfriedl]
[ ./kernel/luna88k/locore/locore_asm_routines.c ]
38
[ ./kernel/luna88k/locore/locore_c_routines.c ]
[ ./kernel/luna88k/luna_fp.c ]
defunct
[92/07/24            jfriedl]
[ ./kernel/luna88k/luna_fp.s ]
Renamed from luna_fp.c
[92/07/24            jfriedl]
[92/07/24            jfriedl]
[ ./kernel/luna88k/pmap_table.c ]
Created [danner].
[92/07/24            jfriedl]
[ ./kernel/luna88k/rawprint_asm_routines.s ]
Created.
[92/07/24            jfriedl]
[ ./kernel/luna88k/rawprint_c_routines.c ]
Created.
[92/07/24            jfriedl]
[ ./kernel/luna88k/trap.c ]
Added watchpoint support.
[92/08/02            jfriedl]

[ ./kernel/luna88kdev/codetbl.h ]
renamed from .t file
[92/07/24            jfriedl]
[ ./kernel/luna88kdev/codetbl.t ]
defunct
[92/07/24            jfriedl]
[ ./kernel/luna88kdev/cons.c ]
Added flexability to support /dev/ttya as the console.
[92/07/24            jfriedl]
[ ./kernel/luna88kdev/deftbl.h ]
renamed from .t file
[92/07/24            jfriedl]
[ ./kernel/luna88kdev/deftbl.t ]
defunct
[92/07/24            jfriedl]
[ ./kernel/luna88kdev/esctbl.h ]
renamed from .t file
[92/07/24            jfriedl]
[ ./kernel/luna88kdev/esctbl.t ]
defunct
[92/07/24            jfriedl]
[ ./kernel/luna88kdev/keymap.h ]
renamed from .t file
[92/07/24            jfriedl]
[ ./kernel/luna88kdev/keymap.t ]
defunct
[92/07/24            jfriedl]
[ ./kernel/luna88kdev/lcd.c ]
Brought from Nagaoka. Completely redid for 3.0.
[92/07/24            jfriedl]
[ ./kernel/luna88kdev/pio.c ]
Brought from Mach 2.5.
[92/07/24            jfriedl]
[ ./kernel/m88k/asm.h ]
Brought to m88k directory.
[92/07/24            jfriedl]
[ ./kernel/m88k/ast.h ]
Created. [danner]
[ ./kernel/m88k/ast_types.h ]
Created from luna.
[92/07/24            jfriedl]
[ ./kernel/m88k/board.h ]
Created. [danner]
[ ./kernel/m88k/cpu_number.h ]
Moved from luna [danner]
[ ./kernel/m88k/db_machdep.h ]
Created m88k copy from luna [danner].
[92/07/24            jfriedl]
[ ./kernel/m88k/exec.h ]
Created
[92/07/24            jfriedl]
[ ./kernel/m88k/genassym.c ]
Created m88k copy from luna [danner].
[92/07/24            jfriedl]
[ ./kernel/m88k/lock.h ]
Created [danner]
[ ./kernel/m88k/mach_param.h ]
Created.
[92/08/03  15:04:31  jfriedl]
[ ./kernel/m88k/machparam.h ]
created [danner]
[ ./kernel/m88k/mmu.h ]
Created from Horizon Research version. [danner].
[92/07/24            jfriedl]
[ ./kernel/m88k/pmap.c ]
Created from Horizon Research version 1.6.
DBG is now undefined by default. [danner]
[ ./kernel/m88k/pmap.h ]
Created from Horizon Research version.
[92/07/24            jfriedl]
[ ./kernel/m88k/pmap_table.h ]
Created [danner]
[ ./kernel/m88k/setjmp.h ]
created [danner]
[ ./kernel/m88k/thread.h ]
Created m88k copy from luna [danner].
[92/07/24            jfriedl]
[ ./kernel/m88k/time_stamp.h ]
Created m88k copy from luna [danner].
[92/07/24            jfriedl]
[ ./kernel/m88k/vm_tuning.h ]
Created m88k copy from luna [danner].
[92/07/24            jfriedl]
[ ./kernel/m88k/xpr.h ]
Created m88k copy from luna [danner].
[92/07/24            jfriedl]
[ ./kernel/mach/luna88k/boolean.h ]
defunct.
[92/08/03  15:07:11  jfriedl]
[ ./kernel/mach/luna88k/exception.h ]
deleted.
[92/08/03  15:07:29  jfriedl]
[ ./kernel/mach/luna88k/kern_return.h ]
deleted
[92/08/03  15:07:40  jfriedl]
[ ./kernel/mach/luna88k/locore_c_routines.c ]
defunct.
[92/07/24            jfriedl]
[ ./kernel/mach/luna88k/syscall_sw.h ]
deleted.
[92/08/03  15:08:02  jfriedl]
[ ./kernel/mach/luna88k/thread_status.h ]
deleted.
[92/08/03  15:08:13  jfriedl]
[ ./kernel/mach/luna88k/vm_param.h ]
deleted.
[92/08/03  15:08:26  jfriedl]
[ ./kernel/mach/luna88k/vm_types.h ]
deleted.
[92/08/03  15:08:36  jfriedl]
[ ./kernel/mach/m88k/boolean.h ]
Created from luna88k version. 
[92/07/24            jfriedl]
[ ./kernel/mach/m88k/exception.h ]
added EXC_M88K_UNKNOWN
[92/07/30            jfriedl]

Created from luna88k version.
[92/07/24            jfriedl]
[ ./kernel/mach/m88k/kern_return.h ]
Created from luna88k version.
[92/07/24            jfriedl]
[ ./kernel/mach/m88k/syscall_sw.h ]
Created from luna88k version.
[92/07/24            jfriedl]
[ ./kernel/mach/m88k/thread_status.h ]
Created from luna88k version.
[92/07/24            jfriedl]
[ ./kernel/mach/m88k/vm_param.h ]
Created from luna88k version.
[92/07/24            jfriedl]
[ ./kernel/mach/m88k/vm_types.h ]
Created from luna88k version.
[92/07/24            jfriedl]
[ ./kernel/motorola/m88k/m88100/cmmu.c ]
Cmmu_cpu_num fixes for 3.0 [jfriedl]
Picked up new version from H R. Extensive changes.[danner]
[ ./kernel/motorola/m88k/m88100/continuation.s ]
Adjusted references from luna88k/locore/* --> luna88k/*
[92/07/24            jfriedl]
[ ./kernel/motorola/m88k/m88100/exception_return.s ]
Update includes, changed to new style manifiest constants [danner]
[ ./kernel/motorola/m88k/m88100/kern_setjmp.h ]
created [danner]
[ ./kernel/motorola/m88k/m88100/m882xx.h ]
Add defines of INST_CMMU, DATA_CMMU for new pmap module. [danner]
[ ./kernel/motorola/m88k/m88100/misc.s ]
created [danner]
[ ./kernel/motorola/m88k/m88100/pcb.c ]
Support for new pmap module [danner]
[ ./kernel/motorola/m88k/m88100/psl.h ]
changed ifndef to depend on ASSEMBLER. [danner]
[ ./kernel/motorola/m88k/trap.h ]
watchpoint support
[92/07/31            jfriedl]
[ ./kernel/motorola/m88k/va-m88k.h ]
Installed from gcc 2.1 release [danner].
[92/07/24            jfriedl]
[ ./kernel/src/makeboot/m88k/exec.c ]
moved from luna88k. [danner]
[92/07/24            jfriedl]
[ ./user/libmach/m88k/_setjmp.s ]
brought from luna88k versions [danner]
[ ./user/libmach/m88k/bcopy.c ]
brought from luna88k versions [danner]
[ ./user/libmach/m88k/bzero.c ]
brought from luna88k versions [danner]
Created
[91/07/20            danner]
[ ./user/libmach/m88k/crt0.c ]
Flushed silly version that was here.
Brought my normal crt0.c and updated for 3.0
[92/08/02            jfriedl]
[ ./user/libmach/m88k/fork.s ]
brought from luna88k versions [danner]
[ ./user/libmach/m88k/movstrHI15x.s ]
brought from gcc source [danner]
[ ./user/libmach/m88k/movstrHI48x.s ]
brought from gcc source [danner]
[ ./user/libmach/m88k/movstrQI16x.s ]
brought from gcc source [danner]
[ ./user/libmach/m88k/movstrSI45x.s ]
brought from gcc source [danner]
[ ./user/libmach/m88k/movstrSI46x.s ]
brought from gcc source [danner]
[ ./user/libmach/m88k/movstrSI47x.s ]
brought from gcc source [danner]
[ ./user/libmach/m88k/movstrSI64n.s ]
brought from gcc source [danner]
[ ./user/libmach/m88k/movstrSI96x.s ]
brought from gcc source [danner]
[ ./user/threads/cthread_internals.h ]
Made state element of struct cproc volatile.
[92/08/02            jfriedl]
[ ./user/threads/m88k/csw.s ]
brought from luna88k versions [danner]
[ ./user/threads/m88k/cthread_inline.awk ]
	brought from luna88k versions [danner]

 Revision 2.2  91/08/24  12:33:53  af
 	Revision 2.1  91/07/11  17:24:50  danner
 	Created.
 
 
[ ./user/threads/m88k/cthreads.h ]
brought from luna88k versions [danner]
Redid cthread_sp() for gcc2 [jfriedl]
[ ./user/threads/m88k/lock.s ]
brought from luna88k versions [danner]
[ ./user/threads/m88k/thread.c ]
brought from luna88k versions [danner]
Created by rwd
[91/08/19  13:49:41  danner]
[ ./kernel/conf/Makefile.luna88k ]
Removed (now unneeded) special rules. Cleaned up.
Added ${SITE_M88K_CFLAGS} to DEFINES.
Condensed history.
[92/07/24            jfriedl]
[ ./kernel/luna88k/db_interface.c ]
added watchpoint support.
[92/07/31            jfriedl]

Test for pmap_initialized in db_{read,write}_bytes. [danner]
Fixed luna_db_print_frame for data exceptions [jfriedl]
[ ./kernel/luna88k/luna_init.c ]
Replaced call of luna_db_set_palette to bm_set_palette_colors.[jfriedl]
Merged with 2.7. Changes for new pmap module. [danner]
[ ./kernel/luna88k/machdep.c ]
Brought my bitmap palette stuff from dd_interface.
Adjusted int_mask_reg to be "volatile int *" rather than the
incorrect "int * volatile". Updated includes to include m88k
rather than luna88k versions if available.
[92/07/24            jfriedl]
[ ./kernel/luna88k/pio.h ]
Cleaned up (but still ways to go).
[92/07/24            jfriedl]
[ ./kernel/luna88k/locore.h ]
Moved from locore/locore.h
[92/07/24            jfriedl]
[ ./kernel/luna88k/exception_vectors.h ]
Moved from locore/exception_vectors.h
[92/07/24            jfriedl]
[ ./kernel/luna88k/locore_asm_routines.s ]
Moved and renamed from locore/locore_asm_routines.c
[92/07/24            jfriedl]
[ ./kernel/luna88k/locore_c_routines.c ]
Moved from locore directory.
[92/07/24            jfriedl]
[ ./kernel/luna88kdev/kbmain.c ]
#include <file.t> now <file.h>
[92/07/24            jfriedl]
[ ./user/libmach/Makefile ]
Added PURE_M88K_OBJS [jfriedl]
Changed SA_LUNA88K_OBJS to SA_M88K_OBJS [danner]
[ ./user/libmach/m88k/gcc.c ]
brought from luna88k versions [danner]
[ ./Makefile-common ]
Support for luna88k->m88k change (some from danner).
[92/07/24            jfriedl]
[ ./kernel/sqtzdc/zd.c ]
Add "zd_devinfo" routine.
[92/08/03  14:36:10  jms]
[ ./kernel/sqtconf/conf.c ]
Add "zd_devinfo" to "zd" disk driver description record.
[92/08/03  14:34:21  jms]
[ ./Directories/ALL ]
dded m88k directories.
[92/08/03            jfriedl]
[ ./Directories/luna88k ]
pdated copyright. Added new m88k directories.
[92/08/03            jfriedl]
[ ./kernel/kern/sched_prim.c ]
Added call to  machine_idle in idle loop if power_save option is
selected.
[92/08/05            mrt]
[ ./kernel/conf/MASTER ]
Added power_save option to trigger machine dependent ways
of conserving power when machine (or parts of it) are idle.
[92/08/05            mrt]
[ ./kernel/conf/files ]
Added power_save option to trigger machine independent
power conservation functions.
[92/08/05            mrt]
[ ./kernel/i386/fpu.c ]
Added volatile to declarations of fp_inifinity, fp_one, fp_zero
to prevent the code from being optimized away. 
Fix from Michael Bushnell - FSF
[92/08/06            jfriedl]
    
    
    
==========================================================================
   ***** MK Version MK79  (danner) *****
    
    
New features:
--- --------

This is an intermediate merge done for internal purposes only.
Several things are still broken.

New architecture and platform support:

	alpha - ADU, partial flamingo [af,jefferyh]
	sparc - sun4c [berman]
	i386  - ibm ps/2 microchannel boxes [mja et al]

64 bit safe. sizeof(void *) > sizeof(int) works. [af]

Ansi prototypes for many kernel files. [many]

Mig output is much cleaner and ansi [pds].
Ansi cpp cleanups [danner,pds]

The luna is now quite viable [jfriedl]

Pc sampling interface [rvb,cmeada]

Pseudo dma support for ttylines. [af,danner]

New build enviroment. A nuisance at cmu, but distributable to
the outside world [mrt].

Multiple atomic sequences per address space. 
New task_ras_control interface. [bershad]

The attach function in chips/busses.h now is of type void. [danner]

The map function in device/conf.h now returns vm_offset_t. [af]

Introduction of natural_t and integer_t. [af]
Introduction of spl_t. [dbg]

Ddb can now support multiple symbol table formats at once. [af,dbg]

Machine independent multiprocessor ddb support [dbg].

[PMAX] New atm code [jcb,bershad]. Dropped old ecc device.

[PMAX] Dec Desktop bus support for maxine and friends. The keyboard will now 
beep [jtp@hut.fi]


Bug fixes:
--- -----

Multi and Uniprocessor eventcount fixes. [af,jfriedl,dbg,bershad,danner]

Processor set code works again. [dbg]

Many mp locking bugs found by the multiserver [jms,dpj,dbg]

The standalone printf is protected against use before printf_init. [danner]

Default pager DEBUG works again [pds]

[I386] locore bug, disable broken fifo code. [dbg,rvb]

Many others.

Organizational changes:
-------------- -------

Converted to ODE make.
Everyone now compiles with gcc-2.3.3.
Everyone now compiles with -O2 -g, so all the kernel debuggers get
line numbers. This makes the kernels a bit bigger on the i386.

Special notes:
------- -----

Build/boot status:

[I386]	STD+WS STD+SQT: build and booted (turtles,boris)
	STD+PS2	      : builds but does not boot

[SUN3]  STD+SWS	      : builds, boots w/o ethernet (rocky)

[VAX]	STD+VAX6bb    : builds and boots (dbg)

[PMAX]  STD+ANY	      : builds and boots (5000/200,5000/120)

[ALPHA] STD+ANY	      : cross building from pmax - broken. Adu only.

[LUNA]  STD+WS	      : builds and boot (halfmoon)

[SPARC] STD+SWS	      : builds and boots single user (sun2)

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
79
[ ./Directories/ALL ]
Added alpha directories.
[92/11/30            af]
[ ./Directories/alpha ]
Created.
[92/12/10            af]
[ ./Makeconf ]
Added DEC Alpha.
[92/11/30            af]
[ ./Makeconf-site.mtoa ]
Created.
[92/12/10            af]
[ ./Makefile-common ]
Updated CDEBUGFLAGS for gcc.
[93/01/12  15:43:03  danner]

LDLIBS/LDFLAGS fixups for gcc. 
[92/12/28            danner]
Support for Alpha.  This first version is for cross-compilation
from a mips box, GCC native will follow.
[92/11/30            af]
Changed mips to compile with gcc.
[92/11/06  04:17:07  cmaeda]
[ ./Makefile-config ]
Added Alpha.
[92/11/30            af]
[ ./Makefile-xstrip ]
Changed default compiler optimization flags.
[93/01/11            danner]
Alpha support, cross compiler.
[92/11/30            af]
Changed mips to compile with gcc.
[92/11/06  04:17:44  cmaeda]
[ ./bootstrap/alpha/exec.c ]
Created.
[92/05/31            af]
[ ./bootstrap/bootstrap.c ]
Fixed atoi to match ANSI prototype.
[92/06/30            pds]
Alpha needs a bigger stack, apparently.
[92/11/30            af]
[ ./bootstrap/default_pager.c ]
Removed prints in set_ras_address.
[93/01/11            danner]
64bit cleanup.
[92/11/30            af]
[ ./bootstrap/defs.h ]
64bit clean. Assumes 32bit filesystem. Breaks 16bit systems(PDP-11).
[92/11/30            af]
[ ./bootstrap/dir.h ]
64bit clean. Assumes 32bit filesystem. Breaks 16bit systems(PDP-11).
[92/11/30            af]
[ ./bootstrap/disk_inode.h ]
64bit clean. Assumes 32bit filesystem. Breaks 16bit systems(PDP-11).
[92/11/30            af]
[ ./bootstrap/file_io.c ]
64bit clean.  Just type-bug fixes, actually.
[92/11/30            af]
[ ./bootstrap/fs.h ]
64bit clean. Assumes 32bit filesystem. Breaks 16bit systems(PDP-11).
[92/11/30            af]
[ ./bootstrap/kalloc.c ]
Fixed malloc and free stubs to match ANSI standard.
[92/06/17            pds]
Keep an eye on memory usage if DEBUG.
[92/12/10            af]
[ ./bootstrap/load.c ]
64bit clean.  Removed uppity check on file mode bits.
[92/11/30            af]
[ ./bootstrap/mach/default_pager.defs ]
Added master_device_port argument to paging_file.
Added default_pager_register_fileserver.
[92/12/10            af]
[ ./bootstrap/mach/default_pager_helper.defs ]
Created.
[92/12/10            af]
[ ./bootstrap/mach/default_pager_types.defs ]
64bit cleanup.
[92/12/10  14:39:41  af]
[ ./include/Makefile ]
Added mach/mig_support.h.
[92/12/14            pds]
Alpha support.
[92/11/30            af]
[ ./include/Makefile-machine ]
Added machdep machine_types (for MiG).
[92/11/30            af]
[ ./include/alpha/Makefile ]
Created.
[92/12/10  14:42:10  af]
[ ./include/luna88k/Makefile ]
Added luna88k/fb.h as a released include file.
[92/12/08            jfriedl]
[ ./kernel/Makefile ]
Added rmlinks to the list of targets to be passed to the
recursive make.
[92/11/30            jvh]
[ ./kernel/alpha/DEC/adu.c ]
Created, from the DEC specs:
"Alpha Demonstration Unit Specification"
V1.0, Aug 1990.
[92/06/02            af]
Created.
[92/12/10            af]
[ ./kernel/alpha/DEC/adu_se.c ]
Created, from the DEC specs:
"Alpha Demonstration Unit Specification"
V1.0, Aug 1990.
[92/06/02            af]
[ ./kernel/alpha/DEC/adu_sl.c ]
Created, from the DEC specs:
"Alpha Demonstration Unit Specification"
V1.0, Aug 1990.
[92/06/02            af]
[ ./kernel/alpha/DEC/alpha_box.c ]
Created.
[92/12/10  15:24:33  af]
[ ./kernel/alpha/DEC/model_dep.c ]
Created.
[92/06/02            af]
[ ./kernel/alpha/DEC/scsi_ADU.h ]
Created, from the DEC specs:
"Alpha Demonstration Unit Specification"
V1.0, Aug 1990.
[92/06/02            af]

Created.
[92/12/10            af]
[ ./kernel/alpha/DEC/scsi_ADU_hdw.c ]
Cleanup a bit: avoid copies when possible, support more
than one target, argue that it should be MP safe.
Still have to beat on it for real.
[92/12/25            af]

Created, from the DEC specs:
"Alpha Demonstration Unit Specification"
V1.0, Aug 1990.
[92/06/02            af]
Created.
[92/12/10  15:26:16  af]
[ ./kernel/alpha/DEC/tvbus.c ]
Created, from the DEC specs:
"Alpha Demonstration Unit Specification"
V1.0, Aug 1990.
[92/06/02            af]
[ ./kernel/alpha/DEC/tvbus.h ]
Created, from the DEC specs:
"Alpha Demonstration Unit Specification"
V1.0, Aug 1990.
[92/06/02            af]
[ ./kernel/alpha/alpha_cache.s ]
Added reference to documentation source(s).
[92/12/16  15:10:16  af]

Created.
[92/12/10  14:47:59  af]
[ ./kernel/alpha/alpha_copyin.s ]
Added reference to documentation source(s).
[92/12/16  15:10:27  af]

Created.
[92/12/10  14:48:32  af]
[ ./kernel/alpha/alpha_cpu.h ]
Added reference to documentation source(s).
[92/12/16  15:10:40  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/alpha_cpu.s ]
Added reference to documentation source(s).
[92/12/16  15:10:52  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/alpha_init.c ]
Set vm_page_big_pagenum to support vm_page_grab_contiguous_pages.
[92/12/25  01:42:54  af]

Added reference to doc for the HWRPB &co.
[92/12/22            af]
Added reference to documentation source(s).
[92/12/16  15:11:03  af]

Created.
[92/06/03            af]
[ ./kernel/alpha/alpha_instruction.c ]
Added reference to documentation source(s).
[92/12/16  15:11:14  af]

Created.
[92/06/01            af]
[ ./kernel/alpha/alpha_lock.s ]
Try_lock should try harder, until either wins it or lose it.
[92/12/24            af]
Added reference to documentation source(s).
[92/12/16  15:11:28  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/alpha_mem_ops.c ]
Created.
[92/12/10  14:50:41  af]
[ ./kernel/alpha/alpha_misc.c ]
Created.
[92/06/02            af]
[ ./kernel/alpha/alpha_scb.c ]
Added reference to documentation source(s).
[92/12/16  15:11:48  af]

Created.
[92/06/03            af]
[ ./kernel/alpha/alpha_scb.h ]
Added reference to documentation source(s).
[92/12/16  15:11:38  af]

Created.
[92/06/03            af]
[ ./kernel/alpha/alpha_startup.c ]
Created.
[92/06/05            af]
[ ./kernel/alpha/ast.h ]
Created.
[92/05/31            af]
[ ./kernel/alpha/ast_check.c ]
Copied from dbg's i386 file.
[92/11/20            af]
[ ./kernel/alpha/ast_types.h ]
Created.
[92/12/10            af]
[ ./kernel/alpha/autoconf.c ]
Added reference to documentation source(s).
[92/12/16  15:11:55  af]

Created.
[92/12/10  14:53:51  af]
[ ./kernel/alpha/clock.c ]
Added reference to documentation source(s).
[92/12/16  15:12:06  af]

Created.
[92/06/03            af]
[ ./kernel/alpha/coff.h ]
Adapted for Alpha.
[92/05/31            af]
[ ./kernel/alpha/conf.c ]
Created.
[92/12/10  14:54:50  af]
[ ./kernel/alpha/context.h ]
Added reference to documentation source(s).
[92/12/16  15:12:17  af]

Created.
[92/05/31            af]
[ ./kernel/alpha/context.s ]
Added reference to documentation source(s).
[92/12/16  15:12:29  af]

Created.
[92/12/10  14:55:23  af]
[ ./kernel/alpha/cpu_number.h ]
Created.
[92/12/10  14:55:43  af]
[ ./kernel/alpha/db_alpha_sym.c ]
Created, from mips version.
[92/05/31            af]
[ ./kernel/alpha/db_disasm.c ]
Added reference to documentation source(s).
[92/12/16  15:12:39  af]

Created.
[91/12/05            af]
[ ./kernel/alpha/db_interface.c ]
Added reference to documentation source(s).
[92/12/16  15:13:59  af]

First cut at using new MI multiP code. Not fully satisfactory.
[92/12/16  12:47:05  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/db_machdep.h ]
Added reference to documentation source(s).
[92/12/16  15:14:10  af]

Added SAVE/RESTORE macros for multiP usage.
[92/12/16  12:43:09  af]

Created.
[92/05/31            af]
[ ./kernel/alpha/db_trace.c ]
Now we can do a "!db_all_cprocs($task2)".
Also, we properly trace ALL cthreads, wired ones included.
[92/12/22  03:09:43  af]

Created, from mips version.
[92/06/01            af]
[ ./kernel/alpha/db_trace.h ]
Created, from my mips version.
[92/06/01            af]
[ ./kernel/alpha/exec.h ]
Created.
[92/12/10  14:57:43  af]
[ ./kernel/alpha/ffs.s ]
Added reference to documentation source(s).
[92/12/16  15:14:20  af]

Created.
[91/12/29            af]
[ ./kernel/alpha/frame.h ]
Added reference to documentation source(s).
[92/12/16  15:15:15  af]

Created.
[92/06/03            af]
[ ./kernel/alpha/genassym.c ]
Created.
[92/05/31            af]
[ ./kernel/alpha/lock.h ]
Created.
[92/11/20            af]
[ ./kernel/alpha/locore.s ]
Added reference to documentation source(s).
[92/12/16  15:15:22  af]

Created.
[92/06/03            af]
[ ./kernel/alpha/mach_param.h ]
Added reference to documentation source(s).
[92/12/16  15:15:30  af]

Created.
[92/05/31            af]
[ ./kernel/alpha/machparam.h ]
Created.
[92/06/02            af]
[ ./kernel/alpha/parse_args.c ]
Created empty.
[92/12/10            af]
[ ./kernel/alpha/pcb.c ]
Added reference to documentation source(s).
[92/12/16  15:15:36  af]

Created.
[92/12/10  14:59:58  af]
[ ./kernel/alpha/pmap.c ]
Added reference to documentation source(s).
[92/12/16  15:17:39  af]

Support for new MI multiP ddb.  Code probably belongs elsewhere.
[92/12/16  12:45:52  af]

Created, starting from i386 version and extending it with
one more layer in the pagetable tree.
[92/12/10  15:02:31  af]
[ ./kernel/alpha/pmap.h ]
Created, from dbg's i386 pmap module.
[92/06/15            af]
[ ./kernel/alpha/prom_interface.h ]
Added reference to documentation source(s).
[92/12/16  15:17:51  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/prom_interface.s ]
Added reference to documentation source(s).
[92/12/16  15:18:00  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/setjmp.h ]
Copied from mips.
[92/05/31            af]
[ ./kernel/alpha/start.s ]
Got more memory on the ADU, bump NLEV3 up.
[92/12/25  01:41:26  af]

Added reference to doc for the HWRPB &co.
[92/12/22            af]
Added reference to documentation source(s).
[92/12/16  15:18:08  af]

Created.
[92/06/03            af]
[ ./kernel/alpha/swapgeneric.c ]
Created, from rvb's version for mips.
[92/06/07            af]
[ ./kernel/alpha/syms.h ]
Adapted for Alpha.
[92/05/31            af]
[ ./kernel/alpha/thread.h ]
Created, from mips version.
[92/05/31            af]
[ ./kernel/alpha/time_stamp.h ]
Created bogus empty file.
[92/05/31            af]
[ ./kernel/alpha/trap.c ]
Added reference to documentation source(s).
[92/12/16  15:18:18  af]

Created.
[92/12/10  15:06:12  af]
[ ./kernel/alpha/trap.h ]
Created.
[92/12/10            af]
[ ./kernel/alpha/va-alpha.h ]
RCS-ed.
[92/12/10            af]
[ ./kernel/alpha/varargs.h.dec ]
RCS-ed.
[92/12/10            af]
[ ./kernel/alpha/varargs.h.gcc ]
RCS-ed.
[92/12/10            af]
[ ./kernel/alpha/vm_tuning.h ]
Created, obsolete.
[92/06/02            af]
[ ./kernel/alpha/xpr.h ]
Created empty.
[92/10/06            af]
[ ./kernel/chips/busses.c ]
Converted to boolean return values, prototyped.
[93/01/14            danner]
[ ./kernel/chips/busses.h ]
Added BUS_CTLR flag.  Use on machines that truly have bus
adaptors, and write a probe function for it.
This was the grand plan from the beginning, alpha now does it.
[92/11/30            af]
[ ./kernel/chips/cfb_hdw.c ]
Interrupt routine takes an spllevel on mips only.
[92/11/30            af]
[ ./kernel/chips/cfb_misc.c ]
Make it share code properly with the "sfb" driver.
[92/11/26            af]
[ ./kernel/chips/dec_lic/ga_hdw.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/dec_lic/gq_hdw.c ]
static/extern fixup.
[93/01/14            danner]

Fixed GCC complaint in an #if 0 branch.
[92/12/16            pds]
Proper spl typing.
[92/11/30            af]
Commented out random text on line 364 which contained a single quote.
[92/11/06            cmaeda]
[ ./kernel/chips/dtop.h ]
Now we know how to talk to the bus.
Added more keyboard state for beeps.
[from jtp@hut.fi]
[ ./kernel/chips/dtop_handlers.c ]
My attempt at DO-key finessing.
[92/12/14            af]
Proper spl typing.
[92/11/30            af]

Throw away the kdb hot key from the keyboard input buffer if
lk201_input returned -2. This prevents bogus autorepeat of the
hot key and bogus kdb interrupts.
[92/10/24            jvh]
[ ./kernel/chips/dtop_hdw.c ]
Prototyped handler.
[93/01/14            danner]

Now that we know how to be heard on the bus, added bell
and .. leds. From jtp@hut.fi.
[92/12/14            af]
Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/dz_hdw.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/ecc.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/fb_hdw.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/fb_misc.c ]
Removed dead code.
[92/11/29            af]
[ ./kernel/chips/fdc_82077.h ]
Store for future reference attempt at getting it working.
[92/12/10            af]
[ ./kernel/chips/fdc_82077_hdw.c ]
Store for future reference attempt at getting it working.
Something wrong with DMA stopped me.
[92/12/10            af]
[ ./kernel/chips/frc.c ]
Fixed mattz's open of nonexistenent frc problem.
[93/01/14            danner]

Corrected type of frc_std.
[93/01/14            danner]
[ ./kernel/chips/ims332.c ]
Added support for different monitors.
[92/11/30            jtp]
[ ./kernel/chips/isdn_79c30_hdw.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/lance.c ]
updated LUNA88K support for mapped ethernet.
Removed IF_CNTRS cruft.
[92/12/02            jfriedl]
Proper spl typing. 64bit mods.
[92/11/30            af]
[ ./kernel/chips/lance_mapped.c ]
corrected typo.
[93/01/12            danner]
Added LUNA88K and portability support.
[92/12/02            jfriedl]
Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/lk201.c ]
Always return -2 from debugger, regardless [jtp@hut.fi]
Proper spl typing. 64bit clean. Made bitmap display optional.
[92/11/30            af]

Return -2 from lk201_input if the kdb hot key was received. Also
do this if already inside kdb
[92/10/24            jvh]
[ ./kernel/chips/mc_clock.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/mouse.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/pm_hdw.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/scc_8530_hdw.c ]
static/extern cleanups.
[93/01/14            danner]

Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/screen.c ]
Added first cut at true kbd layer [jtp@hut.fi]
Proper spl typing.  Finessed the above.
[92/11/30            af]

Fixed screen_set_cursor to keep the cursor from wrapping to
the other side of the screen when the mouse is moved outside
the screen.
Move also the physical cursor when the cursor is moved from
above.
[92/11/30            jvh]
[ ./kernel/chips/screen_defs.h ]
Added first cut at true kbd layer [jtp@hut.fi]
[ ./kernel/chips/screen_switch.c ]
Added sfb driver.
[92/12/10            af]
[ ./kernel/chips/serial_console.c ]
Proper typing.
[92/11/30            af]
[ ./kernel/chips/sfb_hdw.c ]
Created.
[92/12/10  15:44:39  af]
[ ./kernel/chips/sfb_misc.c ]
Created.
[92/12/10  15:44:58  af]
[ ./kernel/chips/xcfb_hdw.c ]
Support for different monitors.
[92/11/30            jtp]

Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/xcfb_misc.c ]
Added support for different monitors.
[92/11/30            jtp]
[ ./kernel/chips/xcfb_monitor.h ]
Created.
[92/11/25            jtp]
[ ./kernel/conf/MASTER ]
Dropped ipc_compat from MI official defines.
If you have 2.5 code to support define it
in the machdep file.
[92/12/10            af]
[ ./kernel/conf/MASTER.alpha ]
Created.
[92/05/31            af]
[ ./kernel/conf/MASTER.alpha.local ]
Created empty.
[92/05/31            af]
[ ./kernel/conf/MASTER.i386 ]
Added ipc_compat to all configs.
[92/12/10            af]
[ ./kernel/conf/MASTER.m88k ]
	Changed OPTIMIZE to -O from -O2 (can still set -O2 in Makefile.site).
	Removed DWANT_PROTOTYPES, FB controller.
[92/12/02            jfriedl]
	Added ipc_compat to STD config.
[92/12/10            af]

 Revision 2.2  92/08/03  17:21:41  jfriedl
	Added OMRON, RAW_PRINTF options.

 Revision 2.1.1.1  92/05/27  15:13:54  danner
Created from luna88k.
[92/05/16            danner]

 Revision 2.7  92/05/04  11:23:16  danner
 	Added BOOTSTRAP_SYMBOLS option.
 	[92/05/03            danner]
 
 	Added lance (ln).
 	[92/04/21            danner]
 
 Revision 2.6  92/02/25  14:13:29  elf
 	Added savarg option.
 	[92/02/25            danner]
 
 Revision 2.6  92/02/19  15:06:30  elf
 	Simplified, condensed history.
 	[92/02/17            rpd]
 
 	Condensed history:
 	Added saveargs option to support argument recovery.
 	Added -moptimize-arg-area in non save args case.
 
Created (danner, rvb).

  CPU TYPE (select exactly one)

luna88k = Luna's MC88K CPU
vme188 = Motorola VME 188 board.

  Production Configuration Components:
  ---------- ------------- ----------

  STD   = [ ipc_compat multi4 host ]
  LUNA  = [ luna88k scsi warn_proto hw_foot optimize lineno]
  OMRON = [ luna88k scsi warn_proto hw_foot savearg debug lineno optimize ]
  VME = [ vme188 scsi ]
  OPT = [ optimize argarea ]
[ ./kernel/conf/MASTER.mac2 ]
Added ipc_compat to options.
[92/12/10            af]
[ ./kernel/conf/MASTER.mips ]
fast_tas goes back to the lab for further debugging.
	Added ipc_compat to STD config.
[92/12/04            af]

Added sfb screen, for HX boards (aka Smart Framebuffer).
[92/11/29            af]
Removed fast_tas from default mips config.  Sigh.
[92/12/13            cmaeda]
Removed lineno option which was cc dependent.
[92/11/06  04:20:00  cmaeda]
[ ./kernel/conf/MASTER.sun3 ]
Added ipc_compat to all configs.
[92/12/10            af]
[ ./kernel/conf/MASTER.vax ]
	Added dtop pseudo-device.
[93/01/14            danner]

Added ipc_compat to VAX6bb config (the only one that works)
[92/12/10            af]
[ ./kernel/conf/Makefile.alpha ]
Created.
[92/05/31            af]
[ ./kernel/conf/Makefile.i386 ]
"The hack below" has been fixed today.
[92/11/30            af]
[ ./kernel/conf/Makefile.i860 ]
"The hack below" has been fixed today.
[92/11/30            af]
[ ./kernel/conf/Makefile.luna88k ]
added ${SITE_M88K_CFLAGS} to CDEBUGFLAGS.
[92/12/02            jfriedl]
[ ./kernel/conf/Makefile.mips ]
LDFLAGS for gcc.
[92/12/28            danner]
Changed to compile with gcc.
[92/11/05            cmaeda]
[ ./kernel/conf/Makefile.template ]
Added rmlinks target for easy removal of the machine and
mach/machine subdirectories.
[92/11/30            jvh]

Create symlinks to individual files in machine and mach/machine
in order to handle shadowing correctly.
[92/09/28            jvh]
[ ./kernel/conf/files ]
Added ddb/db_mp.c for multiprocessor debugger support.
[92/10/25            dbg]
[ ./kernel/conf/files.alpha ]
Created.
[92/05/31            af]
[ ./kernel/conf/files.luna88k ]
added frame buffer (luna88kdev/fb.c),
dip switch (luna88kdev/dip.c), and
mapped ethernet (chips/lance_mapped.c), all from Omron.
[92/11/27            jfriedl]
[ ./kernel/conf/files.mips ]
Added Smart frame buffer.
[92/12/03            af]
Removed compiler option for vm/vm_fault.c which was cc dependent.
[92/11/06  04:21:00  cmaeda]
[ ./kernel/ddb/db_access.c ]
Fixed last entry of db_extend.
[93/01/14            danner]

64bit cleanup. db_extend[] was rightly signed.
[92/11/30            af]
[ ./kernel/ddb/db_access.h ]
Enabled prototypes.
[92/11/30            af]
[ ./kernel/ddb/db_aout.c ]
Support for coexhistance of multiple symbol table types.
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_break.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_break.h ]
64bit cleanup. Enabled prototypes.
[92/11/30            af]
[ ./kernel/ddb/db_command.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_command.h ]
Added db_recover.
[92/10/26            dbg]
Added db_recover.
[92/10/26            dbg]
[ ./kernel/ddb/db_examine.c ]
64bit cleanup.
[92/12/10  16:16:01  af]
[ ./kernel/ddb/db_expr.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_input.c ]
Fixed history code.  In comparing current command line with
last, every other character was skipped.
[barbou@gr.osf.org]
[ ./kernel/ddb/db_lex.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_lex.h ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_macro.c ]
Cleaned db_del_macro_cmd to quiet gcc warnings.
[92/08/12            jfriedl]
[ ./kernel/ddb/db_mp.c ]
Made more machine-independent, as alpha and mips keep
register states on stack.  Spots.
[92/12/16  12:44:42  af]

Pulled code from OSF/Grenoble and restructured.
[92/10/24            dbg]
[ ./kernel/ddb/db_output.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_output.h ]
Proper prototype for db_printf(), but incompat with varargs
so set it aside for now.
[92/11/30            af]
[ ./kernel/ddb/db_print.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_run.c ]
added use of db_branch_is_delayed in db_restart_at_pc. 
[92/11/28            jfriedl]
64bit cleanup.
[92/12/10  16:20:16  af]
[ ./kernel/ddb/db_sym.c ]
Handle multiple, coexisting symbol table types.
64bit cleanup.
[92/11/30            af]

Check for null db_last_symtab in db_line_at_pc.
[92/10/06            jvh]
[ ./kernel/ddb/db_sym.h ]
Handle coexisting symtable types.
64bit cleanup, prototypes.
[92/11/30            af]
[ ./kernel/ddb/db_task_thread.c ]
Removed `static' from db_lookup_task_id so can be used elsewhere.
[92/12/02            jfriedl]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_trap.c ]
64bit cleanup.
[92/12/10  16:22:07  af]
[ ./kernel/ddb/db_variables.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_variables.h ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_watch.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ddb/db_write_cmd.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/device/chario.c ]
Proper spl typing. 64bit safe. Bumped up tty_inq_size.
[92/11/30            af]

Added function prototypes.  Fixed documentation.
Removed tty_queueempty and ttyoutput.
[92/11/17            dbg]
[ ./kernel/device/cirbuf.c ]
Added function prototypes.  Added cb_clear.
[92/11/17            dbg]
Added function prototypes.  Added cb_clear.
[92/11/17            dbg]
[ ./kernel/device/cirbuf.h ]
Added function prototypes.  Added cb_clear.
[92/11/17            dbg]
Added function prototypes.  Added cb_clear.
[92/11/17            dbg]
[ ./kernel/device/device.defs ]
Flavors have a type of their own now.
[92/11/30            af]
[ ./kernel/device/device_types.defs ]
Added dev_flavor_t, use int32 instead of 'int'.
[92/11/30            af]
[ ./kernel/device/device_types.h ]
Added dev_flavor_t.
[92/11/30            af]
[ ./kernel/device/disk_status.h ]
Changed longs into ints, which is what they are anyways.
When we'll have a disk 1 terabyte big we'll see about it.
[92/08/02            af]
[ ./kernel/device/ds_routines.c ]
64bit cleanup.
[92/11/30            af]

Return D_INVALID_SIZE instead of panicking in write routines when
there is no data. This is the case when device_write() is given
zero as the data length.
[92/10/08            jvh]
[ ./kernel/device/net_io.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/device/subrs.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/device/tty.h ]
Added function prototypes.
[92/11/17            dbg]
Removed Omron kanji support.... will replace with MI
support at a later date.
[92/12/10            jfriedl]
Added function prototypes.
[92/11/17            dbg]
[ ./kernel/device/tty_status.h ]
Use proper types in defining constants.
[92/11/30            af]
[ ./kernel/emul/vaxconvrt.s ]
ansi cpp fixes.
[93/01/14            danner]
[ ./kernel/emul/vaxemulat.s ]
ansi cpp fixes.
[93/01/14            danner]
[ ./kernel/emul/vaxexception.s ]
Ansi cpp fixes.
[93/01/14            danner]
[ ./kernel/emul/vaxfloat.s ]
ansi cpp fixes.
[93/01/14            danner]
[ ./kernel/emul/vaxregdef.h ]
Ansi cpp fixes.
[93/01/14            danner]
[ ./kernel/emul/vaxstring.s ]
ansi cpp fixes.
[93/01/14            danner]
[ ./kernel/i386/db_interface.c ]
Pick up multiprocessor DDB changes from Grenoble.
[92/10/23            dbg]
[ ./kernel/i386/db_machdep.h ]
Added SAVE/RESTORE macros for multiP usage.
[92/12/16  12:42:39  af]

Say we only do a.out images.
[92/12/10  17:37:02  af]
[ ./kernel/i386/db_trace.c ]
Proper spl typing.  db_symbol_values() changed.
[92/11/30            af]
[ ./kernel/i386/fpe_linkage.c ]
Added include of mach/std_types.h.
[92/12/04            af]
[ ./kernel/i386/fpu.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386/genassym.c ]
Define constants for boot_info.
[92/12/10  17:39:38  af]
[ ./kernel/i386/ipl.h ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386/machparam.h ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386/pcb.c ]
Added include of mach/std_types.h
[92/12/10  17:41:42  af]
[ ./kernel/i386/pic.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386/pio.h ]
altered malformed error message
[92/12/18            danner]
Took the warning inside ifndef __GNUC__ outside of comments. This
will make the compiler find the error instead of having to find
out about it manually.
Protected against multiple inclusions.
[92/11/30            jvh]
[ ./kernel/i386/pit.c ]
Proper spl typing.
[92/12/10  17:42:39  af]
[ ./kernel/i386/start.s ]
Boot_info changed.
[92/12/10  17:43:44  af]
[ ./kernel/i386/trap.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/blit.c ]
Proper spl typing.
[92/12/10  17:44:52  af]
[ ./kernel/i386at/com.c ]
Always disable fifo in comprobe().
[92/12/12            dbg]
Added changes suggested from Finland for FIFOs.
They still do not work, but we'll get there eventually...
[92/12/19  10:55:22  af]

Disabled FIFOs until we have good code for them.
Do input buffering at 9600 and over.
[92/12/10            af]

Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/comreg.h ]
Finessing Fifos From Finland.
[92/12/19  10:56:33  af]
[ ./kernel/i386at/fd.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/hd.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/if_3c501.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/if_ns8390.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/if_par.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/if_pc586.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/kd.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/kd.h ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/kd_event.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/kd_mouse.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/kd_queue.h ]
Added include of mach/std_types.h
[92/12/10  17:50:14  af]
[ ./kernel/i386at/lpr.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/model_dep.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386at/rtc.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/i386ipsc/cnp/if_cnp.c ]
Proper spl typing.
[92/12/10  17:55:25  af]
[ ./kernel/i386ipsc/dcm_input.c ]
Proper spl typing.
[92/12/10  17:52:00  af]
[ ./kernel/i386ipsc/led.c ]
Proper spl typing.
[92/12/10  17:53:44  af]
[ ./kernel/i386ipsc/md.c ]
Proper spl typing.
[92/12/10  17:54:13  af]
[ ./kernel/i386ipsc/model_dep.c ]
Proper spl typing.
[92/12/10  17:54:33  af]
[ ./kernel/i386ipsc/sd.c ]
Proper spl typing.
[92/12/10  17:54:55  af]
[ ./kernel/intel/pmap.c ]
Lock pmap_object!
[92/09/22            dbg]
Lock pmap_object!
[92/09/22            dbg]
[ ./kernel/ipc/ipc_entry.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ipc/ipc_kmsg.c ]
64bit cleanup
[92/11/30            af]
[ ./kernel/ipc/ipc_kmsg.h ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ipc/ipc_machdep.h ]
Created.
[92/12/10            af]
[ ./kernel/ipc/ipc_notify.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ipc/ipc_space.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ipc/mach_msg.c ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/ipc/port.h ]
64bit cleanup.
[92/11/30            af]
[ ./kernel/kern/ast.c ]
Proper spl typing.
[92/11/30            af]
[ ./kernel/kern/bootstrap.c ]
64bit cleanup.  Added a magic number to the boot label.
Changed ovbcopy_ints to be quicker where it can.
[92/11/30            af]
[ ./kernel/kern/cpu_number.h ]
ANSI C cleanups.
[92/12/10  18:01:47  af]
[ ./kernel/kern/debug.c ]
Added alpha, simplified.
[92/11/30            af]
[ ./kernel/kern/eventcount.c ]
Typecast assert_wait arguments.
[93/01/12            danner]
Fixes for multiprocessor usage.
[92/11/16            jfriedl]
Fixed two-for-one bug in evc_wait, per jcb's report.
See comments in code.
[92/12/15            af]
Proper spl typing.
[92/11/30            af]
[ ./kernel/kern/eventcount.h ]
Allow count to go negative.
[92/12/15            af]
[ ./kernel/kern/exception.c ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/kern/host.c ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/kern/ipc_host.c ]
Added function prototypes.  Combined ipc_processor_init and
ipc_processor_enable.  Removed ipc_processor_disable and
ipc_processor_terminate; processor ports are never removed.
Fixed lock ordering bugs in processor and processor_set code.
[92/11/17            dbg]
Added function prototypes.  Combined ipc_processor_init and
ipc_processor_enable.  Removed ipc_processor_disable and
ipc_processor_terminate; processor ports are never removed.
Fixed lock ordering bugs in processor and processor_set code.
[92/11/17            dbg]
[ ./kernel/kern/ipc_host.h ]
Added function prototypes.  Combined ipc_processor_init and
ipc_processor_enable.  Removed ipc_processor_disable and
ipc_processor_terminate; processor ports are never removed.
[92/11/17            dbg]
Added function prototypes.  Combined ipc_processor_init and
ipc_processor_enable.  Removed ipc_processor_disable and
ipc_processor_terminate; processor ports are never removed.
[92/11/17            dbg]
[ ./kernel/kern/ipc_kobject.h ]
ipc_kobject_t is casted sometimes to a pointer.
[92/07/24            af]
[ ./kernel/kern/ipc_mig.c ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/kern/ipc_sched.c ]
Added ANSI function prototypes.
[92/12/29            dbg]
Proper spl typing.  64bit cleanup.
[92/12/01            af]
[ ./kernel/kern/ipc_sched.h ]
Moved contents to kern/sched_prim.h.
[92/12/28            dbg]
[ ./kernel/kern/kern_types.h ]
Created.
[92/11/23            dbg]
[ ./kernel/kern/lock.c ]
Added ANSI function prototypes.
[92/12/30            dbg]
64bit cleanup.
[92/12/01            af]
[ ./kernel/kern/lock.h ]
Added ANSI function prototypes.  Made simple lock data
volatile.
[92/12/30            dbg]
ANSI-fied cpp directives.
[92/12/01            af]
[ ./kernel/kern/lock_mon.c ]
64bit cleanup.
[92/12/10  18:06:15  af]
[ ./kernel/kern/mach_clock.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/kern/machine.c ]
Fixed lock ordering problem in processor_doaction by having
processor_assign wait until a previous assignment is completed.
[92/10/29            dbg]
Events must be of type 'vm_offset_t', not 'int'.
Proper spl typing.
[92/12/01            af]

Fixed lock ordering problem in processor_doaction by having
processor_assign wait until a previous assignment is completed.
[92/10/29            dbg]
[ ./kernel/kern/macro_help.h ]
Too many replicas of this file.
[92/12/10  18:07:36  af]
[ ./kernel/kern/pcsample.c ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/kern/printf.c ]
64bit cleanup.  Tuned up doprnt slightly.
[92/12/01            af]
[ ./kernel/kern/priority.c ]
Added check to thread_quantum_update for processor not in a
processor set (when being reassigned).  This should be fixed in
processor assignment code instead.
[92/10/23            dbg]
Removed unnecessary include of machine/mach_param.h
[92/12/16            af]
Proper spl typing.
[92/12/01            af]

Added check thread_quantum_update for processor not in a
processor set (when being reassigned).  This should be fixed in
processor assignment code instead.
[92/10/23            dbg]
Proper spl typing.
[92/12/01            af]

Added check thread_quantum_update for processor not in a
processor set (when being reassigned).  This should be fixed in
processor assignment code instead.
[92/10/23            dbg]
[ ./kernel/kern/processor.c ]
Fixed indireciton in cpu_control call.
[93/01/12            danner]
Fixed type of count argument to processor_control.
[93/01/12            danner]
Explictily include <kern/task.h>
[93/01/12            dbg]
64bit cleanup.
[92/12/01            af]
[ ./kernel/kern/processor.h ]
Removed definitions moved to kern/kern_types.h
[93/01/12  14:50:37  danner]

Moved actual declarations of struct processor, processor_t,
struct processor_set, processor_set_t to kern/kern_types.h to
permit mutually recursive structure definitions.  Finished
adding ANSI function prototypes.
[92/12/28            dbg]
Added separate pset_ref_lock, only governing reference count, to
fix lock ordering to avoid deadlocks.  Documented locking hierarchy.
Added prototypes for pset functions.
[92/10/28            dbg]
[ ./kernel/kern/profile.c ]
Updated argument casts for calls to assert_wait, thread_sleep and thread_wakeup.
[93/01/12            danner]
Proper spl typing. 64bit cleanup.
[92/12/01            af]
[ ./kernel/kern/sched_prim.c ]
Added assert_wait argument casts.
[93/01/12            danner]

Added ANSI function prototypes.
[92/12/28            dbg]

Fixed locking in do_thread_scan: thread lock must be taken
before runq lock.  Removed obsolete swap states from
documentation of state machine.
[92/10/29            dbg]
64bit cleanup. Proper spl typing.
NOTE NOTE NOTE: events must be 'vm_offset_t' and dont you forget it.
[92/12/01            af]

Added function prototypes.
[92/11/23            dbg]

Fixed locking in do_thread_scan: thread lock must be taken
before runq lock.  Removed obsolete swap states from
documentation of state machine.
[92/10/29            dbg]
[ ./kernel/kern/sched_prim.h ]
Added function prototypes.
[92/11/11            dbg]
[ ./kernel/kern/startup.c ]
Invoke printf_init() for multiP interlock setup.
[92/12/01            af]
[ ./kernel/kern/syscall_subr.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/kern/task.c ]
Added ANSI function prototypes.
[92/12/29            dbg]

Fixed pset locking.  Pset lock must be taken before task or
thread lock.
[92/10/28            dbg]
Proper spl typing. 64bit cleanup.
[92/12/01            af]

Fixed pset locking.  Pset lock must be taken before task or
thread lock.
[92/10/28            dbg]
[ ./kernel/kern/task.h ]
Moved actual declaration of struct task and task_t to
kern/kern_types.h, to permit mutually recursive structure
definitions.  Added ANSI function prototypes.
[92/12/28            dbg]
Swapped fields for better alignment.
[92/12/01            af]
[ ./kernel/kern/thread.c ]
Added ANSI function prototypes.
[92/12/29            dbg]

Changed thread_create to hold both the pset and task locks while
inserting the new thread in the lists.
[92/11/20            dbg]

Fixed pset lock ordering.  Pset lock must be taken before task
and thread locks.
[92/10/28            dbg]
64bit cleanup. Proper spl typing.
[92/12/01            af]

Changed thread_create to hold both the pset and task locks while
inserting the new thread in the lists.
[92/11/20            dbg]

Fixed pset lock ordering.  Pset lock must be taken before task
and thread locks.
[92/10/28            dbg]
[ ./kernel/kern/thread.h ]
Moved actual declaration of struct thread and thread_t to
kern/kern_types.h, to permit mutually recursive structure
definitions.  Added ANSI function prototypes.
[92/12/28            dbg]
Swapped some fields for better alignment.
[92/12/01            af]
[ ./kernel/kern/thread_swap.c ]
Corrected casts for thread_wakeup and assert_wait.
[93/01/12            danner]
64bit cleanup. Proper spl typing.
[92/12/01            af]
[ ./kernel/kern/time_stamp.c ]
64bit cleanup.
[92/12/10  18:14:01  af]
[ ./kernel/kern/xpr.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/kern/zalloc.c ]
Fixed casts of assert_wait and thread_wakeup arguments.
[93/01/12            danner]
64bit cleanup. Proper spl typing.
[92/12/01            af]
[ ./kernel/luna88k/autoconf.c ]
Removed unneeded frame buffer "controller"
[92/12/07            jfriedl]

support for frame buffer (fb) and ethernet address for mapped
ethernet [sugahara@omron].
[92/11/27            jfriedl]
[ ./kernel/luna88k/board.h ]
added BMAP_END24P and BMAP_IDENTROM.
[92/11/27            jfriedl]
[ ./kernel/luna88k/conf.c ]
support for frame buffer, mouse, and DIP [from Omron]
Added mapped ethernet, made it default 'am' device.
[92/10/19            jfriedl]
[ ./kernel/luna88k/db_disasm.c ]
some gcc -Wall cleanup
[92/12/07            jfriedl]

added newline to db_disasm()
[92/08/10            jfriedl]
[ ./kernel/luna88k/db_interface.c ]
Removed max-width restrictions when raw_printf used.
Added quiet_db_read_bytes (currently used only in db_trace).
Some gcc -Wall cleanup..
Added /h (help) to "mach regs" command.
Added /h (help) and /f (force) to "mach frame" command.
Added luna_db_translate ("mach trans" command).
[92/12/07            jfriedl]

Renamed MD command "registers" to "regs".
Removed 2.5 support (was unused).
[92/08/10            jfriedl]
[ ./kernel/luna88k/db_machdep.h ]
We do not support coff.
[92/12/18            danner]

fixed IS_WATCHPOINT_TRAP to not always be false.
[92/12/07            jfriedl]

moved inst_unconditional_flow_transfer, inst_call,
and inst_return here from db_sstep.c.
Added db_branch_is_delayed.
[92/11/28            jfriedl]
ifdef lunatics do not belong in MI code.
[92/11/30            af]
[ ./kernel/luna88k/db_sstep.c ]
Support for inst_call, inst_return, inst_delayed, and
inst_unconditional_flow_transfer being macros.
Fixed next_instr_address to match the (very strange, undocumented)
semantics of its use. Some gcc -Wall changes.
[92/12/07            jfriedl]
[ ./kernel/luna88k/db_trace.c ]
Condensed history. All the hard work had been done by danner.
Reworked and simplified. Added /h (help), /a (addresses),
/p (show preserved registers at each step), /d (debug).
Modified to work even with latest gcc super-optimzer.
[92/12/07            jfriedl]

Added continuation address to "blocked with cont." message.
[92/08/20            jfriedl]

Reformatting to pretty up. Some mods to quiet gcc warnings.
[92/08/12            jfriedl]

removed newlines from after calls to db_disasm (it now puts them)
[92/08/10            jfriedl]
[ ./kernel/luna88k/eh.s ]
Replaced rediculous version of error_handler with something
that might even work.
[92/12/07            jfriedl]
[ ./kernel/luna88k/fb.h ]
Created.
[92/12/07            jfriedl]
[ ./kernel/luna88k/locore_asm_routines.s ]
various cleanups.
[92/12/10            jfriedl]
[ ./kernel/luna88k/locore_c_routines.c ]
Removed LOOP_DEBUG. Added report_lock_info().
[92/12/07            jfriedl]
[ ./kernel/luna88k/machdep.c ]
Added some cache flushed when starting slaves.
Some gcc -Wall cleanup.
[92/12/07            jfriedl]
[ ./kernel/luna88k/softint.c ]
Gcc -Wall cleanup.
[92/12/07            jfriedl]
[ ./kernel/luna88k/trap.c ]
Some reorginization. Better error messages for debugging.
Added error_fault().
[92/12/07            jfriedl]

Cleanup to quiet more gcc warnings.
[92/08/12            jfriedl]
[ ./kernel/luna88kdev/cons.c ]
Removed kanji support (to be replaced with MI support at a later date)
[92/12/10            jfriedl]

Removed unused 2.5 support.
Some Omron changes.
[92/12/08            jfriedl]
[ ./kernel/luna88kdev/dip.c ]
Added uncheked from Omron.
[92/12/08            jfriedl]
[ ./kernel/luna88kdev/fb.c ]
Brought from Omron as "fbmap.c", renamed to "fb.c".
Reworked, made (more) UX-independent.
[92/12/08            jfriedl]
[ ./kernel/luna88kdev/kbmain.c ]
Dropped in Omron changes.
[92/12/08            jfriedl]
[ ./kernel/luna88kdev/kbms.h ]
Dropped in Omron changes (added _IO('K') defines)
[92/12/08            jfriedl]
[ ./kernel/luna88kdev/msmain.c ]
Removed unused 2.5 support. Omron changes.
[92/12/08            jfriedl]
[ ./kernel/luna88kdev/uart.c ]
Removed kanji support.
[92/12/10            jfriedl]

mods to quiet gcc warnings.
Removed some unused (2.5) code.
[92/08/12            jfriedl]
Removed call to ttstart - not needed in pure kernel.
[92/11/18            dbg]
[ ./kernel/m88k/db_machdep.h ]
Was out-of-sync with Luna one. Each 88k arch should just include
their own MD one here...
[92/12/10            jfriedl]
[ ./kernel/m88k/machparam.h ]
Added spl_t. Inclusion protections.
[92/12/18  18:07:36  danner]
[ ./kernel/m88k/mmu.h ]
Made variables in DO_PTES less likely to shadow others
[92/12/02            jfriedl]
[ ./kernel/m88k/pmap.c ]
Added default case (panic) to switch in cache_flush_loop().
Added Omron pmap changes.
At top of pmap_extract and pmap_extract_unlocked, changed
    for (i = batc_used; i > 0; i--)
to
    for (i = batc_used-1; i > 0; i--)
[92/10/19            jfriedl]
[ ./kernel/m88k/pmap.h ]
Added OMRON_PMAP stuff.
[92/12/02            jfriedl]
[ ./kernel/mac2/machparam.h ]
Added spl_t.
[92/12/01            af]
[ ./kernel/mach/alpha/alpha_instruction.h ]
Created.
[91/12/05            af]
[ ./kernel/mach/alpha/asm.h ]
Created.
[91/12/11            af]
[ ./kernel/mach/alpha/boolean.h ]
Copied for alpha.
[92/12/17            af]
[ ./kernel/mach/alpha/exception.h ]
Created.
[91/12/29            af]
[ ./kernel/mach/alpha/kern_return.h ]
Created.
[91/12/29            af]
[ ./kernel/mach/alpha/machine_types.defs ]
Created.
[92/08/04            af]
[ ./kernel/mach/alpha/syscall_sw.h ]
Created.
[91/12/29            af]
[ ./kernel/mach/alpha/thread_status.h ]
Revised for new calling sequence.
[92/06/07            af]

Created.
[91/12/29            af]
[ ./kernel/mach/alpha/vm_param.h ]
Created, partly empty.
[91/12/29            af]
[ ./kernel/mach/alpha/vm_types.h ]
Created.
[91/12/29            af]
[ ./kernel/mach/boolean.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/boot_info.h ]
Added magic number, for sanity.
[92/12/01            af]
[ ./kernel/mach/error.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/exception.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/host_info.h ]
Cleanup.
[92/06/10            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach/i386/boolean.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i386/exception.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i386/fp_reg.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/i386/kern_return.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i386/machine_types.defs ]
Created.
[92/08/04            af]
[ ./kernel/mach/i386/syscall_sw.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i386/thread_status.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i386/vm_param.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i386/vm_types.h ]
Cleanup.
[92/06/10            pds]
New (more) fundamental types.
Standardized conditional that controls multiple inclusion of
this file.  Added MACH_MSG_TYPE_INTEGER_T.
[92/06/03            af]
[ ./kernel/mach/i860/boolean.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i860/exception.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i860/kern_return.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i860/machine_types.defs ]
Created.
[92/08/04            af]
[ ./kernel/mach/i860/syscall_sw.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i860/thread_status.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i860/vm_param.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/i860/vm_types.h ]
Cleanup.
[92/06/10            pds]
New (more) fundamental types.
Standardized conditional that controls multiple inclusion of
this file. Added MSG_TYPE_INTEGER_T.
[92/06/03            af]
[ ./kernel/mach/kern_return.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/luna88k/machine_types.defs ]
Created.
[92/12/10            af]
[ ./kernel/mach/m88k/machine_types.defs ]
Created.
[92/08/04            af]
[ ./kernel/mach/m88k/syscall_sw.h ]
deal with ansi preprocessing.
[92/12/17            danner]
[ ./kernel/mach/m88k/vm_param.h ]
Appended 'U' to constants with high bit set.
[92/12/02            jfriedl]
[ ./kernel/mach/m88k/vm_types.h ]
Ansi cleanups
[92/12/28            danner]
New (more) fundamental types.
Since I am standardizing all similar files, but this was ok,
well make it pass ANSI C preproc.
[92/06/03            af]
[ ./kernel/mach/mac2/boolean.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mac2/exception.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mac2/frame.h ]
Cleanup.
[92/06/10            pds]
Final cleanup.
[90/09/07            bohman]
[ ./kernel/mach/mac2/kern_return.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mac2/machine_types.defs ]
Created.
[92/08/04            af]
[ ./kernel/mach/mac2/reg.h ]
Cleanup.
[92/06/10            pds]
Final cleanup.
[90/09/07            bohman]
[ ./kernel/mach/mac2/syscall_sw.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mac2/thread_status.h ]
Cleanup.
[92/06/10            pds]
Final cleanup.
[90/09/07            bohman]
[ ./kernel/mach/mac2/vm_param.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mac2/vm_types.h ]
Cleanup.
[92/06/10            pds]
New (more) fundamental types.
Standardized conditional that controls multiple inclusions of
this file.
[92/06/03            af]
[ ./kernel/mach/mach_param.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mach_traps.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mach_types.defs ]
64bit cleanup.  All types now based on integer_t/natural_t.
[92/12/01            af]
[ ./kernel/mach/mach_types.h ]
Moved definition of vm_address_t to std_types.h.
[92/12/14            pds]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/machine.h ]
Cleanup.
[92/06/10            pds]
Added Alpha architecture, and some initial machine types.
[92/06/06            af]
[ ./kernel/mach/memory_object.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/message.h ]
Cleanup.
[92/06/10            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach/mig_errors.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mig_support.h ]
Changed the argument to mig_init to void * for compatibility
with the C-Threads mig_init.
[92/12/18            pds]
Define memcpy to be bcopy in the kernel, otherwise include string.h.
Added include of sys/types.h.
[92/12/17            pds]
Created.
[92/12/11            pds]
[ ./kernel/mach/mips/asm.h ]
Protected against multiple inclusion.
[92/06/10            pds]
Fixes for ANSI CPP.
[92/10/06            jvh]
[ ./kernel/mach/mips/boolean.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mips/exception.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mips/kern_return.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mips/machine_types.defs ]
Created.
[92/08/04            af]
[ ./kernel/mach/mips/mips_instruction.h ]
Protected against multiple inclusion.
[92/06/10            pds]
[ ./kernel/mach/mips/syscall_sw.h ]
Cleanup.
[92/06/10            pds]
Fixes for ANSI CPP.
[92/10/06            jvh]
[ ./kernel/mach/mips/thread_status.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/mips/vm_param.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/mips/vm_types.h ]
Cleanup.
[92/06/10            pds]
New (more) fundamental types.
Standardized conditional that controls multiple inclusion of
this file.
[92/06/03            af]
[ ./kernel/mach/msg_type.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/norma_special_ports.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/notify.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/policy.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/port.h ]
Cleanup.
[92/06/10            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach/processor_info.h ]
Cleanup.
[92/06/10            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach/profil.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/profilparam.h ]
Protected against multiple inclusion.
[92/12/14  14:02:33  pds]
[ ./kernel/mach/std_types.defs ]
64bit cleanup.  All types based on natural_t/integer_t.
Define and use int32 when we can possibly take a smaller type,
and hint on its minimal size.
[92/12/01            af]
[ ./kernel/mach/std_types.h ]
Added definition of vm_address_t from mach_types.h.
[92/12/14            pds]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/sun3/boolean.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/sun3/exception.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/sun3/kern_return.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/sun3/machine_types.defs ]
Created.
[92/08/04            af]
[ ./kernel/mach/sun3/reg.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/sun3/syscall_sw.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/sun3/thread_status.h ]
Add include of mach/machine/vm_types.h
[93/01/14            danner]

Cleanup.
[92/06/10            pds]
[ ./kernel/mach/sun3/vm_param.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/sun3/vm_types.h ]
Cleanup.
[92/06/10            pds]
New (more) fundamental types.
Standardized conditional that protects against multiple
inclusions of this file.
[92/06/03            af]
[ ./kernel/mach/syscall_sw.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/task_info.h ]
Standardized include symbol name.
[92/06/10            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach/task_special_ports.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/thread_info.h ]
Cleanup.
[92/06/10            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach/thread_special_ports.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/thread_status.h ]
Include mach/machine/vm_types.h
[93/01/14            danner]

Standardized include symbol name.
[92/06/10            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach/thread_switch.h ]
Standardized include symbol usage.
[92/06/10            pds]
[ ./kernel/mach/time_value.h ]
Standardized include symbol name.
[92/06/10            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach/vax/boolean.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/vax/exception.h ]
Added standard inclusion protection symbol.
[92/06/10            pds]
[ ./kernel/mach/vax/kern_return.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/vax/machine_types.defs ]
Created.
[92/08/04            af]
[ ./kernel/mach/vax/syscall_sw.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/vax/thread_status.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/vax/vm_param.h ]
Cleanup.
[92/06/10            pds]
[ ./kernel/mach/vax/vm_types.h ]
Standardized include symbol name.
[92/06/10            pds]
New (more) fundamental types.
Standardized conditional that controls multiple inclusion.
[92/06/03            af]
[ ./kernel/mach/vm_attributes.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/vm_inherit.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/vm_param.h ]
Standardized include symbol name.
[92/06/10            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach/vm_prot.h ]
Standardized include symbol name.
[92/06/10            pds]
[ ./kernel/mach/vm_statistics.h ]
Standardized include symbol name.
[92/06/10            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach_debug/hash_info.h ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach_debug/ipc_info.h ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach_debug/mach_debug_types.defs ]
bit cleanup.
[92/12/01            af]
[ ./kernel/mach_debug/pc_info.h ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach_debug/vm_info.h ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mach_debug/zone_info.h ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/mips/PMAX/kmin.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/mips/PMAX/kmin_dma.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/mips/PMAX/kn01.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/mips/PMAX/kn02_dma.c ]
New dma_init routine (from af).
[93/01/14            danner]

Proper spl typing.
[92/12/01            af]
[ ./kernel/mips/PMAX/kn02ba.c ]
Added storage declarator for kn02ba_haltintr_count.
[93/01/14            danner]
[ ./kernel/mips/PMAX/maxine.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/mips/PMAX/mips_box.c ]
Added sfb.
[92/11/29            af]
[ ./kernel/mips/PMAX/model_dep.c ]
Proper spl typing.
[92/12/01            af]

Fixes for ANSI C.
[92/10/06            jvh]
Added some missing extern declarations.
[92/11/06            cmaeda]
[ ./kernel/mips/PMAX/pmagb_ba.h ]
Created, with imagination from the DEC specs:
"Flamingo Macrocoder's Manual" Chap 4.6 "CXTURBO"
Workstation and Servers, Maynard, MA. Oct 21, 1991.
[Yes, there is certainly a more proper document]

[90/09/03            af]
[ ./kernel/mips/PMAX/tc.c ]
Added PMAGB-BA (aka HX board).
[92/11/29            af]
[ ./kernel/mips/autoconf.c ]
cleaned tiny spl spot.
[92/12/01            af]
[ ./kernel/mips/db_disasm.c ]
Added include of mach/std_types.h
[92/12/10  20:06:49  af]
[ ./kernel/mips/db_interface.c ]
Solved another byteorder issue. Proper spl typing.
[92/12/01            af]
[ ./kernel/mips/db_machdep.h ]
We only do COFF symtabs.
[92/12/10  20:07:48  af]
[ ./kernel/mips/db_mips_sym.c ]
Added casts.
[93/01/14            danner]

Typos.
[92/12/01            af]
[ ./kernel/mips/db_trace.c ]
Fixed casts, extern/static complaints.
[93/01/14            danner]

db_symbol_values() changed its looks.
[92/12/01            af]

Fixes for ANSI C.
[92/08/22            jvh]
Added a declaration for getreg_val().
[92/11/06            cmaeda]
[ ./kernel/mips/locore.s ]
Restore FPA-disabled optimization that was broken in rev 2.13.
[92/12/10            af]
[ ./kernel/mips/machparam.h ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/mips/mips_cpu.s ]
Improper register save in fpa_intr() was clobbering user
register s1 [branch_delay() was storing over it].
[92/11/30            af]
[ ./kernel/mips/mips_init.c ]
cleanup extern/static complaints.
[93/01/14            danner]
[ ./kernel/mips/mips_instruction.c ]
Removed register declaration of &'ed variable.
[93/01/14            danner]
[ ./kernel/mips/mips_mem_ops.c ]
Declaration cleanups.
[93/01/14            danner]
[ ./kernel/mips/mips_misc.c ]
In dprintf, pass the fourth argument that was sleazily added to
doprnt() without telling anyone.  Grrr.
[92/12/10            af]
[ ./kernel/mips/parse_args.c ]
Added monitor# command line options.
[92/11/30            jtp]
[ ./kernel/mips/pcb.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/mips/pmap.c ]
Removed thread_sleep/wakeup argument coerecion.
[93/01/14            danner]
[ ./kernel/mips/softfp.s ]
hanged some comments from assembler # syntax to C style to make
ansi cpp happy.
[92/12/18            danner]
[ ./kernel/mips/trap.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/motorola/m88k/m88100/cmmu.c ]
Substantial cleanup, enhancements.
  + ability to shadow BATC usage.
  + cleaned up code via CMMU and REGS defines.
  + cleaned up how CMMUs are initialized
  + added cmmu_shutdown_now (but may not be useful yet)
  + added debugging hooks / cmmu_show_translation()
[92/12/02            jfriedl]
[ ./kernel/motorola/m88k/m88100/continuation.s ]
Enhanced debugger support for continuations.
[92/12/02            jfriedl]
[ ./kernel/motorola/m88k/m88100/m88100.h ]
u_int -> unsigned int
[92/12/02            jfriedl]
u_int -> unsigned int
[92/12/02            jfriedl]

<  * Revision 2.1  92/01/22  19:01:39  danner
<  * Created.
<  * 
---
>  * $Log:	MERGE_HISTORY,v $
NONERevision 2.56  93/09/01  16:56:50  mrt
NONE	MK Version MK83
NONE
NONERevision 2.55  93/06/02  21:55:59  rvb
NONE	MK Version MK82
NONE
NONERevision 2.54  93/06/02  11:31:17  rvb
NONE	Something went wrong!
NONE
NONE
NONERevision 2.53  93/03/30  12:02:44  mrt
NONE	MK Version MK80
NONE
NONERevision 2.52  93/02/05  13:12:47  danner
NONE	MK Version MK79
NONE
u_int -> unsigned int
[92/12/02            jfriedl]

[92/01/22  19:01:48  danner]
u_int -> unsigned int
[92/12/02            jfriedl]
u_int -> unsigned int
[92/12/02            jfriedl]

<  * Revision 2.1  92/01/22  19:01:39  danner
<  * Created.
<  * 
---
>  * $Log:	MERGE_HISTORY,v $
NONERevision 2.56  93/09/01  16:56:50  mrt
NONE	MK Version MK83
NONE
NONERevision 2.55  93/06/02  21:55:59  rvb
NONE	MK Version MK82
NONE
NONERevision 2.54  93/06/02  11:31:17  rvb
NONE	Something went wrong!
NONE
NONE
NONERevision 2.53  93/03/30  12:02:44  mrt
NONE	MK Version MK80
NONE
NONERevision 2.52  93/02/05  13:12:47  danner
NONE	MK Version MK79
NONE
u_int -> unsigned int
[92/12/02            jfriedl]

[92/01/22  19:01:48  danner]
[ ./kernel/motorola/m88k/m88100/m882xx.h ]
u_int --> unsigned int
[92/12/02            jfriedl]
[ ./kernel/motorola/m88k/m88100/psl.h ]
u_int -> unsigned
[92/12/02            jfriedl]
[ ./kernel/norma/ipc_deadname.c ]
64bit cleanup.
[92/12/01            af]

Created.
[92/05/25            dlb]
[ ./kernel/norma/ipc_ether.c ]
64bit cleanup. Proper spl typing.
[92/12/01            af]
[ ./kernel/norma/ipc_kserver.c ]
64bit cleanup. Proper spl typing.
[92/12/01            af]
[ ./kernel/norma/ipc_net.c ]
64bit cleanup. Proper spl typing.
[92/12/01            af]
[ ./kernel/scsi/adapters/scsi_33C93_hdw.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/scsi/adapters/scsi_5380_hdw.c ]
Proper spl typing.  This adapter does NOT handle disconnects.
[92/12/01            af]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
Proper spl typing. Fixes to target mode code.
[92/12/10  20:30:24  af]
[ ./kernel/scsi/adapters/scsi_7061_hdw.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/scsi/adapters/scsi_aha15_hdw.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/scsi/mapped_scsi.c ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/scsi/rz.c ]
Proper spl typing.
[92/12/01            af]

Added rz_simple_strategy(), common strategy routine for (most) devices
that do not need to reorder requests.
[92/11/29            af]
[ ./kernel/scsi/rz_cpu.c ]
Some more code, good enough for experimenting.
[92/12/10  20:22:19  af]
[ ./kernel/scsi/rz_disk.c ]
Made all stack-allocated buffers aligned.
[92/08/02            af]
[ ./kernel/scsi/rz_host.c ]
Checkpoint.
[92/12/10  20:23:33  af]
[ ./kernel/scsi/rz_labels.h ]
Alpha labels.
[92/12/01            af]
[ ./kernel/scsi/rz_tape.c ]
Changed to use common strategy routine.
Handle fixed tape errors better (idall is happy).
64bit cleanup.
[92/12/01            af]
[ ./kernel/scsi/scsi.c ]
Use SCSI_{OPEN,CLOSE,OPTIMIZE}_NULL
[93/01/14            danner]

Added initializers for up to 5 scsi busses. Proper spl typing.
[92/12/01            af]
[ ./kernel/scsi/scsi_defs.h ]
Define SCSI_{OPTIMIZE,OPEN,CLOSE}_NULL. 
	Expounded scsi_devsw_t function prototypes.
[93/01/14            danner]
[ ./kernel/sqt/interrupt.s ]
Made NMI interrupts call nmi_intr instead of t_res.  Added
allow_nmi.
[92/10/25            dbg]
Made NMI interrupts call nmi_intr instead of t_res.  Added
allow_nmi.
[92/10/25            dbg]
[ ./kernel/sqt/model_dep.c ]
Added cpu_interrupt_to_db and nmi_intr.
[92/10/25            dbg]
Added cpu_interrupt_to_db and nmi_intr.
[92/10/25            dbg]
[ ./kernel/sqt/sema.c ]
Fix calls to sched_prim functions.
[92/12/31            dbg]
[ ./kernel/sqtconf/conf_sd.c ]
Added vm_types.h include.
[93/01/14            danner]
[ ./kernel/sqtsec/if_se.c ]
Ansified preprocessor comments, fixed a static/extern problem
 with se_output.
[93/01/14            danner]
[ ./kernel/src/config/config.h ]
Added alpha.
[92/12/01            af]
[ ./kernel/src/config/config.y ]
Added alpha.
[92/12/01            af]
[ ./kernel/src/config/main.c ]
Added alpha, simplified crap.
[92/12/01            af]
[ ./kernel/src/config/mkioconf.c ]
Considerably less crap.
[92/12/01            af]
[ ./kernel/src/config/mkmakefile.c ]
Removed some confusing unused stuff.
[92/12/01            af]
[ ./kernel/src/makeboot/Makefile ]
Cross from 32 to 64 bit machines.
[92/12/01            af]
[ ./kernel/src/makeboot/alpha/exec.c ]
Created, from mips version by dbg&rpd.
[92/05/31            af]
[ ./kernel/src/makeboot/build_boot.c ]
Added cross-endian support (from Ian Dall down under :-)
Added cross-wordsize support (yours truly)
[92/12/01            af]
[ ./kernel/src/makeboot/cross_32_to_64.c ]
Created.
[92/12/10            af]
[ ./kernel/src/makeboot/cross_32_to_64.h ]
Created.
[92/12/10            af]
[ ./kernel/src/makeboot/cross_endian.h ]
Created.
[92/06/06            idall]
[ ./kernel/src/makeboot/sun3/exec.c ]
     Added support for running handling little endian
     executables on a big endian machine and visa versa.
	[92/06/06            iwd]
[ ./kernel/src/mig/Makefile ]
Added vprint.o
[93/01/11            danner]
Added CCOPTS that includes -ansi and  defines the various symbols,
e.g. MACH, CMUCS, the local header files need that aren't defined
with gcc -ansi.
Added PMAX_CCOPTS for -Dmips, which is also needed.
[92/12/17            pds]
Removed obsolete pmax compiler options.
[92/12/08            pds]
Yet more cross-compile support.
[92/12/01            af]
Removed pmax option which was cc-dependent.
[92/11/06  04:22:31  cmaeda]
[ ./kernel/src/mig/cross64.h ]
64bit cross-compile support.
[92/12/01            af]
[ ./kernel/src/mig/error.c ]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/error.h ]
Made text on #endif lines into comments.
[92/12/14            pds]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/global.c ]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/global.h ]
Made text on #endif lines into comments.
[92/12/14            pds]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/header.c ]
Made text on #endif lines into comments.
[92/12/14            pds]
Converted file and generated stub code to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/lexxer.h ]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/lexxer.l ]
Converted file to ANSI C.
[92/12/08            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/src/mig/mig.c ]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/parser.y ]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/routine.c ]
Converted file to ANSI C.
[92/12/08            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/src/mig/routine.h ]
Made text on #endif lines into comments.
[92/12/14            pds]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/server.c ]
Removed #include of string.h from WriteIncludes.
[92/12/14            pds]
Converted file and generated stub code to ANSI C.
Changed code to always use static message types.
[92/12/08            pds]

Added parentheses to expression used to round the size of in-line
arrays in order to make GCC happy.
Fixed bug checking for the Hi-C compiler: hc -> __HC__.
Made text on #endif/#else lines into comments.
Added declartions for mig_deallocate and mig_strncpy.
[92/08/06            pds]

Added #include of string.h to WriteIncludes.
[92/06/13            pds]
[ ./kernel/src/mig/statement.c ]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/statement.h ]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/string.c ]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/string.h ]
Made text on #endif lines into comments.
[92/12/14            pds]
Converted file to ANSI C.
Added constant string and identifier types.
[92/12/08            pds]
[ ./kernel/src/mig/type.c ]
Removed obsolete itTidType.
[92/12/14            pds]
Converted file to ANSI C.
Removed initialization of (Camelot) tid_t support.
[92/12/08            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/src/mig/type.h ]
Removed obsolete itTidType.
[92/12/14            pds]
Converted file to ANSI C.
[92/12/08            pds]
64bit cleanup.
[92/12/01            af]
[ ./kernel/src/mig/user.c ]
Removed #include of string.h from WriteIncludes.
[92/12/14            pds]
Converted file and generated stub code to ANSI C.
Changed code to always use static message types.
[92/12/08            pds]

Added parentheses to expression used to round the size of in-line
arrays in order to make GCC happy.
Made text on #endif/#else lines into comments.
Added declartions for mig_allocate and mig_strncpy.
[92/08/06            pds]

Changed to #include strings.h in WriteIncludes to string.h.
[92/06/13            pds]
64bit cleanup.
[92/12/23  23:20:22  af]
[ ./kernel/src/mig/utils.c ]
Converted file and generated code to ANSI C.
Changed code to always use static message types.
[92/12/08            pds]

Fixed bug checking for the Hi-C compiler: hc -> __HC__.
Made text on #endif/#else lines into comments.
[92/08/06            pds]
[ ./kernel/src/mig/utils.h ]
Made text on #endif lines into comments.
[92/12/14            pds]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/src/mig/vprint.c ]
Cleanup.
[93/01/11            danner]
Created.
[93/01/11            danner]
[ ./kernel/src/mig/write.h ]
Made text on #endif lines into comments.
[92/12/14            pds]
Converted file to ANSI C.
[92/12/08            pds]
[ ./kernel/sun/cons.c ]
Open-coded call to tty_queueempty (only one in kernel).
[92/11/18            dbg]
Open-coded call to tty_queueempty (only one in kernel).
[92/11/18            dbg]
[ ./kernel/sun3/machparam.h ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/sundev/kbd.c ]
Replaced call of ttyoutput with putc/ttstart.
[92/11/18            dbg]
Replaced call of ttyoutput with putc/ttstart.
[92/11/18            dbg]
[ ./kernel/sys/types.h ]
Added definition of size_t.
Added void * cast to the definition of NULL.
[92/12/15            pds]
[ ./kernel/sys/varargs.h ]
Added alpha.
[92/12/01            af]
[ ./kernel/vax/blkops.s ]
Ansi cpp fixes.
[93/01/14            danner]
[ ./kernel/vax/db_trace.c ]
Fixed args to db_printsym.c
[93/01/14            danner]
[ ./kernel/vax/locore.s ]
Fixed ansi cpp complaints.
[93/01/13            danner]
[ ./kernel/vax/machparam.h ]
Proper spl typing.
[92/12/01            af]
[ ./kernel/vm/memory_object.c ]
Removed unneeded cast in argument to thread_wakeup/assert_wait.
[92/12/30            dbg]

Unlock object around call to vm_map_copy_invoke_cont in
memory_object_data_supply.
[92/09/22            dbg]
64bit cleanup.
[92/12/01            af]

Unlock object around call to vm_map_copy_invoke_cont in
memory_object_data_supply.
[92/09/22            dbg]
[ ./kernel/vm/vm_debug.c ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/vm/vm_fault.c ]
Removed unneeded cast from argument to thread_wakeup_with_result.
[92/12/30            dbg]
64bit cleanup.
[92/12/01            af]

Added temporary variable to ensure that cpu_number (hence
current_thread) does not change around blocking call to zalloc.
Fix from Grenoble.
[92/10/23            dbg]
[ ./kernel/vm/vm_kern.c ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/vm/vm_map.c ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/vm/vm_map.h ]
64bit cleanup.
[92/12/10  20:49:22  af]
[ ./kernel/vm/vm_object.c ]
Added ANSI function prototypes.
[92/12/30            dbg]
64bit cleanup.
[92/12/01            af]
[ ./kernel/vm/vm_object.h ]
Added ANSI function prototypes.
[92/12/29            dbg]
64bit cleanup.  Fixed type of LockHolder.
[92/12/01            af]
[ ./kernel/vm/vm_page.h ]
Added ANSI prototypes.
[92/12/30            dbg]
64bit cleanup.
[92/12/01            af]
[ ./kernel/vm/vm_pageout.c ]
64bit cleanup.
[92/12/01            af]
[ ./kernel/vm/vm_resident.c ]
Added ANSI function prototypes.
[92/12/30            dbg]
Added vm_page_grab_contiguous_pages.
[92/12/23            af]
64bit cleanup.
[92/12/10  20:51:23  af]
64bit cleanup.
[92/12/10  20:51:23  af]
[ ./user/libmach/Makefile ]
Added mem.o to mach arches standalone library.
[93/01/11            danner]
Added new routines and files from default pager.
[92/12/10  20:52:32  af]
[ ./user/libmach/alpha/_setjmp.s ]
Created.

Created.
[89/10/12            af]
[ ./user/libmach/alpha/bcopy.c ]
Created.
[92/12/10            af]
[ ./user/libmach/alpha/bzero.c ]
Created.

Created.
[89/10/12            af]
[ ./user/libmach/alpha/crt0.c.source ]
From mips.
[92/12/10            af]
[ ./user/libmach/alpha/crt0.s ]
RCS-ed.
[92/12/10            af]
[ ./user/libmach/alpha/fork.cs ]
Created.
[92/05/31            af]
[ ./user/libmach/doprnt.c ]
64bit cleanup.
[92/12/01            af]
[ ./user/libmach/exit.c ]
Wrote atexit.  Not thread safe.
[92/11/05            cmaeda]
[ ./user/libmach/m88k/mem.c ]
Created.
[93/01/11            danner]
[ ./user/libmach/mach_init_ports.c ]
64bit cleanup.
[92/12/01            af]
[ ./user/libmach/mach_msg_destroy.c ]
64bit cleanup.
[92/12/01            af]
[ ./user/libmach/mig_allocate.c ]
Converted file to ANSI C.
[92/12/11            pds]
[ ./user/libmach/mig_deallocate.c ]
Converted file to ANSI C.
[92/12/11            pds]
[ ./user/libmach/mig_reply_setup.c ]
Converted file to ANSI C.
[92/12/11            pds]
[ ./user/libmach/mig_strncpy.c ]
Fixed include of mig_support.h.
[92/12/14            pds]
Converted file to ANSI C.
[92/12/11            pds]
[ ./user/libmach/mig_support.c ]
Changed the argument to mig_init to void * for compatibility
with the C-Threads mig_init.
[92/12/18            pds]
Converted file to ANSI C.
[92/12/11            pds]
[ ./user/libmach/mips/mem.c ]
Created.
[93/01/11            danner]
[ ./user/libmach/printf.c ]
Added protections and warnings for calls to printf before printf init.
[93/01/10            danner]
64bit cleanup.
[92/12/21  14:38:43  af]

Retry until truly flushed output, or something broken.
[92/12/01            af]
[ ./user/libmach/sbrk.c ]
Well, multimaxen are gone.  And since I am at it, cleanup
the mess the kids have made around here.  And throw in
a properly implemented brk() and _brk() pair.
[92/11/29            af]

Added pc532 support.
Changed ns32000 ifdefs to multimax ifdefs.
[92/10/06            jvh]
[ ./user/libmach/setjmp.h ]
Added alpha.
[92/12/01            af]
[ ./user/libmach/slot_name.c ]
Added Alpha.
[92/09/08            af]
[ ./user/threads/Makefile ]
Copyright update, cruft removal.
[93/01/10            danner]

Added switches for compiling with GCC -ansi to CCOPTS.
[92/12/18  16:05:37  pds]
[ ./user/threads/alpha/csw.s ]
Fixed bug in cproc_prepare, it was not setting up
the PV register properly.  Safer GP usage too.
ANSIfied comments.
[92/12/22  03:00:50  af]

Created.
[92/05/31            af]
[ ./user/threads/alpha/cthreads.h ]
Created.
[92/05/31            af]
[ ./user/threads/alpha/lock.s ]
Mumble, "try_lock" really means "try_hard_once".
That is, try hard until you either get it or lose it.
[92/12/24            af]
Created a while back.
[92/12/10            af]
[ ./user/threads/alpha/thread.c ]
Created.
[92/05/31            af]
[ ./user/threads/call.c ]
Converted file to ANSI C.
[92/12/18            pds]
[ ./user/threads/cprocs.c ]
Convert file to ANSI C.
[92/12/18            pds]
64bit cleanup.
[92/12/10  21:08:32  af]
[ ./user/threads/cthread_data.c ]
Converted file to ANSI C.
Removed usage of obsolete type any_t.
[92/12/18            pds]
[ ./user/threads/cthread_internals.h ]
Added declarations for library-internal routines.
[92/12/18            pds]

Replaced malloc and mach_error declarations with includes of
mach_error.h and stdlib.h.
[92/06/13            pds]
64bit cleanup.
[92/12/01            af]
[ ./user/threads/cthreads.c ]
Converted file to ANSI C.
Removed use of obsolete type any_t.
[92/12/18            pds]
64bit cleanup.
[92/12/01            af]

Free private_data in cthread_exit, from Mike Kupfer.
[92/11/30            af]
[ ./user/threads/cthreads.h ]
Added MACRO_BEGIN and MACRO_END to definition of spin_lock.
Fixed return value of cthread_set_data.
Added prototypes for other miscellaneous functions.
[92/12/18            pds]
Converted file to ANSI C.
Added declarations of cthread_fork_{prepare,parent,child}.
Added include of <sys/macro_help.h>.
[92/12/13            pds]

Replaced calloc declaration with an include of stdlib.h.
[92/06/15            pds]
64bit cleanup.
[92/12/02            af]
[ ./user/threads/i386/cthreads.h ]
asm -> __asm__
[93/01/10            danner]
[ ./user/threads/i386/thread.c ]
Converted file to ANSI C.
Fixed argument types.
[92/12/18            pds]
[ ./user/threads/i860/thread.c ]
Converted file to ANSI C.
Fixed argument types.
[92/12/18            pds]
[ ./user/threads/m88k/cthreads.h ]
asm -> __asm__
[93/01/10            danner]
[ ./user/threads/m88k/thread.c ]
ansification updates.
[93/01/10            danner]
[ ./user/threads/malloc.c ]
Fixed comments on #else/#endif lines.
[92/12/18            pds]
Fixed typo.
[92/12/15            pds]
Converted file to ANSI C.  Fixed realloc behavior when passed
NULL/0 arguments to conform to the ANSI standard.
[92/12/13            pds]

Fixed arguments and return type of malloc and realloc to any_t so
that they will be correctly typed if __STDC__ is defined.
Defined free as a void function.
Added includes of stdlib.h and string.h.
[92/06/13            pds]
[ ./user/threads/mig_support.c ]
Converted file to ANSI C.
Made argument to mig_init a void * for compatibility with
mig_init in libmach.
[92/12/18            pds]
[ ./user/threads/mips/csw.s ]
Fixes for ANSI CPP.
[92/08/22            jvh]
[ ./user/threads/mips/lock.s ]
Fixes for ANSI CPP.
[92/08/22            jvh]
[ ./user/threads/mips/thread.c ]
Corrected type casts; bcopy -> memcpy.
[93/01/10            danner]
Converted file to ANSI C. 
Fixed argument types. 
[92/12/18            pds]
[ ./user/threads/stack.c ]
Converted file to ANSI C.
[92/12/18            pds]
64bit cleanup.
[92/12/02            af]
[ ./user/threads/sun3/cthreads.h ]
asm -> __asm__
[93/01/10            danner]
[ ./user/threads/sun3/thread.c ]
Converted file to ANSI C.
Fixed argument types.
[92/12/18            pds]
[ ./user/threads/sync.c ]
Converted file to ANSI C.
[92/12/18            pds]
[ ./user/threads/vax/cthreads.h ]
asm -> __asm__
[93/01/10            danner]
[ ./user/threads/vax/thread.c ]
Converted file to ANSI C.
Fixed argument types.
[92/12/18            pds]
[ ./kernel/conf/Makefile.sun3 ]
Changed cflags
[ ./kernel/conf/Makefile.vax ]
Changed CPP definition.
[ ./kernel/conf/files.vax ]
Added dtop.
[ ./kernel/emul/vaxeditpc.s ]
ansi cpp fixes
[ ./kernel/mips/swapgeneric.c ]
Fixed declarations.
[ ./kernel/src/config/Makefile ]
link flag fixups
[ ./user/libmach/vax/SYS.h ]
Ansi cpp fixes.
[ ./user/threads/luna88k/cthreads.h ]
update
[ ./kernel/alpha/autoconf.c ]
Added reference to doc for the HWRPB &co.
[93/01/19            af]
[ ./kernel/alpha/prom_interface.h ]
Added reference to doc for the HWRPB &co.
[93/01/19            af]
[ ./user/threads/cprocs.c ]
Added missing spin_lock_t type from cproc_list_lock decl.
[92/12/30            af]

[ ./user/threads/alpha/csw.s ]
Locks are longs now.  Put MBs before and after releasing
locks.
[93/01/15            af]
[ ./user/threads/alpha/cthreads.h ]
Locks are now 64bits.
[92/12/30            af]
[ ./kernel/alpha/alpha_cache.s ]
Added Dcache flushing.  Should have not been necessary.
[93/01/19            af]
[ ./kernel/alpha/alpha_copyin.s ]
Added fast aligned_block_copy.
[93/01/19            af]
[ ./kernel/alpha/alpha_cpu.s ]
Added ops on MCES.
[93/01/15            af]
[ ./kernel/alpha/alpha_init.c ]
MP Icache sanity call, help Jeffrey in dprintf by delaying
dropping of bootstrap VM spaces.
[93/01/15            af]
[ ./kernel/alpha/alpha_lock.s ]
Locks are quad-words now.
[92/12/30            af]
[ ./kernel/alpha/coff.h ]
Fix TXTOFF to cope with assembler/linker incoherence viz
rounding in OMAGIC files.
[93/01/15            af]
[ ./kernel/alpha/db_interface.c ]
MP debugging works now.
[93/01/15            af]
[ ./kernel/alpha/db_trace.c ]
Locks are longs now.
[93/01/15            af]
[ ./kernel/alpha/genassym.c ]
Locks are now 64bits.
[92/12/30            af]
[ ./kernel/alpha/pcb.c ]
Horrible mess to cope with cache-coherency bugs on ADU MP.
There is also some other bug at large that prevents proper
cleanup of the switch functions. Sigh.
[93/01/15            af]
[ ./kernel/alpha/pmap.c ]
Fixed locking bug: at interrupt time one should not call
pmap_extract()  !  Made kvtophys() call the safer one.
[93/01/15            af]
[ ./kernel/alpha/pmap.h ]
Do not allocate cpusets as commons, to avoid
cacheline conflicts.
[93/01/15            af]
[ ./kernel/alpha/prom_interface.s ]
Dispatch routine works now.  Puts broken, Jeffrey fixed it
so I am not [prom takes only 32bits anyways].
[93/01/15            af]
[ ./kernel/alpha/start.s ]
Changed ADU-specific way to setup k0seg mappings into
MI way to do it, using ldqp/stqp pal calls.
[93/01/15            af]
[ ./kernel/alpha/trap.c ]
Better MP printouts.  Save more state before getting to ddb
in crashes.  Still cannot continue from a crash, though.
[93/01/15            af]
[ ./kernel/alpha/DEC/adu.c ]
Added C version of simple_lock to deal with ADU bug.
[93/01/15            af]
[ ./kernel/alpha/DEC/model_dep.c ]
Fixed prom dispatch init.
[93/01/16  12:19:28  af]
[ ./kernel/alpha/DEC/scsi_ADU_hdw.c ]
tbis does not fly, something broken cuz it should.
[93/01/16  12:22:27  af]
[ ./kernel/ddb/db_run.c ]
64bit cleanup. software single step code revision.
comment correction (jfriedl).
[92/12/10  16:20:16  af]
[ ./kernel/ddb/db_mp.c ]
More info in debugging printouts.
[92/12/26            af]
[ ./kernel/kern/lock.h ]
Underlying simple lock type is now volatile natural_t.
[93/01/19            danner]
[ ./kernel/kern/task.h ]
Corrected argument types.
[93/01/19            danner]
[ ./kernel/kern/thread.h ]
Correct arguments to natural_t.
[93/01/19            danner]
[ ./kernel/mach/alpha/alpha_instruction.h ]
Added some, removed some PAL calls.
Chosed not to put here PAL instructions (for ddb)
because I am sadly afraid they might be chip-specific.
We'll see.
[93/01/15            af]
[ ./kernel/mips/softfp.s ]
More comment fixups.
[93/01/19            danner]
[ ./kernel/src/makeboot/alpha/exec.c ]
Forgot to bzero out_header to init properly when cross.
[93/01/15            af]
[ ./bootstrap/default_pager.c ]
Updated for new ras interface
[93/01/19  16:27:16  bershad]
[ ./kernel/chips/atm.c ]
Created.
[93/01/19  16:29:30  bershad]
[ ./kernel/chips/atmreg.h ]
Created.
[93/01/19  16:29:41  bershad]
[ ./kernel/conf/MASTER ]
Enable fixpri by default.
[93/01/20            bershad]
[ ./kernel/kern/eventcount.c ]
Added evc_notify_thread_destroy_bkpt and
evc_notify_thread_destroy.
[93/01/20            bershad]
[ ./kernel/kern/task.c ]
fast tas changes.
[93/01/20            bershad]
[ ./kernel/kern/task.h ]
Expanded to allow TASK_FAST_TAS_NRAS ras.
[93/01/19  16:33:32  bershad]
[ ./kernel/kern/thread.c ]
Add call in thread_deallocate to evc_notify_thread_destroy to
deal with threads terminating while in evc_wait.
[93/01/20            bershad]
[ ./kernel/mach/mach.defs ]
New interface for task_ras_control.
[93/01/19  16:35:06  bershad]
[ ./kernel/mach/task_info.h ]
Introduced flavors for task_ras_control
[93/01/19  16:35:26  bershad]
[ ./kernel/mips/PMAX/mips_box.c ]
ecc --> atm
[93/01/19  16:35:47  bershad]
[ ./kernel/mips/conf.c ]
ecc --> atm
[93/01/19  16:36:03  bershad]
[ ./kernel/mips/trap.c ]
Fast tas, pc sample support.
[93/01/20            bershad]
[ ./user/threads/cthreads.c ]
Remove deadlock in cproc_fork_child; must release malloc lock first.
[93/01/19  16:37:43  bershad]
[ ./user/threads/mips/lock.s ]
Label movement for RAS
[93/01/19  16:38:06  bershad]
[ ./user/threads/mips/thread.c ]
Use new interface for ras control
[93/01/19  16:38:25  bershad]
[ ./kernel/src/config/mkmakefile.c ]
Update for ODE make and .mk files.
 - Replaced get_VPATH which relied on the special make variable
   MAKEPSD with VPATHopen which seaches the directories input with
   the -Iflags.
 - Changed IDENT to include conftypename for all machine types
 - Output the makevariable options from MASTER at beginning of
   Makefile.internal so they can be used to trigger conditional
   rules
Removed old history messsages.
[92/12/22            mrt]
[ ./kernel/kern/thread.h ]
Typo correction.
[ ./Makefile-common ]
Not needed by ODE make
[ ./Makeconf-site.mtoa ]
Not needed or moved for ODE make
[ ./Makefile-config ]
Not needed or moved for ODE make
[ ./Makefile-mkdirs ]
Not needed or moved for ODE make
[ ./Makefile-mklinks ]
Not needed or moved for ODE make
[ ./Makefile-subdirs ]
Not needed or moved for ODE make
[ ./Makefile-xstrip ]
Not needed or moved for ODE make
[ ./bootstrap/luna88k/exec.c ]
Not needed or moved for ODE make
[ ./bootstrap/luna88k/exec.h ]
Not needed or moved for ODE make
[ ./kernel/chips/ecc.c ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.alpha ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.alpha.local ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.i386 ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.i386.local ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.i860 ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.i860.local ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.luna88k ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.luna88k.local ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.m88k ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.m88k.local ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.mac2 ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.mac2.local ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.mips ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.mips.local ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.sun3 ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.sun3.local ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.vax ]
Not needed or moved for ODE make
[ ./kernel/conf/MASTER.vax.local ]
Not needed or moved for ODE make
[ ./kernel/conf/Makefile.alpha ]
Not needed or moved for ODE make
[ ./kernel/conf/Makefile.i386 ]
Not needed or moved for ODE make
[ ./kernel/conf/Makefile.i860 ]
Not needed or moved for ODE make
[ ./kernel/conf/Makefile.luna88k ]
Not needed or moved for ODE make
[ ./kernel/conf/Makefile.m88k ]
Not needed or moved for ODE make
[ ./kernel/conf/Makefile.mac2 ]
Not needed or moved for ODE make
[ ./kernel/conf/Makefile.mips ]
Not needed or moved for ODE make
[ ./kernel/conf/Makefile.sun3 ]
Not needed or moved for ODE make
[ ./kernel/conf/Makefile.template ]
Not needed or moved for ODE make
[ ./kernel/conf/Makefile.vax ]
Not needed or moved for ODE make
[ ./kernel/conf/files.alpha ]
Not needed or moved for ODE make
[ ./kernel/conf/files.i386 ]
Not needed or moved for ODE make
[ ./kernel/conf/files.i860 ]
Not needed or moved for ODE make
[ ./kernel/conf/files.luna88k ]
Not needed or moved for ODE make
[ ./kernel/conf/files.m88k ]
Not needed or moved for ODE make
[ ./kernel/conf/files.mac2 ]
Not needed or moved for ODE make
[ ./kernel/conf/files.mips ]
Not needed or moved for ODE make
[ ./kernel/conf/files.sun3 ]
Not needed or moved for ODE make
[ ./kernel/conf/files.vax ]
Not needed or moved for ODE make
[ ./kernel/src/config/FILES ]
Not needed or moved for ODE make
[ ./kernel/src/makeboot/luna88k/exec.c ]
Not needed or moved for ODE make
[ ./user/libmach/vax/crt0.cc ]
Not needed or moved for ODE make
[ ./user/libmach/i386/bcopy.c ]
Using bcopy.s now
[ ./kernel/conf/MASTER ]
Add mach_pcsampling option from C. Maeda.
[93/01/15  16:56:04  rvb]
[ ./kernel/conf/files ]
Add mach4 interface "defs" file and kern/pc_sample.c
[93/01/11            rvb]
[ ./kernel/i386/trap.c ]
Installed pc sampling from C Maeda; added interrupted_pc().
[93/01/12            rvb]
[ ./kernel/i386at/com.c ]
[93/01/19  11:03:26  rvb]
[ ./kernel/i386at/conf.c ]
Add d-link "600" ethernet device "de"
[92/08/13            rvb]
[ ./kernel/i386at/fd.c ]
[93/01/19  11:03:43  rvb]
[ ./kernel/i386at/fdreg.h ]
Make unit_info.addr a u_short to make inb and friends happy.
[93/01/18            rvb]
[ ./kernel/i386at/hd.c ]
Deal with DPT WD1003 emulation that clears BUSY before READY is
set.
[92/10/01            rvb]
[ ./kernel/i386at/if_de6c.c ]
Oh, well.  We don't get to distribute the sources.
[93/01/19            rvb]
Turn off debugging.
[93/01/19            rvb]
Created.
I have used if_3c501.c as a typical driver template and
spliced in the appropriate particulars for the 
d-link 600.
[92/08/13            rvb]
[ ./kernel/i386at/if_de6c.h ]
Oh, well.  We don't get to distribute the sources.
[93/01/19            rvb]
Created.
[92/08/13            rvb]
[ ./kernel/i386at/if_de6s.s ]
Oh, well.  We don't get to distribute the sources.
[93/01/19            rvb]
Created.
[92/08/13            rvb]
[ ./kernel/i386at/if_ns8390.c ]
Sigh! Sometimes the reported length of the packet is zero.  But
the rest of the chain looked OK.  So we'll just skip the packet.
[92/10/27            rvb]
[ ./kernel/i386at/if_par.c ]
Typo.
[92/10/01            rvb]
[ ./kernel/i386at/if_pc586.c ]
Found a pc586 with octets 0:0:1c
[93/01/15            rvb]
[ ./kernel/i386at/kd.c ]
Add protection around the bell timeout to prevent timeout panics.
[93/01/20            danner]
[ ./kernel/i386at/kd_mouse.c ]
Added 3 button ps2 mouse from Jim Reese.
[93/01/19  13:15:08  rvb]
[ ./kernel/i386at/lpr.c ]
Convert lpr_addr to vm_offset_t.
[93/01/19            rvb]
Add d-link "600" ethernet device "de"
[92/08/13            rvb]
[ ./kernel/kern/eventcount.c ]
rename notify routines; prototypes.
[93/01/22            danner]
[ ./kernel/kern/eventcount.h ]
Prototypes, evc_notify_abort.
[93/01/22            danner]
[ ./kernel/kern/ipc_kobject.c ]
Introduce Mach4 interface.  Initially for pc sampling.
[93/01/11            rvb]
[ ./kernel/kern/lock.h ]
Add include of mach/machine/vm_types.h
[ ./kernel/kern/mach_clock.c ]
Add pc sampling from C Maeda.  Make it conditional on thread or
task sampling being enabled.
[93/01/12            rvb]
[ ./kernel/kern/pc_sample.c ]
Lots of changes.
[93/01/12            rvb]
Created.
[92/05/10            cmaeda]
[ ./kernel/kern/task.c ]
We must explicitly set "new_thread->pc_sample.buffer = 0;" so
that we don't think we have a sampling buffer.
[93/01/13            rvb]
[ ./kernel/kern/task.h ]
Added sample_control to indicate that all the threads of the task are
to have their pc's sampled periodically.
[93/01/12            rvb]
[ ./kernel/kern/thread.c ]
Add call to evc_notify_abort to thread_abort; correct call in
 thread_terminate. 
[93/01/22            danner]

We must explicitly set "new_thread->pc_sample.buffer = 0;" so
that we don't think we have a sampling buffer.
[93/01/13            rvb]
[ ./kernel/kern/thread.h ]
Added sample_control to indicate that this threads is to
have its pc's sampled periodically.
[93/01/12            rvb]
[ ./kernel/mach/mach4.defs ]
Recast Maeda's pc sampling code into new interface file.  Also
redefined how it works.
[93/01/11            rvb]
[ ./kernel/mach/mach_types.h ]
Include the pc_sample.h definition for everyone.  The 
sample_control structure is included in task.h and thread.h.
[93/01/12            rvb]
[ ./kernel/mach/pc_sample.h ]
Added sample_control_t.
[93/01/15            rvb]
[ ./kernel/mips/PMAX/tc.c ]
ecc -> atm (bershad).
[93/01/20            danner]
[ ./kernel/mips/trap.c ]
Add include of mach_pcsample.h.

[ ./user/libmach/i386/bcopy.s ]
Make the flow a little simpler to not confuse gprof profiling,
so we can see who bcopy's
[93/01/13            rvb]
Created!
[92/10/22            rvb]
[ ./user/libmach/i386/crt0.c ]
Need -DCRT0 and -DMCRT0 versions.  MCRT0 will be done
later.
[92/11/29            rvb]
Export _eprol
[92/11/21  22:33:42  rvb]
[ ./user/libmach/i386/memcpy.s ]
Returned a pointer to the destination memory, to conform
to the specification of memcpy.
[92/10/15            mrt]
[ ./user/libmach/strcat.c ]
Created!
[92/10/22            rvb]
[ ./user/libmach/strcmp.c ]
Created!
[92/10/22            rvb]
[ ./user/libmach/strcpy.c ]
typo
[92/10/23  10:46:33  rvb]

Created!
[92/10/22            rvb]
[ ./user/libmach/strlen.c ]
Created!
[92/10/22            rvb]
[ ./user/libmach/strncpy.c ]
Created!
[92/10/22            mrt]
[ ./user/threads/cthreads.h ]
Get MACRO_BEGIN, MACRO_END, NEVER, ... from sys/macro_help.h
why define it here.
[92/10/20            rvb]
[ ./user/threads/i386/cthreads.h ]
Move ! in spin_try_lock to give the compiler
a fighting chance.
[92/11/19            rvb]
[ ./user/threads/Makefile ]
Modified for ODE make
[92/12/17            mrt]
[ ./user/threads/mig_support.c ]
Corrrected include of mach/mach.h to mach.h
[93/01/16            mrt]
[ ./user/libmach/exit.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./kernel/i386at/if_de6c.b ]
binary
[ ./bootstrap/Makefile ]
Xstrip rule now implicit.
[93/01/24            danner]

Updated for ODE make.
[93/01/01            mrt]
[ ./include/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/alpha/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/Makefile ]
Created for Reno make
[91/05/17            mrt]
[ ./kernel/chips/frc.c ]
Sandro's fixes to danner's fixes to mattz's fixes.
[93/01/17            mrt]
[ ./kernel/sun3/eeprom.h ]
Changed include of ../mon/eeprom.h to just <mon/eeprom.h>
[93/01/17            mrt]
[ ./kernel/sun3/db_machdep.h ]
Say we only support a.out files.
[93/01/18            mrt]
[ ./kernel/sunif/if_subr.c ]
assembler syntax fix
[ ./kernel/mips/softfp.s ]
comment syntax fixes
[ ./kernel/mach/time_value.h ]
Added include of mach/machine/vm_types.h to get definition
of integer_t.
[93/01/17            mrt]
[ ./kernel/vax/vax_init.s ]
Fixed a few comments. The gcc preprossesor doesn't like
comments staring with # (. Thinks they are directives.
[93/01/17            mrt]
[ ./kernel/vax/phys.s ]
Changed a few comments where the first non-blank symbol on the
line was #. The gcc preprossor took that as a directive.
[93/01/17            mrt]
[ ./kernel/vax/db_machdep.h ]
Say we only support a.out files.
[93/01/18            mrt]
[ ./user/libmach/vax/crt0.c ]
Renamed from crt0.cc to crt0.c as we do not need a special rule
since we are now using gcc 2.3.2. Also dumped romp code.
Added some extra asm magic to get function names correct
[93/01/16            mrt]
[ ./user/libmach/vax/mem.c ]
Created.
[93/01/14            danner]
[ ./user/libmach/sun3/mem.c ]
Created.
[93/01/14            danner]
[ ./user/libmach/sun3/SYS.h ]
ansi cpp fixups
[ ./user/libmach/mig_support.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./user/libmach/ms_vm_map.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./user/libmach/ms_mach_port_allocate.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./user/libmach/ms_mach_port_allocate_name.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./user/libmach/ms_mach_port_deallocate.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./user/libmach/ms_mach_port_insert_right.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./user/libmach/ms_task_create.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./user/libmach/ms_task_set_special_port.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./user/libmach/ms_task_suspend.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./user/libmach/ms_task_terminate.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./user/libmach/ms_vm_allocate.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./user/libmach/ms_vm_deallocate.c ]
Corrected include of mach/mach.h to mach.h.
[93/01/16            mrt]
[ ./kernel/mach/sun4/machine_types.defs ]
created
[ ./kernel/motorola/m88k/m88100/continuation.s ]
changed ;comments to C-style for cpp.
[93/01/25            jfriedl]
[ ./kernel/motorola/m88k/m88100/cmmu.c ]
ANSIfied. Cleaned up includes.
[93/01/22            jfriedl]
[ ./kernel/motorola/m88k/m88100/thread_status.h ]
Added #ifndef wrapper, int->unsigned
[93/01/24            jfriedl]
[ ./kernel/motorola/m88k/m88100/exvec.h ]
Removed cruft.
[93/01/25            jfriedl]
[ ./kernel/motorola/m88k/m88100/exception_return.s ]
conditionalized define of ASSEMBLER.
[93/01/22            jfriedl]
[ ./kernel/motorola/m88k/m88100/lotrap.s ]
Tidy.
[93/01/25            jfriedl]
[ ./kernel/motorola/m88k/m88100/m882xx.h ]
Added cmmu.c prototypes, fixed includes.
[93/01/22            jfriedl]
[ ./kernel/motorola/m88k/m88100/pcb.c ]
ANSIfied, cleaned up includes.
[93/01/25            jfriedl]
[ ./kernel/motorola/m88k/m88100/pcb.h ]
Cleaned up includes, added pcb.h prototypes.
[93/01/25            jfriedl]
[ ./kernel/motorola/m88k/m88100/psl.h ]
Added #ifndef file wrapper.
[93/01/25            jfriedl]
[ ./kernel/motorola/m88k/m88100/kern_setjmp.h ]
tidy.
[93/01/25            jfriedl]
[ ./kernel/motorola/m88k/m88100/misc.s ]
Conditionalied "#define ASSEMBLER".
[93/01/25            jfriedl]
[ ./kernel/motorola/m88k/cpus.h ]
int -> unsigned
[93/01/22            jfriedl]
[ ./kernel/motorola/m88k/cpu_number.h ]
Converted macro to static inline.
[93/01/22            jfriedl]
[ ./kernel/motorola/m88k/endian.c ]
ANSIfied.
[93/01/25            jfriedl]
[ ./kernel/luna88k/machdep.h ]
Created.
[93/01/24            jfriedl]
[ ./kernel/luna88k/db_machdep.h ]
added prototypes, fixed includes.
[93/01/22            jfriedl]
[ ./kernel/luna88k/autoconf.c ]
ANSIfied. Inlined and removed slave_config().
Moved cpu_configuration_print, strarg etc., from machdep.c
Cleaned up includes.
[93/01/22            jfriedl]
[ ./kernel/luna88k/board.h ]
Added #ifndef wrapper.
[93/01/24            jfriedl]
[ ./kernel/luna88k/clock.c ]
ANSIfied. Cleaned up includes.
Inlined and removed clock.h
[93/01/25            jfriedl]
[ ./kernel/luna88k/db_interface.c ]
ANSIfied, reorginized. Cleaned up includes.
[93/01/22            jfriedl]
[ ./kernel/luna88k/db_disasm.c ]
ANSIfied. Cleaned up includes.
[93/01/24            jfriedl]
[ ./kernel/luna88k/db_trace.c ]
ANSIfied. Cleaned up includes.
[93/01/25            jfriedl]

add forward declaration.
[93/01/20            danner]
[ ./kernel/luna88k/luna_init.c ]
ANSIfied. Cleaned up includes.
[93/01/25            jfriedl]
[ ./kernel/luna88k/jtermio.h ]
Added #ifndef wrapper.
[93/01/24            jfriedl]
[ ./kernel/luna88k/machdep.c ]
ANSIfied, reorginized. Cleaned out cruft.
[93/01/22            jfriedl]
[ ./kernel/luna88k/pmap_table.c ]
Fixed up includes.
[93/01/25            jfriedl]
[ ./kernel/luna88k/machine_thread.c ]
ANSIfied.
[93/01/25            jfriedl]
[ ./kernel/luna88k/nvram.h ]
Added #ifndef file wrapper.
[93/01/24            jfriedl]
[ ./kernel/luna88k/trap.c ]
ANSIfied, cleaned up includes.
[93/01/23            jfriedl]

Added interrupted_pc()
[93/01/21            jfriedl]
[ ./kernel/luna88k/pio.h ]
Added #ifndef file wrapper
[93/01/24            jfriedl]
[ ./kernel/luna88k/db_sstep.c ]
ANSIfied.
[93/01/25            jfriedl]
[ ./kernel/luna88k/eh.s ]
Replaced ;comments with C-style comments for better CPPification.
[93/01/22            jfriedl]
[ ./kernel/luna88k/softint.c ]
ANSIfied. Cleaned up includes.
[93/01/23            jfriedl]
[ ./kernel/luna88k/rom1ep.h ]
Added #ifndef file wrapper.
[93/01/24            jfriedl]
[ ./kernel/luna88k/lcd.h ]
Renamed #ifndef wrapper.
[93/01/24            jfriedl]
[ ./kernel/luna88k/softint.h ]
Added #ifndef file wrapper, prototypes.
[93/01/24            jfriedl]
[ ./kernel/luna88k/locore.h ]
Removed NEWLINE define (now in object area's assym.s)
Added #ifndef file wrapper.
[93/01/22            jfriedl]
[ ./kernel/luna88k/locore.s ]
Replaced ;comments with C-style comments for better CPPification.
[93/01/22            jfriedl]
[ ./kernel/luna88k/fb.h ]
Added #ifndef wrapper
[93/01/24            jfriedl]
[ ./kernel/luna88k/locore_asm_routines.s ]
Replaced ;comments with C-style comments for better CPPification.
Cleaned up includes. Removed unused byte_* fcns, other old cruft.
[93/01/22            jfriedl]
[ ./kernel/luna88k/locore_c_routines.c ]
Cleaned up includes. ANSIfied.
[93/01/25            jfriedl]
[ ./kernel/luna88k/rawprint_asm_routines.s ]
Replaced ;comments with C-style comments for better CPPification.
Some gcc cleanup.
[93/01/22            jfriedl]
[ ./kernel/luna88k/rawprint_c_routines.c ]
Tidy.
[93/01/25            jfriedl]
[ ./kernel/m88k/asm.h ]
Added #ifndef file wrapper.
[93/01/24            jfriedl]
[ ./kernel/m88k/genassym.c ]
tidied up.
[93/01/24            jfriedl]
[ ./kernel/m88k/machparam.h ]
Added defines to shadow endian.c, include of luna88k/machdep.h
[93/01/24            jfriedl]
[ ./kernel/m88k/mmu.h ]
Removed unused prototypes. Added invalidate_pte prototype.
[93/01/25            jfriedl]
[ ./kernel/m88k/pmap.c ]
ANSIfied. Cleaned up includes.
[93/01/22            jfriedl]
[ ./kernel/m88k/pmap.h ]
Added pmap.c's prototypes, fixed include files.
[93/01/23            jfriedl]
[ ./kernel/m88k/asm_macro.h ]
Created.
[93/01/24            jfriedl]
[ ./kernel/luna88kdev/cons.c ]
ANSIfied.
[93/01/25            jfriedl]
[ ./kernel/luna88kdev/kbmain.c ]
ANSIfied.
[93/01/25            jfriedl]
[ ./kernel/luna88kdev/msmain.c ]
caddr_t->vm_offset_t
[93/01/25            jfriedl]
[ ./kernel/luna88kdev/uart.c ]
caddr_t -> vm_offset_t
[93/01/25            jfriedl]
[ ./kernel/luna88kdev/lcd.c ]
Minor mods to sync with ANSIfication of other MD files
[93/01/25            jfriedl]
[ ./kernel/luna88kdev/fb.c ]
caddr_t -> vm_offset_t.
[ ./bootstrap/sun4/exec.c ]
Updated copyright.
[93/01/12            berman]

Created for Sparc port of MACH 3.0
[92/02/03            berman]
[ ./kernel/mach/sun4/boolean.h ]
Updated copyright.
[93/01/12            berman]

Created for Sparc (sun4) port from MACH 2.5 sources.
[93/01/12            berman]
[ ./kernel/mach/sun4/exception.h ]
Updated copyright.
[93/01/12            berman]

Copied from MACH 2.5 for Sparc (sun4) port.
[93/01/12            berman]
[ ./kernel/mach/sun4/kern_return.h ]
Updated copyright.
[93/01/12            berman]

Created from MACH 2.5 version for Sparc port.
[93/01/12            berman]
[ ./kernel/mach/sun4/syscall_sw.h ]
Updated copyright.
[93/01/12            berman]

Created for Sparc (sun4) port.
[93/01/12            berman]
[ ./kernel/mach/sun4/thread_status.h ]
Updated copyright.
[93/01/12            berman]

Changed fpa to fpu.
[92/07/28            berman]

Created for Sparc port of MACH 3.0
[92/02/07            berman]
[ ./kernel/mach/sun4/vm_param.h ]
Updated copyright.
[93/01/12            berman]

Created for Sparc port of MACH 3.0
[92/02/04            berman]
[ ./kernel/mach/sun4/vm_types.h ]
Recreated wholesale from af.
[93/01/24            danner]
[ ./kernel/mon/openprom.h ]
Updated copyright.
[93/01/12            berman]

Created for Sparc port of MACH 3.0  Changed dev_ops to
sundev_ops to avoid name clashes.
[92/03/03            berman]
[ ./kernel/mon/sunromvec.h ]
Replaced entire contents with updated version from
MACH 2.5 for Sparc (sun4) port.
Condensed history follows:

Modified for SPARCstation I port.
[90/11/09            berman]

[89/07/05  20:17:55  jjc]

Picked up new version for Sun 4.
[89/03/30            jjc]

More cleanup.

Added new copyright and #ifndef <filename>_H_ around whole
	file as part of kernel cleanup.
	Removed else leg of CMU conditionals as part of kernel cleanup.
	[89/02/09            jjc]

16-Jul-87 Mary Thompson (mrt) at Carnegie-Mellon University
[ ./kernel/pixrect/cg1var.h ]
Created from MACH 2.5 port for Sparc.
[93/01/13            berman]
[ ./kernel/pixrect/cg2var.h ]
Created from MACH 2.5 port for Sparc.
[93/01/13            berman]
[ ./kernel/pixrect/cg3var.h ]
Created from MACH 2.5 port for Sparc.
[93/01/13            berman]
[ ./kernel/pixrect/cg4var.h ]
Created from MACH 2.5 port for Sparc.
[93/01/13            berman]
[ ./kernel/pixrect/cg6fbc.h ]
Created from MACH 2.5 port for Sparc.
[93/01/13            berman]
[ ./kernel/pixrect/cg6tec.h ]
Created from MACH 2.5 port for Sparc.
[93/01/13            berman]
[ ./kernel/pixrect/cg6thc.h ]
Created from MACH 2.5 port for Sparc.
[93/01/13            berman]
[ ./kernel/pixrect/cg6var.h ]
Created from MACH 2.5 port for Sparc.
[93/01/13            berman]
[ ./kernel/pixrect/memvar.h ]
Updated copyright.
[93/01/12            berman]
Updated with changes for Sparcstation port of MACH 3.0.
[92/11/13            berman]
[ ./kernel/pixrect/pr_impl_util.h ]
Updated copyright.
[93/01/12            berman]
Created for Sparcstation port of MACH 3.0.
[92/11/13            berman]
[ ./kernel/sbusdev/audio.c ]
Fixed args to assert_wait().
[93/01/26            berman]

Changed SLEEP to call audio_sleep() which provides both MACH
3.0 compatibility and returns the int value that SLEEP()
is expected to return.
[93/01/18            berman]
Upadated copyright.
[93/01/14            berman]

Converted for MACH_KERNEL use redefining SLEEP and WAKEUP,
changing include files, and replacing ioctl with get/setstat.
[92/11/17            berman]

Defined dev_ops to be sundev_ops to prevent name clash.
[92/03/03            berman]
[ ./kernel/sbusdev/audioio.h ]
Updated copyright.
[93/01/14            berman]

Placed here for Sparcstation port of MACH 3.0.  
	Fixed 'i' in _IOWR().
[92/11/17            berman]
[ ./kernel/sbusdev/audioreg.h ]
Placed here for Sparcstation port of MACH 3.0.
Updated copyright.
[93/01/14            berman]
[ ./kernel/sbusdev/audiovar.h ]
Placed here for Sparcstation port of MACH 3.0.
Updated copyright.
[93/01/14            berman]
[ ./kernel/sbusdev/bwtwo.c ]
Placed here for Sparcstation port of MACH 3.0.
Updated copyright.
[93/01/14            berman]
[ ./kernel/sbusdev/cg6reg.h ]
Updated copyright.
[93/01/14            berman]

Created for MACH 3.0 on Sparcstations.
[92/11/13            berman]
[ ./kernel/sbusdev/cgsix.c ]
Cleaned up side-effecting if() in cg6_update-cmap() to 
compute then test.
[93/01/18            berman]
Updated copyright.
[93/01/14            berman]

Created for MACH 3.0 on Sparcstations.
[92/11/13            berman]
[ ./kernel/sbusdev/cgthree.c ]
Placed here for Sparcstation port of MACH 3.0.
Updated copyright.
[93/01/14            berman]
[ ./kernel/sbusdev/dmaga.c ]
Placed here for Sparcstation port of MACH 3.0.
Updated copyright.
[93/01/14            berman]
[ ./kernel/sbusdev/dmaga.h ]
Placed here for Sparcstation port of MACH 3.0.
Updated copyright.
[93/01/14            berman]
[ ./kernel/sbusdev/fbutil.c ]
Placed here for Sparcstation port of MACH 3.0.
Updated copyright.
[93/01/14            berman]
[ ./kernel/sbusdev/fd.c ]
Placed here for Sparcstation port of MACH 3.0.
Updated copyright.
[93/01/14            berman]
[ ./kernel/sbusdev/fdreg.h ]
Placed here for Sparcstation port of MACH 3.0.
Updated copyright.
[93/01/14            berman]
[ ./kernel/sbusdev/fdvar.h ]
Placed here for Sparcstation port of MACH 3.0.
Updated copyright.
[93/01/14            berman]
[ ./kernel/sbusdev/memfb.h ]
Placed here for Sparcstation port of MACH 3.0.
Updated copyright.
[93/01/14            berman]
[ ./kernel/src/makeboot/sun4/exec.c ]
Created for Sparc (sun4) port.  Updated copyright.
[93/01/12            berman]
[ ./kernel/sun/autoconf.h ]
Updated copyright.
[93/01/12            berman]
Added Sparc definitions for MACH 3.0 port.
[92/02/10            berman]
[ ./kernel/sun/conf.c ]
Updated copyright.
[93/01/12            berman]
Added audio driver entry points.
[92/12/28            berman]
[ ./kernel/sun/cons.c ]
Updated copyright.
[93/01/12            berman]
Added tp argument to kbdfreset() call in cnopen().
[92/12/21            berman]

Upgraded with changes from Mach 2.5 to support sun4 and sun4c
SPARC architectures.
[92/03/04            berman]
[ ./kernel/sun/dkio.h ]
Updated copyright.
[93/01/12            berman]
Added lots of definitions for Sparcstation port of 3.0.
Added conditionals to switch on Relese 4 version
options in this file.
[92/12/24            berman]
[ ./kernel/sun/dklabel.h ]
Updated copyright.
[93/01/12            berman]
Added lots of definitions for Sparcstation port of 3.0.
Added conditionals to switch on Relese 4 version
options in this file.
[92/12/24            berman]
[ ./kernel/sun/fbio.h ]
Updated copyright.
[93/01/12            berman]
Created for Sparc port of MACH 3.0.  Fixed all _IO* to
quote the 'F'.
[92/11/17            berman]
[ ./kernel/sun/heap_kmem.c ]
Updated copyright.
[93/01/12            berman]
Created from MACH 2.5 version to ease integration
of Sparc device drivers.  This can eventually go away.
[92/12/24            berman]
[ ./kernel/sun/mb_machdep.c ]
Updated copyright.
[93/01/12            berman]
Conditionalized out test for zero pfnum in mb_mapalloc
since page zero is valid for DVMA mapping under 3.0.
[93/01/11            berman]
Created from MACH 2.5 version for Sparc port
of MACH 3.0.
[92/12/24            berman]
[ ./kernel/sun/openprom_util.c ]
Added include of pmap.h.  Remove include of scsi/scsi.h.
[93/01/25            berman]

Updated copyright.
[93/01/12            berman]
Modified for MACH 3.0.
[92/03/12            berman]
[ ./kernel/sun/softint.c ]
Updated copyright.
[93/01/12            berman]
Created for Sparc port of MACH 3.0.  Moved from sun3/softint.c
to sun/softint since this is used for both models.
[92/03/23            berman]
[ ./kernel/sun3/machparam.h ]
Add htonl.
[93/01/25            danner]
[ ./kernel/sun4/asm_linkage.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0 This files contains
compatibility definitions for SunOS based applications which
want access the register windows stack protocol.
[92/02/04            berman]
[ ./kernel/sun4/ast.h ]
Updated copyright.
[93/01/14            berman]
Created for Sun4 MACH 3.0 port.
[92/02/10            berman]
[ ./kernel/sun4/audio_asm.s ]
Fixed single quotes.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Fixed include of interreg.h
[93/01/13            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/autoconf.c ]
Converted old concat to ansi ## operator.
[93/01/25            berman]

Moved pseudo_inits extern declaration to outside the function
for gcc.
[93/01/22            berman]
Updated copyright.
[93/01/14            berman]
Changed finddev() to function correctly under MACH 3.0 and
removed conditionals that previously disabled its use.
Changed consconfig() to correctly identify console input
keyboard and to change its indirect table entry when found.
Re-enabled localetheraddr() call in idprom() conditional on le
device being in configuration.
[92/12/22            berman]
Changed all the dev_ops to sundev_ops to prevent name clash.
[92/03/03            berman]

Created for Sparc port of MACH 3.0
[92/02/19            berman]
[ ./kernel/sun4/auxio.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/buserr.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/clock.c ]
Updated copyright.
[93/01/14            berman]
Changed error message when clock seems corrupt.  Updated to 
view 1992 as reasonable base.
[92/11/16            berman]
Modified for MACH 3.0.  Flushd mmu_getpte() mmu_setpte()  simply
use getpgmap() and setpgmap().
[92/03/13            berman]
[ ./kernel/sun4/clock.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/context.s ]
Removed all the single quotes.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Deleted dead code.  Rewrote Switch_context again, using
flush_windows and %wim manipulation.
[92/09/16            berman]
Radically changed Switch_context and fixed up call_continuation
to set the wim to the previous window.
[92/07/23            berman]
Created for Sparc port of MACH 3.0
[92/02/04            berman]
[ ./kernel/sun4/coproc.s ]
Removed all single quotes.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Created (a skeleton) for use later when we encounter 
coprocessors.
[93/01/13            berman]
[ ./kernel/sun4/copy.s ]
Removed all single quotes.
[93/01/25            berman]

Added memcpy entry point.  Calls bcopy.
[93/01/18            berman]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/cpu.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/crt.s ]
Removed all single quotes.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/db_disasm.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/db_interface.c ]
Moved extern declarations of softcall() and enter_kdb()
to make visible for later use.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Fixed type clash in db_phys_eq().
[92/12/24            berman]
Updated to support memory access in both kernel and user space.
[92/10/15            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/db_machdep.h ]
Added DB_NO_COFF.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Updated to support access to memory in both kernel and user
space.
[92/10/15            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/db_reg.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/db_trace.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/diag.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/11            berman]
[ ./kernel/sun4/eccreg.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/eeprom.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/enable.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/11            berman]
[ ./kernel/sun4/exec.h ]
Updated copyright.
[93/01/14            berman]
Created from various sources for the Sparc port of Mach 3.0
[92/02/03            berman]
[ ./kernel/sun4/fd_asm.s ]
Removed all single quotes.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Modified for MACH 3.0.
[92/03/12            berman]
[ ./kernel/sun4/float.s ]
Converted concat operators to ## operator for ansi.
Removed all single quotes.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Fixed for MACH 3.0.  Conditionally fix the saved psr
on the stack and in the pcb->sss structure in enable_fp.  
Purged all non-MACH code.
[92/12/08            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/addsub.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/compare.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/div.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/fpu.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/fpu_simulator.c ]
Repaird broken sccsid string.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/fpu_simulator.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/globals.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/ieee.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/iu_simulator.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/mul.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/pack.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/unpack.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/utility.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/fpu/uword.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/genassym.c ]
Updated copyright.
[93/01/14            berman]
Changed definitions of KSTACK_START and KSTATE_START to be
consistent with actual stack model used.
[92/07/24            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/ieeefp.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/interreg.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/kgdb_stub.c ]
Fixed kgdbacc() to not try to use current_thread() unless in
user mode.
[93/01/21            berman]
Updated copyright.
[93/01/14            berman]
Changed include file name to be mach_kgdb.h to match config
option.
[93/01/13            berman]
Deleted confusing consdev struct.
[92/12/22            berman]

Fixed (yet again) memory set/get operations for kernel space
accesses.  Also frob boothowto if we reboot via halt_all_cpus().
[92/12/16            berman]

Removed some of the state being sent over to remove debugger.
The TBR, FSR, and CSR can be left out for now.
[92/12/08            berman]
Fixed get/set memory to work with user space via ddb routines.
[92/10/15            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/locore.s ]
Removed all the single quotes.
[93/01/25            berman]

Converted concat operators to ## operator for ansi.
[93/01/25            berman]

Changed beq to be.  This is the correct syntax.
[93/01/20            berman]
Updated copyright.
[93/01/14            berman]
Added hook in user_return to let C code check state of 
register file before returning to user mode.
[93/01/13            berman]

Rewrote native system call handling code
to deal with 0 to 11 arguments all here in locore.
[92/12/31            berman]
Changed emulated syscall dispatch to store return addr in g1.
[92/12/10            berman]

Cleaned up lots of dead code.  Conditionally removed code
to save extra state into sparc_saved_state.  Changed handlers
for coprocessor exceptions to point to (soon to come) coprocessor
driver.
[92/12/07            berman]

Reinstall psr icc when syscall is handled by emulator.
[92/11/25            berman]
Changes to emulator dispatch for emulated syscalls to make
correct jump location.  Also changes to flush windows code to
correct that user trap.
[92/10/15            berman]
Changed handling of trap T_FLUSH_WINDOWS, deleted some debugging
code, reduced the exception frame storage from user trap to just
the psr.  Removed syscall debugging code.
[92/09/16            berman]
Rearranged argument handling in syscall_native to not use %i0.
Removed note_ast debugging code.  Rearranged
thread_bootstrap_return to always use window 0.
[92/08/11            berman]
Cleaning up some debugging code.
[92/07/31            berman]
Commented out the MINFRAME+REGSIZE adjustments of the stack
pointer since KSTACK_START now includes that.  Removed extra
nops.
[92/07/24            berman]
Some changes to thread_bootstrap and user_exception to handle wim
and psr correctly.
[92/07/22            berman]
Cleaned out some scaffolding.
[92/07/21            berman]
Rewrote fault() to handle cleanly both 4_60 and 4_70 type bus
error register hardware.  Supply trap() with correct rw argument.
This can be eliminated with minimal work in trap().
[92/05/06            berman]

Created for Sparc port of MACH 3.0.  Eliminated all the old code.
Use dynamic calculation of nwindows.  Use all the latest fixes
from MACH 2.6.  Flushed most of the PARTIAL_ALIGN assembly, because
in MACH 3.0 we don't touch user stacks from here.
[92/02/11            berman]
[ ./kernel/sun4/mach_param.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/machparam.h ]
Protect typedef inside !ASSEMBLER.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Created and completely restructured for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/map.s ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/mem.c ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/memerr.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/mmu.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/model_dep.c ]
Updated copyright.
[93/01/14            berman]
Ifdef'ed out buscheck() code that enforces DVMA physical pages
be in a restricted range. MACH 3.0 does not require
this restriction.
[93/01/13            berman]
Changed to inittodr() with base argument it expects.  
Read the clock first to provide base time.
[92/11/16            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/ocsum.s ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/openprom_xxx.c ]
Adjusted include files to get pmap.h.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Turned off path_debug.
[92/12/24            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/overflow.s ]
Removed all the single quotes.
[93/01/25            berman]

Cleaned up conditionals around EXTRA_STATE code
to use correct macro.
[93/01/21            berman]
Updated copyright.
[93/01/14            berman]
Deleted wrong code that skipped reload of %g1 and %g2 before
returning to user.  Fixed some bugs in going to trap() for
	missing stacks.  Fix getting the page map entry for fault addr.
[92/09/24            berman]
Cleaned up some debugging code.  Restore trap psr when doing user
overflow with no stack.
[92/08/19            berman]
Commented out adjustment of stack by MINFRAME+REGSIZE since
it is taken care of now in KSTACK_START.
[92/07/24            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/pcb.c ]
Added some casts to args of db_printsym().
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Added definition of syscall_emulation_sync() for future use.
[93/01/13            berman]
Changed stack_handoff() and switch_context() to recognize new
pcb field pcb_pend_sp and to flush user windows to stack when 
new thread will be switching stacks on resume.  Also give the
	psr in thread_get_state.
[92/12/24            berman]

Changed value of arg_size in set_user_regs().
[92/12/07            berman]
Changed allocation of pcbs to be long-word aligned a la m88k.
Modularized debugging code.  Deleted dead functions.
[92/09/16            berman]
Made some changes to debugging code, set psr and i7 in
stack_attach.  Added PMAP_CONTEXT calls in stack_handoff and
switch_context.  Added spl protection around manipulations of
active_threads and active_stacks.
[92/07/24            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/pcb.h ]
Updated copyright.
[93/01/14            berman]
Added (null) definition of syscall_emulation_sync();
[93/01/13            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/pmap.c ]
Updated copyright.
[93/01/14            berman]
Fixed spelling of EMPTY everyhere.  Conditionalized the QUEUE
EMPTY printf in all the *_enq_ck() functions to need CHECK 
defined as 2 or more before printing.  Condtionalized call
to pmeg_remq_ck() in pmeg_free() under CHECK.  
[92/12/18            berman]

Fixed minor bug in ppg_out() which had a mis-placed break.
[92/11/13            berman]
Turned on all the WATCH and PARANOIA checks, fixed code that was
under these conditionals to check wired bits correctly, and
deleted references to old vm_page_array.
[92/10/15            berman]
Created for Sparc port of MACH 3.0.  Eliminated all the old code.
Use dynamic calculation of nwindows.  Use all the latest fixes
from MACH 2.6.
[92/02/11            berman]
[ ./kernel/sun4/pmap.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0, updated with standard 3.0
macros.
[92/02/10            berman]
[ ./kernel/sun4/psl.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/10            berman]
[ ./kernel/sun4/reg.h ]
Updated copyright.
[93/01/14            berman]
Fixed REGSIZE.
[92/07/23            berman]
Created for Sparc port of MACH 3.0.  This files contains
compatibility definitions for SunOS based applications which
want access the register windows stack protocol.
[92/03/30            berman]
[ ./kernel/sun4/romvec.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/scb.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/11            berman]
[ ./kernel/sun4/scsi/adapters/esp.c ]
Changed includes of scsi/.. to sun4/scsi/..
Added missing local function declarations.
[93/01/25            berman]

Updated copyright
[93/01/14  09:14:15  berman]

Undid changes to DELAY calls for MACH 3.0.
[93/01/13            berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/adapters/espreg.h ]
Made u_char volatile for registers.
[93/01/22            berman]
Updated copyright
[93/01/14  09:14:23  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/adapters/espvar.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:14:26  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/adapters/ncr.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:14:30  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/adapters/ncrctl.h ]
Updated copyright
[93/01/14  09:14:38  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/adapters/ncrreg.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:14:41  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/adapters/ncrsbc.h ]
Updated copyright
[93/01/14  09:14:44  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/adapters/sc.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:14:46  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/adapters/screg.h ]
Updated copyright
[93/01/14  09:14:52  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/adapters/udc.h ]
Updated copyright
[93/01/14  09:14:55  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/conf/autoconf.h ]
Updated copyright
[93/01/14  09:15:01  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/conf/device.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:04  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/conf/scsi_confdata.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:14:58  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/conf/scsi_confsubr.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:08  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/generic/commands.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:11  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/generic/dad_mode.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:29  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/generic/inquiry.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:14  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/generic/message.h ]
Updated copyright
[93/01/14  09:15:17  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/generic/mode.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:32  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/generic/sense.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:19  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/generic/status.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:24  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/commands.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:39  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/inquiry.h ]
Updated copyright
[93/01/14  09:16:15  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/mode.h ]
Updated copyright
[93/01/14  09:16:17  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/pkt_wrapper.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Added pad1 to scsi_cmd to keep cmd_cdb aligned.
[93/01/21            berman]
Updated copyright
[93/01/14  09:15:35  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/scsi_capabilities.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:48  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/scsi_control.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:50  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/scsi_data.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:45  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/scsi_resource.c ]
Changed includes of scsi/.. to sun4/scsi/..
Corrected args to assert_wait().
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:42  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/scsi_subr.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:15:53  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/scsi_transport.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:16:03  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/sense.h ]
Updated copyright
[93/01/14  09:15:56  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/services.h ]
Updated copyright
[93/01/14  09:15:58  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/status.h ]
Updated copyright
[93/01/14  09:16:05  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/transport.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:16:09  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/types.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:16:12  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/impl/uscsi.h ]
Updated copyright
[93/01/14  09:16:20  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/scsi.h ]
Updated copyright
[93/01/14  09:16:26  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/scsi_address.h ]
Updated copyright
[93/01/14  09:16:23  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/scsi_ctl.h ]
Updated copyright
[93/01/14  09:16:33  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/scsi_params.h ]
Updated copyright
[93/01/14  09:16:28  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/scsi_pkt.h ]
Updated copyright
[93/01/14  09:16:39  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/scsi_resource.h ]
Updated copyright
[93/01/14  09:16:36  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/scsi_types.h ]
Updated copyright
[93/01/14  09:17:30  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/targets/sd.c ]
Changed includes of scsi/.. to sun4/scsi/..
Fixed sleep macro and made prototypes for missing statics.
Added some local extern declarations for strcpy().
[93/01/25            berman]

Corrected some static declarations for gcc.
[93/01/20            berman]
Updated copyright
[93/01/14  09:16:44  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]

Added a definition for u.u_error and a macro to replace sleep().
Changed MACH_KERNEL conditional appropriately.
[92/07/29            berman]
[ ./kernel/sun4/scsi/targets/sd_conf.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:17:14  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/targets/sddef.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:16:50  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/targets/sf.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:16:55  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/targets/sfdef.h ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:16:59  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/targets/sr.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:17:18  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/targets/srdef.h ]
Updated copyright
[93/01/14  09:17:25  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/targets/st.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:17:03  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/targets/st_conf.c ]
Changed includes of scsi/.. to sun4/scsi/..
[93/01/25            berman]

Updated copyright
[93/01/14  09:17:28  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/scsi/targets/stdef.h ]
Updated copyright
[93/01/14  09:17:11  berman]

Created for Sparc (sun4) port temporarily
until the SunOS based drivers can be flushed.
[93/01/13            berman]
[ ./kernel/sun4/setjmp.h ]
Updated copyright.
[93/01/14            berman]
Created from various sources for Sparc port of MACH 3.0
[92/02/04            berman]
[ ./kernel/sun4/setjmp.s ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/04            berman]
[ ./kernel/sun4/setroot.c ]
Updated copyright.
[93/01/14            berman]
Added explicit unit=0 in sun4c case to fix annoying bug in
boot-up.
[92/11/16            berman]
Removed some debugging code.
[92/10/15            berman]
Created for Sparc port of MACH 3.0
[92/03/16            berman]
[ ./kernel/sun4/subr.s ]
Removed all the single quotes.
Ifdefed out the insque and remque functions.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0.  Relocated some
locore functions to here (set_auxioreg, servicing_interrupt,
montrap, getvbr, and boom).
[92/03/10            berman]
[ ./kernel/sun4/sun_init.c ]
Updated copyright.
[93/01/14            berman]
Change to make the kernel image writeable for now.
[92/12/17            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/thread.h ]
Updated copyright.
[93/01/14            berman]
Conditionally deleted EXTRA_STATE from struct sparc_saved_state
and added pcb_pend_sp to save pending stack pointer changes.
[92/12/07            berman]
Added pcb_ioerror to pcb struct for use as u.u_error in device
drivers.
[92/07/29            berman]
Changed definitions for MKSTACK_START and STACK_MKS
[92/07/23            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/time_stamp.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/trap.c ]
Fixed astoff() to have argument, added MACH_PCSAMPLE code.
Fixed thread_block() arg.
[93/01/25            berman]

Check current_thread() before using it in trap().
[93/01/20            berman]
Updated copyright.
[93/01/14            berman]
Adjusted lots of debugging code.  Rewrote syscall
tracing to use new interface.
[93/01/13            berman]
Some debugging code changes for floating point and user faults.
[92/12/24            berman]
Implemented flush windows code for user level flush trap.
Changed some debugging code to be more accurate.
[92/10/15            berman]
Deleted some old code.  Changed some debugging printfs.
[92/09/16            berman]
Removed some debugging code and added some window overflow
counters.
[92/07/24            berman]
Added tracing for window underflow.
[92/07/22            berman]
Created for Sparc port of MACH 3.0.  Rewrote extensively.  Added
continuations.  Removed gotos in trap().  Call exception at end
if exc is set.
[92/05/06            berman]
[ ./kernel/sun4/trap.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/02/11            berman]
[ ./kernel/sun4/underflow.s ]
Removed all the single quotes.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Fixed some debugging code to operate using locals that get
clobbered by real user locals.
[92/11/25            berman]

Remove bogus debugging code.
[92/11/18            berman]
Updated with some changes from dlc to fix state storage during
bad underflows.
[92/10/14            berman]
Cleaned up user underflow without stack.  Added some debugging
code.  Restore trap psr when going deeper into kernel.
[92/08/19            berman]
Commented out adjustment of stack by MINFRAME+REGSIZE since
it is taken care of now in KSTACK_START.
[92/07/24            berman]
Changed all the underflow handling to work with new
	MACH 3.0 register file conventions.
[92/07/22            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/varargs.h ]
Added GNU support.
[93/01/18            berman]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/vm_tuning.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/xpr.h ]
Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sun4/zs_asm.s ]
Removed the single quotes.
[93/01/25            berman]

Updated copyright.
[93/01/14            berman]
Created for Sparc port of MACH 3.0
[92/07/15            berman]
[ ./kernel/sundev/kbd.c ]
Added prototype for kbdqueuepress.
[93/01/26            berman]

Updated copyright.
[93/01/12            berman]
Updated copyright.
[93/01/11            berman]
Changed much of the kbdinput() state machine to cope
correctly with sun4 keyboards.  Support keyclick in the 
OPENPROM way when available.  Added debugging code controlled
by a conditional.
[92/12/24            berman]

Fixed some bugs and added OPENPROM support for sun4c keyboards.
	Make keyboard writeable before kbdreset() in kbdopen().
[92/12/23            berman]

Added changes for Sparcstation port of MACH 3.0
[92/03/11            berman]
[ ./kernel/sundev/kbd.h ]
Updated copyright.
[93/01/12            berman]
Updated copyright.
[93/01/11            berman]
Added sun4 and vt220 keyboard id values.
[92/12/24            berman]
[ ./kernel/sundev/keytables.c ]
Updated copyright.
[93/01/12            berman]
Updated copyright.
[93/01/11            berman]
Updated keytables from SunOS 4.0.3c for Sparcstation Port 
of MACH 3.0 (added Sun4 and vt220 keytables).
[92/12/24            berman]
[ ./kernel/sundev/mbvar.h ]
Updated copyright.
[93/01/12            berman]
Updated copyright.
[93/01/11            berman]
Added DVMA and IOPB macro definitions for sun4.
[92/12/24            berman]

Conditionalize out pritospl() for sun4 (see psl.h)
[92/03/04            berman]
[ ./kernel/sundev/subr_rmap.c ]
Updated copyright.
[93/01/12            berman]
Updated copyright.
[93/01/11            berman]
Picked up fix from MACH 2.5:
Allow negative addresses to be passed to rmfree() because
the kernel starts at 0xf8000000 on the Sun 4.
[92/04/20            berman]
[ ./kernel/sundev/subr_rmap.h ]
Updated Copyright.
[93/01/12            berman]
Updated copyright.
[93/01/11            berman]
Added some sun4/sparc definitions to make this compatible with
imported drivers.
[92/03/16            berman]
[ ./kernel/sundev/zs_async.c ]
Fixed arguments to assert_wait().
[93/01/26            berman]

Updated copyright.
[93/01/12            berman]
Updated copyright also.
[93/01/11            berman]
Locally define MACH_KDB 1 here for keyboard interrupt on console
serial line.
[93/01/11            berman]
Some changes for sun4 machines, and some OSF/1 hacks 
for compatibility.  A ^P debugger entry point too.
[92/11/25            berman]
[ ./kernel/sundev/zs_common.c ]
Updated copyright.
[93/01/12            berman]
Updated copyright.
[93/01/11            berman]
Many changes for Sparcstion port of MACH 3.0.
Added conditionals for sparc specific code, and changed
sun3 to machine.
[92/12/24            berman]
[ ./kernel/sunif/if_le.c ]
Corrected some static declarations for gcc.
[93/01/20            berman]
Replaced entire contents of this file with updated driver from
MACH 2.5 and back-merged 3.0 changes.
[93/01/12            berman]
[ ./kernel/sunif/if_lereg.h ]
Replaced entire contents of this file with updated version from
MACH 2.5 port.
[93/01/12            berman]
[ ./kernel/sunif/if_levar.h ]
Created for Sparc (sun4) port from MACH 2.5 version.
[93/01/12            berman]
[ ./kernel/sunif/if_subr.c ]
Updated copyright.
[93/01/12            berman]
Fixed conditionals for sun4 in if_log_2() to have
only 1 return.
[92/12/24            berman]
Conditionalized sun3 code appropriately to prevent
asm statements with sun3 assembly from being compiled
for sun4.  Lifted if_log_2() from mips/PMAX/if_se.c
for sun4.  Added localetheraddr and ether_print routines.
[92/12/24            berman]
[ ./user/libmach/sun4/DEFS.h ]
Added copyright, and history section.
Created for Sparc (sun4) port from MACH 2.5 sources.
[93/01/12            berman]
[ ./user/libmach/sun4/PIC.h ]
Added copyright, and history section.
Created for Sparc (sun4) port from MACH 2.5 sources.
[93/01/12            berman]
[ ./user/libmach/sun4/SYS.h ]
Added copyright, and history section.
Created for Sparc (sun4) port from MACH 2.5 sources.
[93/01/12            berman]
[ ./user/libmach/sun4/_setjmp.s ]
Added copyright, and history section.
Created for Sparc (sun4) port from MACH 2.5 sources.
[93/01/12            berman]
[ ./user/libmach/sun4/bcopy.s ]
Added copyright, and history section.
Created for Sparc (sun4) port from MACH 2.5 sources.
[93/01/12            berman]
[ ./user/libmach/sun4/bzero.s ]
Added copyright, and history section.
Created for Sparc (sun4) port from MACH 2.5 sources.
[93/01/12            berman]
[ ./user/libmach/sun4/crt0.s ]
Added GNU support.
[93/01/18            berman]
Added updated history.
[93/01/12            berman]

Changed epilog from cthread_init_routine to use returned stack
pointer if present.
[92/07/21            berman]
[ ./user/libmach/sun4/div.s ]
Created for Sparc (sun4) port.
[93/01/12            berman]
[ ./user/libmach/sun4/fork.s ]
Added updated copyright.
[93/01/12            berman]

Added history section and code to call mach_init routine
to reset ports. [from dlc]
[ ./user/libmach/sun4/main.s ]
Created.
[93/01/19            berman]
[ ./user/libmach/sun4/memcpy.s ]
Created for Sparc (sun4) port.
[93/01/12            berman]
[ ./user/libmach/sun4/multiply.s ]
Created for Sparc (sun4) port.
[93/01/12            berman]
[ ./user/libmach/sun4/ptr_call.s ]
Created for Sparc (sun4) port.
[93/01/12            berman]
[ ./user/libmach/sun4/rem.s ]
Created for Sparc (sun4) port.
[93/01/12            berman]
[ ./user/libmach/sun4/stret1.s ]
Created for Sparc (sun4) port.  This must go ASAP!
[93/01/12            berman]
[ ./user/libmach/sun4/stret2.s ]
Created for Sparc (sun4) port.  This must go ASAP!
[93/01/12            berman]
[ ./user/libmach/sun4/stret4.s ]
Created for Sparc (sun4) port.  This must go ASAP!
[93/01/12            berman]
[ ./user/libmach/sun4/umultiply.s ]
Created for Sparc (sun4) port.
[93/01/12            berman]
[ ./user/threads/cthreads.h ]
Updated include of mach/mach.h to mach.h

[ ./user/threads/sun4/csw.s ]
Created for Sparc (sun4) port.  Updated copyright.
[93/01/12            berman]
[ ./user/threads/sun4/cthread_inline.awk ]
Created for Sparc (sun4) port.  Updated copyright.
[93/01/12            berman]
[ ./user/threads/sun4/cthreads.h ]
Updated copyright.
[93/01/12            berman]

Created for Sparc port of Mach 3.0
[92/02/03            berman]
[ ./user/threads/sun4/lock.s ]
Created for the Sparc (sun4) port.  Updated copyright.
[93/01/12            berman]
[ ./user/threads/sun4/thread.c ]
Created for Sparc (sun4) port.  Updated
copyright.  Need to delete debugging code soon.
[93/01/12            berman]
[ ./kernel/sun4/BINARY/cg2_rop.b ]
binary
[ ./kernel/sun4/BINARY/cg4_colormap.b ]
binary
[ ./kernel/sun4/BINARY/mem_colormap.b ]
binary
[ ./kernel/sun4/BINARY/mem_kern.b ]
binary
[ ./kernel/sun4/BINARY/mem_rop.b ]
binary
[ ./kernel/sun4/BINARY/pr_clip.b ]
binary
[ ./kernel/sun4/BINARY/pr_dblbuf.b ]
binary
[ ./kernel/sun4/BINARY/pr_plngrp.b ]
binary
[ ./kernel/sun4/BINARY/pr_reverse.b ]
binary
[ ./kernel/sun4/BINARY/rect.b ]
binary
[ ./kernel/sun4/BINARY/rectlist.b ]
binary
[ ./kernel/sun4/BINARY/strcat.b ]
binary
[ ./kernel/sun4/BINARY/cg2_colormap.b ]
binary
[ ./kernel/ipc/ipc_kmsg.h ]
Replaced include of kern/thread.h with ipc/ipc_kmsg_queue.h
[ ./kernel/ipc/ipc_kmsg_queue.h ]
Created to break latent circularity between ipc_kmsg_queue.h and kern/thread.h
[93/01/27            danner]
[ ./kernel/kern/thread.h ]
Break latent include circularity by introduction of ipc_kmsg_queue.h. 


[ ./kernel/kern/mach_clock.c ]
take_pc_sample() is void.
[93/01/25            jfriedl]
[ ./kernel/kern/printf.c ]
printf_init(), sprintf() are void.
[93/01/25            jfriedl]

Updated copyright.
[93/01/12            berman]
Wrote a version of sprintf() for general use.
[92/03/18            berman]
[ ./kernel/kern/debug.c ]
Updated copyright.
[93/01/12            berman]
Changed sun conditional to be sun3, and added sun4 code
in Debugger().
[93/01/11            berman]
[ ./kernel/kern/queue.c ]
Remove ifdef sun around insque and remque.
[93/01/25            danner]
[ ./kernel/kern/pc_sample.c ]
take_pc_sample() is void, get_sampled_pcs is static return_t
[93/01/25            jfriedl]
[ ./kernel/i386/locore.s ]
Make tenmicrosec() generally available.  Clean up comment.
[93/01/25            rvb]
[ ./bootstrap/Makefile ]
Added -Dsun4c to Sun 4 CFLAGS (after the include of rules.mk).
It is needed for now to get the right parameters for allocating
the stack.
[93/01/29            dlc]
[ ./kernel/mon/cpu.addrs.h ]
Added copyright. Fixed nested comment warning pointed out by gcc
-Wall.
[93/01/29            dlc]
[ ./kernel/mon/openprom.h ]
Removed nested start comment sequence by proper closing history
message comment.
[93/01/29            dlc]
[ ./kernel/sbusdev/memfb.h ]
Fixed nested comment warning pointed out by gcc -Wall; in this
case some constant definitions (probably not used) were commented
out.
[93/01/29            dlc]
[ ./kernel/sun/dklabel.h ]
Fixed nested comment warnings pointed out by gcc -Wall
[93/01/29            dlc]
[ ./kernel/sun4/autoconf.c ]
Added (int) cast to sizeof division expressions in fill_devinfo()
since getproplen() may return -1 and we want to "do the right
thing"; set the result to 0.  Added proper aggregate initializor
to "prop" variable and since SBUS_SPACE is treated as unsigned
make the decode_address() parameters unsigned (both pointed out
by gcc -Wall).
[93/01/29            dlc]
[ ./kernel/sun4/fd_asm.s ]
Fixed nested comment warning pointed out by gcc -Wall
[93/01/29            dlc]
[ ./kernel/sun4/fpu/fpu_simulator.h ]
Fixed nested comment warnings pointed out by gcc -Wall
[93/01/29            dlc]
[ ./kernel/sun4/fpu/globals.h ]
Fixed nested comment warnings pointed out by gcc -Wall
[93/01/29            dlc]
[ ./kernel/sun4/scsi/adapters/esp.c ]
Fixed nested comment warning pointed out by gcc -Wall
[93/01/29            dlc]

Corrected typo in prototype for esp_twobyte_msg().
[93/01/27            berman]
[ ./kernel/sun4/scsi/adapters/espvar.h ]
Fixed nested comment warning pointed out by gcc -Wall
[93/01/29            dlc]
[ ./kernel/sun4/scsi/generic/inquiry.h ]
Fixed nested comment warnings pointed out by gcc -Wall; the
definition of DPQ_VUNIQ (probably unused) was omitted.
[93/01/29            dlc]
[ ./kernel/sunif/if_le.c ]
Fixed nested comment warning pointed out by gcc -Wall
[93/01/29            dlc]
[ ./kernel/motorola/m88k/m88100/m882xx.h ]
Added () to NBPG define.
[93/01/28            jfriedl]
[ ./kernel/device/chario.c ]
Extend buffering down to 300 baud.
[93/01/27            danner]

Refined pdma support (feedback from rvb & af).
[93/01/27            danner]
[ ./kernel/device/tty.h ]
Added TS_MIN_TO_RCV definition.
[93/01/27            danner]
[ ./kernel/device/device_init.c ]
Added call to chario_init.
[93/01/25            danner]
[ ./kernel/luna88k/autoconf.c ]
Made bitfields unsigned.
[93/01/26            jfriedl]
[ ./kernel/luna88k/db_trace.c ]
Put 'signed' attribute to bitfield in is_jump_source_ok.
[93/01/26            jfriedl]
[ ./kernel/kern/eventcount.c ]
Remove evc_signal panic for suspension case.
[93/01/28            danner]
[ ./kernel/sys/types.h ]
Updated copyright.
[93/01/12            berman]
Added label_t for sparc compilers.
[92/12/24            berman]
[ ./kernel/sys/varargs.h ]
Updated copyright.
[93/01/12            berman]
Added sparc clause to include sun4/varargs.h.
[92/12/24            berman]
[ ./kernel/vax/asm.h ]
Added include of gcc_asm.h to compensate for lack of working -include switch.
[ ./kernel/vax/ast.h ]
Include gcc_asm.h
[ ./kernel/vax/pmap.h ]
Include gcc_asm.h

[ ./kernel/vax/genassym.c ]
Add symbols from boot_info.
[93/01/27            dbg]
[ ./kernel/vax/trap.c ]
Added bcopy and bzero fro routines that couldn't find it from
 inline.
[93/01/26            danner]
[ ./kernel/vax/phys.s ]
Cpp cleanups.
[ ./kernel/vax/dfloat.s ]
Cpp fixup.
[ ./kernel/vax/locore.s ]
Cpp fixups.
[ ./kernel/vax/vax_init.s ]
Changed '(r3)+' to 'OFFSET(r3)' to deal with boot_info block
changes.
[93/01/27            dbg]
[ ./kernel/sun3/genassym.c ]
Add symbols from boot_info.
[93/01/28            dbg]
[ ./kernel/sun3/trap.c ]
Added interrupted_pc.
[93/01/25            danner]
[ ./kernel/sun3/locore.s ]
Use symbolic offsets into boot_info block.
[93/01/28            dbg]
[ ./kernel/src/mig/mig.sh ]
Changed the "fixing-up" of dependencies to work with the
ODE md program and gcc 2.3.2.
[92/12/09            mrt]
[ ./kernel/src/makeboot/m88k/exec.c ]
Fix includes.
[ ./kernel/ipc/ipc_object.c ]
return 0 in ipc_object_copyin_type if panic/assert returns.
[93/01/25            jfriedl]
[ ./kernel/ddb/db_command.c ]
Removed unused (and incorrect) decl of db_machine_cmds.
[93/01/25            jfriedl]
[ ./kernel/ddb/db_aout.c ]
aout_db_search_by_addr returns boolean_t.
[93/01/25            jfriedl]
[ ./kernel/chips/lance_mapped.c ]
Put return types on some functions to quiet warnings.
[93/01/25            jfriedl]
[ ./kernel/chips/lance.c ]
Removed ntohl def from LUNA section (now in machine/machparam.h)
[93/01/25            jfriedl]
[ ./kernel/chips/dtop_hdw.c ]
Made all printfs conditional
[93/01/25            danner]
[ ./kernel/scsi/rz_cpu.c ]
Removed unused variable 'tgt' from sccpu_act_as_target().
[93/01/25            jfriedl]
[ ./user/libmach/setjmp.h ]
Added some definitions for GCC support and generic sun4 support.
[93/01/18            berman]
Added sun4 support. Updated copyright.
[93/01/12            berman]
[ ./user/libmach/Makefile ]
Sun4 support (from berman).
[93/01/24            danner]

Fixed the mig rules for parallel make.
[93/01/24            mrt]

Update ras calls.
[93/01/20            danner]

Modified for ODE make
[93/01/14            mrt]
[ ./user/libmach/sun3/SYS.h ]
Cpp fixups.
[ ./user/libmach/sbrk.c ]
Updated copyright.
Changed sun to sun3 in #ifs.  Added #else clause for non-mips
case to define curbrk and minbrk. [from dlc]
[93/01/12            berman]
[ ./user/libmach/m88k/gcc.c ]
Removed memcpy.
[93/01/20            danner]
[ ./user/libmach/m88k/mem.c ]
Memcpy def.
[ ./user/threads/alpha/thread.c ]
mach/mach.h -> mach.h
[93/01/28            danner]
[ ./bootstrap/kalloc.c ]
Honest prototypes, void *'s.
[93/01/28            danner]
[ ./bootstrap/queue.h ]
Fixed comment-with-comments.
[93/01/27            jfriedl]
[ ./bootstrap/alpha/exec.c ]
mach/mach.h -> mach.h
[93/01/28            danner]
[ ./kernel/src/makeboot/build_boot.c ]
Added defines for types that sys/stat.h uses that the
kernel version of sys/types.h does not define.
[93/02/02            mrt]
[ ./user/threads/i386/thread.c ]
Changed include of mach/mach.h to mach.h.
[93/02/02            mrt]
[ ./user/threads/i860/thread.c ]
Changed include of mach/mach.h to mach.h
[93/02/02            mrt]
[ ./user/threads/m88k/thread.c ]
Changed include of mach/mach.h to mach.h
[93/02/02            mrt]
[ ./user/threads/mips/thread.c ]
Changed include of mach/mach.h to mach.h
[93/02/02            mrt]
[ ./user/threads/sun3/thread.c ]
Changed include of mach/mach.h to mach.h
[93/02/02            mrt]
[ ./user/threads/vax/thread.c ]
Changed include of mach/mach.h to mach.h
[93/02/02            mrt]
[ ./user/threads/luna88k/csw.s ]
Moved to m88k
[ ./user/threads/luna88k/cthread_inline.awk ]
Moved to m88k
[ ./user/threads/luna88k/cthreads.h ]
Moved to m88k
[ ./user/threads/luna88k/lock.s ]
Moved to m88k
[ ./user/threads/luna88k/thread.c ]
Moved to m88k
[ ./user/libmach/luna88k/_setjmp.cs ]
Moved to m88k
[ ./user/libmach/luna88k/_setjmp.h ]
Moved to m88k
[ ./user/libmach/luna88k/bcopy.c ]
Moved to m88k
[ ./user/libmach/luna88k/bzero.c ]
Moved to m88k
[ ./user/libmach/luna88k/crt0.ss ]
Moved to m88k
[ ./user/libmach/luna88k/fork.ss ]
Moved to m88k
[ ./user/libmach/luna88k/gcc.c ]
Moved to m88k
[ ./kernel/sun/mb_machdep.c ]
Corrected argument to assert_wait().
[93/01/27            berman]
[ ./kernel/device/dev_pager.c ]
Prototyped.
[93/02/01            danner]

Prototyped.
[93/02/01            danner]
[ ./kernel/luna88k/eh.s ]
luna88k/asm.h -> m88k/asm.h
[93/02/02            jfriedl]
[ ./kernel/luna88k/locore.s ]
luna88k/asm.h -> m88k/asm.h
[93/02/02            jfriedl]
[ ./kernel/luna88k/locore_asm_routines.s ]
luna88k/asm.h -> m88k/asm.h
[93/02/02            jfriedl]
[ ./kernel/mach/machine.h ]
PS2 support.
[93/01/18            prithvi]
[ ./kernel/sys/macro_help.h ]
Cast down from UX.
[ ./kernel/vm/vm_object.h ]
Added vm_object_page_map prototype.
[93/02/02            danner]
[ ./kernel/sun3/sun_init.c ]
Missing parenthesis addition (berman).
[ ./kernel/sundev/scsi.h ]
Fixed nested comment.
[ ./kernel/sundev/sdreg.h ]
Nested comment removal.
[ ./kernel/alpha/DEC/adu.c ]
Added C version of simple_lock to deal with ADU bug.
[93/01/15            af]
Created, from the DEC specs:
"Alpha Demonstration Unit Specification"
V1.0, Aug 1990.
[92/06/02            af]
Created.
[92/12/10            af]
[ ./kernel/alpha/genassym.c ]
Fixpri fixes.
<<<log message for ./kernel/alpha/genassym.c>>>
48a49
> #include <mach_fixpri.h>
327c328
< 	check((char*)&thread->swap_func,char,(8+4+4+8+8+4+4+4+4+4))
---
> 	check((char*)&thread->swap_func,char,(8+4+4+8+8+4+4 +4+4+4))
330c331,332
< 	check(&thread->recover,vm_offset_t,(8+4+4+8+8+4+4 +4+4+4+4+4+4+4+4+4+4+4+4+4+4+4+4))
---
> 	check(&thread->recover,vm_offset_t,(8+4+4+8+8+4+4 +4+4+4 +4+4+4+4+4+4+4+4
> 		+(MACH_FIXPRI*8) +4+4+4+4+4))
332c334
< 		16+8+8+16+16+8+8 +8+8+8+8 +8+4+4+4+4+4+4+4+4+4+4+8/*align*/);
---
> 		16+8+8+16+16+8+8 +8+8+8+8 +8+4+4+4+4+4+4+4 +(MACH_FIXPRI*8) +4+4+4+8/*align*/);
343c345,346
< 	check(&thread->recover,vm_offset_t,(8+4+4+8+8+4 +4+4+4+4+4+4+4+4+4+4+4+4+4+4+4+4))
---
> 	check(&thread->recover,vm_offset_t,(8+4+4+8+8+4 +4+4+4 +4+4+4+4+4+4+4+4
> 		+(MACH_FIXPRI*8) +4+4+4+4+4))
345c348,349
< 		16+8+8+16+16+8/*align*/+8+8+8+8 +8+4+4+4+4+4+4+4+4+4+4+8/*align*/);
---
> 		16+8+8+16+16+8/*align*/+8+8+8+8 +8+4+4+4+4+4+4+4  +(MACH_FIXPRI*8)
> 		+4+4+4+8/*align*/);
[ ./kernel/alpha/thread.h ]
Missing indirection in user_regs declaration.
[93/02/02            danner]
[ ./kernel/alpha/trap.c ]
Added pc_sampling support
[93/02/02            danner]
[ ./kernel/i386/_setjmp.s ]
Convert asm comment "/" over to "/ *" "* /"
[93/01/27            rvb]
[ ./kernel/i386/bcopy.s ]
Convert asm comment "/" over to "/ *" "* /"
[93/01/27            rvb]
[ ./kernel/i386/bzero.s ]
Convert asm comment "/" over to "/ *" "* /"
[93/01/27            rvb]
[ ./kernel/i386/cswitch.s ]
Convert asm comment "/" over to "/ *" "* /"
[93/01/27            rvb]
[ ./kernel/i386/fpu.c ]
Add PS2 to #if AT386 conditional.
[93/01/25            rvb]
[ ./kernel/i386/gdt.c ]
Merge in PS2 support.
[92/02/22            dbg@ibm]
[ ./kernel/i386/genassym.c ]
Remove struct i386_fpsave_state (not used).
[92/06/02            dbg@ibm]

PS2 support.
[92/02/24            dbg@ibm]
[ ./kernel/i386/hardclock.c ]
Integrate PS2 and non PS2 cases into one routine.
[93/01/25            rvb]

Don't check for SPL 0 here.  Interrupt return code checks
for pending softclock interrupt.
[92/04/19            dbg@ibm]

PS2-only version.  Different interrupt stack format,
clock interrupt reset code.  Does NOT use ABIOS.
[92/03/30            dbg@ibm]
[ ./kernel/i386/interrupt.s ]
	Convert asm comment "/" over to "/ *" "* /"
[93/01/28            rvb]

Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386/locore.s ]
Added special case of TIME_TRAP_UENTRY for system calls:
TIME_TRAP_SENTRY.  It needs to save and restore %eax around the
call to timer_normalize.  Fix from OSF Grenoble.
[93/01/20            dbg]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386/pic.c ]
Take care of PS2!
[93/01/25            rvb]
[ ./kernel/i386/pic.h ]
Added PS2 to #ifdef AT386 cases.
[93/01/25            rvb]
[ ./kernel/i386/pit.c ]
Make spinwait() and tenmicrosec() [findspeed() & microtime()]
available for everyone.  They once were but they were incorrect.
Re-add tenmicrosec for PS2.
[92/02/25           dbg@ibm]
[ ./kernel/i386/pit.h ]
Add PS2 to #if AT386.
[93/01/25            rvb]
[ ./kernel/i386/seg.h ]
Merge in PS2 support.
[92/02/22            dbg@ibm]
[ ./kernel/i386/start.s ]
Replace lost ps2 asm_startup include.
[ ./kernel/i386/spl.s ]
Convert asm comment "/" over to "/ *" "* /"
[93/01/27            rvb]
[ ./kernel/i386at/lpr.c ]
Warning fixups.
[93/01/27            danner]
[ ./kernel/i386ps2/asm_startup.h ]
PS2 version
[92/02/24            dbg@ibm]
[ ./kernel/i386ps2/abios.c ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/abios.h ]
Integrate PS2 code from IBm.
[93/01/18            prithvi]
[ ./kernel/i386ps2/abioscall.s ]
Defined NO_ABIOS_INTERRUPTS here instead of as a config option.
[93/01/16            chs]

Set thread stack descriptor base address in abioscall.
[92/03/24            dbg@ibm]
[ ./kernel/i386ps2/kd_mouse_io.h ]
Removed non-ansi-style ioctl definitions.
[93/01/18            chs]

Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/autoconf.c ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/bus.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/conf.c ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/debugf.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/fd.c ]
Disable media-change detection for the floppy to allow booting
from them in the microkernel world.
[93/01/18            zon]

Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/fd_abios.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/fdreg.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/gdabios.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/hd.c ]
Using i386at/disk.h rather than i386ps2/disk.h == They are
identical. 
[93/01/25            rvb]

Changed to new partition scheme.
Pick up recent bugfixes from i386at/hd.c.
[93/01/18            zon]

Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/hdreg.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/if_common.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/if_tr.c ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/if_trreg.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/if_trvar.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/kd.c ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/kd_abios.c ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/kd_mouse.c ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/kd_var.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/kd_mouse_abios.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/kdabios.h ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/model_dep.c ]
Initialize NMI here.
[92/03/30            dbg@ibm]

Add io_space_offset_to_addr - first step in IO space object
[92/03/22            dbg@ibm]

PS2 version
[92/02/24            dbg@ibm]
[ ./kernel/i386ps2/nmi.c ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
[ ./kernel/i386ps2/pic_mca.c ]
Integrate PS2 code from IBM.
[93/01/18            prithvi]
Synched 2.5 & 3.0 at I386q (r2.1.1.2) & XMK35 (r2.1)
[90/11/15            rvb]

We don't want to see clock interrupts till clkstart(),
but we can not turn the interrupt off so we disable them.
2.5 ONLY!
[90/11/05            rvb]
Created based on pic.c
[90/06/16            rvb]
[ ./user/libmach/alpha/mem.c ]
Created.
[ ./bootstrap/mips/exec.c ]
Changed include of mach/mach.h to mach.h
[93/02/04            mrt]
[ ./bootstrap/i386/exec.c ]
Changed mach/mach.h to mach.h.
[93/02/04            mrt]
[ ./bootstrap/vax/exec.c ]
Changed mach/mach.h to mach.h.
[93/02/04            mrt]
[ ./bootstrap/sun3/exec.c ]
Changed mach/mach.h to mach.h.
[93/02/04            mrt]
[ ./bootstrap/Makefile ]
Made xstripping rule explicit again as it has been
removed from osf.mach3.mk.
[93/02/02            mrt]
[ ./user/libmach/Makefile ]
Added mem.o for the alpha
[ ./bootstrap/Makefile ]
Removed the installation of bootstrap. This file is only
used during a kernel build when it is found in export.
[93/02/04            mrt]
[ ./kernel/src/mig/migcom.c ]
renamed from mig.c

[ ./kernel/src/mig/mig.c ]
renamed to migcom.c
[ ./kernel/src/mig/include/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/src/mig/include/alpha/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/src/mig/include/i386/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/src/mig/include/m88k/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/src/mig/include/machine/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/src/mig/include/mips/Makefile ]
Created to export include files that mig uses
[ ./kernel/src/mig/include/sun3/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/src/mig/include/sun4/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/src/mig/include/vax/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/src/config/sun/sun_mkioconf.c ]
Added sun4/ to the path to include scsi/conf/..  We are
only temporarily using the sun scsi package.
[93/01/28            berman]

	Upgraded for sun4 (SPARC) port of MACH 3.0. -by Berman
Moved the sun specific code from mkioconf.c, so that we
   can restrict it's distributon to holders of SUN/OS licenses.
   This code derived from code in SUN/0S 3.5 and 4.0 sources
[93/01/25            mrt]
[ ./kernel/include/mach/i386/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/mach/i860/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/mach/sun3/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/mach/mips/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/mach/vax/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/mach/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/mips/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/vax/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/i386/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/i860/Makefile ]
Updated for ODE
[ ./kernel/include/sun3/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/src/Makefile ]
Created for ODE make.
[92/12/24            mrt]
[ ./kernel/src/makeboot/Makefile ]
Created for ODE makefile
[93/01/29            mrt]
[ ./kernel/src/mig/Makefile ]
Updated for ODE make.
[93/01/16            mrt]
[ ./kernel/src/doconf/Makefile ]
Modifed for ODE make.
[92/12/23            mrt]
[ ./kernel/src/config/main.c ]
Changed input parameters from -d <source_directory> to [-I<dir>]*
   to allow a search path to be used to find the input files.
   Needed to make shadowing work.
	Added CONFTYPE_SUN4C for Sparc (sun4) port. - by berman
Condensed History
[92/12/22            mrt]
[ ./kernel/src/config/parse.l ]
profile is now a keyword that can be set in the configuration
   file and with -p on the command line.
Integrated PS/2 code from IBM - by Prithvi
	Added device-driver, target, and scsibus for Sparc (sun4)
	   port. -by Berman
[93/01/21            danner]

Renamed from config.l, updated copyright and condensed
history
[93/01/16            mrt]
[ ./kernel/src/config/config.h ]
16-Jan-93 Mary Thompson (mrt) at Carnegie-Mellon University
Updated for switch from single source_directory to search_path.
	Integrated PS2 code from IBM - from Prithvi
Removed CONFTYPE_ROMP,MMAX
	Added d_init and d_intr to struct device for Sparc (sun4) - from Berman
	Condensed history.
[ ./kernel/src/config/mkglue.c ]
Updated copyright.
[92/12/22            mrt]
[ ./kernel/src/config/mkheaders.c ]
Updated copyright.
	Additions for Sparc (sun4) port. - berman
[93/01/24            mrt]
[ ./kernel/src/config/mkioconf.c ]
Updated copyright, condensed history.
Added 386_ioconf for PS/2 support from IBM - by prithvi
Moved the sun specific code to a separate file for
   licensing reasons.
[93/01/24            mrt]
[ ./kernel/src/config/gram.y ]
PROFILE is now a keyword that can be set in the configuration
file and has the same effect as "-p" on the command line. (rvb).
Added PS/2 code from IBM - by Prithvi
Removed ROMP and MMAX conftyptes - by mrt
	Lots of changes and additions for Sparc (sun4) port of MACH 3.0
    -by Berman
Renamed from config.y to gram.y and condensed history. -by mrt
[93/01/21            danner]
[ ./kernel/src/config/Makefile ]
Modifed for ODE make.
[92/12/23            mrt]
[ ./user/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/src/config/config.l ]
renamed to parse.l
[ ./kernel/src/config/config.y ]
renamed to gram.y
[ ./kernel/src/config/mk ]
no longer used
[ ./kernel/mips/conf.c ]
added include of vm_types to make conf.h work.
[93/02/04            mrt]
[ ./kernel/conf/copyright ]
Update to 1993
[ ./kernel/conf/i386/MASTER ]
Flush blit and par; add dlink ethernet de device.
lineno is now defined in MI MASTER
	Integrate PS2 code from IBM. - by prithvi, rvb
[93/01/21            danner]
[ ./kernel/conf/i386/MASTER.local ]
Moved from conf/MASTER.i386.local

[ ./kernel/conf/i386/files ]
Add dlink support.
	Integrate PS2 code from IBM. -by prithvi
[93/01/21            danner]
[ ./kernel/conf/i386/template.mk ]
Updated for ODE make.
[93/01/16            mrt]
[ ./kernel/conf/mips/MASTER ]
ecc renamed atm. Reenable fast_tas (bershad).
Removed lineno as it is now defined in MI MASTER (mrt)
[93/01/20            danner]
[ ./kernel/conf/mips/MASTER.local ]
Moved from conf/MASTER.mips.local

[ ./kernel/conf/mips/files ]
replaced ecc device with atm.
[93/01/20            danner]
[ ./kernel/conf/mips/template.mk ]
Updated for ODE make and gcc2.3.2.
[93/01/16            mrt]
[ ./user/threads/mips/thread.c ]
The sins of the advisor are visited on the student. 
[93/02/04            pds]
[ ./kernel/conf/sun3/files ]
Moved from conf/files.sun3

[ ./kernel/conf/sun3/MASTER.local ]
Moved from MASTER.sun3.local

[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
Flamingo changes
[93/01/31            af]
[ ./kernel/conf/vax/MASTER ]
Removed lineno as it is now defined in MI MASTER.
[93/01/25            mrt]
[ ./kernel/conf/vax/MASTER.local ]
moved from conf/*.vax
[ ./kernel/conf/vax/files ]
moved from conf/*.vax
[ ./kernel/conf/sun4c/MASTER ]
Moved from conf/*.sun4c
[ ./kernel/conf/sun4c/MASTER.local ]
Moved from conf/*.sun4c
[ ./kernel/conf/sun4c/files ]
Moved from conf/*.sun4c
[ ./kernel/conf/sun4c/template.mk ]
Changes for compiling under ode.
Added -Xlinker flag for -X to ld.
[93/01/26            berman]
[ ./kernel/conf/sun4/MASTER ]
Moved from conf/*.sun4
[ ./kernel/conf/sun4/MASTER.local ]
Moved from conf/*.sun4
[ ./kernel/conf/sun4/files ]
Moved from conf/*.sun4
[ ./kernel/conf/sun4/template.mk ]
Moved from conf/*.sun4
[ ./kernel/conf/alpha/MASTER ]
lineno is now in the MI MASTER std defintion.
[93/01/25            mrt]
[ ./kernel/conf/alpha/MASTER.local ]
Moved from conf/*.alpha
[ ./kernel/conf/alpha/files ]
Moved from conf/*.alpha
[ ./kernel/conf/alpha/template.mk ]
Updated for ODE make.
[93/01/16            mrt]
[ ./kernel/conf/m88k/MASTER ]
Added ipc_compat.
[93/02/03            jfriedl]

Removed lineno as it is now defined in MI MASTER.
[93/01/25            mrt]
[ ./kernel/conf/m88k/MASTER.local ]
added [danner]
[ ./kernel/conf/m88k/files ]
Removed reference to empty file sys_machdep.c
[93/01/23            jfriedl]
[ ./kernel/conf/m88k/template.mk ]
Added "OBJSDEPS=assym.s" so assym.s is available to all.
Removed CC_OPT_LEVEL assignment since it is the same as 
in the MI template.mk -- mrt
[93/01/25            jfriedl]
[ ./kernel/conf/i860/MASTER ]
Moved from conf/*.i860
[ ./kernel/conf/i860/MASTER.local ]
Moved from conf/*.i860
[ ./kernel/conf/i860/files ]
Moved from conf/*.i860
[ ./kernel/conf/i860/template.mk ]
Moved from conf/Makefile.i860. Probably needs more work
before it is correct with the ODE make.
[93/02/04            mrt]
[ ./kernel/conf/Makefile ]
Created for ODE make.
[92/12/26            mrt]
[ ./kernel/conf/MASTER ]
Defined LINENO which is now selected by default. It can be
overridden in the machine dependent MASTER files.
Changed ident from mach to mach_kernel.
[93/02/04            mrt]
[ ./Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./Makeconf ]
Updated for ODE make.
	Set MAKEOBJDIR from OBJECTDIR which is set in
	setup.sh
[92/12/12            mrt]
[ ./include/m88k/Makefile ]
Added asm.h
[93/02/02            jfriedl]

Created for ODE make
[92/12/17            mrt]
[ ./include/i386/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/Makefile ]
M88K_EXTRA_DIRS -> LUNA88K_EXTRA_DIRS
[93/02/04            jfriedl]

Add sys to subdirs.
[93/01/25            danner]
[ ./include/mips/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/sun3/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/vax/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/luna88k/Makefile ]
Removed varargs.h, exec.h, asm.h (now in m88k); added mouse.h
[93/02/02            jfriedl]

Created for ODE make
[92/12/17            mrt]
[ ./include/sun4/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/sys/Makefile ]
Created for ODE make.
[92/12/17            mrt]
[ ./include/mach/mips/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/mach/sun3/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/mach/i386/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/mach/vax/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/mach/i860/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/mach/m88k/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/mach/alpha/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/mach/sun4/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/mach_debug/Makefile ]
Created for ODE make.
[92/12/17            mrt]
[ ./include/device/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./include/scsi/Makefile ]
Created for ODE make.
[92/12/17            mrt]
[ ./include/chips/Makefile ]
Created for ODE make.
[92/12/17            mrt]
[ ./include/mach/Makefile ]
Add mach4.defs
Created for ODE make -mrt
[93/01/21            danner]
[ ./kernel/include/i860/Makefile ]
Created for ODE make.
[93/02/04            mrt]
[ ./kernel/include/alpha/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/Makefile ]
Removed the ${TARGET_MACHINE} stuff as it was unused
[93/02/04            mrt]
[ ./kernel/include/sun4/Makefile ]
Added some more include files.
[93/01/25            berman]

Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/m88k/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/mach/alpha/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/mach/sun4/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/include/mach/m88k/Makefile ]
Created for ODE make
[92/12/17            mrt]
[ ./kernel/src/config/mkmakefile.c ]
Fixed up support for profiling.
[93/01/21            mrt]
[ ./include/Makefile-include ]
not used in ODE make
[ ./include/Makefile-machine ]
not used in ODE make
[ ./include/Makefile-midevice ]
not used in ODE make
[ ./kernel/luna88k/asm.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/ast.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/ast_types.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/clock.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/cpu_number.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/exec.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/genassym.c ]
no longer needed or moved to m88k
[ ./kernel/luna88k/lock.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/locore/asm_utils.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/locore/debug_msg.c ]
no longer needed or moved to m88k
[ ./kernel/luna88k/locore/eh.c ]
no longer needed or moved to m88k
[ ./kernel/luna88k/locore/exception_vectors.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/locore/locore.c ]
no longer needed or moved to m88k
[ ./kernel/luna88k/locore/locore.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/locore/locore_asm_routines.c ]
no longer needed or moved to m88k
[ ./kernel/luna88k/locore/locore_c_routines.c ]
no longer needed or moved to m88k
[ ./kernel/luna88k/luna_fp.c ]
no longer needed or moved to m88k
[ ./kernel/luna88k/m88k.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/mach_param.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/machparam.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/mem.c ]
no longer needed or moved to m88k
[ ./kernel/luna88k/pcb.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/pte.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/scr.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/setjmp.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/sys_machdep.c ]
no longer needed or moved to m88k
[ ./kernel/luna88k/thread.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/time_stamp.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/vm_tuning.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/vmparam.h ]
no longer needed or moved to m88k
[ ./kernel/luna88k/varargs.h ]
no longer needed or moved to m88k
[ ./kernel/sun/dklabel.h ]
Fixed struct dk_label to correctly pad for new rpm and pcyl
fields.
[93/02/04            berman]
[ ./kernel/sun/conf.c ]
Added mach/machine/vm_types.h for vm_offset_t in device/conf.h
[93/02/04            berman]
[ ./kernel/device/conf.h ]
The map function really returns a phys address.
[93/02/04  01:54:45  af]
[ ./kernel/luna88k/conf.c ]
Include for vm_offset_t, new mouse routines.
[93/02/04            jfriedl]
[ ./kernel/luna88k/db_trace.c ]
Fixes for tracing random user tasks.
[93/02/04            jfriedl]
[ ./kernel/luna88k/mouse.h ]
Created.
[93/02/04            jfriedl]
[ ./kernel/luna88k/trap.c ]
Fixed some naughty debugging code.
[93/02/04            jfriedl]
[ ./kernel/kern/bootstrap.c ]
Alpha like mips, has machdep init flags.
[93/02/04  01:56:09  af]

64bit cleanup.  Added a magic number to the boot label.
Changed ovbcopy_ints to be quicker where it can.
[92/11/30            af]
[ ./kernel/kern/lock.h ]
Reorganization of lock structure.
Recursion_depth is now a bitfield,
and the thread pointer is the first field.
[93/02/04            danner]
[ ./kernel/sunif/if_levar.h ]
Add volatile
[ ./kernel/sundev/screg.h ]
Volatiles.
[ ./kernel/sundev/si.c ]
Comment, warning fixups.
[ ./kernel/sundev/sireg.h ]
Volatile decls.
[ ./kernel/sundev/sc.c ]
Comments, returns.
[ ./kernel/sundev/sd.c ]
gcc mods.
[ ./kernel/alpha/DEC/adu.c ]
Dropped ISP hacking.
[93/02/04  01:19:18  af]

Added C version of simple_lock to deal with ADU bug.
[93/01/15            af]
Created, from the DEC specs:
"Alpha Demonstration Unit Specification"
V1.0, Aug 1990.
[92/06/02            af]
Created.
[92/12/10            af]
[ ./kernel/alpha/DEC/alpha_box.c ]
Changes for Flamingo
[93/01/12            jeffreyh]
Created.
[92/12/10  15:24:33  af]
[ ./kernel/alpha/DEC/model_dep.c ]
Flamingo changes
[93/01/12            jeffreyh]
Fixed prom dispatch init.
[93/01/16  12:19:28  af]

No more stealing, now we use grab_contiguous_pages.
[92/12/25  01:46:02  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/alpha_init.c ]
No more ISP hacks.  Now we parse args.
Fixed bug in memory stealing call.
[93/02/04  00:56:23  af]

MP Icache sanity call, help Jeffrey in dprintf by delaying
dropping of bootstrap VM spaces.
[93/01/15            af]
Set vm_page_big_pagenum to support vm_page_grab_contiguous_pages.
[92/12/25  01:42:54  af]

Added reference to doc for the HWRPB &co.
[92/12/22            af]
Added reference to documentation source(s).
[92/12/16  15:11:03  af]

Created.
[92/06/03            af]
[ ./kernel/alpha/alpha_cpu.h ]
Added machine-check error register defines.
[93/02/04  00:42:24  af]

Added reference to documentation source(s).
[92/12/16  15:10:40  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/alpha_cpu.s ]
Change mov inst. to or
[93/01/12            jeffreyh]
Added ops on MCES.
[93/01/15            af]
Added reference to documentation source(s).
[92/12/16  15:10:52  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/alpha_mem_ops.c ]
Fixed broken blkclr.  Added protos.  Added rindex.
[93/02/04  00:54:25  af]

Created.
[92/12/10  14:50:41  af]
[ ./kernel/alpha/alpha_misc.c ]
32bit-prom-bug support (jeffreyh).
Sketch proper reboot.
[93/02/04  00:47:40  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/conf.c ]
Changes for Flamingo
[93/01/12            jeffreyh]
Created.
[92/12/10  14:54:50  af]
[ ./kernel/alpha/context.s ]
Change all mov inst to or inst
[93/01/12            jeffreyh]
Added reference to documentation source(s).
[92/12/16  15:12:29  af]

Created.
[92/12/10  14:55:23  af]
[ ./kernel/alpha/db_interface.c ]
Made a mental note to fix watchpoints, later on.
[93/02/04  00:43:50  af]

MP debugging works now.
[93/01/15            af]
Added reference to documentation source(s).
[92/12/16  15:13:59  af]

First cut at using new MI multiP code. Not fully satisfactory.
[92/12/16  12:47:05  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/db_disasm.c ]
Added PAL instruction decoding.
Fixed bug in float register names.
Say the right effective address for LDAH instructions.
[93/02/04  00:50:39  af]

Added reference to documentation source(s).
[92/12/16  15:12:39  af]

Created.
[91/12/05            af]
[ ./kernel/alpha/db_alpha_sym.c ]
Turned on all prints now that prom interface is ok.
[93/02/04  00:39:42  af]

Created, from mips version.
[92/05/31            af]
[ ./kernel/alpha/db_machdep.h ]
Fixed isa-breakpt macro.
[93/02/04  00:52:51  af]

Added reference to documentation source(s).
[92/12/16  15:14:10  af]

Added SAVE/RESTORE macros for multiP usage.
[92/12/16  12:43:09  af]

Created.
[92/05/31            af]
[ ./kernel/alpha/locore.s ]
Removed ISP hacks.  Console callbacks work now,
so they are not truly needed anymore.
[93/01/26            af]

Change all mov inst. to or instructions to avoid a strange chip
bug seen in starts.
[93/01/12            jeffreyh]
Added reference to documentation source(s).
[92/12/16  15:15:22  af]

Created.
[92/06/03            af]
[ ./kernel/alpha/parse_args.c ]
Since there a (twisted) way to pass arguments to the
kernel, resurvived and adapted my old mips code.
[93/02/02            af]
Created empty.
[92/12/10            af]
[ ./kernel/alpha/swapgeneric.c ]
Rewritten, old code did not fly.
[93/02/02            af]
Created, from rvb's version for mips.
[92/06/07            af]
[ ./kernel/alpha/pmap.c ]
Added pmap_set_modify, for some smart device driver.
[93/02/04  00:51:56  af]

Fixed locking bug: at interrupt time one should not call
pmap_extract()  !  Made kvtophys() call the safer one.
[93/01/15            af]
Added reference to documentation source(s).
[92/12/16  15:17:39  af]

Support for new MI multiP ddb.  Code probably belongs elsewhere.
[92/12/16  12:45:52  af]

Created, starting from i386 version and extending it with
one more layer in the pagetable tree.
[92/12/10  15:02:31  af]
[ ./kernel/alpha/start.s ]
Change all mov calls to or calls due to strange chip bug
on Flamingo with pass 2 chip
[93/01/12            jeffreyh]
Changed ADU-specific way to setup k0seg mappings into
MI way to do it, using ldqp/stqp pal calls.
[93/01/15            af]
Got more memory on the ADU, bump NLEV3 up.
[92/12/25  01:41:26  af]

Added reference to doc for the HWRPB &co.
[92/12/22            af]
Added reference to documentation source(s).
[92/12/16  15:18:08  af]

Created.
[92/06/03            af]
[ ./kernel/alpha/prom_interface.h ]
Working version, taken from boot directory.
[93/02/04  00:57:09  af]

Added reference to doc for the HWRPB &co.
[92/12/22            af]
Added reference to documentation source(s).
[92/12/16  15:17:51  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/prom_interface.s ]
Simplification to known code from af's boot code.
[93/01/14            jeffreyh]
Dispatch routine works now.  Puts broken, Jeffrey fixed it
so I am not [prom takes only 32bits anyways].
[93/01/15            af]
Added reference to doc for the HWRPB &co.
[92/12/22            af]
Added reference to documentation source(s).
[92/12/16  15:18:00  af]

Created.
[92/06/02            af]
[ ./kernel/alpha/trap.c ]
Added machine check handler (jeffreyh).
[93/02/04  00:45:20  af]
[ ./kernel/alpha/boot/Makefile ]
Created.
[93/02/04  01:01:46  af]
[ ./kernel/alpha/boot/c_misc.c ]
Created a while back.
[93/02/04            af]
[ ./kernel/alpha/boot/dev.h ]
Adapted for alpha, from my mips code.
[93/02/04            af]
[ ./kernel/alpha/boot/dir.h ]
Adapted for alpha.
[93/02/04            af]
[ ./kernel/alpha/boot/disk_boot.c ]
Rewritten for alpha.
[93/02/04            af]
[ ./kernel/alpha/boot/disk_inode.h ]
Adapted for alpha.
[93/02/04            af]
[ ./kernel/alpha/boot/fs.h ]
Adapted for alpha.
[93/02/04            af]
[ ./kernel/alpha/boot/min_io.h ]
Adapted for alpha.
[93/02/04            af]
[ ./kernel/alpha/boot/prom_routines.h ]
Created a while back.
[93/02/04            af]
[ ./kernel/alpha/boot/prom_routines.s ]
Created a while back.
[93/02/04            af]
[ ./kernel/alpha/boot/start.s ]
Created.
[93/02/04  01:02:11  af]
[ ./kernel/alpha/boot/supage.s ]
First (working) draft.  Still needs to go hunting the shadow
for the ABOX_CTL register and *or* in our bits so that..
[93/02/04            af]
[ ./kernel/alpha/boot/test.c ]
Created.
[93/02/04            af]
[ ./kernel/alpha/boot/ufs.c ]
Adapted for alpha.
[93/02/04            af]
[ ./kernel/alpha/boot/ufs.h ]
Adapted for alpha.
[93/02/04            af]
[ ./kernel/mips/PMAX/kmin.c ]
Clock got more generic.
[93/02/04  02:02:48  af]

Proper spl typing.
[92/12/01            af]
[ ./kernel/mips/PMAX/maxine.c ]
Clock got more generic.
[93/02/04  02:01:08  af]

Proper spl typing.
[92/12/01            af]
[ ./kernel/mips/PMAX/mips_box.c ]
Clock got more generic.
[93/02/04  02:03:31  af]
[ ./kernel/mips/PMAX/pmagb_ba.h ]
Turns out Flamingo has same offset as Ds.
Define a neutral "reset" address cuz I cannot find
a proper specific one.
[93/02/04  02:05:12  af]

Created, with imagination from the DEC specs:
"Flamingo Macrocoder's Manual" Chap 4.6 "CXTURBO"
Workstation and Servers, Maynard, MA. Oct 21, 1991.
[Yes, there is certainly a more proper document]

[90/09/03            af]
[ ./kernel/mips/PMAX/model_dep.c ]
Clock got more generic.
[93/02/04  02:02:17  af]
[ ./kernel/mips/mips_init.c ]
Clock got more generic.
[93/02/04  01:58:47  af]
[ ./kernel/mips/machparam.h ]
Corrected splx proto now that we have protos and a compiler that
groks void better.
[93/01/19            af]
Proper spl typing.
[92/12/01            af]
[ ./kernel/mips/mips_misc.c ]
Clock got more generic.
[93/02/04  01:59:32  af]

In dprintf, pass the fourth argument that was sleazily added to
doprnt() without telling anyone.  Grrr.
[92/12/10            af]
[ ./kernel/chips/bt459.c ]
Flamingo (more flexible reg accesses).
I don't think its working right, its using dense space.
[93/02/04  01:46:58  af]
[ ./kernel/chips/cfb_hdw.c ]
Changes for Flamingo.
[93/02/04  01:28:05  af]

Interrupt routine takes an spllevel on mips only.
[92/11/30            af]
[ ./kernel/chips/cfb_misc.c ]
Flamingo, protos.
[93/02/04  01:44:04  af]

Make it share code properly with the "sfb" driver.
[92/11/26            af]
[ ./kernel/chips/dc503.c ]
Everybody needs this because of the cursor, simplified
defines.
[93/02/04  01:24:17  af]
[ ./kernel/chips/scc_8530_hdw.c ]
Flamingo, full_modem and isa_console per-line.
[93/02/04            af]
[ ./kernel/chips/lance.h ]
More flexible in register accesses (Flamingo).
64bit cleanup.
[93/02/04  01:31:59  af]
[ ./kernel/chips/lk201.c ]
Flamingo, protos.
[93/02/04  01:44:48  af]

Always return -2 from debugger, regardless [jtp@hut.fi]
Proper spl typing. 64bit clean. Made bitmap display optional.
[92/11/30            af]

Return -2 from lk201_input if the kdb hot key was received. Also
do this if already inside kdb
[92/10/24            jvh]
[ ./kernel/chips/screen_switch.c ]
Add conditionals for pmax screen. Not available on a Flamingo
[92/12/03            jeffreyh]
Added sfb driver.
[92/12/10            af]
[ ./kernel/chips/mc_clock.c ]
Heavy cosmetic changes to make it look like a device after all.
Flamingo uses it too.
[93/02/04  01:30:53  af]

Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/mouse.c ]
Flamingo, protos, 64bit.
[93/02/04  01:38:40  af]

Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/pm_misc.c ]
Made work on Flamingo.  Fixed NPM defines.
Protos.
[93/02/04  01:38:02  af]
[ ./kernel/chips/lance.c ]
Changes for Flamingo
[92/10/21            jeffreyh]
[ ./kernel/chips/dec_lic/ga_misc.c ]
Mods to *compile* on Flamingo.
[93/02/04  01:51:39  af]
[ ./kernel/chips/dec_lic/ga_hdw.c ]
Mods to *compile* on Flamingo.
[93/02/04  01:51:04  af]

Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/dec_lic/gq_misc.c ]
Mods to *compile* on Flamingo.
[93/02/04  01:52:10  af]
[ ./kernel/chips/dec_lic/gq_hdw.c ]
Mods to *compile* on Flamingo.
[93/02/04  01:50:39  af]
[ ./kernel/chips/dec_lic/gx_misc.c ]
Mods to *compile* on Flamingo.
[93/02/04  01:52:39  af]
[ ./kernel/chips/fb_hdw.c ]
Changes for Flamingo.
[93/02/04  01:28:46  af]

Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/fb_misc.c ]
Removed commented include.
[93/02/04  01:29:39  af]

Removed dead code.
[92/11/29            af]
[ ./kernel/chips/scc_8530.h ]
Generalized register access, to accomodate Alpha.
[93/02/04  01:27:21  af]
[ ./kernel/chips/serial_console.c ]
Flamingo.  Mods to be ~~debuggable.
[93/02/04  01:49:37  af]

Proper typing.
[92/11/30            af]
[ ./kernel/chips/screen.c ]
Prototypes. 64bit clean.
[93/02/04  01:34:50  af]

Added first cut at true kbd layer [jtp@hut.fi]
Proper spl typing.  Finessed the above.
[92/11/30            af]

Fixed screen_set_cursor to keep the cursor from wrapping to
the other side of the screen when the mouse is moved outside
the screen.
Move also the physical cursor when the cursor is moved from
above.
[92/11/30            jvh]
[ ./kernel/chips/isdn_79c30_hdw.c ]
Changes for Flamingo.
[93/02/04            af]
Proper spl typing.
[92/11/30            af]
[ ./kernel/chips/sfb_hdw.c ]
Works on Flamingo too.  Protos.
[93/02/04  01:36:44  af]

Created.
[92/12/10  15:44:39  af]
[ ./kernel/chips/sfb_misc.c ]
Flamingo, protos.
[93/02/04  01:39:27  af]

Created.
[92/12/10  15:44:58  af]
[ ./kernel/luna88kdev/cons.c ]
commented-out kanji support (for now)
[93/02/04            jfriedl]
[ ./kernel/luna88kdev/msmain.c ]
Completely rewrote for 3.0
[93/02/04            jfriedl]
[ ./kernel/luna88kdev/uart.c ]
commented-out kanji support (for now)
[93/02/04            jfriedl]
[ ./kernel/vax/cons.c ]
Added include of vm_types.h
[93/02/04            danner]
[ ./kernel/vax/autoconf.c ]
Fix includes.
[93/02/04            danner]
[ ./kernel/vax/conf.c ]
Fix includes.
[93/02/04            danner]
[ ./kernel/alpha/genassym.c ]
Version 2.
[ ./kernel/i386at/conf.c ]
Added include.
[93/02/04            danner]
[ ./kernel/sqtconf/conf.c ]
Fixed include.
[93/02/04            danner]
[ ./kernel/chips/dz_hdw.c ]
splx -> spltty.
[93/02/04            danner]
[ ./kernel/chips/lance_mapped.c ]
Include fixes.
[93/02/04            danner]
[ ./kernel/i386ps2/conf.c ]
Fix includes.

[ ./kernel/sunif/if_le.c ]
Partially fixed for sun3 compatibility.
[93/02/05            berman]
[ ./kernel/sundev/screg.h ]
Undo 2.2 changes.  Not needed.
[93/02/05            berman]
[ ./kernel/sundev/sireg.h ]
Undo 2.2 changes.  Not needed.
[93/02/05            berman]
[ ./kernel/conf/template.mk ]
Fixed support for profiling.
Added mach4.  - danner
Renamed Makefile.template to template.mk and modifed for ODE
make.
[93/01/21            mrt]
[ ./kernel/conf/sun3/MASTER ]
Overide the definiton of lineno that is in MASTER, because
a kernel built with gcc 2.3.3 linenumbers overlaps the frame
buffer on at least a sun3/60.
[93/01/25            mrt]
[ ./kernel/conf/sun3/template.mk ]
Updated for ODE make
[93/01/16            mrt]
[ ./kernel/conf/vax/template.mk ]
Created.

    
    
    
==========================================================================
   ***** MK Version MK80  (mrt) *****
    
    
New features:
--- --------

Added support for scsi CD-ROM devices

[I386] and [PMAX]
	Added support for profiling. libmach and libmach_sa
	build with -pg switch

[ALPHA]
	lots of changes for the alpha machines.
	It now runs on the Flamingo model.


Bug fixes:
--- -----

More prototype and gcc cleanup

Updated the kernel man pages

[I386]
	Fix to give a "reaonable" reply to get_disk_label even
	when there isn't one

	Fix for keyboard wedging on Gateway 2000 4DX2-66V

[PMAX]
	Fix to dma bug that has occasionally zero'ed disk blocks.

[LUNA]  Many

Special notes:
------- -----

The standard kernel configurations for the i386, pmax, luna, alpha and sun4
all built with linenos on for debugging and are 1 to 2 Meg. Smaller verisons
(STD+WS-lineno) are available for the i386 and pmax machines.


******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
80
[ ./kernel/alpha/DEC/model_dep.c ]
Wrapped includes in ifdef FLAMINGO.
[93/03/01            danner]
[ ./kernel/src/config/mkmakefile.c ]
Changed do_cflags to add extra flags to ${CFLAGS} instead of 
replacing ${CFLAGS}
[93/03/01            mrt]
[ ./bootstrap/alpha/exec.c ]
Added support for a.out images.
[93/03/05            af]
[ ./bootstrap/def_pager_setup.c ]
Added extern of kalloc().
[93/03/05            af]
[ ./bootstrap/default_pager.c ]
Adde extern of kalloc.
[93/03/05            af]
[ ./include/alpha/Makefile ]
Added full set of varargs files. Sigh.
[93/03/05            af]
[ ./kernel/alpha/DEC/alpha_box.c ]
Dispatch scsi interrupts to TC handler.
[93/03/05            af]
[ ./kernel/alpha/DEC/asic.h ]
Jeffrey Heller created this duplicating it from mips.
[93/03/06  14:23:11  af]
[ ./kernel/alpha/DEC/flamingo.c ]
Disable some debug code.
[93/03/06            af]
Created.
[93/02/18            jeffreyh]
[ ./kernel/alpha/DEC/flamingo.h ]
Created.
[92/11/18            jeffreyh]
[ ./kernel/alpha/DEC/flamingo_dma.c ]
Created.
[92/11/18            jeffreyh]
[ ./kernel/alpha/DEC/ln_copy.c ]
Jeffrey Heller created this expounding from my mips code.
[93/03/06  14:26:06  af]
[ ./kernel/alpha/DEC/model_dep.c ]
Reflected changes in prom dispatching.
[93/02/20            af]

Add sgmap_init()
[93/02/08            jeffreyh]
[ ./kernel/alpha/DEC/sgmap.c ]
Created.
[93/02/18            jeffreyh]
[ ./kernel/alpha/DEC/sgmap.h ]
Created.
[93/02/18            jeffreyh]
[ ./kernel/alpha/DEC/tc.c ]
Jeffrey Heller created this from my mips code.
[93/03/06  14:27:58  af]
[ ./kernel/alpha/DEC/tc.h ]
Jeffrey Heller created this from my mips code.
[93/03/06  14:28:19  af]
[ ./kernel/alpha/DEC/tvbus.c ]
GCC lint.
[93/03/05            af]
[ ./kernel/alpha/alpha_init.c ]
GCC quiets, protos, standard boothowto, lint.
[93/03/05            af]
[ ./kernel/alpha/alpha_lock.s ]
Added placeholder for non-MP case to satisfy GLD.
[93/02/16            af]
[ ./kernel/alpha/alpha_mem_ops.c ]
GCC lint.
[93/03/05            af]
[ ./kernel/alpha/alpha_misc.c ]
String protos.
[93/03/07  13:31:07  af]

Fixed reboot (almost), I had forgotten all about the HWRPB. Sigh.
[93/02/19            af]
[ ./kernel/alpha/boot/c_misc.c ]
Prom dispatching, protos, now can ask for file and read labels.
Which means booting from any partition. Also does a.out images.
[93/03/05            af]
[ ./kernel/alpha/boot/disk_boot.c ]
main --> _main_ to spare GCC wastes.
Interactively asking for file works.
[93/03/05            af]
[ ./kernel/alpha/boot/prom_routines.s ]
Different prom dispatching, link safe.
[93/03/05            af]
[ ./kernel/alpha/boot/start.s ]
Call main function _main_ so that GCC won't generate
its bogon extra call.
[93/02/20            af]
[ ./kernel/alpha/boot/ufs.h ]
Make damn sure we get sys/types.h from the right place.
[93/03/05            af]
[ ./kernel/alpha/conf.c ]
zero d_mmap entries for non-mappable devices.
[93/03/07  15:22:06  af]

Added CD_ROM audio. Lint.
[93/03/05            af]
[ ./kernel/alpha/db_alpha_aout.c ]
Created, brutally taken from my ADB code without cleaning.
[93/02/20            af]
[ ./kernel/alpha/db_alpha_sym.c ]
Findproc now exists for a.out too.
[93/03/05            af]
[ ./kernel/alpha/db_trace.c ]
Fix for findproc.  GCC lint.
[93/03/05            af]
[ ./kernel/alpha/exec.h ]
Quiet warnings if magics already defined.
Happens if including coff.h also.
[93/03/05            af]
[ ./kernel/alpha/locore.s ]
Removed debugging code that did not fly under GCC.
Sigh, nothing like shoting yourself on the foot.
[93/02/19            af]
[ ./kernel/alpha/parse_args.c ]
String protos.
[93/03/07            af]
[ ./kernel/alpha/pmap.c ]
GCC quiets.
[93/03/05            af]
[ ./kernel/alpha/prom_interface.h ]
Changed prom dispatching to be more link-safe.
[93/02/20            af]
[ ./kernel/alpha/prom_interface.s ]
Changed prom dispatching to be more link-safe.
[93/02/20            af]
[ ./kernel/alpha/start.s ]
GP setup was wrong under GCC.
[93/03/05            af]
[ ./kernel/alpha/swapgeneric.c ]
Parse partition digit too.
[93/03/05            af]
[ ./kernel/alpha/thread.h ]
There was no indirection bug, thread->pcb truly is a pointer.
[93/03/05            af]
[ ./kernel/alpha/trap.c ]
Proto for Thread_syscall_return with GCC.
[93/03/07            af]
Fixed pcsample botch.
[93/03/05            af]
[ ./kernel/alpha/varargs.h ]
Created.
[93/03/06            af]
[ ./kernel/chips/fb_hdw.c ]
tc_probe() returns a vm_offset_t.
[93/03/05            af]
[ ./kernel/chips/lance.c ]
Propagated protos of switch structure.
[93/03/06            af]
Removed dev_t, which is just a U*x compat type. Lint.
Would be nice to be able to make this file readable again.
Reset lo(n)g history, contributors so far:
	rvb, af, mja, rpd, jsb, danner, jfriedl, jeffreyh
[93/03/05            af]
[ ./kernel/chips/lance.h ]
Proper types for functions in switch structure.
[93/03/06            af]
[ ./kernel/chips/pm_misc.c ]
Optimized for 64bit machines the inner copy loops.
[93/03/05            af]
[ ./kernel/chips/scc_8530_hdw.c ]
GCC quiet.
[93/03/07  13:29:58  af]

Post-debugging lint.
[93/03/05            af]
[ ./kernel/chips/sfb_hdw.c ]
Post-debugging lint.
[93/03/05            af]
[ ./kernel/conf/alpha/MASTER ]
Changes for Flamingo from jeffreyh. Plus some.
Cannot yet have a common ADU/Flamingo kernel.
[93/03/05            af]
[ ./kernel/conf/alpha/files ]
Flamingo and other new files.  Lint.
[93/03/06  14:33:28  af]
[ ./kernel/conf/alpha/template.mk ]
GCC & BL10 changes.
[93/03/05            af]
[ ./kernel/conf/files ]
Added kern/sscanf.c
[93/03/05            af]
[ ./kernel/conf/i386/files ]
Added rz_audio.c
[93/03/06            af]
[ ./kernel/conf/m88k/files ]
Added rz_audio.c
[93/03/06            af]
[ ./kernel/conf/mips/files ]
Added rz_audio.c
[93/03/06            af]
[ ./kernel/conf/newvers.sh ]
Fixed build of version string to accomodate both BSD and OSF/1
/bin/echo commands. ("\n" can't be echoed with the same command)
From: [93/01/12            bernadat]
[ ./kernel/ddb/db_access.c ]
Here we go again. Pls leave db_extend[] alone, ok ?
[93/03/05            af]
[ ./kernel/ddb/db_aout.c ]
Make searching slightly less confusing if the symtab has not
been xstripped.
[93/03/05            af]
[ ./kernel/ddb/db_command.c ]
String protos.
[93/03/07            af]
[ ./kernel/ddb/db_lex.c ]
String protos.
[93/03/07            af]
[ ./kernel/ddb/db_print.c ]
String protos.
[93/03/07            af]
[ ./kernel/ddb/db_sym.c ]
String protos.
[93/03/07            af]
[ ./kernel/ddb/nlist.h ]
Made explicit padding for alpha, has its uses.
Made n_other unsigned.  Fixed erroneous def of N_FN.
[93/02/21            af]
[ ./kernel/ddb/stab.h ]
Added N_FRAME, an extension I added to a.out symtabs
for machines with non-self describing frame formats.
[93/02/21            af]
[ ./kernel/device/blkio.c ]
block_io_mmap() must return a vm_offset_t.
[93/03/07            af]
[ ./kernel/device/dev_pager.c ]
Non-mappable devices should use a zero as their d_mmap.
[93/03/07            af]
Fixed decl for block_io_mmap().  Mods to hash macro for GCC.
[93/03/07            af]
[ ./kernel/device/disk_status.h ]
Horrible alpha-specific fix.  See apologies in the code.
[93/02/26            af]
[ ./kernel/device/subrs.c ]
Removed string routines, and the Berkeley copyright that came
with them.  The new ones we wrote now live in kern/strings.[ch].
[93/03/06            af]
[ ./kernel/i386at/com.c ]
Don Lindsay kindly provides us with:
  Bug fix in comopen() - cleans up chip status.
  Change in debug routine compr_addr() to print line state first,
    because touching other things changes the line state.
  Made comparam() static, since no outside uses.
  Added several (void)s and fixed some function return types.
  Changed a return; to return 0; in comparam().
[93/03/05            af]
[ ./kernel/i386at/conf.c ]
Added SCSI CD-ROM Audio.  Added back SCSI processor links.
[93/03/06            af]
[ ./kernel/ipc/ipc_hash.c ]
Added typecast to hashing macro to shutup GCC.
[93/03/06            af]
[ ./kernel/ipc/ipc_marequest.c ]
Added typecast in hashing macros to shutup GCC.
[93/03/06            af]
[ ./kernel/ipc/mach_msg.c ]
Added typecast to quiet GCC.
[93/03/06            af]
[ ./kernel/kern/exception.c ]
Removed duplicated decl for thread_syscall_return().
Added a tiny GNUism to shutup GCC.
[93/03/06            af]
[ ./kernel/kern/mach_clock.c ]
Removed gratuitous casts to ints.
[93/03/05            af]
[ ./kernel/kern/printf.c ]
Lint to quiet GCC.
[93/03/07  13:25:20  af]

A better, MP-safe sprintf.
[93/03/05            af]
[ ./kernel/kern/queue.c ]
Fixed remque not to typecast. ANSI C.
[93/03/05            af]
[ ./kernel/kern/sched_prim.h ]
A small GNUism to signify thread_syscall_return does not return.
[93/03/06            af]
[ ./kernel/kern/sscanf.c ]
Created.
[93/03/06  14:35:41  af]
[ ./kernel/kern/strings.c ]
Created from Bob's new code in libmach.  Added strncmp().
ANSI-fied, prototypes the way GCC wants them (signed char* ??).
[93/03/06            af]
[ ./kernel/kern/strings.h ]
Created.
[93/03/06            af]
[ ./kernel/kern/syscall_subr.c ]
Removed duplicated decl for thread_syscall_return.
[93/03/06            af]
[ ./kernel/luna88k/conf.c ]
Added CD-ROM Audio.
[93/03/06  14:36:30  af]
[ ./kernel/mach/alpha/asm.h ]
For GAS, use a space in .ent directives.
[93/03/05            af]
[ ./kernel/mach/alpha/syscall_sw.h ]
Changed .ent stmts to use spaces.
[93/02/15            af]
[ ./kernel/mips/conf.c ]
Added CD-ROM audio.
[93/03/06            af]
[ ./kernel/mips/softfp.s ]
Why do an half-job ?  Changed all comments to C syntax.
[93/03/06            af]
[ ./kernel/scsi/adapters/scsi_33C93_hdw.c ]
Added CDROM cmds.
[93/03/06            af]
[ ./kernel/scsi/adapters/scsi_53C94.h ]
Mask off bytes properly when reading the dma counter.
[93/03/06            af]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
Some more mb()s. Lint. There is still trouble in the synch
negotiation (slowpoke CDROM).
[93/03/06            af]
[ ./kernel/scsi/adapters/scsi_7061_hdw.c ]
Added CDROM cmds.
[93/03/06            af]
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
Added CDROM cmds.
[93/03/06            af]
[ ./kernel/scsi/adapters/scsi_aha15_hdw.c ]
Added CDROM cmds.
[93/03/06            af]
[ ./kernel/scsi/rz.c ]
rz_check now is officially exported by this module.
[93/03/06            af]
[ ./kernel/scsi/rz_disk.c ]
Merge botch in scdisk_writelabel(), was still setting tgt->ior
before grab_it().
To accomodate a weird "feature" in some Adaptec microcode and
slowpoke <unnamed> disk.. retry if the unit is not yet ready
when we come to read it.
[93/02/23            af]
[ ./kernel/scsi/rz_host.c ]
Protos, start routine is void.
[93/03/07            af]
[ ./kernel/scsi/scsi.c ]
By default, do not require any enquiry-time operations to
be done on devices.  The only case so far was a tape drive
from <unnamed> who required a receive_diagnostics() at powerup.
[93/03/06            af]

Changes to make SCSI_MEMORY (optical direct access media) work.
[93/02/17            jeffreyh]

In scsi_bus_was_reset().  Fixed second loop to touch all
targets for which we have a descriptor.  The problem is
with dynamic probe and spinup of disks, assuming the disk
takes a loooong time we endup resetting the bus while
the scsi_inquiry() routine is spinning on tgt->done.
[93/02/06            af]
[ ./kernel/scsi/scsi.h ]
Define EJECT flag in start/stop unit (SCSI2).
Give a name to the block_decsriptors in mode sense/sel.
[93/03/06            af]
[ ./kernel/scsi/scsi2.h ]
Added some more defs, just enough to get CDROMs.
[93/03/06            af]
[ ./kernel/scsi/scsi_alldevs.c ]
Fixed check_sense_data to return ok unconditionally for
unit-not-ready.
[93/03/06            af]
[ ./kernel/scsi/scsi_comm.c ]
Turn on code unconditionally.  Removed optimize function,
unless it will turn out to be needed later on on a true driver.
[93/03/06            af]
[ ./kernel/scsi/scsi_defs.h ]
Merge botch, oops.  So I did enough to get a clean build
under GCC on alpha.
[93/03/07  13:24:00  af]

Added cdrom status keeping. Lint.
[93/03/06            af]

Change type of optimize to void in scsi_devsw_t to match usage.
[93/02/17            jeffreyh]
[ ./kernel/scsi/scsi_jukebox.c ]
Enabled code unconditionally.  Removed optim function.
[93/03/06            af]
[ ./kernel/scsi/scsi_optical.c ]
This is really just a removable hard disk, call it rz.
Verified it works with an  "HP C1716C 3238" drive.
[93/02/18            jeffreyh]
[ ./kernel/scsi/scsi_rom.c ]
Implemented missing commands.  
Code tested on a "DEC RRD42(C)DEC 4.5d" drive.
[93/03/06            af]
[ ./kernel/scsi/scsi_scanner.c ]
Turn on code unconditionally.  Remove optim function.
[93/03/06            af]
[ ./kernel/src/makeboot/alpha/exec.c ]
Catched a bogus NMAGIC for a.out (quis ? quomodo ? quando ?),
as well as other peculiar little things derived from previous
a.out machines (their loaders dont look at headers, obviously).
[93/03/06            af]
[ ./kernel/vm/vm_resident.c ]
Added typecast to hash macro to quiet GCC.
[93/03/06            af]
[ ./user/libmach/mach_msg_server.c ]
Added decl for extern malloc().
[93/02/12            af]
[ ./user/libmach/sbrk.c ]
dlc took a #endif for a #else, the file was just fine as is.
Explained some more, hope it is *really* clear now.
[93/03/06            af]
[ ./user/threads/alpha/lock.s ]
Lost in previous merge:
   Added memory barriers where needed.
   Locks are longs now.
   [93/01/15            af]
[ ./user/threads/cprocs.c ]
Lint.
[93/03/06            af]
[ ./kernel/mach/vax/vm_types.h ]
Changed include conditional  to _MACHINE_VM_TYPES_H_ since
that is what sys/types.h is expecting.
[93/02/20            mrt]
[ ./kernel/mach/m88k/vm_types.h ]
Changed conditional define to _MACHINE_VM_TYPES_H_ so it
would match what sys/types.h expects.
[93/02/20            mrt]
[ ./kernel/i386/asm.h ]
Flushed wheeze and fixed for gcc cpp.
[93/03/03            mrt]
[ ./kernel/scsi/rz_disk.c ]
If there is no recognizable label, we must set p_size of the
MAXPARTITION slice.  We use MAXPARTITION to do ABSOLUTE reads.
[93/02/23            rvb]
[ ./kernel/scsi/rz_labels.c ]
If there is no recognizable label, we must set p_size of the
MAXPARTITION slice.  We use MAXPARTITION to do ABSOLUTE reads.
[93/02/23            rvb]
[ ./kernel/i386at/grab_bob_label.c ]
If there is no recognizable label, we must return sensible
defaults for getstatus or freak out diskutil.  Alternatively,
we could ship a new diskutil.
[93/02/23            rvb]
[ ./kernel/i386at/iopl.c ]
And printer at 0x278
[93/03/04  11:16:17  rvb]

Added two ports for ATI graphics card from Savage.
[93/03/03            rvb]
[ ./kernel/i386at/kd.c ]
Fix for keyboard wedging on Gateway 2000 4DX2-66V
[93/03/04            savage]
[ ./kernel/sys/macro_help.h ]
Simplified.
[93/03/09            danner]
[ ./kernel/kern/bootstrap.c ]
String protos.
[93/03/07            af]
[ ./kernel/scsi/rz_audio.c ]
Created.
[93/03/09            af]
[ ./bootstrap/alpha/exec.c ]
mach/mach.h -> mach.h (again).
[93/03/09            danner]
[ ./include/luna88k/Makefile ]
Arrgh. Put exec.h back.
[93/02/08            jfriedl]
[ ./kernel/ddb/db_examine.c ]
Added ',' format to examine command.
[93/02/25            jfriedl]
[ ./kernel/luna88k/autoconf.c ]
strarg->bootarg; cleaned up.
[93/03/09            jfriedl]
[ ./kernel/luna88k/db_interface.c ]
Added "gimmeabreak" boot arg.
[93/03/09            jfriedl]

Added /t option to show_translation.
Added db_task_name to showalltasks/u.
[93/02/22            jfriedl]

addr_mod in luna_dmx_print was opposite.
[93/02/20            jfriedl]
[ ./kernel/luna88k/db_machdep.h ]
Added DB_TASK_NAME, etc.
[93/02/22            jfriedl]
[ ./kernel/luna88k/db_trace.c ]
modified for new global union instruction.
[93/03/09            jfriedl]

Lots of stuff... /stack and /frame options; better hex value
printing; allowing for either endian-ness; etc.
[93/02/22            jfriedl]
[ ./kernel/luna88k/eh.s ]
Renamed user_ksp_valid to exception_handler_has_ksp and moved
to allow backtrace routines to work past data exceptions.
[93/02/22            jfriedl]
[ ./kernel/luna88k/exception_vectors.h ]
Added user_raw_xpr.
[93/03/09            jfriedl]
[ ./kernel/luna88k/lcd.h ]
Added LCD_GOTO.
[93/02/22            jfriedl]
[ ./kernel/luna88k/locore_asm_routines.s ]
Created raw_xpr stuff.
[93/03/09            jfriedl]
[ ./kernel/luna88k/locore_c_routines.c ]
Updated d.a.e. debug prints.
Created raw_xpr stuff.
[93/03/09            jfriedl]

Removed assembler xmem_dae: label.
[93/02/22            jfriedl]
[ ./kernel/luna88k/luna_init.c ]
Fixed boothowto; cleanup.
[93/03/09            jfriedl]
[ ./kernel/luna88k/machdep.c ]
Added stop_on_unsup_inter; cleaned nvram stuff.
[93/03/09            jfriedl]
[ ./kernel/luna88k/machdep.h ]
Added prototype for bootarg()
[93/02/25            jfriedl]
[ ./kernel/luna88k/pio.h ]
Fixed diptest.
[93/03/09            jfriedl]
[ ./kernel/luna88k/pmap_table.c ]
replaced BMAP_PALLET2
[93/03/09            jfriedl]
[ ./kernel/luna88k/rawprint_c_routines.c ]
Added no_rawprintf option.
[93/02/22            jfriedl]
[ ./kernel/luna88k/trap.c ]
expanded debug prints.
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/codetbl.h ]
simplified and cleaned up.
Flushed VT52 support.
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/compat_25.h ]
unused.
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/cons.c ]
cleanup
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/cons.h ]
cleanup
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/deftbl.h ]
unused
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/esctbl.h ]
unused
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/fb.c ]
Put palette base back to BMAP_PALLET2.
[93/02/22            jfriedl]
[ ./kernel/luna88kdev/kbmain.c ]
Rewrote and simplified (in progress)
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/kbms.h ]
cleanup
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/keymap.h ]
unused
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/lcd.c ]
Used LCD_GOTO() in init message.
[93/02/22            jfriedl]
[ ./kernel/luna88kdev/msmain.c ]
ANSI and uart cleanup
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/table.h ]
unused
[93/03/09            jfriedl]
[ ./kernel/luna88kdev/uart.c ]
cleanup.
[93/03/09  14:31:44  jfriedl]
[ ./kernel/luna88kdev/uart.h ]
Redid.
[93/03/09            jfriedl]
[ ./kernel/m88k/pmap.c ]
added LOCK_PVH to pmap_clear_reference.
[93/03/09            jfriedl]

Reworked with cmmu_pmap_activate for speed.
Made physical address > MAXPHYSMEM uncached (!)
Replaced gratuitous NBATC with BATC_MAX from m88k/mmu.h
[93/02/22            jfriedl]

Fixed function args for pmap_set_batc() [were out of order]
Replaced pairs of cmmu_set_batc_entry with cmmu_set_pair_batc_entry
where appropriate.
[ ./kernel/m88k/pmap.h ]
Renamed NBATC -> BATC_MAX.
Correct arg order of pmap_set_batc's prototype.
[93/02/22            jfriedl]

Fixed prototype for pmap_set_batc.
[93/02/11            jfriedl]
[ ./kernel/mach/m88k/vm_types.h ]
Changed file wrapper token to _MACHINE_VM_TYPES_H_ to
match the other architectures.
[93/02/18            jfriedl]
[ ./kernel/man/ddb.man ]
Added , modifier to examine
[93/03/09            jfriedl]
[ ./kernel/motorola/m88k/m88100/cmmu.c ]
Turned off SHADOW_BATC debugging.
Got rid of a lot of debugging cache/tlb flushes.
Added cmmu_pmap_activate for pmap speed.
Corrected arguments to cmmu_show_translation; added thread option.
Corrected cmmu_show_translation to properly access physical address
through their associated virtual address.
[93/02/22            jfriedl]

Added cmmu_set_pair_batc_entry.
[93/02/11            jfriedl]
[ ./kernel/motorola/m88k/m88100/m882xx.h ]
Added prototypes for new functions cmmu_pmap_activate and
cmmu_set_pair_batc_entry (and associated include of m88k/mmu.h).
Corrected argument order of cmmu_show_translation.
[93/02/22            jfriedl]

Added prototype for cmmu.c's cmmu_set_pair_batc_entry.
[93/02/11            jfriedl]
[ ./kernel/src/makeboot/m88k/exec.c ]
replaced
[93/03/09            jfriedl]

Added include of m88k/exec.h.
[93/02/22            jfriedl]
[ ./kernel/alpha/clock.h ]
Copied from mips.
[93/03/09  18:10:16  af]
[ ./kernel/sqtsec/co.h ]
u_long -> u_int
[93/03/10            danner]
[ ./kernel/sqtsec/if_se.h ]
u_long -> u_int
[93/03/10            danner]
[ ./kernel/sqtsec/sd.c ]
u_long -> u_int
[93/03/10            danner]
[ ./kernel/sqtsec/sec.c ]
u_long -> u_int
[93/03/10            danner]
[ ./kernel/sqtsec/sec.h ]
u_long -> u_int
[93/03/10            danner]
[ ./kernel/Makefile ]
Expanded the kernel rule, so it would work in an empty shadow
directory. Addded kernel_only target for building the kernel
in an already populated area.
[93/03/10            mrt]
[ ./kernel/conf/vax/MASTER ]
iberated LINENO
[93/03/11            danner]
[ ./kernel/mach/mig_support.h ]
eliminate size_t.
[93/03/09            danner]
[ ./kernel/sys/types.h ]
Removed u_long definition.
Removed definition of size_t.
This file is EXCLUSIVELY here for compat reasons, nothing
should be added to it at this point. 
[93/03/06  14:46:00  af]
[ ./kernel/sys/reboot.h ]
u_long -> u_int.
[93/03/09            danner]
[ ./kernel/vax/ma780subrs.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/vax/ma780var.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/vax/mscp.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/vax/setroot.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/vax/ka630.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/vax/ka3100.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/vax/ka3100.h ]
Elimate u_long.
[93/03/09            danner]
[ ./kernel/sun3/autoconf.c ]
u_long -> u_int.
[93/03/09            danner]
[ ./kernel/src/config/config.h ]
u_long -> u_int
[93/03/10            danner]
[ ./kernel/src/config/mkioconf.c ]
u_long -> u_int
[93/03/10            danner]
[ ./kernel/alpha/DEC/model_dep.c ]
Move platforms.h def before use.
[ ./kernel/alpha/DEC/flamingo.c ]
correct pmap_steal_memory args.
[93/03/11            danner]
[ ./kernel/alpha/db_trace.c ]
Debug off.
[ ./kernel/alpha/alpha_init.c ]
Corrected boot time page stealing commentary.
[93/03/11            danner]
[ ./kernel/conf/files ]
kern/strings.c
[93/03/09            danner]
[ ./kernel/i386at/disk.h ]
u_long -> u_int.
[93/03/09            danner]
[ ./kernel/i386at/hd.c ]
u_long -> u_int.
[93/03/09            danner]
[ ./kernel/i386at/if_3c501.c ]
u_long -> u_int.
[93/03/09            danner]
[ ./kernel/sqt/cfg.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sqt/ioconf.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sqt/memory.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sqtzdc/zd.c ]
u_long -> u_int
[93/03/10            danner]
[ ./kernel/sqtzdc/zdc.h ]
u_long -> u_int
[93/03/10            danner]
[ ./kernel/sqtzdc/zdinit.c ]
u_long -> u_int
[93/03/10            danner]
[ ./kernel/chips/lance_mapped.c ]
eliminate u_long.
[93/03/09            danner]
[ ./kernel/chips/atm.c ]
Corrected atm_probe argument types.
[93/03/09            danner]
[ ./kernel/scsi/rz_audio.c ]
Forward decl. Replaced gimmeabreak with panic.
[ ./kernel/i386ps2/abios.c ]
u_long -> u_int
[93/03/09            danner]

[93/03/09            danner]
[ ./kernel/i386ps2/abios.h ]
u_long -> u_int
[93/03/09            danner]

[93/03/09            danner]
[ ./kernel/i386ps2/bus.h ]
u_long -> u_int
[93/03/09            danner]

[93/03/09            danner]
[ ./kernel/i386ps2/fd.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/i386ps2/fd_abios.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/i386ps2/fdreg.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/i386ps2/gdabios.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/i386ps2/hd.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/i386ps2/hdreg.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/i386ps2/kd_mouse_abios.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/i386ps2/kdabios.h ]
u_long -> u_int
[93/03/09            danner]

[93/03/09            danner]
[ ./kernel/vax/ma780reg.h ]
u_long -> u_int.
[ ./kernel/sun4/autoconf.c ]
Changed u_long -> u_int
[93/03/17            mrt]
[ ./kernel/sun/mb_machdep.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sunif/if_le.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sunif/if_ie.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sundev/cgfour.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sundev/mbvar.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sundev/screg.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sundev/xyreg.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sundev/st.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sundev/sd.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sbusdev/cgsix.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sbusdev/cgthree.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sbusdev/dmaga.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sbusdev/dmaga.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sbusdev/fbutil.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/adapters/esp.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/adapters/espreg.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/adapters/espvar.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/adapters/ncr.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/adapters/ncrctl.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/adapters/ncrreg.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/adapters/sc.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/adapters/screg.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/conf/scsi_confsubr.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/generic/mode.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/impl/pkt_wrapper.h ]
u_long -> u_int
[93/03/09            danner]

u_int -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/impl/commands.h ]
u_long -> u_int
[93/03/09            danner]

u_int -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/impl/scsi_resource.c ]
u_long -> u_int
[93/03/09            danner]

u_int -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/targets/sddef.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/targets/sf.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/targets/srdef.h ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/scsi/targets/st.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/sun4/model_dep.c ]
u_long -> u_int
[93/03/09            danner]
[ ./kernel/chips/bt459.c ]
Added memory barriers for where they are needed.
Prototypes.  Use sparse space for Flamingo.
[93/03/10            af]
[ ./kernel/chips/sfb_hdw.c ]
Use sparse space addresses for bt459 on flamingo.
[93/03/10            af]
[ ./Directories/sun4 ]
Added missing generic sun directories.
[93/03/17            mrt]
[ ./kernel/chips/audio.c ]
Backward compat include of sys/types.h since busses.h
not fixed yet in this release.
[93/03/18  01:21:22  af]
 
Started, from Berkeley's driver.
[93/03/09            af]
[ ./kernel/chips/audio_config.h ]
Created.
[93/03/17  21:38:48  af]
[ ./kernel/chips/audio_defs.h ]
Started, from Berkeley's driver.
[93/03/09            af]
[ ./kernel/chips/isdn_79c30.h ]
Started, from Berkeley's driver.
[93/03/09            af]
[ ./kernel/chips/isdn_79c30_hdw.c ]
Added include of sys/types.h for old busses.h with caddr_t.
[93/03/18  01:22:51  af]

Added some real code, taken from Berkeley driver.
Consequently, added Berkeley copyright.
[93/03/12            af]
[ ./kernel/device/audio_status.h ]
Created from Berkeley driver.
[93/03/12            af]
[ ./kernel/device/chario.c ]
Missed a label.
[93/03/18  01:04:14  af]

Compressed code here and there.
[93/03/17            af]
[ ./kernel/man/task_set_ras_pc.2 ]
replaced by task_ras_control.man
[ ./kernel/man/thread_special_ports.man ]
Renamed to thread_get_special_port.man
[ ./kernel/man/thread_state.man ]
Renamed to thread_get_state.man
[ ./kernel/man/processor_assign.man ]
corrected types
[93/03/11  12:31:40  lli]
[ ./kernel/man/processor_control.man ]
corrected types
[93/03/11  12:51:02  lli]
[ ./kernel/man/task_special_ports.man ]
Renamed to task_get_special_ports
[ ./kernel/man/task_set_special_ports.man ]
Created a link to task_get_special_port
[ ./kernel/man/thread_set_state.man ]
Created as a link file
[ ./kernel/man/thread_set_special_port.man ]
Created as a link file
[ ./kernel/man/task_get_assignment.man ]
Created as a link file
[ ./kernel/man/task_assign_default.man ]
Created as a link file
[ ./kernel/man/processor_start.man ]
Created as a link file
[ ./kernel/man/processor_set_policy_disable.man ]
Created as a link file
[ ./kernel/man/processor_get_assignment.man ]
Created as a link file
[ ./kernel/man/host_info.man ]
corrected types
[93/03/12  16:51:26  lli]
[ ./kernel/man/host_kernel_version.man ]
corrected types
[93/03/12  16:51:44  lli]
[ ./kernel/man/host_processor_set_priv.man ]
corrected types
[93/03/12  16:51:47  lli]
[ ./kernel/man/host_processor_sets.man ]
corrected types
[93/03/12  16:51:51  lli]
[ ./kernel/man/processor_info.man ]
corrected types
[93/03/11  12:53:50  lli]
[ ./kernel/man/processor_set_create.man ]
corrected types
[93/03/11  12:53:53  lli]
[ ./kernel/man/processor_set_default.man ]
corrected types
[93/03/11  12:53:56  lli]
[ ./kernel/man/processor_set_destroy.man ]
corrected types
[93/03/11  12:53:59  lli]
[ ./kernel/man/processor_set_info.man ]
corrected types
[93/03/11  12:54:02  lli]
[ ./kernel/man/processor_set_max_priority.man ]
corrected types
[93/03/11  12:54:05  lli]
[ ./kernel/man/processor_set_policy_enable.man ]
corrected types
[93/03/11  12:54:28  lli]
[ ./kernel/man/processor_set_tasks.man ]
corrected types
[93/03/11  12:54:31  lli]
[ ./kernel/man/processor_set_threads.man ]
corrected types
[93/03/11  12:54:34  lli]
[ ./kernel/man/task_assign.man ]
corrected types
[93/03/12  16:51:54  lli]
[ ./kernel/man/task_create.man ]
corrected types
[93/03/12  16:52:23  lli]
[ ./kernel/man/task_get_special_ports.man ]
corrected types
[93/03/12  16:52:46  lli]
[ ./kernel/man/task_info.man ]
corrected types
[93/03/12  16:52:49  lli]
[ ./kernel/man/task_priority.man ]
corrected types
[93/03/12  16:52:52  lli]
[ ./kernel/man/task_ras_control.man ]
	Created by Brian Bershad
[93/03/18            bershad]
[ ./kernel/man/task_resume.man ]
corrected types
[93/03/12  16:52:56  lli]
[ ./kernel/man/task_suspend.man ]
corrected types
[93/03/12  16:53:32  lli]
[ ./kernel/man/task_terminate.man ]
corrected types
[93/03/12  16:53:35  lli]
[ ./kernel/man/task_threads.man ]
corrected types
[93/03/12  16:53:38  lli]
[ ./kernel/man/thread_abort.man ]
corrected types
[93/03/12  16:53:42  lli]
[ ./kernel/man/thread_create.man ]
corrected types
[93/03/12  16:53:47  lli]
[ ./kernel/man/thread_get_special_port.man ]
corrected types
[93/03/12  16:54:00  lli]
[ ./kernel/man/thread_get_state.man ]
corrected types
[93/03/12  16:54:08  lli]
[ ./kernel/man/thread_info.man ]
corrected types
[93/03/12  16:54:11  lli]
[ ./kernel/man/thread_suspend.man ]
corrected types
[93/03/12  16:55:03  lli]
[ ./kernel/man/thread_terminate.man ]
corrected types
[93/03/12  16:55:06  lli]
[ ./kernel/man/vm_allocate.man ]
corrected types
[93/03/12  16:55:09  lli]
[ ./kernel/man/vm_copy.man ]
corrected types
[93/03/12  16:55:12  lli]
[ ./kernel/man/vm_deallocate.man ]
corrected types
[93/03/12  16:55:15  lli]
[ ./kernel/man/vm_inherit.man ]
corrected types
[93/03/12  16:55:19  lli]
[ ./kernel/man/vm_machine_attribute.man ]
corrected types
[93/03/12  16:55:24  lli]
[ ./kernel/man/vm_map.man ]
corrected types
[93/03/12  16:55:28  lli]
[ ./kernel/man/vm_protect.man ]
corrected types
[93/03/12  16:55:31  lli]
[ ./kernel/man/vm_read.man ]
corrected types
[93/03/12  16:55:34  lli]
[ ./kernel/man/vm_region.man ]
corrected types
[93/03/12  16:55:37  lli]
[ ./kernel/man/vm_set_default_memory_manager.man ]
corrected types
[93/03/12  16:55:40  lli]
[ ./kernel/man/vm_statistics.man ]
corrected types
[93/03/12  16:55:44  lli]
[ ./kernel/man/vm_write.man ]
corrected types
[93/03/12  16:55:47  lli]
[ ./kernel/man/task_assign_default.man ]
Fixed name of included man page
[ ./user/libmach/mips/crt0.s ]
Added eprol and mcount entries.
Fix by Bob Baron
Changed comments to c style, renamed to crt0.s
[93/03/22            mrt]
[ ./user/libmach/mips/crt0.ss ]
renamed to crt0.s
[ ./kernel/man/Makefile ]
Jan-1-93  Mary Thompson (mrt) at Carnegie-Mellon University
Created for Reno make
[ ./include/mach/Makefile ]
Added MACH_IPC_COMPAT for old architectures so that the
netmsgserver can be built.
[93/03/26            mrt]
[ ./Makeconf ]
Changed Alpha default to Workstation config.
[93/03/22            af]
[ ./kernel/Makefile ]
Added man to SUBDIRS.

[ ./kernel/kern/bootstrap.c ]
Changed boot_map to be palatable to vm_object_page_map().
ANSIfied (except for varargs functions).
[93/03/23            af]
[ ./kernel/kern/ipc_mig.c ]
Merge botch got rid of the above.
[93/03/23            af]
[ ./kernel/kern/sscanf.c ]
Lint.
[93/03/23            af]
[ ./kernel/alpha/DEC/scsi_ADU_hdw.c ]
Fixed some decls.
[93/03/23            af]
[ ./kernel/alpha/DEC/adu_se.c ]
Fixed some decls.
[93/03/23            af]
[ ./kernel/alpha/DEC/adu_sl.c ]
Fixed decls.
[93/03/23            af]
[ ./kernel/alpha/DEC/tvbus.c ]
Fixed some decls.
[93/03/23            af]
[ ./kernel/alpha/DEC/flamingo.c ]
Dispatch ISDN interrupts properly.
[93/03/22            af]
[ ./kernel/alpha/alpha_misc.c ]
Lint.
[93/03/23            af]
[ ./kernel/alpha/conf.c ]
Added audio driver.
[93/03/17            af]
[ ./kernel/conf/mips/MASTER ]
Added pseudo-device audio for maxine


[ ./kernel/conf/mips/files ]
Added audio driver.
[93/03/17            af]
[ ./kernel/conf/alpha/files ]
Added audio driver.
[93/03/17            af]
[ ./kernel/conf/alpha/MASTER ]
Added audio driver.
[93/03/17            af]
[ ./kernel/mips/PMAX/maxine.c ]
Correct return value

[ ./kernel/mips/conf.c ]
Added audio driver, fixed types.
[93/03/17            af]
[ ./kernel/chips/dz_defs.h ]
Rid of dev_t.
[93/03/19            af]
[ ./kernel/chips/dz_hdw.c ]
Removed all uses of minor() and dev_t.
[93/03/17            af]
[ ./kernel/chips/scc_8530_hdw.c ]
No minor()s, no dev_t.
[93/03/18            af]
[ ./kernel/chips/lance_mapped.c ]
Removed dev_t, minor();
[93/03/17            af]
[ ./kernel/chips/lance.c ]
Removed all uses of minor().
[93/03/17            af]
[ ./kernel/chips/serial_console.c ]
cleaned up minor/makedev/dev_t.
[93/03/17            af]
[ ./kernel/chips/serial_defs.h ]
Rid of dev_t.
[93/03/19            af]
[ ./kernel/chips/dtop_hdw.c ]
Rid of dev_t.
[93/03/19            af]
[ ./kernel/chips/screen.c ]
No more minor()s.
[93/03/18            af]
[ ./kernel/chips/isdn_79c30_hdw.c ]
DEC and GCC disagree on ANSI C.
[93/03/19            af]
[ ./kernel/chips/frc.c ]
Removed all uses of minor().
[93/03/17            af]
[ ./kernel/chips/audio_config.h ]
Don't define by default the register map.

[ ./kernel/scsi/scsi_alldevs.c ]
Added sizeof_scsi_command().
[93/03/17            af]
[ ./kernel/scsi/scsi2.h ]
Added cdrom structures.
[ ./kernel/scsi/scsi_defs.h ]
Use a pointer (to a list of alternate operations) to
mark CDROM drives that are non-standard.
[93/03/22            af]

Command is unsigned.
[93/03/17            af]
[ ./kernel/scsi/adapters/scsi_5380_hdw.c ]
Added some CDROM cmds for RRD42.
[93/03/17            af]
[ ./kernel/scsi/adapters/scsi_7061_hdw.c ]
A couple more vendor-specific commands for DEC RRD42.
[93/03/17            af]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
More CDROM cmds. Some redecls.
[93/03/17            af]
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
Added a couple of vendor-specific commands for RRD42 CDROM.
[93/03/17            af]
[ ./kernel/scsi/adapters/scsi_aha15_hdw.c ]
Picked up from NORMA branch:
	  Changes from af to correct the problem the the 1742 now actually
	  verifies how much data it got back from INQUIRY and REQUEST_SENSE
	  commands, whereas the other boards from Adaptec do not.
	  [92/04/14  10:27:24  jeffreyh]
	  Complete Parallelization for MPs.
	  For Corollary, must translate cbus adresses to
	  regular AT addresses if they are used by the
	  adaptec board.
	  Added a H/W reset for Boards where BIOS is not active.
	  Fixed DMA programming (use unsigned chars for outb().
	  [91/09/27            bernadat]
[ ./kernel/scsi/rz_audio.c ]
Tested NEC driver.  Tested Sony driver.
[93/03/22            af]

Rewritten a lot.  Do not even try (some) SCSI-2 commands on those
drivers that aren't even SCSI-1 compliant.  Use instead a list of
vendor-specific work-arounds.
[93/03/22            af]

Functionality is now complete for RRD42.
[93/03/17            af]
[ ./user/libmach/Makefile ]
Added moncrt0.o object and crt0.o_CFLAGS
Added -pg and GPROF for i386 and mips
Added -DMACH_IPC_COMPAT for i386, mips, luna88k, sun3 and vax
[93/03/22            mrt]
[ ./kernel/scsi/scsi_rom.c ]
Changed and made work scsi_read_subchannel, now strictly
standard-abiding.
[93/03/26            af]
[ ./user/libmach/msg.c ]
Resurrected and updated to match new types.
[93/03/29            pds]
[ ./kernel/mips/PMAX/kmin_dma.c ]
Quick fix to nasty bug triggered by GCC: there needs
to be at least one cycle between disabling DMA and
clearing the SCSI_SCR.
There are other problems with this file, but I'll merge
later. This one was urgent: it was causing bad SCSI commands
to go out to the bus in rare occasions, trashing disks.
[93/03/27            af]
[ ./user/libmach/Makefile ]
Added -DMACH_IPC_COMPAT and all the little IPC_COMPAT objects
for i386, mips, luna88k, sun3 and vax
[93/03/29            mrt]
[ ./kernel/alpha/boot/Makefile ]
Converted for odemake.
[93/03/09            mrt]

==========================================================================
   ***** MK Version MK81  (rvb) *****


In a few days an executive summary will sent to mach3.  The complete details
of the merge follow:

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
81
[ ./kernel/i386at/kd_mouse.c ]
Allow for mouse speed to be patchable

[ ./bootstrap/Makefile.bsd ]
Revised for bsdss.
[93/05/04  16:29:42  rvb]
[ ./bootstrap/bootstrap.c ]
Include files specified with quotes dont work properly
when the C file in in the master directory but the
include file is in the shadow directory. Change to
using angle brackets.
Ian Dall <DALL@hfrd.dsto.gov.au>	4/28/93
[93/05/10  13:12:37  rvb]
[ ./bootstrap/def_pager_setup.c ]
Include files specified with quotes dont work properly
when the C file in in the master directory but the
include file is in the shadow directory. Change to
using angle brackets.
Ian Dall <DALL@hfrd.dsto.gov.au>	4/28/93
[93/05/10  13:13:04  rvb]
[ ./bootstrap/default_pager.c ]
Added sanity checking to partition_of(). Made it a function
instead of a macro. Added set_partition_of.
Do mutex_unlocks in pager_alloc_page only if the lock was taken.
[93/04/15            jvh]
[ ./bootstrap/defs.h ]
Remove type defs for things defined in sys/types.h
[93/04/14            Ian Dall <DALL@hfrd.dsto.gov.au>]
[ ./bootstrap/file_io.c ]
Include files specified with quotes dont work properly
when the C file in in the master directory but the
include file is in the shadow directory. Change to
using angle brackets.
Ian Dall <DALL@hfrd.dsto.gov.au>	4/28/93
[93/05/10  13:15:31  rvb]
[ ./bootstrap/file_io.h ]
Include files specified with quotes dont work properly
when the C file in in the master directory but the
include file is in the shadow directory. Change to
using angle brackets.
Ian Dall <DALL@hfrd.dsto.gov.au>	4/28/93
[93/05/10  13:15:57  rvb]
[ ./bootstrap/kalloc.c ]
For now #ifdef __386BSD__ avoid size_t.
[93/05/05            rvb]
[ ./bootstrap/load.c ]
Include files specified with quotes dont work properly
when the C file in in the master directory but the
include file is in the shadow directory. Change to
using angle brackets.
Ian Dall <DALL@hfrd.dsto.gov.au>	4/28/93
[93/05/10  13:16:22  rvb]
[ ./kernel/chips/lance.c ]
Tell the lance to send the packet now instead of waiting
until the next 1.6 ms poll interval expires.
[from cmaeda.]
[ ./kernel/conf/MASTER ]
lineno is now not in STD configuration
[93/05/07  12:32:30  rvb]
[ ./kernel/conf/MASTER.cf ]
Revised for bsdss.
[93/05/04  16:44:12  rvb]
[ ./kernel/conf/MASTER.local.cf ]
Revised for bsdss
[93/05/04  16:46:31  rvb]
[ ./kernel/conf/Makefile.bsd ]
Revised for bsdss
[93/05/04  16:51:01  rvb]
[ ./kernel/conf/files.cf ]
Revised for bsdss
[93/05/04  16:54:34  rvb]
[ ./kernel/conf/i386/MASTER.cf ]
Revised for bsdss
[93/05/04  16:49:20  rvb]
[ ./kernel/conf/i386/MASTER.local.cf ]
Revised for bsdss
[93/05/04  16:49:35  rvb]
[ ./kernel/conf/i386/files.cf ]
Revised for bsdss
[93/05/04  16:55:52  rvb]
[ ./kernel/conf/i386/template.mk ]
Use CC_OPT_LEVEL from MI template.mk
[93/05/07  12:39:42  rvb]

Make CC_OPT_LEVEL set in env override value that would be set
here.
[93/05/06            rvb]
[ ./kernel/conf/i386/template.mk.bsd ]
Revised for bsdss

Condensed history:
[93/05/04  16:57:12  rvb]
[ ./kernel/conf/mips/template.mk ]
Use CC_OPT_LEVEL and CC_OPT_EXTRA for max flexibility
[93/05/07            rvb]
[ ./kernel/conf/template.mk ]
Typo missing `
Ian Dall <DALL@hfrd.dsto.gov.au>	4/28/93
[93/05/10  13:17:11  rvb]

Use CC_OPT_LEVEL and CC_OPT_EXTRA for max flexibility
[93/05/07            rvb]
[ ./kernel/conf/template.mk.bsd ]
Revised for bsdss
[93/05/04  16:57:58  rvb]
[ ./kernel/ddb/db_output.c ]
_doprint assumes 1st arg of putc type function is char not int.
Make db_putc conform.
[93/04/27            Ian Dall <DALL@hfrd.dsto.gov.au>]

Call _doprnt with the right number of arguments. Define db_putc
which has an extra dummy argument cf db_putchar. Use db_putc
instead of db_putchar in call to _doprnt.
[93/04/25            Ian Dall <DALL@hfrd.dsto.gov.au>]
[ ./kernel/device/chario.c ]
Added test to check that buffer is large enough to hold data
returned by tty_get_status.
[93/04/20            kivinen]
[ ./kernel/device/net_io.c ]
Added test to check that buffer is large enough to hold data
returned by net_getstat.
[93/04/20            kivinen]
[ ./kernel/i386/asm.h ]
Define LCLL(x) "Local label" == x:
Specify ALIGN == 2.
[93/05/03            rvb]
[ ./kernel/i386/locore.s ]
Use C comments
[93/05/04  17:16:38  rvb]
[ ./kernel/i386/start.s ]
Use C comments
[93/05/04  17:17:00  rvb]
[ ./kernel/i386at/asm_startup.h ]
Use C comments
[93/05/04  17:18:16  rvb]
[ ./kernel/i386at/boot/Makefile.bsd ]
Revised for bsdss
[93/05/04  17:19:43  rvb]
[ ./kernel/i386at/boot/asm.s ]
Use C Comment
[93/05/04  17:28:59  rvb]
[ ./kernel/i386at/boot/bios.s ]
Use C Comment
[93/05/04  17:29:17  rvb]
[ ./kernel/i386at/boot/boot.c ]
Leave sector #1 empty so 386bsd can store its label there.
Fix typo in handling "ha" device.
New banner.
[93/04/01            rvb]
[ ./kernel/i386at/boot/boot.h ]
bsdss has a different fs layout
[93/05/04  17:33:14  rvb]
[ ./kernel/i386at/boot/disk.c ]
Use < vs " for include-ed files
[93/05/05  11:41:20  rvb]
[ ./kernel/i386at/boot/start.s ]
Leave sector #1 empty so 386bsd can store its label there.
[93/04/01            rvb]
[ ./kernel/i386at/boot/sys.c ]
bsdss has a different fs layout
[93/05/04  17:34:21  rvb]
[ ./kernel/i386at/boot/table.c ]
Leave sector #1 empty so 386bsd can store its label there.
[93/04/01            rvb]
[ ./kernel/i386at/com.c ]
I spend a little time working out rconsole with Steve Berman
and don't want to lose the code.  It's not quite done yet
but it seems close.
[93/05/10            rvb]
[ ./kernel/i386at/kd.c ]
I spend a little time working out rconsole with Steve Berman
and don't want to lose the code.  It's not quite done yet
but it seems close.  BUT WE WILL SKIP INPUT FOR NOW.
[93/05/10            rvb]
[ ./kernel/i386at/rtc.c ]
Let's not use time_t in the kernel.
[93/05/04  17:37:13  rvb]
[ ./kernel/kern/assert.h ]
According to Friedl's wishes undo Change 2.6.  Too many people
seem to believe that Assert() can return a value.
[93/05/10  15:47:06  rvb]
[ ./kernel/kern/mach_clock.c ]
Rudy asked for this change for xntp and dbg thought it would
do no harm.  (I think that HZ is pretty always 100 so that this
code and the previous version always go the tickadj = 1; route.)
[93/05/10  15:52:26  rvb]
[ ./kernel/luna88k/exec.h ]
Undefuncted
[93/05/10  15:57:50  rvb]
[ ./kernel/mach/mach_traps.h ]
	386BSD gets confused iff mach_task_self is still defined.
[93/05/05            rvb]
[ ./kernel/mach/mig_support.h ]
Totally eliminate size_t.
[93/05/04  17:42:35  rvb]
[ ./kernel/src/config/Makefile.bsd ]
Revised for bsdss.
[93/05/04  16:36:19  rvb]
[ ./kernel/src/config/config.h ]
Avoid type conflicts #ifdef __386BSD__.
[93/05/04  16:38:44  rvb]
[ ./kernel/src/config/gram.y ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:35:19  rvb]
[ ./kernel/src/config/main.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:35:30  rvb]
[ ./kernel/src/config/mkglue.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:35:39  rvb]
[ ./kernel/src/config/mkheaders.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:35:49  rvb]
[ ./kernel/src/config/mkioconf.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:35:59  rvb]
[ ./kernel/src/config/mkmakefile.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:36:12  rvb]
[ ./kernel/src/config/mkmakefile.c.bsd ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:36:22  rvb]

Revised for bsdss
[93/05/04  16:40:00  rvb]
[ ./kernel/src/config/parse.l ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:36:34  rvb]
[ ./kernel/src/doconf/doconf.sh ]
Sh shell version of Csh script.  Converted by Ian Dall.
[93/05/10  13:33:32  rvb]
[ ./kernel/src/makeboot/Makefile.bsd ]
Revised for bsdss
[93/05/04  18:05:17  rvb]
[ ./kernel/src/makeboot/alpha/exec.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:40:31  rvb]
[ ./kernel/src/makeboot/build_boot.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:40:41  rvb]
[ ./kernel/src/makeboot/cross_32_to_64.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:40:51  rvb]
[ ./kernel/src/makeboot/sun3/exec.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:41:02  rvb]
[ ./kernel/src/mig/Makefile.bsd ]
Revised for bsdss
[93/05/04  18:06:06  rvb]
[ ./kernel/src/mig/error.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:27:23  rvb]

386BSD lex does not do line numbers ... yet
[93/05/05  09:24:01  rvb]
[ ./kernel/src/mig/error.h ]
Only use __attribute__ iff __GNUC__ > 1
[93/05/05  09:15:24  rvb]
[ ./kernel/src/mig/global.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:27:32  rvb]
[ ./kernel/src/mig/global.h ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:27:41  rvb]
[ ./kernel/src/mig/header.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:27:51  rvb]
[ ./kernel/src/mig/lexxer.l ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:27:59  rvb]

386BSD uses a different lex
[93/05/05  09:16:56  rvb]
[ ./kernel/src/mig/mig.sh.bsd ]
Revised for bsdss
[93/05/05  09:27:19  rvb]
[ ./kernel/src/mig/migcom.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:28:09  rvb]
[ ./kernel/src/mig/parser.y ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:28:19  rvb]
[ ./kernel/src/mig/routine.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:28:28  rvb]
[ ./kernel/src/mig/routine.h ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:28:40  rvb]
[ ./kernel/src/mig/server.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:28:50  rvb]
[ ./kernel/src/mig/statement.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:29:03  rvb]
[ ./kernel/src/mig/statement.h ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:29:11  rvb]
[ ./kernel/src/mig/string.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:29:20  rvb]

386BSD string declarations
[93/05/05  09:25:39  rvb]
[ ./kernel/src/mig/type.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:29:29  rvb]
[ ./kernel/src/mig/type.h ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:29:38  rvb]
[ ./kernel/src/mig/user.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:29:47  rvb]

386BSD string declarations
[93/05/05  09:25:43  rvb]
[ ./kernel/src/mig/utils.c ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:30:03  rvb]
[ ./kernel/src/mig/write.h ]
Fix include to use < vs " for new ode shadowing
[93/05/10  10:30:16  rvb]
[ ./user/libmach/Makefile ]
Fixed typo on mach/i386/mach_i386.defs rule.
[93/05/05  14:40:23  rvb]
[ ./user/libmach/Makefile.bsd ]
clean up a few more files
[93/05/06  10:10:00  rvb]

Export mach/default_pager.h
[93/05/04  17:47:11  rvb]

Revised for bsdss
[93/05/04  17:44:44  rvb]
[ ./user/libmach/i386/_setjmp.s ]
Use C Comment
[93/05/04  17:57:21  rvb]
[ ./user/libmach/i386/bcopy.s ]
Use C Comment
[93/05/04  17:57:24  rvb]
[ ./user/libmach/i386/bzero.s ]
Use C Comment
[93/05/04  17:57:28  rvb]
[ ./user/libmach/i386/crt0.c ]
	MACH is true, and Wheeze is false.
[93/05/05            rvb]
[ ./user/libmach/i386/memcpy.s ]
Use C Comment
[93/05/04  17:57:33  rvb]
[ ./user/libmach/mig_strncpy.c ]
Avoid size_t
[93/05/04  18:00:57  rvb]
[ ./user/libmach/mips/crt0.s ]
Fix mcount(), to pop 8 bytes and restore AT -> RA
This will/should make gcc 2.3 happy.
[93/04/19  22:53:26  rvb]
[ ./user/libmach/panic.c ]
Put a delay loop before actually panicing. Otherwise
the panic message can get lost or scrambled. Currently
#ifdef PC532 but could be generic.
Ian Dall <DALL@hfrd.dsto.gov.au>	4/28/93
[93/05/10  13:18:58  rvb]
[ ./user/libmach/sbrk.c ]
Use defined(multimax) instead of defined(ns32000) for
obsolete way of defining curbrk and minbrk.
Ian Dall <DALL@hfrd.dsto.gov.au>	4/28/93
[93/05/10  13:19:42  rvb]
[ ./user/threads/Makefile ]
Handle -pg and -DGPROF just like libthreads does.
[93/05/06            rvb]
-DCTHREAD_DATA is now unnecessary.  It is effectively
always true.
[93/05/06            rvb]
[ ./user/threads/Makefile.bsd ]
-DCTHREAD_DATA is now unnecessary.  It is effectively
always true.
[93/05/06            rvb]
Revised for bsdss
[93/05/04  18:02:13  rvb]
[ ./user/threads/cthread_data.c ]
Make cthread_set_data and cthread_data macros.
[93/05/06            rvb]
[ ./user/threads/cthread_internals.h ]
Flush stdlib
[93/05/05  09:12:29  rvb]
[ ./user/threads/cthreads.h ]
Just imagine how much more useful TWO special/fast lookup
variables could be.  (Actually, I am planning on using this
for bsdss -- for multiple threads per task.  If I don't, I'll
remove the feature.)
[93/05/10            rvb]
Big mistake here! CTHREAD_DATA must always be set TRUE.
cthreads.h is included by import_mach.h by lots of files
that are not compiled with -DCTHREAD_DATA.  This means
they see a different structure for cthread_t than the
cthread library -- which is compiled with CTHREAD_DATA.
Also, make cthread_set_data and cthread_data macros.
[93/05/06            rvb]
Flush stdlib
[93/05/05            rvb]
[ ./user/threads/i386/csw.s ]
Use C Comment
[93/05/04  18:13:59  rvb]
[ ./user/threads/i386/lock.s ]
Use C Comment
[93/05/04  18:14:05  rvb]
[ ./kernel/man/host_processors.man ]
updated
[93/04/21  16:03:04  lli]
[ ./kernel/man/mach_port_allocate.man ]
updated
[93/04/21  16:03:10  lli]
[ ./kernel/man/mach_port_allocate_name.man ]
updated
[93/04/21  16:03:13  lli]
[ ./kernel/man/mach_port_deallocate.man ]
updated
[93/04/21  16:03:16  lli]
[ ./kernel/man/mach_port_destroy.man ]
updated
[93/04/21  16:03:19  lli]
[ ./kernel/man/mach_port_extract_right.man ]
updated
[93/04/21  16:03:22  lli]
[ ./kernel/man/mach_port_get_receive_status.man ]
updated
[93/04/21  16:03:26  lli]
[ ./kernel/man/mach_port_get_refs.man ]
updated
[93/04/21  16:03:29  lli]
[ ./kernel/man/mach_port_get_set_status.man ]
updated
[93/04/21  16:03:32  lli]
[ ./kernel/man/mach_port_insert_right.man ]
updated
[93/04/21  16:03:35  lli]
[ ./kernel/man/mach_port_mod_refs.man ]
updated
[93/04/21  16:03:42  lli]
[ ./kernel/man/mach_port_move_member.man ]
updated
[93/04/21  16:03:46  lli]
[ ./kernel/man/mach_port_names.man ]
updated
[93/04/21  16:03:49  lli]
[ ./kernel/man/mach_port_rename.man ]
updated
[93/04/21  16:03:52  lli]
[ ./kernel/man/mach_port_request_notification.man ]
updated
[93/04/21  16:03:55  lli]
[ ./kernel/man/mach_port_set_mscount.man ]
updated
[93/04/21  16:03:58  lli]
[ ./kernel/man/mach_port_set_qlimit.man ]
updated
[93/04/21  16:04:02  lli]
[ ./kernel/man/mach_port_set_seqno.man ]
updated
[93/04/21  16:04:05  lli]
[ ./kernel/man/mach_port_type.man ]
updated
[93/04/21  16:04:08  lli]
[ ./kernel/man/mach_ports_register.man ]
updated
[93/04/21  16:07:08  lli]
[ ./kernel/man/man/host_processors.man ]
updated
[93/04/21  16:01:18  lli]
[ ./kernel/man/man/mach_port_allocate.man ]
updated
[93/04/21  16:01:27  lli]
[ ./kernel/man/man/mach_port_allocate_name.man ]
updated
[93/04/21  16:01:37  lli]
[ ./kernel/man/man/mach_port_deallocate.man ]
updated
[93/04/21  16:01:44  lli]
[ ./kernel/man/memory_object_copy.man ]
updated
[93/04/21  16:08:05  lli]
[ ./kernel/man/memory_object_create.man ]
updated
[93/04/21  16:08:08  lli]
[ ./kernel/man/memory_object_data_error.man ]
updated
[93/04/21  16:08:11  lli]
[ ./kernel/man/memory_object_data_initialize.man ]
updated
[93/04/21  16:08:14  lli]
[ ./kernel/man/memory_object_data_provided.man ]
updated
[93/04/21  16:08:17  lli]
[ ./kernel/man/memory_object_data_request.man ]
updated
[93/04/21  16:08:21  lli]
[ ./kernel/man/memory_object_data_unavailable.man ]
updated
[93/04/21  16:08:24  lli]
[ ./kernel/man/memory_object_data_unlock.man ]
updated
[93/04/21  16:08:30  lli]
[ ./kernel/man/memory_object_data_write.man ]
updated
[93/04/21  16:08:33  lli]
[ ./kernel/man/memory_object_destroy.man ]
updated
[93/04/21  16:08:36  lli]
[ ./kernel/man/memory_object_get_attributes.man ]
updated
[93/04/21  16:08:40  lli]
[ ./kernel/man/memory_object_init.man ]
updated
[93/04/21  16:08:43  lli]
[ ./kernel/man/memory_object_lock_completed.man ]
updated
[93/04/21  16:08:46  lli]
[ ./kernel/man/memory_object_lock_request.man ]
updated
[93/04/21  16:08:49  lli]
[ ./kernel/man/memory_object_set_attributes.man ]
updated
[93/04/21  16:08:53  lli]
[ ./kernel/man/memory_object_terminate.man ]
updated
[93/04/21  16:08:56  lli]
[ ./kernel/man/thread_wire.man ]
updated
[93/04/21  16:09:00  lli]
[ ./kernel/man/vm_wire.man ]
updated
[93/04/21  16:09:06  lli]
[ ./bootstrap/bootstrap.c ]
Changed "" includes to <>
[93/04/30            mrt]
[ ./bootstrap/def_pager_setup.c ]
Changed "" includes to <>
[93/04/30            mrt]
[ ./bootstrap/default_pager.c ]
Changed include "" to <>
[93/04/30            mrt]
[ ./bootstrap/file_io.c ]
Changed "" includes to <>
[93/04/30            mrt]
[ ./bootstrap/file_io.h ]
Changed "" includes to <>
[93/04/30            mrt]
[ ./bootstrap/load.c ]
Changed "" includes to <>
[93/04/30            mrt]
[ ./kernel/Makefile ]
Added ${MAKE_ARGS} to kernel_only make rule, at Daryl's
suggestion. Makes possible commands like

odemake MAKE_ARGS=`locore.o relink` kernel_only
[93/04/08            mrt]
[ ./kernel/conf/alpha/MASTER ]
Made gx driver conditional on dec-lic so that it would be
easier to build the system without the licensed code.
[93/05/10            mrt]
[ ./kernel/conf/mips/MASTER ]
Removed obsolete PMAX_USE_GCC makeoption.
[93/05/10            mrt]

Isolated code that requires license from DEC under dec_lic so it
will be easy to compile without it.
[93/04/28            jvh]
[ ./kernel/conf/mips/template.mk ]
Removed LINENO from here as it is now used in machine independent
MASTER file. Set CC_OPT_EXTRA which is now an addition to
CC_OPT_LEVEL.
[93/05/10            mrt]
[ ./kernel/conf/template.mk ]
Added trailing ` on cat ${VERSION_FILES_SOURCE line.
Fix courtesy of Ian Dall.
[93/04/29            mrt]
[ ./user/libmach/Makefile ]
Removed -pg and -DGRPOF for mips and i386.  Added
LIBRARIES_P instead. Now libmach.a libmach_p.a, libmach_sa.a
and libmach_p_sa.a will always get built and exported.
[93/05/09            mrt]

Removed bogus trailing blank from mach_i386.defs rule.
[93/04/08            mrt]
[ ./user/threads/cthreads.h ]
Removed include of stdlib.h and just define malloc
[93/04/27            mrt]
[ ./kernel/i386at/hd.c ]
Types.
[93/05/08  11:17:48  af]
[ ./kernel/alpha/DEC/flamingo.c ]
Support for 3000/400. Lint.
[93/05/07  14:43:16  af]
[ ./kernel/alpha/DEC/flamingo_dma.c ]
Types.
[93/05/07  14:43:57  af]
[ ./kernel/alpha/DEC/model_dep.c ]
Fixed TC probing.
[93/05/07  14:44:51  af]
[ ./kernel/alpha/DEC/tc.c ]
ANSI-C. Lint.
[93/05/07  14:45:57  af]

CPU driver changed name, removed unnecessary buserror scrubbing,
made silent by default, start off with all TC interrupts off.
[90/11/01  03:49:16  af]

Created, from the DEC specs:
"TURBOchannel Hardware Specification"
EK-369AA-OD-005, Version 005, July 1990
[90/09/03            af]
[ ./kernel/alpha/DEC/tc.h ]
Fixed TC probing.
[93/05/07  14:46:41  af]

Created, from the DEC specs:
"TURBOchannel Hardware Specification"
EK-369AA-OD-005, Version 005, July 1990
[90/09/03            af]
[ ./kernel/chips/atm.c ]
No more sys/types.h.  Fixed some other types.
[93/05/06  09:53:34  af]
[ ./kernel/chips/audio.c ]
GCC quiet.
[93/05/06  09:53:58  af]
[ ./kernel/chips/busses.h ]
No more caddr_t.
[93/04/09            af]
[ ./kernel/chips/cfb_hdw.c ]
Fixed types.
[93/05/06  10:00:37  af]
[ ./kernel/chips/dtop_handlers.c ]
No more sys/types.h
[93/05/06  09:55:58  af]
[ ./kernel/chips/dtop_hdw.c ]
Fixed types.
[93/05/06  09:59:47  af]
[ ./kernel/chips/dz_defs.h ]
Use Mach types.
[93/05/06  09:55:29  af]
[ ./kernel/chips/dz_hdw.c ]
Fixed types.
[93/05/06  09:59:28  af]
[ ./kernel/chips/fb_hdw.c ]
Fixed types.
[93/05/06  10:00:11  af]
[ ./kernel/chips/fdc_82077_hdw.c ]
Fixed types.
[93/05/06  09:58:59  af]
[ ./kernel/chips/frc.c ]
Fixed types.
[93/05/06  09:58:36  af]
[ ./kernel/chips/isdn_79c30_hdw.c ]
No more sys/types.h
[93/05/06  10:02:24  af]
[ ./kernel/chips/lance.c ]
No more sys/types.h.  Define what is exported and what not.
[93/05/06  09:52:17  af]
[ ./kernel/chips/lance_mapped.c ]
No more sys/types.h.
[93/05/06  09:52:53  af]
[ ./kernel/chips/lk201.c ]
Fixed types.
[93/05/06  09:58:13  af]
[ ./kernel/chips/mc_clock.c ]
Fixed types. Define what is exported and what not.
[93/05/06  09:57:45  af]
[ ./kernel/chips/mouse.c ]
No more sys/types.h
[93/05/06  09:55:04  af]
[ ./kernel/chips/pm_hdw.c ]
Fixed types.
[93/05/06  09:57:15  af]
[ ./kernel/chips/scc_8530.h ]
Lint.
[93/05/06  09:56:51  af]
[ ./kernel/chips/scc_8530_hdw.c ]
Fixed types.
[93/05/06  10:01:41  af]
[ ./kernel/chips/screen.c ]
No more sys/types.h
[93/05/06  09:54:42  af]
[ ./kernel/chips/serial_console.c ]
No sys/types.h.
[93/05/06  09:54:21  af]
[ ./kernel/chips/sfb_hdw.c ]
Fixed types.
[93/05/06  10:01:16  af]
[ ./kernel/chips/xcfb_hdw.c ]
Fixed types.
[93/05/06  09:56:26  af]
[ ./kernel/conf/MASTER ]
Lineno is too expensive to enable on all archies.
[93/05/06  11:12:28  af]
[ ./kernel/device/chario.c ]
Fixed pdma stuff.
[93/05/06  11:07:39  af]
[ ./kernel/device/dev_hdr.h ]
Added block size (bsize) field, replaces DEV_BSIZE.
[93/05/06  11:10:35  af]
[ ./kernel/device/dev_lookup.c ]
Removed depends on DEV_BSIZE, now it is just a default
for backward compat.
[93/05/06  11:09:37  af]
[ ./kernel/device/dev_pager.c ]
Removed depends on DEV_BSIZE.
[93/05/06  11:08:38  af]
[ ./kernel/i386/fpu.c ]
spl_t fixes.
[93/05/06  11:15:58  af]
[ ./kernel/i386/pic.c ]
spl_t fixes.
[93/05/06  11:15:36  af]
[ ./kernel/i386at/autoconf.c ]
Lint.
[93/05/08  11:20:03  af]

Made it possible to have two Adaptec boards.
[93/05/07  18:37:34  af]

Added include of standard types.
[93/05/06  09:30:11  af]
[ ./kernel/i386at/com.c ]
Removed 2.5 compat cruft. FIFOs work, but needs more work.
Added watchdog to cure lost xmit interrupts [there is a
bug somewhere else because I am losing them even on a
chip that has no hardware bugs].  Do input buffering
at all speeds higher than 300 bauds.
[93/05/06  09:29:11  af]
[ ./kernel/i386at/comreg.h ]
Added mask for interrupt register.
[93/05/06  09:29:39  af]
[ ./kernel/i386at/fd.c ]
Lint.
[93/05/08  11:19:03  af]
[ ./kernel/i386at/if_3c501.c ]
Lint.
[93/05/08  11:22:57  af]
[ ./kernel/i386at/if_ns8390.c ]
Lint.
[93/05/08  11:20:50  af]
[ ./kernel/i386at/if_pc586.c ]
Lint.
[93/05/08  11:21:38  af]
[ ./kernel/i386at/kd_mouse.c ]
Lint.
[93/05/08  11:22:15  af]
[ ./kernel/i386at/lpr.c ]
Lint.
[93/05/08  11:18:33  af]
[ ./kernel/kern/machine.c ]
Do not cast to (int) unless you know what that is.
Use (integer_t) when in doubt.
[93/04/09            af]
[ ./kernel/mach/mig_support.h ]
size_t --> vm_size_t.
[93/04/09            af]
[ ./kernel/mips/PMAX/kmin.c ]
Take the HALT button interrupt.
No more sys/types.h
[93/05/06  09:43:20  af]
[ ./kernel/mips/PMAX/kmin_cpu.h ]
Let Halt interrupt always in.  Let DMA interrupts in
as much as possible.
[93/05/06  09:47:22  af]
[ ./kernel/mips/PMAX/kmin_cpu.s ]
Let Halt interrupt always in.
[93/05/06  09:49:35  af]
[ ./kernel/mips/PMAX/kmin_dma.c ]
Complete rewrite.  Now it makes sense to use tapes and such.
[93/04/08            af]
[ ./kernel/mips/PMAX/kn02_dma.c ]
Removed a couple of duplicated functions.
Fixed interface for dma_init().
[93/04/09            af]
[ ./kernel/mips/PMAX/kn02ba.c ]
Debounce halt button press.
[93/05/06  09:45:53  af]

No more sys/types.h
[93/05/06  09:41:26  af]
[ ./kernel/mips/PMAX/maxine.c ]
No minors or sys/types.h
[93/05/06  09:39:57  af]
[ ./kernel/mips/PMAX/mips_box.c ]
No more sys/types.h
[93/05/06  09:40:51  af]
[ ./kernel/mips/PMAX/model_dep.c ]
Initialize the interrupt mask register on maxine and kmin.
GCC quiet.
[93/05/06  09:39:18  af]
[ ./kernel/mips/PMAX/tc.c ]
No sys/types.h
[93/05/06  09:40:19  af]
[ ./kernel/mips/conf.c ]
Zero map function where unused.
Use block_io for disks.
[93/05/06  09:32:51  af]
[ ./kernel/mips/db_interface.c ]
Removed sys/types.h
[93/05/06  09:31:18  af]
[ ./kernel/mips/mips_cache.s ]
How very stupid of me: while flushing the Icache we
can use the Dcache as Icache to speedup the loop !!
Thanks to Brad Chen for pointing this out.
[93/05/06  09:34:18  af]
[ ./kernel/mips/pmap.c ]
No more sys/types.h
[93/05/06  09:31:45  af]
[ ./kernel/scsi/adapters/scsi_53C94.h ]
Added memory barriers for when writes are out of order.
[93/04/09            af]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
Handle odd-byte-boundary conditions if asked to.
Dynamic probe was not counting targets correctly.
Final xfer counter value was clobbered before use.
Handle boundary case of exactly MAX_TC_SIZE.
Added some comments. Lint.
[93/04/09            af]
[ ./kernel/scsi/adapters/scsi_7061_hdw.c ]
Fixed types.
[93/05/06  10:17:50  af]
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
Added Toshiba machdeps.  This is getting out of hand.
[93/05/06  10:16:37  af]
[ ./kernel/scsi/adapters/scsi_aha15.h ]
Define IDs for 1740 and 1540C.
[93/05/07  18:38:13  af]
[ ./kernel/scsi/adapters/scsi_aha15_hdw.c ]
Types.
[93/05/08            af]
Redid init sequence so that 1540C works.  Sheez.
[93/05/07  18:38:58  af]

Added Toshiba machdeps.
[93/05/06  10:17:10  af]
[ ./kernel/scsi/adapters/scsi_dma.h ]
Prototypes.
[93/04/09            af]
[ ./kernel/scsi/mapped_scsi.c ]
No more sys/types.
[93/05/06  10:04:40  af]
[ ./kernel/scsi/rz.c ]
Removed depend on DEV_BSIZE. Lint.
[93/05/06  10:14:29  af]
[ ./kernel/scsi/rz_audio.c ]
Added Toshiba drives.
[93/04/13  22:48:05  af]
[ ./kernel/scsi/rz_disk.c ]
Removed depends on DEV_BSIZE.
Do not assume read_capacity will work (violations of standard..)
Try to set the logical block size to the default U*X wants,
but take whatever the drive wants if not.  For CDROMs.
Write back the label where we found it.
[93/05/06  10:13:33  af]
[ ./kernel/scsi/rz_disk_bbr.c ]
Removed depends on DEV_BSIZE.
[93/05/06  10:09:46  af]
[ ./kernel/scsi/rz_labels.c ]
Removed depends on DEV_BSIZE.
[93/05/06  10:09:09  af]
[ ./kernel/scsi/rz_tape.c ]
Added GET_SIZE ioctl. 
Fixed log and a couple of comments.
[93/04/09            af]
[ ./kernel/scsi/scsi.c ]
Make CDROMs readonly.
[93/05/06  10:07:01  af]
[ ./kernel/scsi/scsi_alldevs.c ]
Lint.
[93/04/13  22:49:08  af]
[ ./kernel/scsi/scsi_defs.h ]
Added rewriting of label where we found it.
[93/05/06  10:05:31  af]
[ ./kernel/scsi/scsi_disk.c ]
Remove depends on DEV_BSIZE.
[93/05/06  10:06:25  af]
[ ./kernel/scsi/scsi_tape.c ]
Always pass density code down. Fixed log.
[93/04/09            af]
[ ./user/libmach/Makefile ]
Fixed rule for i386 defs.
[93/05/06  09:20:47  af]
[ ./user/libmach/alpha/fork.cs ]
Quiet if no -w.
[93/04/11            af]
[ ./user/libmach/mig_strncpy.c ]
No size_t's.
[93/05/06  09:21:41  af]
[ ./user/threads/cthread_internals.h ]
Context is a natural_t.  Assumming, that is, that on 
some future architecture one word might be enough.
[93/05/06  09:19:35  af]
[ ./kernel/alpha/DEC/flamingo_dma.c ]
Types.
[93/05/07  14:43:57  af]
[ ./kernel/alpha/DEC/model_dep.c ]
Fixed TC probing.
[93/05/07  14:44:51  af]
[ ./kernel/alpha/DEC/tc.h ]
Fixed TC probing.
[93/05/07  14:46:41  af]

Created, from the DEC specs:
"TURBOchannel Hardware Specification"
EK-369AA-OD-005, Version 005, July 1990
[90/09/03            af]
[ ./kernel/chips/busses.c ]
No more caddr_t.
[93/04/09            af]
[ ./kernel/man/mach_ports_lookup.man ]
Created
[93/05/10            rvb]
[ ./kernel/conf/MASTER ]
Checkin for MK80 branch.
[93/05/10  15:21:02  grm]
[ ./kernel/conf/files ]
Checkin for MK80 branch.
[93/05/10  15:21:33  grm]
[ ./kernel/conf/i386/files ]
Checkin for MK80 branch
[93/05/10  15:24:25  grm]
[ ./kernel/device/net_io.c ]
Checkin for MK80 branch.
[93/05/10  15:16:19  grm]
[ ./kernel/i386/kttd_interface.c ]
Checkin for MK80 branch.
[93/05/10  15:11:12  grm]
[ ./kernel/i386/kttd_machdep.h ]
Checkin for MK80 branch.
[93/05/10  15:11:30  grm]
[ ./kernel/i386/locore.s ]
Checkin for MK80 branch.
[93/05/10  15:11:52  grm]
[ ./kernel/i386/trap.c ]
Checkin for MK80 branch.
[93/05/10  15:12:36  grm]
[ ./kernel/i386at/autoconf.c ]
Checkin for MK80 branch.
[93/05/10  15:13:07  grm]
[ ./kernel/i386at/if_ns8390.c ]
Checkin for MK80 branch.
[93/05/10  15:13:33  grm]
[ ./kernel/include/i386/Makefile ]
Checkin for MK80
[93/05/10  15:25:22  grm]
[ ./kernel/ttd/kernel_ttd.h ]
Checkin for MK80 branch.
[93/05/10  15:04:38  grm]
[ ./kernel/ttd/ttd_comm.c ]
Checkin for MK80 branch.
[93/05/10  15:05:52  grm]
[ ./kernel/ttd/ttd_comm.h ]
Checkin for MK80 branch.
[93/05/10  15:07:45  grm]
[ ./kernel/ttd/ttd_debug.h ]
Checkin for MK80 branch.
[93/05/10  15:08:12  grm]
[ ./kernel/ttd/ttd_msg.h ]
Checkin for MK80 branch.
[93/05/10  15:08:31  grm]
[ ./kernel/ttd/ttd_server.c ]
Checkin for MK80 branch.
[93/05/10  15:08:55  grm]
[ ./kernel/ttd/ttd_server.h ]
Checkin for MK80 branch.
[93/05/10  15:09:23  grm]
[ ./kernel/ttd/ttd_stub.c ]
Turned kttd debugging output off by default.
[93/05/10  15:15:11  grm]

Checkin for MK80 branch.
[93/05/10  15:09:57  grm]
[ ./kernel/ttd/ttd_stub.h ]
Checkin for MK80 branch.
[93/05/10  15:10:15  grm]
[ ./kernel/ttd/ttd_types.h ]
Checkin for MK80 branch.
[93/05/10  15:10:37  grm]
[ ./kernel/i386at/adaptec.c ]
Defunct
[ ./kernel/i386at/adaptec.h ]
Defunct
[ ./kernel/i386at/scsi.h ]
Defunct
[ ./kernel/src/doconf/doconf.csh ]
Defunct
[ ./kernel/conf/MASTER.cf ]
Added TTD teledebug i386 optional files.
[93/05/11            grm]
[ ./kernel/conf/files.cf ]
Added TTD teledebug i386 optional files.
[93/05/11            grm]
[ ./kernel/conf/i386/files.cf ]
Added TTD teledebug i386 optional files.
[93/05/11            grm]
[ ./user/threads/Makefile ]
Removed -pg and -DGRPOF for mips and i386.  Added
LIBRARIES_P instead. Now libthreads.a and libthreads_p.a
will always get built and exported.
[93/05/11            mrt]
[ ./kernel/conf/mips/template.mk ]
Changed uses of CMACHFLAGS to CC_OPT_EXTRA.
[93/05/11            mrt]
[ ./conf/template.mk ]
We don't profile the kernel yet.
[ ./kernel/i386at/kd.c ]
Accept either keyboard in cn_dogetc
[ ./kernel/i386at/com.c ]
Accept either keyboard in cn_dogetc
[ ./kernel/i386at/kd.c ]
Accept either keyboard in cn_dogetc
[ ./kernel/i386at/kd.c ]
Accept either keyboard in cn_dogetc
[ ./kernel/i386at/kd_mouse.c ]
Typo
[ ./kernel/i386at/kd.c ]
Accept either keyboard in cndogetc. Typo on comrc_put{c}.
[ ./user/libmach/Makefile ]
LIBRARIES_P only for mips and i386
[ ./user/threads/Makefile ]
LIBRARIES_P only for mips and i386
[ ./user/libmach/sbrk.c ]
You can not flush the extern decl of curmin in the asm case.
I don't see how this could work![ ./user/libmach/alpha/fork.cs ]
Defunct: fork.cs->fork.s
[ ./user/libmach/i386/fork.cs ]
Defunct: fork.cs->fork.s
[ ./user/libmach/mips/fork.cs ]
Defunct: fork.cs->fork.s
[ ./user/libmach/i860/fork.cs ]
Defunct: fork.cs->fork.s
[ ./user/libmach/vax/fork.cs ]
Defunct: fork.cs->fork.s
[ ./user/libmach/sun3/fork.cs ]
Defunct: fork.cs->fork.s
[ ./user/libmach/vax/bcopy.cs ]
Defunct: bcopy.cs->bcopy.s
[ ./kernel/vax/ka3100.h ]
Include <sys/types.h> because pm_hdw.c no longer does.
[93/05/12            rvb]
[ ./user/libmach/mips/crt0.s ]
.aent belongs in .ent
[ ./kernel/conf/alpha/template.mk ]
Removed use of LINENO. It is used in machine independent
template.mk.
Made all the compiler options set dynamically.
[93/05/12            mrt]
[ ./kernel/ddb/db_output.c ]
Make db_putc static.
[93/05/13            rvb]
[ ./user/libmach/Makefile ]
Corrected errors.
[93/05/11            mrt]
[ ./user/libmach/Makefile.bsd ]
".if <var> == string" requires string to be in double quotes.
[93/05/13            rvb]
[ ./user/threads/Makefile ]
".if <var> == string" requires string to be in double quotes.
[ ./user/threads/Makefile.bsd ]
".if <var> == string" requires string to be in double quotes.
[93/05/13            rvb]
[ ./user/threads/sun4/thread.c ]
int->natural_t
[ ./kernel/mach/sun4/vm_types.h ]
ADD H_
[ ./kernel/ddb/db_output.c ]
db_putc is used by the luna; rename it here.
[ ./kernel/ddb/db_output.c ]
db_putc is used by the luna; rename it here.
[93/05/13            rvb]
[ ./kernel/conf/MASTER.bnr ]
.cf->.bnr
[ ./kernel/conf/i386/MASTER.bnr ]
.cf->.bnr
[ ./kernel/conf/sun4c/template.mk ]
Don't define CC_OPT_LEVEL; let user do it
[ ./bootstrap/kalloc.c ]
For malloc(), use vm_size_t vs size_t.
[93/05/14            rvb]
[ ./include/device/Makefile ]
Export audio_status.h for af's toys.
[93/05/14            rvb]
[ ./kernel/conf/Makefile.bnr ]
.cf -> .bnr
[93/05/14            rvb]
[ ./kernel/i386at/com.c ]
Berman is right; check txbusy first then write for comrc_put
[93/05/14            rvb]
[ ./kernel/mach/mig_support.h ]
#include string.h -> strings.h
[93/05/14            rvb]
[ ./kernel/src/config/mkmakefile.c.bnr ]
"file's" suffix .cf -> .bnr
[93/05/14            rvb]
[ ./user/threads/m88k/thread.c ]
#include string.h->strings.h; kill stdlib.h
[93/05/14            rvb]
[ ./user/threads/malloc.c ]
#include string.h->strings.h; kill stdlib.h
size_t -> vm_size_t. 
[93/05/14            rvb]
[ ./user/threads/mips/thread.c ]
#include string.h->strings.h; kill stdlib.h
[93/05/14            rvb]
[ ./user/threads/sun3/thread.c ]
#include string.h->strings.h; kill stdlib.h
[93/05/14            rvb]
[ ./user/threads/vax/thread.c ]
#include string.h->strings.h; kill stdlib.h
[93/05/14            rvb]
[ ./kernel/device/cirbuf.c ]
Fixed nasty bug in getc(): it was returning -1 when
the character was 0xff. This makes SLIP work on DS boxes.
[93/05/13  20:28:59  af]
[ ./kernel/kern/task.c ]
machparam.h -> machspl.h
[ ./kernel/sun/heap_kmem.c ]
machparam.h -> machspl.h
[ ./kernel/motorola/m88k/m88100/cmmu.c ]
machparam.h -> machspl.h
[ ./kernel/device/chario.c ]
machparam.h -> machspl.h
[ ./kernel/device/ds_routines.c ]
machparam.h -> machspl.h
[ ./kernel/device/net_io.c ]
machparam.h -> machspl.h
[ ./kernel/kern/mach_clock.c ]
machparam.h -> machspl.h
[ ./kernel/kern/ast.c ]
machparam.h -> machspl.h
[ ./kernel/kern/sched_prim.c ]
machparam.h -> machspl.h
[ ./kernel/kern/machine.c ]
machparam.h -> machspl.h
[ ./kernel/kern/eventcount.c ]
machparam.h -> machspl.h
[ ./kernel/kern/syscall_subr.c ]
machparam.h -> machspl.h
[ ./kernel/kern/startup.c ]
machparam.h -> machspl.h
[ ./kernel/kern/ipc_host.c ]
machparam.h -> machspl.h
[ ./kernel/kern/thread.c ]
machparam.h -> machspl.h
[ ./kernel/kern/ipc_sched.c ]
machparam.h -> machspl.h
[ ./kernel/kern/thread_swap.c ]
machparam.h -> machspl.h
[ ./kernel/kern/xpr.c ]
machparam.h -> machspl.h
[ ./kernel/kern/zalloc.c ]
machparam.h -> machspl.h
[ ./kernel/kern/priority.c ]
machparam.h -> machspl.h
[ ./kernel/mach/mac2/vm_param.h ]
machparam.h -> machspl.h
[ ./kernel/mach/sun4/vm_param.h ]
machparam.h -> machspl.h
[ ./kernel/vax/pmap.c ]
machparam.h -> machspl.h
[ ./kernel/vax/cons.c ]
machparam.h -> machspl.h
[ ./kernel/vax/biconf.c ]
machparam.h -> machspl.h
[ ./kernel/vax/clock.c ]
machparam.h -> machspl.h
[ ./kernel/vax/mscp.c ]
machparam.h -> machspl.h
[ ./kernel/vax/model_dep.c ]
machparam.h -> machspl.h
[ ./kernel/vax/watch_chip.c ]
machparam.h -> machspl.h
[ ./kernel/vax/ka6200.c ]
machparam.h -> machspl.h
[ ./kernel/vaxif/if_de.c ]
machparam.h -> machspl.h
[ ./kernel/vaxif/if_qe.c ]
machparam.h -> machspl.h
[ ./kernel/vaxif/if_ni.c ]
machparam.h -> machspl.h
[ ./kernel/vaxuba/qv.c ]
machparam.h -> machspl.h
[ ./kernel/vaxuba/uba.c ]
machparam.h -> machspl.h
[ ./kernel/vaxuba/qd.c ]
machparam.h -> machspl.h
[ ./kernel/vaxuba/uda_umd.c ]
machparam.h -> machspl.h
[ ./kernel/sun3/db_interface.c ]
machparam.h -> machspl.h
[ ./kernel/sun3/genassym.c ]
machparam.h -> machspl.h
[ ./kernel/sun3/pmap.c ]
machparam.h -> machspl.h
[ ./kernel/sun3/model_dep.c ]
machparam.h -> machspl.h
[ ./kernel/sun3/trap.c ]
machparam.h -> machspl.h
[ ./kernel/sun3/scb.s ]
machparam.h -> machspl.h
[ ./kernel/sun3/locore.s ]
machparam.h -> machspl.h
[ ./kernel/sundev/bwtwo.c ]
machparam.h -> machspl.h
[ ./kernel/sundev/cgfour.c ]
machparam.h -> machspl.h
[ ./kernel/sundev/cgtwo.c ]
machparam.h -> machspl.h
[ ./kernel/sundev/fbutil.c ]
Change for MACH_KERNEL
[89/05/23            rwd]
[ ./kernel/sundev/kbd.c ]
machparam.h -> machspl.h
[ ./kernel/sundev/mb.c ]
machparam.h -> machspl.h
[ ./kernel/sundev/mbvar.h ]
machparam.h -> machspl.h
[ ./kernel/sundev/sc.c ]
machparam.h -> machspl.h
[ ./kernel/sundev/st.c ]
machparam.h -> machspl.h
[ ./kernel/sundev/sd.c ]
machparam.h -> machspl.h
[ ./kernel/sundev/xy.c ]
machparam.h -> machspl.h
[ ./kernel/m88k/pmap.h ]
machparam.h -> machspl.h
[ ./kernel/alpha/DEC/flamingo.c ]
machparam.h -> machspl.h
[ ./kernel/alpha/DEC/scsi_ADU_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/alpha/DEC/adu_se.c ]
machparam.h -> machspl.h
[ ./kernel/alpha/DEC/adu_sl.c ]
machparam.h -> machspl.h
[ ./kernel/alpha/DEC/alpha_box.c ]
machparam.h -> machspl.h
[ ./kernel/alpha/DEC/sgmap.c ]
machparam.h -> machspl.h
[ ./kernel/alpha/alpha_init.c ]
machparam.h -> machspl.h
[ ./kernel/alpha/alpha_misc.c ]
machparam.h -> machspl.h
[ ./kernel/alpha/db_interface.c ]
machparam.h -> machspl.h
[ ./kernel/alpha/pcb.c ]
machparam.h -> machspl.h
[ ./kernel/alpha/pmap.c ]
machparam.h -> machspl.h
[ ./kernel/alpha/trap.c ]
machparam.h -> machspl.h
[ ./kernel/mips/PMAX/maxine.c ]
machparam.h -> machspl.h
[ ./kernel/mips/PMAX/mips_box.c ]
machparam.h -> machspl.h
[ ./kernel/mips/PMAX/kmin.c ]
machparam.h -> machspl.h
[ ./kernel/mips/PMAX/kmin_dma.c ]
machparam.h -> machspl.h
[ ./kernel/mips/PMAX/kn02_dma.c ]
machparam.h -> machspl.h
[ ./kernel/mips/PMAX/model_dep.c ]
machparam.h -> machspl.h
[ ./kernel/mips/PMAX/kn01.c ]
machparam.h -> machspl.h
[ ./kernel/mips/db_interface.c ]
machparam.h -> machspl.h
[ ./kernel/mips/mips_init.c ]
machparam.h -> machspl.h
[ ./kernel/mips/mips_misc.c ]
machparam.h -> machspl.h
[ ./kernel/mips/pcb.c ]
machparam.h -> machspl.h
[ ./kernel/mips/trap.c ]
machparam.h -> machspl.h
[ ./kernel/i386/db_interface.c ]
machparam.h -> machspl.h
[ ./kernel/i386/fpu.c ]
machparam.h -> machspl.h
[ ./kernel/i386/ipl.h ]
machparam.h -> machspl.h
[ ./kernel/i386/pic.c ]
machparam.h -> machspl.h
[ ./kernel/i386/trap.c ]
machparam.h -> machspl.h
[ ./kernel/i386at/com.c ]
machparam.h -> machspl.h
[ ./kernel/i386at/blit.c ]
machparam.h -> machspl.h
[ ./kernel/i386at/kd.c ]
machparam.h -> machspl.h
[ ./kernel/i386at/kd.h ]
machparam.h -> machspl.h
[ ./kernel/i386at/kd_event.c ]
machparam.h -> machspl.h
[ ./kernel/i386at/fd.c ]
machparam.h -> machspl.h
[ ./kernel/i386at/rtc.c ]
machparam.h -> machspl.h
[ ./kernel/i386at/model_dep.c ]
machparam.h -> machspl.h
[ ./kernel/i386ipsc/dcm_input.c ]
machparam.h -> machspl.h
[ ./kernel/norma/ipc_kserver.c ]
machparam.h -> machspl.h
[ ./kernel/norma/ipc_ether.c ]
machparam.h -> machspl.h
[ ./kernel/norma/ipc_input.c ]
machparam.h -> machspl.h
[ ./kernel/norma/ipc_list.c ]
machparam.h -> machspl.h
[ ./kernel/chips/dec_lic/ga_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/chips/dec_lic/gq_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/chips/cfb_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/chips/dz_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/chips/lance_mapped.c ]
machparam.h -> machspl.h
[ ./kernel/chips/lk201.c ]
machparam.h -> machspl.h
[ ./kernel/chips/mc_clock.c ]
machparam.h -> machspl.h
[ ./kernel/chips/mouse.c ]
machparam.h -> machspl.h
[ ./kernel/chips/pm_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/chips/dtop_handlers.c ]
machparam.h -> machspl.h
[ ./kernel/chips/lance.c ]
machparam.h -> machspl.h
[ ./kernel/chips/fdc_82077_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/chips/atm.c ]
machparam.h -> machspl.h
[ ./kernel/chips/fb_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/chips/serial_console.c ]
machparam.h -> machspl.h
[ ./kernel/chips/dtop_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/chips/screen.c ]
machparam.h -> machspl.h
[ ./kernel/chips/xcfb_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/chips/isdn_79c30_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/chips/sfb_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/chips/audio.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/adapters/scsi_5380_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/adapters/scsi_7061_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/adapters/scsi_33C93_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/adapters/scsi_aha15_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/adapters/scsi_53C700_hdw.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/rz_audio.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/mapped_scsi.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/rz.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/rz_disk.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/scsi.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/rz_cpu.c ]
machparam.h -> machspl.h
[ ./kernel/scsi/rz_host.c ]
machparam.h -> machspl.h
[ ./kernel/mac2/act.c ]
machparam.h -> machspl.h
[ ./kernel/mac2/machdep.c ]
machparam.h -> machspl.h
[ ./kernel/mac2/softint.c ]
machparam.h -> machspl.h
[ ./kernel/i386ps2/if_tr.c ]
machparam.h -> machspl.h
[ ./kernel/sbusdev/audio.c ]
machparam.h -> machspl.h
[ ./kernel/sbusdev/bwtwo.c ]
machparam.h -> machspl.h
[ ./kernel/sbusdev/cgsix.c ]
machparam.h -> machspl.h
[ ./kernel/sbusdev/dmaga.c ]
machparam.h -> machspl.h
[ ./kernel/sun4/scsi/adapters/esp.c ]
machparam.h -> machspl.h
[ ./kernel/sun4/scsi/targets/sd.c ]
machparam.h -> machspl.h
[ ./kernel/sun4/scsi/scsi.h ]
machparam.h -> machspl.h
[ ./kernel/sun4/db_interface.c ]
machparam.h -> machspl.h
[ ./kernel/sun4/copy.s ]
machparam.h -> machspl.h
[ ./kernel/sun4/locore.s ]
machparam.h -> machspl.h
[ ./kernel/sun4/map.s ]
machparam.h -> machspl.h
[ ./kernel/sun4/overflow.s ]
machparam.h -> machspl.h
[ ./kernel/sun4/pmap.c ]
machparam.h -> machspl.h
[ ./kernel/sun4/underflow.s ]
machparam.h -> machspl.h
[ ./kernel/norma/ipc_net.h ]
machparam.h -> machspl.h
[ ./kernel/alpha/DEC/flamingo_dma.c ]
machparam.h machspl.h
[ ./kernel/alpha/machparam.h ]
renamed to machspl.h
[ ./kernel/i386/machparam.h ]
renamed to machspl.h
[ ./kernel/m88k/machparam.h ]
Renamed to machsp.h
[ ./kernel/m88k/machspl.h ]
Used to be machparam.h
[93/05/15            mrt]
[ ./kernel/i386/machspl.h ]
Used to be machparam.h
[93/05/15            mrt]
[ ./kernel/alpha/machspl.h ]
Used to be machparam.h
[93/05/15            mrt]
[ ./kernel/sun4/machparam.h ]
Renamed to machspl.h
[ ./kernel/sun4/machspl.h ]
Used to be machparam.h
[93/05/15            mrt]
[ ./kernel/sun3/machspl.h ]
Used to be machparam.h
[93/05/15            mrt]
[ ./kernel/sun3/machparam.h ]
renamed to machspl.h
[ ./kernel/vax/machparam.h ]
renamed to machspl.h
[ ./kernel/vax/machspl.h ]
Used to be machparam.h
[93/05/15            mrt]
[ ./kernel/mips/machspl.h ]
Used to be machspl.h
[93/05/15            mrt]
[ ./kernel/mips/machparam.h ]
renamed to machspl.h
[ ./kernel/Makefile ]
Eliminate the include SUBDIR.
[93/05/14            mrt]
[ ./kernel/include/mach/i386/Makefile ]
no longer  needed
[ ./kernel/include/mach/i860/Makefile ]
no longer  needed
[ ./kernel/include/mach/sun3/Makefile ]
no longer  needed
[ ./kernel/include/mach/mips/Makefile ]
no longer  needed
[ ./kernel/include/mach/vax/Makefile ]
no longer  needed
[ ./kernel/include/mach/alpha/Makefile ]
no longer  needed
[ ./kernel/include/mach/m88k/Makefile ]
no longer  needed
[ ./kernel/include/mach/Makefile ]
no longer  needed
[ ./kernel/include/mach/sun4/Makefile ]
no longer  needed
[ ./kernel/include/mips/Makefile ]
no longer  needed
[ ./kernel/include/vax/Makefile ]
no longer  needed
[ ./kernel/include/i386/Makefile ]
no longer  needed
[ ./kernel/include/Makefile ]
no longer  needed
[ ./kernel/include/i860/Makefile ]
no longer  needed
[ ./kernel/include/sun3/Makefile ]
no longer  needed
[ ./kernel/include/alpha/Makefile ]
no longer  needed
[ ./kernel/include/sun4/Makefile ]
no longer  needed
[ ./kernel/include/m88k/Makefile ]
no longer  needed
[ ./Directories/ALL ]
Removed kernel/include directories.
[93/05/16            mrt]
[ ./Directories/MI ]
Removed kernel/include directories.
[93/05/16            mrt]
[ ./Directories/alpha ]
Removed kernel/include directories.
[93/05/16            mrt]
[ ./Directories/i386 ]
Removed kernel/include directories.
[93/05/16            mrt]
[ ./Directories/luna88k ]
Removed kernel/include directories.
[93/05/16            mrt]
[ ./Directories/mips ]
Removed kernel/include directories.
[93/05/16            mrt]
[ ./Directories/sqt ]
Removed kernel/include directories
[93/05/16            mrt]
[ ./Directories/sun3 ]
Removed kernel/include directories.
[93/05/16            mrt]
[ ./Directories/sun4 ]
Removed kernel/include directories.
[93/05/16            mrt]
[ ./Directories/vax ]
Removed kernel/include directories
[93/05/16            mrt]
[ ./include/m88k/Makefile ]
Added KINCLUDES which are the include files the kernel
gets out of machine/. These files are only exported and
not released. The only UINCLUDES which are the files that 
user level programs need are released.
[93/05/14            mrt]
[ ./include/i386/Makefile ]
Added KINCLUDES which are the include files the kernel
gets out of machine/. These files are only exported and
not released. The only UINCLUDES which are the files that 
user level programs need are released.
[93/05/14            mrt]
[ ./include/alpha/Makefile ]
Added KINCLUDES which are the include files the kernel
gets out of machine/. These files are only exported and
not released. The only UINCLUDES which are the files that 
user level programs need are released.
[93/05/14            mrt]
[ ./include/vax/Makefile ]
Added KINCLUDES which are the .h files that the kernel
needs to find in the machine directory. They go into
to export/include area. Only the INCLUDES, which the
user programs need to see go into the release area.
[93/05/14            mrt]
[ ./include/mips/Makefile ]
Added KINCLUDES which are the include files the kernel
gets out of machine/. These files are only exported and
not released. The only UINCLUDES which are the files that 
user level programs need are released.
[93/05/14            mrt]
[ ./include/sun3/Makefile ]
Added KINCLUDES which are the .h files that the kernel
needs to find in the machine directory. They go into
to export/include area. Only the INCLUDES, which the
user programs need to see go into the release area.
[93/05/14            mrt]
[ ./include/sun4/Makefile ]
Added KINCLUDES which are the .h files that the kernel
needs to find in the machine directory. They go into
to export/include area. Only the INCLUDES, which the
user programs need to see go into the release area.
[93/05/14            mrt]
[ ./kernel/conf/version.minor ]
No longer used.

[ ./kernel/conf/version.major ]
Changed to something useful
[ ./kernel/conf/newvers.sh ]
Removed use of version.minor and use version.major
[93/05/16            mrt]
[ ./kernel/conf/i386/files.bnr ]
Added TTD teledebug i386 optional files.
[93/05/17            rvb]
[ ./kernel/sun/conf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/luna88k/machdep.h ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/luna88k/conf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/vax/conf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/vax/autoconf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/vax/ka3100.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/vaxif/if_qe.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/vaxuba/qd.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/vaxuba/uba.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/vaxuba/uda_umd.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/sunif/if_le.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/sundev/cgtwo.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/sundev/mb.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/sundev/sd.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/mips/db_trace.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/mips/mips_init.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/i386at/conf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/ddb/db_break.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/ddb/db_examine.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/chips/dec_lic/ga_hdw.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/chips/dec_lic/gq_hdw.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/chips/busses.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/chips/cfb_misc.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/chips/frc.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/chips/isdn_79c30_hdw.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/chips/mc_clock.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/scsi/adapters/scsi_5380_hdw.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/luna88kdev/cons.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/sun4/db_trace.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./user/threads/mips/thread.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[ ./kernel/device/cirbuf.c ]
Fixed nasty bug in getc(): it was returning -1 when
the character was 0xff. This makes SLIP work on DS boxes.
[93/05/13  20:28:59  af]
[ ./kernel/device/dev_name.c ]
We need a nomap() of type vm_offset_t
[ ./kernel/i386at/conf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/17            rvb]
[ ./kernel/chips/mc_clock.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/17            rvb]
[ ./kernel/chips/dec_lic/ga_hdw.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/17            rvb]
[ ./kernel/scsi/adapters/scsi_5380_hdw.c ]
machparam.h -> machspl.h
[93/05/17            rvb]
[ ./kernel/vax/autoconf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/17            rvb]
[ ./kernel/vax/mscpvar.h ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/17            rvb]
[ ./kernel/device/conf.h ]
Since map's return vm_offset_t's, we need a "nomap()" that does
so also, to keep the type system happy.
[93/05/17            rvb]
[ ./kernel/sun/conf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/17            rvb]
[ ./kernel/vax/conf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/17            rvb]
[ ./kernel/sqtconf/conf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/17            rvb]
[ ./kernel/mips/conf.c ]
Use nomap where required vs nodev or "0"
[93/05/17            rvb]
[ ./kernel/luna88k/conf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/17            rvb]
[ ./kernel/alpha/conf.c ]
Use nomap to indicate no map entry -- it has the right type.
[93/05/17            rvb]
[ ./kernel/chips/dec_lic/gq_hdw.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/17            rvb]
[ ./kernel/chips/scc_8530_hdw.c ]
include machparam.h -> machspl.h
[ ./kernel/conf/template.mk.bnr ]
Flush version.minor
[ ./kernel/i386/db_trace.c ]
machparam.h -> machspl.h
Cleanup's to make gcc generate less warnings.
[ ./kernel/scsi/adapters/scsi_89352_hdw.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/17            rvb]
[ ./Makefile ]
Removed kernel from list of EXPINC_SUBDIRS
[93/05/14            mrt]
[ ./kernel/conf/template.mk ]
Removed EXPORTBASE/kernel from list of INDIRS. We now
put all those files in the regular export dir.
Removed use of version.minor
[93/05/14            mrt]
[ ./user/libmach/alpha/crt0.s ]
Changed comments from # to /* so cpp would be happy.
[93/05/17            mrt]
[ ./kernel/alpha/boot/start.s ]
Initialize stack pointer. New firmware starts with sp set to 0.
Fix from Michael Uhlenberg of PCS.
[93/05/17            mrt]
[ ./kernel/alpha/boot/start.s ]
Must set sp again, let it start below text so that 
endless recursion (trap inside trap) does not clobbber
data.
Fix from Michael Uhlenberg of PCS.
[93/05/17            mrt]
[ ./kernel/alpha/start.s ]
Initialize stack pointer. Used if starting from console
with start command. New firmware starts with sp set to 0.
Fix from Michael Uhlenberg.
[93/05/17            mrt]
[ ./kernel/device/dev_pager.c ]
A device that can not be mapped has its mapping function == nomap, for
type sanity reasons
[ ./kernel/device/chario.c ]
Flush some debugging for AF
[ ./kernel/vax/mscp.c ]
Lint
[ ./kernel/chips/isdn_79c30_hdw.c ]
Sadly, the .h files says that audio_attach takes a (audio_switch_t *),
not a (const audio_switch_t *).  So you can not make the isdn_ops table
a const.
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/18            rvb]
[ ./kernel/sqtconf/conf.c ]
Revision 2.8  93/05/17  16:33:27  rvb
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/18            rvb]
[ ./kernel/i386ps2/conf.c ]
Lint: <>map is now a vm_offset_t
[ ./kernel/sqtsec/sd.c ]
Lint
[ ./kernel/sqt/setconf.c ]
Lint
[ ./kernel/conf/i386/files.bnr ]
mrt changed machparam.h -> machspl.h
[ ./kernel/vax/conf.c ]
Type casts, etc to quiet gcc 2.3.3 warnings
[93/05/18            rvb]
[ ./kernel/sun4/sun_init.c ]
Calc_memsize on avail_memlist to get memorysize.  This prevents
telling the vm system about more memory than it will be allowed
to use after rom steals some, e.g. ELC steals 111 pages.
Removed some dead code.
[93/05/19            berman]
[ ./kernel/conf/MASTER ]
ttd->lineno; it needs linenumbers for debugging
[ ./kernel/chips/serial_console.c ]
We were dropping HUPCLS.  And since 0==DM_HUP we were not
taking modem bits right.
[93/05/16  23:19:29  af]
[ ./kernel/chips/scc_8530_hdw.c ]
Added first (working) cut at true modem support, but I have
a bad cable and needs finessing.
Also, 3max+ support, from John Wroclawski (jtw@lcs.mit.edu).
[93/05/08            af]
Fixed types.
[93/05/06  10:01:41  af]

Fixed types.
[93/05/06  10:01:41  af]
[ ./kernel/mach/alpha/asm.h ]
Changed uses of the zero register to ra in calls to .frame.
[93/05/18            mrt]
[ ./kernel/alpha/start.s ]
Changed use of zero to ra in call to NESTED.
[93/05/18            mrt]
[ ./kernel/alpha/alpha_copyin.s ]
Changed use of zero to ra in call to NESTED.
[93/05/18            mrt]
[ ./kernel/alpha/prom_interface.s ]
Changed use of zero to ra in call to NESTED.
[93/05/18            mrt]
[ ./kernel/alpha/boot/start.s ]
Changed use of zero to ra in call to NESTED.
[93/05/18            mrt]
[ ./kernel/alpha/boot/prom_routines.s ]
Changed use of zero to ra in call to NESTED.
[93/05/18            mrt]
[ ./kernel/conf/mips/template.mk ]
Changed AS_FLAGS_NORMAL to PMAX_ASFLAGS so the value
would get used.
[93/05/20            mrt]
[ ./kernel/conf/i386/MASTER ]
Changed all comments to start with "# ". The BNR version
of doconf needs to be able to recognize real comments from
the pseudo ones it generates.
[93/05/19            mrt]
[ ./kernel/conf/alpha/template.mk ]
	Removed use of LINENO. It is used in machine independent
	template.mk.
	Made all the compiler options set dynamically.
[93/05/14            mrt]
[ ./kernel/conf/alpha/files ]
Made additional flags to vm_fault be conditional
on NOT_USING_GCC2
[93/05/20            mrt]
[ ./kernel/conf/m88k/MASTER ]
Need to have lineno on or mk does not boot!
[93/05/24            rvb]
[ ./kernel/sun3/model_dep.c ]
-h as a boot flag seems to freak out the rom.  So ...
-d now is used to enter the debugger before configure.
[ ./kernel/sundev/kbd.c ]
tsc which is fed as an in/out arg to tty_get_status (from kdbopen)
must be initialized or bad thing could happen and finally have.
[ ./kernel/chips/screen.c ]
Initialize screen_console because used before the bss is.
[93/05/21            af]
[ ./kernel/conf/template.mk ]
Change relink rule to build mach.boot as well as linking the
kernel.
[93/05/28            mrt]
[ ./kernel/i386ps2/hd.c ]
In the getstat and setstat routines, return failure
if the flavor isn't one we know about.
[93/05/28  15:07:28  chs]
[ ./kernel/i386ps2/if_tr.c ]
In tropen(), wait until the adapter is actually running before
returning.
[93/05/28  15:12:30  chs]
[ ./kernel/alpha/db_alpha_aout.c ]
Reflect change in VECTOR macro for fr->isvector.
[93/05/21            af]
[ ./kernel/alpha/db_alpha_sym.c ]
Reflect change in VECTOR macro.
[93/05/21            af]
[ ./kernel/chips/dz_hdw.c ]
Added modem CTS/RTS flow control protocol.
[93/05/29  09:43:38  af]
[ ./kernel/chips/lance.c ]
Sanity check in copy_to_lance was screwed by type promotions.
[93/05/28            af]
[ ./kernel/chips/scc_8530_hdw.c ]
Handle CTS transitions, for modem CTS/RTS flow control.
[93/05/29  09:45:48  af]
[ ./kernel/chips/serial_console.c ]
Some modem code was moved up in chario.c.
Added cons_mctl.
[93/05/29  09:48:06  af]
[ ./kernel/conf/mips/MASTER ]
Added kn03.
[93/05/08            af]
[ ./kernel/conf/mips/files ]
Added kn03 (DS5000/240), revisited conditionals a little.
[Someone should build a non-generic kernel and let me know.]
[ ./kernel/device/chario.c ]
Added calls for modem control operations. Pdma code on by default.
Added ttyinput_many and tty_cts. Lint.
[93/05/29  09:50:55  af]
[ ./kernel/device/tty.h ]
Added t_mctl for modem control operations and TS_RTS_DOWN.
[93/05/29  10:07:25  af]
[ ./kernel/i386at/com.c ]
Changed to use MI modem code, adding commctl.
Does CTS/RTS flow control now.
[93/05/29  09:52:46  af]
[ ./kernel/mips/PMAX/kmin.c ]
asic_init() interface changed.
[93/05/29  09:54:25  af]
[ ./kernel/mips/PMAX/kmin_dma.c ]
Added kn03 (3max+) support, from John.Wroclawski@lcs.mit.edu
[93/05/09            af]
[ ./kernel/mips/PMAX/kn02ba.c ]
Took pity of a friend and fixed copyout not to overcopy.
[93/05/28            af]
[ ./kernel/mips/PMAX/kn03.c ]
RCS-ed.
[93/05/29            af]
[ ./kernel/mips/PMAX/kn03.h ]
RCS-ed.
[93/05/29            af]
[ ./kernel/mips/PMAX/kn03_cpu.h ]
RCS-ed.
[93/05/29            af]
[ ./kernel/mips/PMAX/kn03_cpu.s ]
RCS-ed.
[93/05/29            af]
[ ./kernel/mips/PMAX/maxine.c ]
Mods for asic_init's interface change.
[93/05/29  09:55:38  af]
[ ./kernel/mips/PMAX/model_dep.c ]
Added support for 5000/240, from John Wroclawski (jtw@lcs.mit.edu).
[93/05/29  09:56:54  af]
[ ./kernel/mips/autoconf.c ]
Added 5000/240.
[93/05/29  09:53:24  af]
[ ./kernel/mips/mips_box.h ]
Added kn03 aka 3max+ aka DS5000/240.
[93/05/08            af]
[ ./kernel/mips/mips_mem_ops.c ]
Adedd memcpy for when not optimizing.
Fix from jtw@lcs.mit.edu.
[93/05/08            af]
[ ./kernel/src/doconf/Makefile ]
Added conditonal rule so the bnr environment would get
its own version of the script.
[93/05/31            mrt]
[ ./kernel/src/doconf/doconf.sh.bnr ]
Fixed to work with BNR2 version of sed.
[93/05/19            mrt]
[ ./kernel/sun4/kgdb_stub.c ]
Added support to recognize version 0 Openprom interface and
deal with it as best we can using PUTC and READ.
[93/05/28            berman]
Commented out use of kgdb_trace pcb field.  Prepare to remove it.
[93/05/20            berman]
[ ./kernel/sun4/locore.s ]
Minor change in clock interrupt code to use btst instead of
andcc.  Shortened pre-ast return to user code.
[93/05/19            berman]

Change sup_return to load nwindows into %g5 up front, and 
use %g5 in computing new %wim.  Remove unnecessary nops.
[93/05/18            berman]

Defined WINDOW_TRAP to more efficiently capture wim state
and made window overflow/underflow scb entries use WINDOW_TRAP.
Changed load of _nwindows to use sethi and %lo().
Changed mov -0x1 to set -0x1 to ensure correct assembly.
Made SYSCALL_TRACE code compare result to -1 instead of -2.
[93/05/17            berman]

Fixed clean_windows trap to use legal registers and to use
active_threads explicitly.  This code is not being used (yet),
but was broken.
[93/04/08            dlc]
[ ./kernel/sun4/model_dep.c ]
Carefully disable cache if use_cache is off.  This makes the
hardware consistent with the software cache status..
[93/05/20            berman]
[ ./kernel/sun4/overflow.s ]
Corrected non-debug case of wo_stack_not_res where calling
_trap requires that %o2 has the fault addr.  We were overwriting
that.
[93/05/20            berman]
Conditionalized debugging code under DEBUG.  Removed %wim 
reading code since it is now handled inside the trap vector.
[93/05/20            berman]

Removed store of current wim in pcb when about to page fault on a
stack (the correct wim had already been stored earlier).  Use
correct register containing the pcb pointer when retrieving the
fault address stored in the PCB_FLAG field.
[93/04/08            dlc]
[ ./kernel/sun4/pcb.c ]
Leave at splhigh() in switch_context().  Set the old kernel stack
to be the active stack, before changing the latter.
[93/04/08            dlc]
[ ./kernel/sun4/pmap.c ]
Made changes to pmap_next_page() to guard against
the pmap_valid_page() loop running off the end of physical
memory.  This only happens when the ROM steals pages out of the
end of physical space.
[93/05/20            berman]

Reverted pmeg wired bitmask to array.  This is necessary
since on sun4c there are 64 pmes/pmeg.  This needs two words to
represent each page in a separate bit.
[93/04/09            berman]
[ ./kernel/sun4/setroot.c ]
Changed sun4c conditionals around to make setroot work for 
older romvec versions.
[93/05/21            berman]
[ ./kernel/sun4/trap.c ]
Cleaned some dead code.  Clear pcb fault variables in
user_pagefault_continue().
[93/05/20            berman]
[ ./kernel/sun4/underflow.s ]
Conditionalized test code under DEBUG.
[93/05/20            berman]

Removed first instruction which saved %wim.  It is now saved in 
the trap vector that gets us here.
[93/05/17            berman]
[ ./kernel/sun4/setroot.c ]
This defines SAIO_COMPAT which causes a warning when it
is again defined, but at least it compiles.
[93/06/01            rvb]

Changed sun4c conditionals around to make setroot work for 
older romvec versions.  Define SAIO_COMPAT for older roms.
[93/05/21            berman]
    
    
    
==========================================================================
   ***** MK Version MK82  (rvb) *****
    
    
Fix for i386 Adaptec 1542C controller.

Fix a few problem in the release process of stripping .o's and emulators.


****************** NOTE ****************** NOTE ****************** 

The previous "diff latest vs merge" showed a few non checked in files in
ux amd mk.  So I checked them in and now have rebuilt all ux's and of
course I needed to rebuilt all kernels to get them to MK82.

Sigh, Sigh, Sigh, Sigh, Sigh, Sigh, Sigh, Sigh, Sigh, Sigh, Sigh, 
Sigh, Sigh, Sigh, Sigh, Sigh, Sigh, Sigh, Sigh, Sigh, Sigh, 

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
82
[ ./kernel/scsi/adapters/scsi_aha15_hdw.c ]
"Temporary" changes from af: Don't let host adapter probe
self.
[ ./kernel/conf/template.mk ]
Added definition of NOSTRIP.
[93/06/02            mrt]
[ ./user/libmach/Makefile ]
Added NOSTRIP definition.
[93/06/02            mrt]
[ ./user/threads/Makefile ]
Added definition of NOSTRIP.
[93/06/02            mrt]
    
    
    
==========================================================================
   ***** MK Version MK83  (mrt) *****
    
    
New features:
--- --------
Added support for PC sampling for profiling.

Added a driver for the ATM - This has only been tested on a DecStation

Added support for the network as a library (i.e. in user space) code.

[PMAX]	Added suppport for 5000/240

[I386]	Added support for NetBSD style labels.


Bug fixes:
--- -----

Yes, see the list of files.

[I386]	Fixed i386ps2/mouse driver

Organizational changes:
-------------- -------

Defined a STD+OTHER configuration for the pmax to build a kernel without any
of the DEC licensed pieces.

The STD+WS+net_atm configuration must be used to enable the ATM and the
support for user level network code. The user level network code will
be available as a library in the next release of UX.

Special notes:
------- -----

This release has been done for pmax, i386, luna88k and alpha platforms.
There will be no more releases for the sun3 and vax.

******** CUT HERE ******** summary of log messages ******** CUT HERE ********
[ ./conf/version.edit ]
83
[ ./kernel/conf/mips/MASTER ]
Put the gx drivers under dec_lic option so that it is
easier for those that do not have the code to build
without them.  CONFIG=STD+OTHER builds without needing any
Ultrix licensed code.
[93/06/29            mrt]
[ ./kernel/conf/template.mk ]
Added rule for mach_norma_user.c and mach_norma.h
[93/06/28            mrt]
[ ./kernel/i386at/fd.c ]
Put the free copyright on this file, again.
[93/07/22            mrt]
[ ./kernel/i386at/fdreg.h ]
Put the free copyright on this file, again.
[93/07/22            mrt]
[ ./kernel/i386ps2/kd_mouse.c ]
Rewrite mouse driver to work correctly.
[93/07/12            zon]
[ ./kernel/src/mig/Makefile ]
Added porting to INCFLAGS on systems who have no stdlib.h
[93/06/22            mrt]

Made the compilation of vprint depend on NO_VPRINT. If
your system provides a local one, use it.
[93/06/08            mrt]
[ ./kernel/src/mig/error.h ]
Added definitions of sys_nerr and sys_errlist since they
are missing from errno.h on some older systems.
Changed sys/errno.h to conform to ANSI errno.h.
[93/06/23            mrt]
[ ./kernel/src/mig/include/Makefile ]
Added strings.h.
[93/08/02            mrt]
[ ./kernel/src/mig/lexxer.l ]
Removed stringize macro which was broken under ANSI C.
[93/07/28            pds]
[ ./kernel/src/mig/porting/stdlib.h ]
Created for systems who do have have a stdlib.h of
their own that defines malloc.
[93/08/02  15:33:25  mrt]
[ ./user/libmach/i386/fork.s ]
"SYS.h" -> <i386/SYS.h> to work when fork.s is copied to
fork.S
[93/06/10            mrt]
[ ./user/libmach/mips/mem.c ]
Removed include of string.h as it was not needed and
caused problems under Ultrix.
[93/07/07            mrt]
[ ./user/threads/Makefile ]
Added LIB_LONG_NAMES for the mips and i386 since one of
the .o names in the libthreads_p.a is too long.
[93/06/13            mrt]
[ ./user/threads/i386/csw.s ]
Fixed comment in cproc_switch.
Bug reported by Ian_Service of stratus.com
[93/06/23            mrt]
[ ./bootstrap/default_pager.c ]
Replace the unconditional unlocks in pager_alloc_page
that were wronly made conditional in rev 2.16. Fix by Ian Dall.
[93/08/02            mrt]
[ ./kernel/chips/sfb_hdw.c ]
Remember probe address, else early interrupts will kill us.
[93/07/29  23:52:12  af]

Fixed types.
[93/05/06  10:01:16  af]
[ ./kernel/device/chario.c ]
Removed the check for sucess on putc in ttyinput. 
We want to wakeup everyone on the delayed queue, regardless
of how the putc turned out.
Fix by bsy and af.
[93/08/03            mrt]
[ ./kernel/kern/mach_clock.c ]
[93/08/02  16:51:35  bershad]

Flavor support for sampling.
[93/07/30  10:21:52  bershad]
[ ./kernel/kern/pc_sample.c ]
[93/08/02  16:50:13  bershad]

Flavor support for PC sampling.
[93/07/30  10:23:02  bershad]
[ ./kernel/kern/task.c ]
[93/07/30  10:30:30  bershad]

Change way in which kernel tasks share the same kernel map to avoid
fault on current thread reference during bootstrap.
[93/07/30  10:24:25  bershad]
[ ./kernel/mach/mach4.defs ]
Addded flavor argument to sampling interface.
[93/07/30  10:25:45  bershad]
[ ./kernel/mach/pc_sample.h ]
Defined some flavors for sampling.
[93/07/30  10:26:03  bershad]
[ ./kernel/mips/PMAX/kmin_dma.c ]
If we have to panic in init, use dprintf.
[93/07/29  23:29:47  af]
[ ./kernel/mips/PMAX/kn03.c ]
Fixed clock interrupt handling.
[93/07/29  23:28:58  af]
[ ./kernel/mips/PMAX/kn03_cpu.h ]
Fixed interrupt handling.
[93/07/29  23:28:03  af]
[ ./kernel/mips/PMAX/kn03_cpu.s ]
Fixed interrupt handling.
[93/07/29  23:28:27  af]
[ ./kernel/scsi/adapters/scsi_7061_hdw.c ]
[Long time, no see.]  Made sii_wait() more lenient.
Handle restore-data-pointer messages.
Handle more bogus behaviours in synch negotiation.
[93/07/29  23:50:49  af]

Fixed types.
[93/05/06  10:17:50  af]
[ ./kernel/scsi/rz.h ]
Added rzlun().
[93/07/29  23:40:26  af]
[ ./kernel/scsi/rz_audio.c ]
Return the device back to the default data-mode at close.
Otherwise things get messy when we change CDs.
MOved zero_ior() elsewhere.
[93/07/29  23:33:56  af]

Added Toshiba drives.
[93/04/13  22:48:05  af]
[ ./kernel/scsi/rz_disk.c ]
No default spl protection for start routine.
[93/07/29  23:31:54  af]

Removed depends on DEV_BSIZE.
Do not assume read_capacity will work (violations of standard..)
Try to set the logical block size to the default U*X wants,
but take whatever the drive wants if not.  For CDROMs.
Write back the label where we found it.
[93/05/06  10:13:33  af]
[ ./kernel/scsi/scsi.c ]
Moved zero_ior() here.
[93/07/29  23:37:16  af]

Make CDROMs readonly.
[93/05/06  10:07:01  af]
[ ./kernel/scsi/scsi.h ]
Added comm device commands.
[93/07/29  23:38:50  af]
[ ./kernel/scsi/scsi_comm.c ]
Added implementations for get/send_message.
[93/07/29  23:41:27  af]
[ ./kernel/scsi/scsi_defs.h ]
Added hooks for multi-LUN devices.
Addeddefs for COMM devices.
[93/07/29  23:39:53  af]

Added rewriting of label where we found it.
[93/05/06  10:05:31  af]
[ ./kernel/src/config/mkmakefile.c ]
Fixed Makefile generation to define PROFILING= before it gets used.
[93/07/30  10:26:34  bershad]
[ ./kernel/src/makeboot/sun4/exec.c ]
Added toolversion machine type and dynamic fields to a.out header
so that boot roms will chew the kernel image nicely.
[93/06/10            berman]
[ ./kernel/sun4/context.s ]
Removed PSR save/restore and manipulation in Switch_Context().
We now assume to be called with interrupts disabled.
[93/06/03            dlc]
[ ./kernel/sun4/trap.c ]
Removed debugger break when exception() is called.
[93/05/25            berman]
[ ./kernel/vm/vm_fault.c ]
[93/08/02  16:55:49  bershad]

Added vm sample support.
[93/07/30  10:27:00  bershad]
[ ./user/libmach/Makefile ]
[93/08/02  16:56:26  bershad]

[93/07/30  10:27:47  bershad]
[ ./user/libmach/i386/crt0.c ]
Unified all the *crt into one that is conditional at runtime, not compile
time.  
[93/07/30  10:29:06  bershad]
[ ./user/libmach/m88k/crt0.c ]
Added startup routine for gprof entry.
[93/08/02  16:57:32  bershad]
[ ./user/libmach/mips/crt0.s ]
Unified profiling and non-profiling crt0 into one file.
[93/07/30  10:29:38  bershad]
[ ./user/libmach/mips/bcopy.c ]
Replaced by bcopy.s

[ ./kernel/i386at/grab_bob_label.c ]
Moved to scsi/pc_label.c
[ ./kernel/chips/scc_8530_hdw.c ]
 Quick workaround for bad cabling on Flamingo. Tzk tzk...
[93/08/05            af]
[ ./kernel/chips/atm.c ]
Replaced with tca100* driver
[ ./include/i386/Makefile ]
Pass pio.h to release.
[93/07/09            rvb]
[ ./include/device/Makefile ]
Export bpf.h for BPF clients.
[93/06/11            cmaeda]
Need disk_status.h for label processing code.
[93/07/09            rvb]
[ ./include/chips/Makefile ]
Exported atm-related header files.
[93/07/04            cmaeda]
[ ./kernel/device/chario.c ]
Added test to check that buffer is large enough to hold data
returned by tty_get_status. Fix by Tero Kivinen (kivinen) at
Helsinki University of Technology. This code was added in
Rev 2.20 and flushed by misktake in Rev 24.
[93/08/09            mrt]
[ ./kernel/device/device_types.h ]
Added io_buf_vec_t for scatter/gather IO.
Looks like a struct iovec from BSD.
[93/04/14            cmaeda]
[ ./kernel/device/ds_routines.c ]
Added support for device write kernel traps.
[93/06/11            cmaeda]
[ ./kernel/device/net_io.c ]
Incorporated BPF+MATCH support from Masanobu Yuhara:
	Changed: garbage collection of dead filters for BPF.
	Added: BPF_MATCH_IMM support.
	Added: BPF support. Derived from tcpdump-2.2.1/bpf/net/bpf.h.
	[93/04/14  16:51:13  yuhara]
[ ./kernel/device/net_status.h ]
Bumped up max size of filter programs since bpf programs are big.
[93/07/06            cmaeda]

Added BPF support.
[93/02/08            yuhara]
[ ./kernel/device/device_types.defs ]
Doubled size of filter_array_t.
[93/07/06            cmaeda]
[ ./kernel/device/bpf.h ]
93/02/08 11:28  Masanobu Yuhara at Fujitsu Labs.
Added BPF support.  Derived from tcpdump-2.2.1/bpf/net/bpf.h.
Add: New BPF instructions and macros:
     BPF_MATCH_IMM, BPF_CKMATCH_IMM, BPF_MATCH_DATA, BPF_REG_DATA,
     BPF_POSTPONE, NETF_BPF, BPF_BEGIN, BPF_INSN_STMT, BPF_INSN_JUMP.
Add: BPF_DLBASE for accessing a data link level header.
Changed: BPF_RVAL mask value (0x18 -> 0x38)
[93/02/08  11:28:23  yuhara]
[ ./kernel/kern/eventcount.c ]
Added evc_wait_clear.  Always clears count before blocking.
[93/03/22            cmaeda]
[ ./kernel/kern/syscall_sw.c ]
Put atm traps under NET_ATM conditional.
[93/08/02            cmaeda]
Moved syscall_device_writev_request to 39 since it
was conflicting with init_process at 41.  Added
comments to trap numbers that are unixoid traps
handled by emulator.
[93/07/19            cmaeda]

Added device_write traps.
[93/07/03            cmaeda]

Added evc_wait_clear.  Very similar to evc_wait.
[93/07/03            cmaeda]

Included traps for network interface.
[93/06/09  15:42:13  jcb]
[ ./kernel/kern/ipc_mig.c ]
Fixed the case where device write traps are called with reply ports.
[93/07/29            cmaeda]

Device traps and scatter/gather IO (actually just gather IO) --
Added port_name_to_device, syscall_device_write_request,
and syscall_device_writev_request.
(Original version of this code from rfr, many moons ago.)
[93/04/14            cmaeda]
[ ./kernel/kern/thread.c ]
Conditionalized atm hooks.
[93/07/30            cmaeda]
Included hooks for network interface.
[93/06/09  15:44:22  jcb]
[ ./kernel/kern/thread.h ]
Conditionalized atm hooks.
[93/07/30            cmaeda]
Included hook for network interface.
[93/06/09  15:45:03  jcb]
[ ./kernel/kern/eventcount.h ]
Changed ev_id to natural_t to match the changes in
eventcount.c
[93/08/03            mrt]
[ ./kernel/kern/task.c ]
Conditionalized atm hooks.
[93/07/30            cmaeda]
Included network interface hooks.
[93/06/09  15:43:04  jcb]
[ ./kernel/kern/task.h ]
Conditionalized atm hooks.
[93/07/30            cmaeda]
Included hooks for network interface.
[93/06/09  15:43:43  jcb]
[ ./kernel/mach/syscall_sw.h ]
Moved device_write traps to avoid conflict with atm traps.
[93/07/03            cmaeda]

Included traps for network interface.
[93/06/09  15:45:40  jcb]
Added device traps.
[93/04/14            cmaeda]

Added evc_wait_clear.
[93/04/14            cmaeda]
[ ./kernel/vm/vm_kern.c ]
Included support for projected buffers: projected_buffer_allocate,
projected_buffer_map, projected_buffer_deallocate, projected_buffer_collect
and projected_buffer_in_range. Projected buffers are buffers shared
between the kernel and user tasks, and which may be persistent or not
(be deallocated from the kernel map automatically when the last user
reference is deallocated). The intended use is for device drivers.
The user is denied direct manipulation of these map entries.
[93/02/16  09:28:21  jcb]
[ ./kernel/vm/vm_kern.h ]
Included support for projected buffers.
[93/02/16  09:30:12  jcb]
[ ./kernel/vm/vm_map.c ]
Included support for projected buffers. The projected_on field of new
vm map entries is defaulted to null. projected_buffer_collect is called
from vm_map_deallocate to garbage collect projected buffers when a task
terminates. Projected buffer entries are cloned exactly on map inheritance.
The user is denied direct deallocation of non-persistent projected buffers
(these need to be deallocated by projected_buffer_deallocate, presumably
by the device driver that created it).
[93/02/16  09:37:28  jcb]
[ ./kernel/vm/vm_map.h ]
Included the projected_on field in VM map entries, to support 
projected buffers.
[93/02/16  09:46:01  jcb]
[ ./kernel/vm/vm_user.c ]
Included calls to projected_buffer_in_range to deny user direct 
manipulation of protection, inheritance, machine attributes or 
wiring of projected buffers. These can be altered only by other code inside
the kernel, presumably the device driver that created the projected buffer.
[93/02/16  09:48:40  jcb]
[ ./kernel/src/mig/Makefile.bnr ]
/usr/include/machine/types.h defines vm_offset_t and vm_size_t
this causes us conflicts.  So substitute in our own types.h:
 	ln -s ../mach/machine/vm_types.h machine/types.h
[93/08/05  10:39:48  rvb]
[ ./kernel/alpha/autoconf.c ]
The answer to the puzzle below came in, and it reads:
"..all the systems implemented the fields backwards, so that
MAJOR and MINOR were switched.  The SRM was changed to match.."
[93/08/06            af]

An FRU on my Flamingo brought by new codes for the processor
type.
[93/08/05            af]
[ ./kernel/alpha/prom_interface.h ]
"..all the systems implemented the fields backwards, so that
" MAJOR and MINOR were switched.  The SRM was changed to match.."
Consequently, we switched our definition in the struct per_cpu_slot.
[93/08/06            af]
[ ./kernel/mips/PMAX/model_dep.c ]
Fixed clock interrupt handling for 240s.
[93/07/29  23:30:38  af]

Added support for 5000/240, from John Wroclawski (jtw@lcs.mit.edu).
[93/05/29  09:56:54  af]

Initialize the interrupt mask register on maxine and kmin.
GCC quiet.
[93/05/06  09:39:18  af]
[ ./kernel/mips/mips_bcopy.s ]
Created.
[93/06/18            cmaeda]
[ ./kernel/ipc/ipc_kmsg.c ]
Religious-fix for GCC on alpha.  This compiler insists that
if a structure contains a long then it must be aligned and
also all fields in it must be.  So our trick with short and
long type descriptors would not play quite right, some 64bit
loads were generated for 32bit quantities.
Put casts all over the place for this.
[93/08/04            af]
[ ./kernel/man/Makefile ]
Added pc_sampling man pages.
[93/08/09            mrt]
[ ./kernel/man/task_enable_pc_sampling.man ]
First checkin

[ ./kernel/chips/frc.c ]
Made frc's accessible to kernel code via frc_address[].
[93/07/20            cmaeda]
[ ./kernel/chips/nc.c ]
Initial check-in.
[93/06/09  15:59:37  jcb]
[ ./kernel/chips/nc.h ]
Initial check-in.
[93/06/09  15:56:14  jcb]
[ ./kernel/chips/nw.h ]
Initial check-in.
[93/06/09  15:54:51  jcb]
[ ./kernel/chips/nw_mk.c ]
Initial check-in.
[93/06/09  16:00:26  jcb]
[ ./kernel/chips/nw_mk.h ]
Initial check-in.
[93/06/09  15:57:00  jcb]
[ ./kernel/chips/spans.c ]
Grabbed from jcb's branch.
[93/07/03  01:53:08  cmaeda]
[ ./kernel/chips/spans.h ]
Initial check-in.
[93/06/09  15:57:21  jcb]
[ ./kernel/chips/tca100.c ]
Initial check-in.
[93/06/09  16:00:50  jcb]
[ ./kernel/chips/tca100.h ]
Initial check-in.
[93/06/09  15:57:40  jcb]
[ ./kernel/chips/tca100_if.c ]
Added a switch to turn off error printf's.
[93/08/02            cmaeda]
Initial check-in.
[93/06/09  16:01:11  jcb]
[ ./kernel/chips/tca100_if.h ]
Initial check-in.
[93/06/09  15:57:59  jcb]
[ ./kernel/scsi/adapters/scsi_53C94_hdw.c ]
asc_wait() now complains only optionally.
Added proper LUN selection and reconnection.
Handle restore-pointer messages in reconnection phase.
This makes some Sony (also sold by DEC) CDROMs work.
[93/08/03            af]
[ ./kernel/scsi/rz_disk.c ]
Fix DIOCxxx ioctls to deal with MAXPARTITION or MAXPARTITION+1
parititions.  We'll do this better next release.
[93/08/09            rvb]
[ ./kernel/scsi/rz_labels.c ]
We now use bsd labels internally and convert from "local labels"
if we find them on the disk.
[93/08/03  20:36:46  rvb]
[ ./user/libmach/mips/bcopy.s ]
Created.
[93/06/18            cmaeda]
[ ./user/libmach/sbrk.c ]
Removed ns32000 from the silly machine list. The Multimax is dead
and the PC532 doesn't need any kludges. Fix by Johannes Helander
(jvh) at Helsinki University of Technology.
[93/08/09            mrt]
[ ./user/libmach/Makefile ]
Made device_stamp depend on files included by device/device.defs.
[93/07/12            cmaeda]

Added ATM kernel traps from jcb.
[93/07/03            cmaeda]

Added device traps.
[93/04/14            cmaeda]

Added evc_wait_clear.
[93/04/14            cmaeda]
[ ./kernel/man/task_enable_pc_sampling.man ]
Fixed the SEE ALSO reference
[ ./kernel/device/dk_label.c ]
Taken from rz_disk.c -- generic label code.
[93/08/10            rvb]
[ ./kernel/alpha/DEC/flamingo.c ]
Negated mask value used in setting kn15aa_tc7_imask in
kn15aa_enable_interrupt.
[93/08/10            mrt]
[ ./kernel/conf/MASTER ]
Added NET_ATM option for the new atm kernel traps.
[93/07/29            cmaeda]
[ ./kernel/conf/files ]
Added net_atm option to switch on the atm kernel traps.
[93/07/29            cmaeda]
[ ./kernel/conf/i386/files.bnr ]
Renamed i386at/grab_bob_label.c to scsi/pc_label.c
[93/08/06            rvb]
[ ./kernel/conf/i386/files ]
Renamed i386at/grab_bob_label.c to scsi/pc_label.c
Made it available for scsi, at386 and ps2
Added pc_scsi_label.c for scsi only.
[93/08/05            mrt]
[ ./kernel/conf/template.mk.bnr ]
/usr/include/machine/types.h defines vm_offset_t and vm_size_t
this causes us conflicts.  So substitute in our own types.h:
 	ln -s ../mach/machine/vm_types.h ${IHDR}machine/types.h
[93/08/05  12:09:04  rvb]
[ ./kernel/conf/mips/MASTER ]
Made atm conditional on net_atm

[ ./kernel/conf/mips/files ]
[93/08/02  14:52:58  cmaeda]
[ ./kernel/conf/m88k/files ]
Added scsi/pc_label.c
[93/08/05            mrt]
[ ./kernel/conf/alpha/files ]
Added scsi/pc_label.c
[93/08/05            mrt]
[ ./kernel/conf/MASTER.bnr ]
Added NET_ATM option for the new atm kernel traps.
[93/08/06            rvb]
[ ./kernel/conf/files.bnr ]
	Added net_atm option to switch on the atm kernel traps.
And device/dk_label.c
[93/08/06            rvb]
[ ./kernel/i386/pc_hd_label.c ]
Created by Robert Baron from hc.c
[ ./kernel/i386at/boot/Makefile ]
DEBUG -> LABEL_DEBUG
[93/08/02            rvb]
Enable Debugging printouts.
[93/07/09  15:22:09  rvb]
[ ./kernel/i386at/boot/boot.c ]
DEBUG -> LABEL_DEBUG
[93/08/02            rvb]
Under #ifdef DEBUG allow for FILE, LABEL and parition printout
[93/07/09  15:14:39  rvb]

Don't print out "Insert file system" message for 3.0
[93/06/29            rvb]
[ ./kernel/i386at/boot/boot.h ]
DEBUG -> LABEL_DEBUG
[93/08/02            rvb]
Under #ifdef DEBUG allow for FILE, LABEL and parition printout
[93/07/09  15:16:23  rvb]
[ ./kernel/i386at/boot/disk.c ]
DEBUG -> LABEL_DEBUG
"better" scheme for picking os partition.
[93/08/02            rvb]
Handle xxxbsd label
[93/07/09            rvb]
[ ./kernel/i386at/boot/start.s ]
Leave a seperator between $ and EXT to make gcc cpp happy.
[93/07/09            rvb]
[ ./kernel/i386at/boot/sys.c ]
DEBUG -> LABEL_DEBUG
[93/08/02            rvb]
Under #ifdef DEBUG allow for FILE, LABEL and parition printout
[93/07/09  15:17:39  rvb]
[ ./kernel/i386at/com.c ]
Add computc(char ch, int unit) puts a character out on the
give serial line.  For mice, etc.
Add comgetc(int unit) for same.
Add comparm(int unit, int baud, int intr, int mode, int modem)
[93/06/06            rvb]
[ ./kernel/i386at/hd.c ]
We now use bsd labels internally and convert from "local labels"
if we find them on the disk. 
[93/08/03  20:36:05  rvb]
[ ./kernel/i386at/autoconf.c ]
Iff rcline != -1, then proberc will turn on the com line first
thing.  So the rest of the probe will be reported thru rconsole.
[93/06/08            rvb]
[ ./kernel/i386at/disk.h ]
Deal with bsd labels
[93/07/09            rvb]
[ ./kernel/i386at/kd_mouse.c ]
Make protocol 5 (-- minor [40-47] ) be Microsoft mouse
but 7 bits.  If this works universally, change protocol 1.
[93/08/03            rvb]
Support Logitech TrackMan mouse (V [or M+]) protocol as
protocol 4 -- minor [32-39]
[ ./kernel/i386at/model_dep.c ]
Look for the rconsole serial line FIRST.
[93/06/17  22:43:15  rvb]
[ ./kernel/i386at/if_pc586.h ]
123e-346 is exponential notation in 2.4.4 NOT subtraction.
sigh ...
[93/07/19            rvb]
[ ./kernel/scsi/pc_label.c ]
Created by Robert Baron.

[ ./kernel/i386ps2/hd.c ]
changed partition -> localpartition for type declaration so not
to conflict with partition struct introduced in disklabel.h
[93/08/09            rvb]
[ ./kernel/scsi/pc_scsi_label.c ]
Moved here from i386at/grab_bob_label.c as the code now works
on scsi disks on many platforms.
	We now use bsd labels internally and convert from "local labels"
	if we find them on the disk.
[93/08/05            rvb]
[ ./kernel/conf/mips/MASTER ]
	Made atm conditional on net_atm
[93/08/10            mrt]
[ ./kernel/conf/i386/files.bnr ]
Added i386/pc_hd_label.c, scsi/pc_label.c and
scsi/pc_scsi_label.c.
[93/08/11            rvb]
[ ./kernel/conf/mips/MASTER ]
Add pseudo_device net_atm
[93/08/11            rvb]
[ ./bootstrap/alpha/exec.c ]
Fixed type blooper in aout_get_symtab(), which now works.
[93/08/19            af]
[ ./kernel/alpha/DEC/flamingo.c ]
Made kn15aa_tc7intr() drop in the debugger if it cannot 
handle an interrupt.  Else we would loop.
[93/08/31            af]
[ ./kernel/alpha/alpha_misc.c ]
To reboot one has to say the operator halted it.
[93/08/25            af]
[ ./kernel/alpha/boot/Makefile ]
Actually made it work with odemake.
[93/08/23            af]
[ ./kernel/alpha/boot/disk_boot.c ]
Contrary to SRM specs, the proms on the Flamingo
do not have a BOOT_DEF_FILE variable.  So try
for "mach" if we do not know what to do.
[93/08/26  17:34:37  af]
[ ./kernel/alpha/boot/test.c ]
main --> _main_
[93/08/26  17:33:09  af]
[ ./kernel/alpha/db_alpha_aout.c ]
Turn debugging off.
[93/08/31            af]
[ ./kernel/ipc/ipc_kmsg.c ]
Defend against the case of a long type that is mis-aligned.
This can be used (horrible fix, sorry) to solve the
issue of what to put in the filler spot of a troublesome
message.  This happens, for instance, with varsize inline
arrays followed by OOL data described by a long type.
One can use a bogus short-type that has the longform bit on...
[93/08/16            af]
[ ./kernel/conf/mips/files ]
Removed the device-driver flag from chips/{spans,nc,nw_mk}
since they are not really device drivers and don't need to
be compiled with special flags.
[93/08/31            mrt]
[ ./kernel/i386/iopb.c ]
io_bitmap_init() now takes an argument stating whether to allow
or inhibit access to ALL io ports.  Now opening iopl gives total
access.
[93/08/19            rvb]
[ ./kernel/i386/iopb.h ]
Support for 64k bit io bitmaps.
[93/08/19            rvb]
[ ./kernel/i386at/iopl.c ]
For X11R5, allow any old address to be mmapped.
[93/08/19            rvb]
